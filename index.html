<script>
// Funci√≥n placeholder para evitar error de referencia
function cargarEmailsGuardados() {
    // Aqu√≠ puedes implementar la carga de emails guardados si es necesario
    console.log('cargarEmailsGuardados llamada (placeholder)');
}
</script>
<!-- Configuraci√≥n de Notificaciones (oculto por defecto, mostrar con JS si es necesario) -->
<div id="notificationSettingsPanel" class="notification-settings" style="display:none;">
    <h2 style="margin-bottom:20px; color:#3366CC;">Configuraci√≥n de Notificaciones</h2>
    <div style="display:flex; flex-direction:column; gap:18px;">
        <label style="display:flex; align-items:center; gap:10px;">
            <input type="checkbox" id="enableNotifications" checked>
            Habilitar notificaciones
        </label>
        <label style="display:none; align-items:center; gap:10px;">
            <input type="checkbox" id="enableSounds" checked>
            Sonido de notificaci√≥n
        </label>
        <label style="display:flex; align-items:center; gap:10px;">
            Duraci√≥n (segundos):
            <input type="number" id="notificationDuration" min="1" max="60" value="5" style="width:60px;">
        </label>
        <label style="display:flex; align-items:center; gap:10px;">
            M√°x. notificaciones visibles:
            <input type="number" id="maxNotifications" min="1" max="20" value="5" style="width:60px;">
        </label>
        <button onclick="saveNotificationSettings()" style="background:#3366CC; color:white; border:none; padding:10px 20px; border-radius:8px; font-weight:600; cursor:pointer;">Guardar configuraci√≥n</button>
    </div>
        <script>
            window.toggleBannerTicker = function(){
                try {
                    const ticker = document.getElementById('bannerTicker');
                    const btn = document.getElementById('bannerToggle');
                    if(!ticker || !btn) return;
                    const paused = ticker.classList.toggle('is-paused');
                    btn.textContent = paused ? '‚ñ∂' : '‚ùö‚ùö';
                    btn.setAttribute('aria-label', paused ? 'Reanudar desplazamiento' : 'Pausar desplazamiento');
                    btn.title = paused ? 'Reanudar' : 'Pausar';
                } catch(e) { /* noop */ }
            };
        </script>
</div>
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ACHS Ejecutivo Centralizado</title>
    <!-- ‚úÖ CSS Y JS INTEGRADOS EN EL HTML - 2025-11-11 -->
    <style>
        /* ========================================
           ESTILOS MIGRADOS DESDE assets/css/styles.css
           ======================================== */
        
        /* B√∫squeda r√°pida (Ctrl+K) */
                /* ===== Banner Ticker Superior ===== */
                .banner-ticker {
                    position:fixed; top:0; left:0; width:100%; height:44px;
                    background:linear-gradient(135deg, #002d5c 0%, #004c8c 50%, #002d5c 100%);
                    color:#fff; font-family:'Helvetica Rounded', 'Arial Rounded MT Bold', 'Helvetica Neue', 'Helvetica', sans-serif;
                    overflow:hidden; z-index:950; box-shadow:0 3px 12px rgba(0, 45, 92, 0.15);
                    display:flex; align-items:center; border-bottom:2px solid rgba(255,255,255,0.1);
                    padding:0 44px 0 12px;
                }
                .banner-ticker .banner-inner {
                    white-space:nowrap; display:inline-block;
                    animation: tickerScroll 20s linear infinite;
                    padding-left:100%; /* Empieza fuera de pantalla */
                }
                .banner-ticker .banner-text { font-size:1.15rem; letter-spacing:.5px; font-weight:600; }
                .banner-ticker:hover .banner-inner { animation-play-state: paused; }
                .banner-ticker.is-paused .banner-inner { animation-play-state: paused; }
                .banner-ticker .banner-toggle{
                    position:absolute; right:8px; top:50%; transform:translateY(-50%);
                    background:rgba(255,255,255,0.15); color:#fff; border:1px solid rgba(255,255,255,0.25);
                    padding:5px 10px; border-radius:20px; font-size:11px; cursor:pointer;
                    line-height:1; backdrop-filter:blur(8px); font-weight:500;
                    transition: all 0.3s ease;
                }
                .banner-ticker .banner-toggle:hover{ 
                    background:rgba(255,255,255,0.25); 
                    box-shadow: 0 2px 8px rgba(255,255,255,0.2);
                    transform:translateY(-50%) scale(1.05);
                }
                @keyframes tickerScroll {
                    0% { transform:translateX(0); }
                    100% { transform:translateX(-100%); }
                }
                /* Ajustar desplazamiento del resto del contenido para no quedar bajo el banner */
                body { padding-top:50px; }
        #busquedaRapidaOverlay {
          display: none;
          position: fixed;
          top: 0; left: 0; width: 100vw; height: 100vh;
          z-index: 120000;
          background: rgba(30,41,59,0.18);
          justify-content: center;
          align-items: flex-start;
        }
        #busquedaRapidaBox {
          margin-top: 10vh;
          background: #fff;
          border-radius: 14px;
          box-shadow: 0 8px 32px rgba(0,33,71,0.18);
          padding: 1.2rem 1.5rem 1.1rem 1.5rem;
          min-width: 340px;
          max-width: 90vw;
          width: 420px;
        }
        #busquedaRapidaInput {
          font-size: 1.1em;
          padding: 8px 12px;
          border-radius: 8px;
          border: 1px solid #cbd5e1;
          outline: none;
          width: 100%;
          box-sizing: border-box;
        }
        #busquedaRapidaResultados {
          list-style: none;
          margin: 14px 0 0 0;
          padding: 0;
          max-height: 260px;
          overflow-y: auto;
        }
        #busquedaRapidaResultados li {
          padding: 8px 10px;
          border-radius: 7px;
          cursor: pointer;
          font-size: 1.04em;
          color: #1e293b;
          transition: background 0.13s;
        }
        #busquedaRapidaResultados li.selected,
        #busquedaRapidaResultados li:hover {
          background: #e0e7ff;
          color: #3730a3;
        }
        #busquedaRapidaVacio {
          color: #64748b;
          font-size: .97em;
          margin-top: 10px;
        }
        
        .submenu-snl {
          position:fixed; top:115px; right:200px;
          background:linear-gradient(135deg,#ffffff 40%,#eef5ff 100%);
          border-radius:14px;
          box-shadow:0 10px 30px rgba(0,0,0,0.16);
          padding:14px; width:380px; display:none; z-index:9998;
          border:2px solid #3b82f6;
        }
        .submenu-snl.show { display:block; animation: slideInRight .35s ease; }
        .submenu-snl-item {
          padding:10px 12px; border-radius:10px; font-weight:600; cursor:pointer; margin-bottom:6px;
          background:linear-gradient(90deg,#ffffff 0%,#e0f2fe 100%);
          color:#1e3a8a; box-shadow:0 2px 6px rgba(59,130,246,0.12);
          border:1px solid #3b82f6;
          transition:background .18s, color .18s, box-shadow .18s, transform .18s;
        }
        .submenu-snl-item:hover, .submenu-snl-item:focus {
          background:linear-gradient(90deg,#bfdbfe 0%,#e0f2fe 100%);
          color:#0f172a;
          box-shadow:0 4px 14px rgba(59,130,246,0.28);
          transform:translateY(-2px);
        }
        .submenu-snl-item:active {
          transform:translateY(0);
          box-shadow:0 2px 8px rgba(59,130,246,0.25);
        }
        .submenu-snl-item.active {
          background:linear-gradient(90deg,#93c5fd 0%,#e0f2fe 100%);
          color:#0f172a;
          border:2px solid #2563eb;
          box-shadow:0 0 0 3px rgba(37,99,235,0.25),0 4px 14px rgba(59,130,246,0.28);
          position:relative;
        }
        .submenu-snl-item.active::after {
          content:"‚úî";
          position:absolute; right:10px; top:50%; transform:translateY(-50%);
          font-size:0.95em; color:#1e3a8a; opacity:.9;
        }

        @keyframes slideInRight { from { opacity:0; transform:translateX(40px);} to { opacity:1; transform:translateX(0);} }

        /* Calendario flotante */
        .panel-calendario { position:fixed; top:90px; right:20px; left:auto; background:#fff; border-radius:16px; box-shadow:0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1); padding:0; width:300px; z-index:1200; font-family:'Helvetica Rounded', 'Arial Rounded MT Bold', 'Helvetica Neue', 'Helvetica', sans-serif; }
        .cal-header { text-align:center; padding:6px 4px; font-weight:600; color:#6b7280; background:#f9fafb; font-size:0.75rem; }
        .cal-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:4px; padding:10px; }
        .cal-day { text-align:center; padding:6px 4px; border-radius:6px; font-weight:500; color:#1f2937; background:#f9fafb; font-size:0.8rem; min-height:32px; display:flex; align-items:center; justify-content:center; }
        .cal-day:empty { background:transparent; }
        .cal-hoy { outline:2px solid #3498db !important; background:#dbeafe !important; font-weight:700 !important; color:#1e40af !important; }
        .cal-feriado { background:#fee2e2 !important; color:#b91c1c !important; font-weight:600 !important; }

        /* Transici√≥n suave al cambiar de mes */
        .cal-fade { animation: calFade .18s ease; }
        @keyframes calFade { from { opacity: .35; transform: translateY(4px); } to { opacity: 1; transform: translateY(0);} }

        /* Bot√≥n flotante de ayuda */
        .help-fab {
          position: fixed !important;
          right: 20px !important;
          bottom: 20px !important;
          z-index: 99999 !important;
          background: #2563eb;
          color: white;
          border: none;
          border-radius: 999px;
          padding: 10px 14px;
          font-weight: 700;
          box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1);
          cursor: pointer;
          transition: transform 150ms cubic-bezier(0.4, 0, 0.2, 1), box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1), background 150ms cubic-bezier(0.4, 0, 0.2, 1);
          display: block !important;
          opacity: 1 !important;
          pointer-events: auto !important;
        }
        .help-fab:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1); background:#1e40af; }
        .help-fab small { font-weight:600; opacity:.95; }

        /* Modal Siglas de Agencias */
        .sigla-lista-vertical { display:flex; flex-direction:column; gap:14px; max-height:55vh; overflow-y:auto; margin-bottom:10px; }
        .titulo-seccion { color:#007bff; font-weight:700; font-size:1.2em; margin-bottom:10px; }
        .importante { background:#fff3cd; border:1px solid #ffc107; padding:10px; border-radius:5px; color:#856404; font-weight:bold; }
        .destacado { background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold; }
        .contacto { background:#e3f2fd; border:1px solid #2196f3; padding:15px; border-radius:8px; text-align:center; }
        .alerta-critica { background:#ffcdd2; border:2px solid #f44336; padding:15px; border-radius:8px; text-align:center; color:#c62828; font-weight:bold; margin:15px 0; }
        .pregunta { font-weight:bold; color:#007bff; }

        /* Estilo del modal de ayuda */
        .modal-ayuda-contenido {
          max-width: 760px;
          background: #fff;
          border-radius: 16px;
          box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -4px rgba(0,0,0,0.1);
          padding: 1.5rem;
          position: relative;
          max-height: 90vh;
          overflow-y: auto;
        }
        .modal-ayuda-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:8px; }
        .modal-ayuda-title { font-size:1.2rem; font-weight:800; color:#1f2937; }
        .modal-ayuda-close { background:transparent; border:none; font-size:1.2rem; cursor:pointer; color:#6b7280; }
        .modal-ayuda-close:hover { color:#111827; }
        .modal-ayuda-section h4 { margin:.6rem 0 .25rem; font-size:1rem; color:#111827; }
        .modal-ayuda-section p { margin:0 0 .5rem; color:#374151; font-size:.95rem; }
        .modal-ayuda-section ul { margin:.25rem 0 .75rem 1rem; }
        .badge { display:inline-block; background:#eef2ff; color:#3730a3; border:1px solid #c7d2fe; border-radius:999px; padding:2px 8px; font-size:.75rem; font-weight:700; }

        /* Encuesta Satisfacci√≥n / Script LE bloques comunes */
        .escala { background:#eef2ff; border:1px solid #6366f1; padding:8px 12px; border-radius:6px; font-size:0.85rem; color:#374151; margin:8px 0 14px; font-weight:600; }
        .nota { background:#f0f9ff; border:1px solid #0ea5e9; padding:10px 14px; border-radius:8px; font-size:0.85rem; color:#075985; margin:12px 0; }
        .seccion hr { border:none; border-top:1px solid #e5e7eb; margin:24px 0; }
        .sigla-tarjeta-grande { display:flex; align-items:center; gap:18px; background:linear-gradient(90deg,#e3eafc 70%,#f8fafc 100%); border:2px solid #b8c2c9; border-radius:12px; padding:16px 20px; box-shadow:0 2px 12px rgba(30,58,138,0.08); transition:box-shadow .2s, border-color .2s; cursor:pointer; }
        .sigla-tarjeta-grande:hover { box-shadow:0 4px 18px rgba(30,58,138,0.18); border-color:#2563eb; }
        .sigla-tarjeta-icono { font-size:2.1em; color:#2563eb; flex-shrink:0; }
        .sigla-tarjeta-info { display:flex; flex-direction:column; }
        .sigla-tarjeta-sigla { font-weight:bold; color:#1e3a8a; font-size:1.18em; letter-spacing:1px; }
        .sigla-tarjeta-agencia { color:#222; font-size:1.05em; }

        /* Estilos para impresi√≥n Script SNL */
        .print-snl-body { font-family: 'Helvetica Rounded', 'Arial Rounded MT Bold', 'Helvetica Neue', 'Helvetica', Arial, sans-serif; line-height:1.6; margin:40px; color:#2c3e50; background:#f8f9fa; }
        .print-snl-header { text-align:center; margin-bottom:30px; padding:20px; background:linear-gradient(135deg,#27ae60,#2ecc71); color:#fff; border-radius:10px; box-shadow:0 4px 15px rgba(39,174,96,0.3); }
        .print-snl-section { margin:20px 0; padding:15px; border-left:4px solid #27ae60; background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
        .print-snl-title { font-weight:700; color:#27ae60; font-size:1.2em; margin-bottom:10px; }
        .print-snl-important { background:#d5f4e6; padding:10px; border-radius:5px; border:1px solid #27ae60; margin:10px 0; }
        .print-snl-destacado { background:#fff3cd; padding:2px 6px; border-radius:3px; font-weight:700; }
        .print-snl-contacto { background:#e1f5fe; padding:10px; border-radius:5px; border:1px solid #03a9f4; margin:10px 0; text-align:center; }
        .print-snl-pregunta { font-weight:700; color:#2980b9; margin:8px 0; }
        .print-snl-escala { background:#e8f5e8; padding:8px; border-radius:5px; font-style:italic; }

        /* Estilos para impresi√≥n Script LE */
        .print-le-body { font-family: 'Helvetica Rounded', 'Arial Rounded MT Bold', 'Helvetica Neue', 'Helvetica', Arial, sans-serif; line-height:1.6; margin:40px; color:#2c3e50; background:#f8f9fa; }
        .print-le-header { text-align:center; margin-bottom:30px; padding:20px; background:linear-gradient(135deg,#9b59b6,#8e44ad); color:#fff; border-radius:10px; box-shadow:0 4px 15px rgba(155,89,182,0.3); }
        .print-le-section { margin:20px 0; padding:15px; border-left:4px solid #9b59b6; background:#fff; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
        .print-le-title { font-weight:700; font-size:1.2em; color:#8e44ad; margin-bottom:10px; display:flex; align-items:center; gap:10px; }
        .print-le-destacado { background:#fff3cd; padding:2px 6px; border-radius:4px; font-weight:700; color:#856404; }
        .print-le-importante { background:#f8d7da; border:1px solid #f5c6cb; padding:15px; border-radius:8px; margin:10px 0; color:#721c24; }
        .print-le-nota { background:#d1ecf1; border:1px solid #bee5eb; padding:15px; border-radius:8px; margin:10px 0; color:#0c5460; }
        .print-le-footer { margin-top:40px; text-align:center; color:#6c757d; font-size:0.9em; }
        .print-le-pregunta { font-weight:700; color:#2980b9; margin:8px 0; }
        .print-le-faq { background:#e8f5e8; padding:10px; border-radius:5px; margin:8px 0; }
        .print-le-faq-titulo { font-weight:700; color:#155724; }
        .print-le-hr { border:none; height:2px; background:linear-gradient(90deg,#9b59b6,#8e44ad); margin:30px 0; }
        
        /* ========================================
           FIN ESTILOS MIGRADOS - Inicio estilos legados
           ======================================== */
                /* INICIO BLOQUE LEGADO: Ser√° migrado a assets/css/styles.css en pasos.
                   Fecha inicio migraci√≥n: 2025-11-10 */
                :root {
                        --primary-blue: #080606;
                        --secondary-blue: #0c0101;
                        --accent-blue: #040c72;
                        --light-blue: #00A1E0;
                        --dark-navy: #0f172a;
                        --success-green: #c50e1e;
                        --warning-amber: #d97706;
                        --error-red: #dc2626;
                        --neutral-gray: #3076e3;
                        --soft-white: #e8eef3;
                        --pure-white: #f2f6f9;
                        /* Gradientes */
                        --gradient-primary: linear-gradient(135deg, #00A1E0 100%);
                        --gradient-secondary: linear-gradient(135deg, #00A1E0 100%);
                        --gradient-accent: linear-gradient(135deg, #00A1E0 100%);
                        --gradient-background: linear-gradient(135deg, #00A1E0 100%);
                        /* Sombras */
                        --shadow-sm: 0 1px 3px rgb(238, 231, 231), 0 1px 2px rgba(0, 0, 0, 0.06);
                        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
                        --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
                        --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.1);
                        /* Espaciado consistente */
                        --spacing-xs: 0.5rem;    /* 8px - espaciado m√≠nimo entre elementos */
                        --spacing-sm: 0.75rem;   /* 12px - espaciado peque√±o */
                        --spacing-md: 1rem;      /* 16px - espaciado medio */
                        --spacing-lg: 1.5rem;    /* 24px - espaciado grande */
                        --spacing-xl: 2rem;      /* 32px - espaciado extra grande */
                        --spacing-2xl: 3rem;     /* 48px - espaciado entre secciones */
                        /* Border radius */
                        --radius-sm: 6px;
                        --radius-md: 10px;
                        --radius-lg: 16px;
                        --radius-xl: 20px;
                }

/* 
<!-- Bot√≥n LEY KARIN al lado de INFORMACION EP y Modal (ubica esto en el body donde corresponda) -->
<!--
<button id="btnLeyKarin" class="btn-secundario hover-scale" onclick="abrirModalLeyKarin()" data-tooltip="Preguntas Frecuentes Ley Karin">‚öñÔ∏è LEY KARIN</button>
<div id="modalLeyKarin" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:700px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(0,33,71,0.15); padding:2rem; position:relative; overflow-y:auto; max-height:90vh;">
        <button onclick="cerrarModalLeyKarin()" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#1e3a8a; cursor:pointer;">&times;</button>
        <h2 style="color:#1e3a8a; margin-bottom:1rem; text-align:center;">‚öñÔ∏è Ley Karin ‚Äì Preguntas Frecuentes ACHS Seguro Laboral</h2>
        <div style="font-size:1em; color:#222; line-height:1.6; max-height:70vh; overflow-y:auto; padding-right:8px;">
            <!-- ...contenido de preguntas frecuentes... -->
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

-->
*/

        /* Tipograf√≠a modernizada: pila de fuentes del sistema para rendimiento y legibilidad.
           Incluye variables para escalas y line-height consistentes.
           Se evita carga externa (Google Fonts) para mantener velocidad. */
        :root {
            --font-sans: 'Helvetica Rounded', 'Arial Rounded MT Bold', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif;
            --font-mono: ui-monospace, SFMono-Regular, 'Segoe UI Mono', 'Roboto Mono', Menlo, Consolas, 'Liberation Mono', monospace;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.85rem;
            --font-size-base: 0.95rem;
            --font-size-md: 1.05rem;
            --font-size-lg: 1.25rem;
            --font-size-xl: 1.6rem;
            --line-height-tight: 1.2;
            --line-height-base: 1.5;
            --line-height-relaxed: 1.65;
            --letter-spacing-tight: -0.015em;
            --letter-spacing-normal: 0;
        }

        body {
            font-family: var(--font-sans);
            font-size: var(--font-size-base);
            line-height: var(--line-height-base);
            letter-spacing: var(--letter-spacing-normal);
            background: #ffffff;
            margin: 0;
            padding: var(--spacing-lg);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .container-principal {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(200, 215, 225, 0.98);
            border-radius: var(--radius-xl);
            padding: var(--spacing-2xl);
            box-shadow: var(--shadow-xl);
            backdrop-filter: blur(20px);
            border: 1px solid rgb(224, 229, 231);

         
        }
        
        .titulo {
            color: var(--primary-blue);
            font-weight: 700;
            font-size: clamp(2.1rem, 4vw, 3.1rem);
            margin-bottom: var(--spacing-md);
            text-align: center;
            text-shadow: 0 2px 4px rgba(30, 58, 138, 0.12);
            border-bottom: 3px solid var(--accent-blue);
            padding-bottom: var(--spacing-md);
            letter-spacing: var(--letter-spacing-tight);
            line-height: var(--line-height-tight);
            font-family: var(--font-sans);
        }

        .subtitulo {
            color: var(--text-secondary);
            font-weight: 500;
            font-size: clamp(1.15rem, 2.3vw, 1.5rem);
            margin-bottom: var(--spacing-2xl);
            text-align: center;
            font-style: normal;
            opacity: 0.85;
            letter-spacing: var(--letter-spacing-normal);
            line-height: var(--line-height-relaxed);
            font-family: var(--font-sans);
        }
        
        .seccion-formulario {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-2xl);
        }
        
        .formulario-principal {
            background: rgba(210, 220, 230, 0.98);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg); /* 24px de padding interno */
            border: 2px solid var(--light-blue);
            box-shadow: var(--shadow-md);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .formulario-principal:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .form-group {
            margin-bottom: var(--spacing-md); /* 16px entre grupos de formulario */
        }
        
        .form-label {
            color: var(--primary-blue);
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: var(--spacing-xs); /* 8px entre label e input */
            display: block;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: var(--spacing-sm); /* 12px de padding interno */
            border: 3px solid var(--secondary-blue);
            border-radius: var(--radius-sm);
            font-size: 0.95rem;
            transition: all 0.2s ease;
            background: rgba(238, 244, 248, 0.95);
            color: var(--dark-navy);
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            border-width: 4px;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.2);
            background: rgba(245, 249, 252, 0.98);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }
        
        .seccion-calendario {
            margin-bottom: var(--spacing-2xl);
        }
        
        .calendario-container {
            background: rgba(238, 244, 248, 0.98);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--light-blue);
        }
        
        .reloj-digital {
            text-align: center;
            margin-bottom: var(--spacing-xl);
            padding: var(--spacing-xl);
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            color: white;
        }
        
        .reloj-tiempo {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: var(--spacing-sm);
            font-variant-numeric: tabular-nums;
        }
        
        .reloj-fecha {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 400;
        }
        
        .calendario-dia {
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #e9ecef;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            min-height: 32px;
            font-size: 0.8em;
        }
        
        .calendario-dia:hover {
            background: #e3f2fd;
            transform: scale(1.05);
        }
        
        .dia-actual {
            background: #007bff !important;
            color: white !important;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
        }
        
        .dia-feriado {
            background: #ffebee !important;
            color: #c62828 !important;
            font-weight: bold;
        }
        
        .dia-feriado::after {
            content: "üéä";
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7em;
        }
        
        .dia-otro-mes {
            color: #bbb;
            background: #e0e8f0;
        }
        
        .dia-fin-semana {
            background: #d8e5d8;
        }
        
        .tooltip-feriado {
            position: absolute;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8em;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            max-width: 200px;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .tooltip-feriado::before {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }
        
        .calendario-dia.seleccionado {
            background: #28a745 !important;
            color: white !important;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        label {
            font-weight: bold;
            display: block;
            margin-top: 10px;
        }
        
        select, input[type="text"], input[type="date"] {
            width: 100%;
            padding: 5px;
            margin-top: 5px;
            margin-bottom: 10px;
            font-size: 1em;
        }
        
        form {
            max-width: 400px;
            margin-left: 0;
            margin-right: auto;
            border: 2px solid #002147;
            border-radius: 10px;
            padding: 20px;
            background: #e8f0f8;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        /* Sistema de botones por prioridad */
        .botones-principales {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg); /* 24px entre secciones de botones */
        }
        
        .botones-primarios {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: var(--spacing-sm); /* 12px entre botones primarios */
            margin-bottom: 0; /* Removido, se usa gap del contenedor */
        }
        
        .botones-consulta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: var(--spacing-sm); /* 12px entre botones de consulta */
            margin-bottom: 0; /* Removido, se usa gap del contenedor */
        }
        
        .botones-herramientas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--spacing-xs); /* 8px entre herramientas (m√°s compacto) */
        }
        
        .btn-primario {
            /* Paleta moderna solo para botones (no se altera fondo general) */
            background: linear-gradient(135deg, #0EA5E9 0%, #2563EB 100%); /* cyan->indigo */
            color: #ffffff;
            padding: var(--spacing-sm) var(--spacing-md); /* 12px vertical, 16px horizontal */
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.95rem;
            border: none;
            cursor: pointer;
            min-height: 42px; /* Aumentado de 36px a 42px para mejor clickabilidad */
            box-shadow: 0 6px 14px rgba(37, 99, 235, 0.25);
            transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs); /* 8px entre icono y texto */
        }
        
        .btn-primario:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 24px rgba(37, 99, 235, 0.35);
            filter: brightness(1.05);
        }
        .btn-primario:active { transform: translateY(0); }
        .btn-primario:focus { outline: none; box-shadow: 0 0 0 3px rgba(37,99,235,.25); }
        
        .btn-secundario {
            background: #ffffff;
            color: #2563EB;
            border: 2px solid #3B82F6; /* azul medio moderno */
            padding: var(--spacing-sm) var(--spacing-md); /* 12px vertical, 16px horizontal */
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            min-height: 42px; /* Consistente con botones primarios */
            transition: transform .18s ease, box-shadow .18s ease, background .18s ease, color .18s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs); /* 8px entre icono y texto */
        }
        
        .btn-secundario:hover {
            background: #EFF6FF; /* azul muy claro */
            color: #1D4ED8;
            border-color: #2563EB;
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.15);
        }
        .btn-secundario:active { transform: translateY(0); }
        .btn-secundario:focus { outline: none; box-shadow: 0 0 0 3px rgba(59,130,246,.25); }
        
        .btn-herramienta {
            background: #3366CC;
            color: #fff;
            padding: var(--spacing-xs) var(--spacing-sm); /* 8px vertical, 12px horizontal (m√°s compacto) */
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-weight: 500;
            border: 2px solid #348fff;
            cursor: pointer;
            min-height: 36px; /* Ligeramente m√°s peque√±o que primarios/secundarios */
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px; /* Gap fijo m√°s peque√±o para herramientas */
        }
        
        .btn-herramienta:hover {
            background: #2176d2;
            color: #fff;
            border: 2px solid #2176d2;
            /* Sin cambio de color ni sombra al pasar el mouse */
            transform: none;
            box-shadow: none;
        }
        
        .btn-especial {
            background: var(--error-red);
            color: white;
        }
        
        .btn-especial:hover {
            background: #b91c1c;
        }
        
        /* ===== ESTILOS DEL BOT√ìN ANEXO ENTRETENIDO ===== */
        .btn-anexo-entretenido {
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            overflow: hidden;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transform-style: preserve-3d;
            animation: pulsoSuave 3s infinite ease-in-out;
        }
        
        .btn-anexo-entretenido::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s;
        }
        
        .btn-anexo-entretenido:hover::before {
            left: 100%;
        }
        
        .btn-anexo-entretenido:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.5);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            animation: none;
        }
        
        .btn-anexo-entretenido:active {
            transform: translateY(-1px) scale(1.02);
            transition: all 0.1s;
        }
        
        .btn-anexo-icono {
            font-size: 16px;
            animation: giroSuave 4s infinite linear;
            display: inline-block;
        }
        
        .btn-anexo-texto {
            font-size: 13px;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .btn-anexo-efectos {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 120%;
            height: 120%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .btn-anexo-entretenido:hover .btn-anexo-efectos {
            transform: translate(-50%, -50%) scale(1);
            opacity: 0.7;
        }
        
        .btn-anexo-entretenido:hover .btn-anexo-icono {
            animation: saltarIcono 0.6s ease-in-out;
        }
        
        /* Animaciones especiales */
        @keyframes pulsoSuave {
            0%, 100% { 
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            }
            50% { 
                box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
            }
        }
        
        @keyframes giroSuave {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            50% { transform: rotate(0deg); }
            75% { transform: rotate(-5deg); }
            100% { transform: rotate(0deg); }
        }
        
        @keyframes saltarIcono {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(10deg); }
            50% { transform: translateY(-3px) rotate(-5deg); }
            75% { transform: translateY(-2px) rotate(5deg); }
        }
        
        /* Efectos de part√≠culas para el bot√≥n anexo */
        .btn-anexo-entretenido:hover::after {
            content: '‚ú®';
            position: absolute;
            top: -10px;
            right: -10px;
            font-size: 12px;
            animation: brillar 1s ease-in-out;
            pointer-events: none;
        }
        
        @keyframes brillar {
            0% { opacity: 0; transform: scale(0) rotate(0deg); }
            50% { opacity: 1; transform: scale(1.2) rotate(180deg); }
            100% { opacity: 0; transform: scale(0) rotate(360deg); }
        }
        
        /* Responsive para el bot√≥n anexo */
        @media (max-width: 768px) {
            .btn-anexo-entretenido {
                min-width: 120px;
                padding: 10px 16px;
                font-size: 13px;
            }
            
            .btn-anexo-icono {
                font-size: 18px;
            }
        }
        /* ===== FIN ESTILOS BOT√ìN ANEXO ENTRETENIDO ===== */
        
        
        .seccion-historial {
            background: rgba(200, 215, 225, 0.98);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--light-blue);
        }
        
        .historial-header {
            color: var(--primary-blue);
            font-weight: 700;
            font-size: 1.4rem;
            text-align: center;
            margin-bottom: var(--spacing-md);
            position: relative;
        }
        
        .historial-header::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 2px;
            background: var(--accent-blue);
            border-radius: 2px;
        }
        
        .botones-historial {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }
        
        .tabla-container {
            overflow-x: auto;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--light-blue);
        }
        
        .tabla-historial {
            width: 100%;
            border-collapse: collapse;
            background: rgba(215, 225, 235, 0.98);
            font-size: 0.85rem;
        }
        
        .tabla-historial thead {
            background: var(--gradient-primary);
            color: white;
        }
        
        .tabla-historial th {
            padding: var(--spacing-sm) var(--spacing-sm);
            font-weight: 700;
            text-align: left;
            border-bottom: 2px solid var(--accent-blue);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: black;
        }
        
        .tabla-historial tbody tr {
            transition: all 0.2s ease;
        }
        
        .tabla-historial tbody tr:nth-child(even) {
            background: rgba(232, 240, 246, 0.95);
        }
        
        .tabla-historial tbody tr:hover {
            background: var(--light-blue);
            transform: scale(1.005);
            box-shadow: var(--shadow-sm);
        }
        
        .tabla-historial td {
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--light-blue);
            vertical-align: middle;
        }
        
        
        /* Animaciones y transiciones globales */
        * {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Animaciones de entrada */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .fade-in-up {
            animation: slideInUp 0.6s ease-out;
        }
        
        .fade-in-scale {
            animation: fadeInScale 0.5s ease-out;
        }
        
        .slide-in-right {
            animation: slideInRight 0.7s ease-out;
        }
        
        /* Efectos hover mejorados */
        .hover-lift:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .hover-scale:hover {
            transform: scale(1.02);
        }
        
        /* Indicadores de carga */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Pulso para elementos activos */
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.05);
            }
        }
        
        /* Estilos para botones flotantes */
        .btn-flotante-ep {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 50%, #ff6b6b 100%);
            background-size: 200% 200%;
            animation: gradientFloating 4s ease infinite;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3), 
                        0 8px 25px rgba(255, 107, 107, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            white-space: nowrap;
            backdrop-filter: blur(10px);
        }
        
        /* Estilos para el bot√≥n flotante SCRIPT SNL */
        .btn-flotante-snl {
            position: fixed;
            top: 70px;
            right: 20px;
            z-index: 9999;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 50%, #2ecc71 100%);
            background-size: 200% 200%;
            animation: gradientFloatingSNL 4s ease infinite;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3), 
                        0 8px 25px rgba(46, 204, 113, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            white-space: nowrap;
            backdrop-filter: blur(10px);
        }
          .btn-flotante-ep:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4), 
                        0 12px 35px rgba(255, 107, 107, 0.3);
        }
        
        .btn-flotante-snl:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4), 
                        0 12px 35px rgba(46, 204, 113, 0.3);
        }

        .btn-flotante-ep:active {
            transform: translateY(0) scale(0.98);
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
        }
        
        .btn-flotante-snl:active {
            transform: translateY(0) scale(0.98);
            box-shadow: 0 2px 8px rgba(46, 204, 113, 0.3);
        }
          @keyframes gradientFloating {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes gradientFloatingSNL {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes sparkle {
            0%, 100% { 
                opacity: 0; 
                transform: scale(0.5) rotate(0deg); 
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1) rotate(180deg); 
            }
        }
          .btn-flotante-ep::before {
            content: '‚ú®';
            position: absolute;
            top: -8px;
            left: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite;
            filter: drop-shadow(0 2px 4px rgba(255,215,0,0.5));
        }

        .btn-flotante-ep::after {
            content: 'üíº';
            position: absolute;
            bottom: -8px;
            right: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite 1.5s;
            filter: drop-shadow(0 2px 4px rgba(255,215,0,0.5));
        }
        
        .btn-flotante-snl::before {
            content: '‚≠ê';
            position: absolute;
            top: -8px;
            left: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite;
            filter: drop-shadow(0 2px 4px rgba(255,215,0,0.5));
        }

        .btn-flotante-snl::after {
            content: 'üíö';
            position: absolute;
            bottom: -8px;
            right: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite 1.5s;
            filter: drop-shadow(0 2px 4px rgba(255,215,0,0.5));
        }

        /* Estilos para el submen√∫ desplegable SNL */
        .submenu-snl {
            position: fixed;
            top: 115px;
            right: 200px;
            z-index: 9998;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(46, 204, 113, 0.3);
            padding: 8px 0;
            min-width: 380px;
            display: none;
            animation: slideInRight 0.3s ease;
            border: 2px solid #27ae60;
        }

        .submenu-snl.show {
            display: block;
        }

        .submenu-snl-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #2c3e50;
            font-weight: 500;
            font-size: 14px;
            border-left: 3px solid transparent;
        }

        .submenu-snl-item:hover {
            background: linear-gradient(90deg, #eafaf1 0%, #fff 100%);
            border-left: 3px solid #27ae60;
            color: #27ae60;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* Estilos para el bot√≥n flotante SCRIPT SNL 2.0 */
        .btn-flotante-snl2 {
            position: fixed;
            top: 170px;
            right: 20px;
            z-index: 9999;
            background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 50%, #00d2ff 100%);
            background-size: 200% 200%;
            animation: gradientFloatingSNL2 4s ease infinite;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            box-shadow: 0 4px 15px rgba(0, 210, 255, 0.3), 
                        0 8px 25px rgba(0, 210, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            white-space: nowrap;
            backdrop-filter: blur(10px);
        }
        
        .btn-flotante-snl2:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 210, 255, 0.4), 
                        0 12px 35px rgba(0, 210, 255, 0.3);
        }

        .btn-flotante-snl2:active {
            transform: translateY(0) scale(0.98);
            box-shadow: 0 2px 8px rgba(0, 210, 255, 0.3);
        }
        
        @keyframes gradientFloatingSNL2 {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .btn-flotante-snl2::before {
            content: 'üìû';
            position: absolute;
            top: -8px;
            left: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite;
            filter: drop-shadow(0 2px 4px rgba(0,210,255,0.5));
        }

        .btn-flotante-snl2::after {
            content: 'üè•';
            position: absolute;
            bottom: -8px;
            right: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite 1.5s;
            filter: drop-shadow(0 2px 4px rgba(0,210,255,0.5));
        }

        /* Estilos para el submen√∫ desplegable SNL 2.0 */
        .submenu-snl2 {
            position:fixed; top:225px; right:200px;
            background:linear-gradient(135deg,#ffffff 40%,#e0f7ff 100%);
            border-radius:14px;
            box-shadow:0 10px 30px rgba(0,0,0,0.16);
            padding:14px; width:420px; display:none; z-index:9998;
            border:2px solid #00d2ff;
            max-height:70vh;
            overflow-y:auto;
        }
        .submenu-snl2.show { display:block; animation: slideInRight .35s ease; }
        .submenu-snl2-item {
            padding:10px 12px; border-radius:10px; font-weight:600; cursor:pointer; margin-bottom:6px;
            background:linear-gradient(90deg,#ffffff 0%,#d0f2ff 100%);
            color:#006494; box-shadow:0 2px 6px rgba(0,210,255,0.12);
            border:1px solid #00d2ff;
            transition:background .18s, color .18s, box-shadow .18s, transform .18s;
            font-size:13px;
        }
        .submenu-snl2-item:hover, .submenu-snl2-item:focus {
            background:linear-gradient(90deg,#a8e8ff 0%,#d0f2ff 100%);
            color:#003d5c;
            box-shadow:0 4px 14px rgba(0,210,255,0.28);
            transform:translateY(-2px);
        }
        .submenu-snl2-item:active {
            transform:translateY(0);
            box-shadow:0 2px 8px rgba(0,210,255,0.25);
        }
        
        /* Estilos para el bot√≥n flotante SCRIPT LE */
        .btn-flotante-le {
            position: fixed;
            top: 120px;
            right: 20px;
            z-index: 9999;
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 50%, #9b59b6 100%);
            background-size: 200% 200%;
            animation: gradientFloatingLE 4s ease infinite;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            box-shadow: 0 4px 15px rgba(155, 89, 182, 0.3), 
                        0 8px 25px rgba(155, 89, 182, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            white-space: nowrap;
            backdrop-filter: blur(10px);
        }
        
        .btn-flotante-le:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(155, 89, 182, 0.4), 
                        0 12px 35px rgba(155, 89, 182, 0.3);
        }

        .btn-flotante-le:active {
            transform: translateY(0) scale(0.98);
            box-shadow: 0 2px 8px rgba(155, 89, 182, 0.3);
        }
        
        @keyframes gradientFloatingLE {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .btn-flotante-le::before {
            content: 'üè•';
            position: absolute;
            top: -8px;
            left: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite;
            filter: drop-shadow(0 2px 4px rgba(155,89,182,0.5));
        }

        .btn-flotante-le::after {
            content: 'üìã';
            position: absolute;
            bottom: -8px;
            right: -8px;
            font-size: 14px;
            animation: sparkle 3s ease-in-out infinite 1.5s;
            filter: drop-shadow(0 2px 4px rgba(155,89,182,0.5));
        }
        
        /* Bot√≥n flotante Calendario Chile */
        .btn-flotante-cal {
            position: fixed;
            top: 220px;
            right: 20px;
            z-index: 9999;
            background: linear-gradient(45deg, #2c3e50, #3498db);
            background-size: 400% 400%;
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 40px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            box-shadow: 0 8px 32px rgba(52, 152, 219, 0.4);
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .btn-flotante-cal:hover { transform: scale(1.08) translateY(-4px); box-shadow: 0 15px 40px rgba(52,152,219,0.55); }
        .btn-flotante-cal:active { transform: scale(0.95); }

        /* Panel Calendario Chile flotante */
        .panel-calendario {
            position: fixed;
            top: 270px;
            right: 20px;
            width: 320px;
            max-height: 80vh;
            background: #fff;
            border-radius: 14px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
            border: 1px solid #e5e7eb;
            overflow: hidden;
            z-index: 10050;
        }
        .cal-header { display:flex; justify-content:space-between; align-items:center; padding:10px 12px; background:linear-gradient(135deg, #3498db, #2c3e50); color:#fff; }
        .cal-header .cal-nav { display:flex; gap:8px; }
        .cal-header button { background: rgba(255,255,255,0.2); border:none; color:#fff; padding:6px 10px; border-radius:6px; cursor:pointer; font-weight:600; }
        .cal-header button:hover { background: rgba(255,255,255,0.3); }
        .cal-body { padding: 10px 12px 12px; }
        .cal-weekdays { display:grid; grid-template-columns: repeat(7, 1fr); gap:6px; margin-bottom:6px; font-weight:700; color:#374151; font-size:12px; text-align:center; }
        .cal-grid { display:grid; grid-template-columns: repeat(7, 1fr); gap:6px; transition: opacity 0.18s ease; }
        .cal-grid.cal-fade { opacity: 0.4; }
        .cal-cell { text-align:center; padding:8px 0; border-radius:8px; font-weight:600; color:#1f2937; background:#f9fafb; }
        .cal-cell.muted { color:#9ca3af; background:#f3f4f6; }
        .cal-cell.hoy { outline:2px solid #3498db; background:#eaf4fe; }
        .cal-cell.feriado { background:#fdecec; color:#b91c1c; border:1px solid #fecaca; }
        .cal-legend { margin-top:10px; font-size:12px; color:#374151; display:flex; gap:10px; align-items:center; }
        .cal-dot { width:10px; height:10px; border-radius:50%; display:inline-block; }
        .cal-dot.feriado { background:#ef4444; }
        .cal-footer { padding:8px 12px 12px; border-top:1px solid #e5e7eb; font-size:12px; color:#6b7280; }
        
       
        /* Estilos para modales */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.4);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: rgb(9, 18, 24);
            border-radius: 10px;
            padding: 30px 20px;
            max-width: 700px;
            width: 95%;
            box-shadow: 0 4px 24px rgba(0,0,0,0.18);
            position: relative;
        }
        
        #accesoLinks {
            display: none;
            position: absolute;
            background: rgb(14, 108, 145);
            border: 2px solid #002147;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,33,71,0.2);
            z-index: 1001;
            min-width: 300px;
            padding: 10px;
        }
        
        #accesoLinks a {
            display: block;
            color: #002147;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 4px;
            margin-bottom: 5px;
            background: #e0e8f0;
            transition: all 0.3s ease;
        }
        
        #accesoLinks a:hover {
            background: #d0e0f0;
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(0,33,71,0.15);
        }
        
        /* Animaciones para pop-ups de atenci√≥n */
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        
        /* Responsive Design Mejorado */        
        /* Calendario y reloj compacto */
        .calendario-reloj-compacto {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--spacing-md);
            margin: var(--spacing-md) 0;
            padding: var(--spacing-sm);
            background: linear-gradient(135deg, #e8eef3 0%, #d8e1e8 100%);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-soft);
            border: 1px solid #c5d0d8;
        }

        /* ===== ANIMACIONES SUTILES Y EFECTOS HOVER AVANZADOS ===== */
        
        /* Transiciones globales suaves */
        * {
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Efectos hover para botones principales */
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 123, 255, 0.25);
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        }
        
        .btn:active {
            transform: translateY(0px);
            transition: all 0.1s ease;
        }
        
        /* Efectos hover para botones espec√≠ficos */
        .btn-success:hover {
            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.25);
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #ffc107 0%, #d39e00 100%);
            box-shadow: 0 8px 25px rgba(255, 193, 7, 0.25);
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #dc3545 0%, #bd2130 100%);
            box-shadow: 0 8px 25px rgba(220, 53, 69, 0.25);
        }
        
        .btn-info:hover {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
            box-shadow: 0 8px 25px rgba(23, 162, 184, 0.25);
        }
        
        /* Animaci√≥n de pulso para botones importantes */
        @keyframes pulso-suave {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .btn-pulse:hover {
            animation: pulso-suave 2s infinite;
        }
        
        /* Efectos hover para elementos de lista */
        .lista-documentos li:hover,
        .list-group-item:hover {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            transform: translateX(5px);
            border-left: 4px solid #007bff;
            cursor: pointer;
        }
        
        /* Animaci√≥n de aparici√≥n suave */
        @keyframes aparecer-suave {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .modal {
            animation: aparecer-suave 0.4s ease-out;
        }
        
        .modal-content {
            animation: aparecer-suave 0.5s ease-out;
        }
        
        /* Efectos hover para modales */
        .modal-header:hover {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        
        /* Animaci√≥n de shimmer para elementos de carga */
        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: calc(200px + 100%) 0; }
        }
        
        .loading-shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, rgba(255,255,255,0.5) 50%, #f0f0f0 75%);
            background-size: 200px 100%;
            animation: shimmer 1.5s infinite;
        }
        
        /* Efectos hover para formularios */
        .form-control:focus {
            transform: scale(1.02);
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
            border-color: #80bdff;
        }
        
        .form-control:hover {
            border-color: #007bff;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.1);
        }
        
        /* Animaci√≥n de rebote suave */
        @keyframes rebote-suave {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0, -8px, 0); }
            70% { transform: translate3d(0, -4px, 0); }
            90% { transform: translate3d(0, -2px, 0); }
        }
        
        .btn-bounce:hover {
            animation: rebote-suave 1s ease;
        }
        
        /* Efectos hover para cards y contenedores */
        .card:hover,
        .alert:hover,
        .badge:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        /* Animaci√≥n de rotaci√≥n suave para iconos */
        @keyframes rotar-suave {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .icono-giratorio:hover {
            animation: rotar-suave 2s linear infinite;
        }
        
        /* Efectos hover para tablas */
        .table-hover tbody tr:hover {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            transform: scale(1.01);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.1);
        }
        
        /* Animaci√≥n de deslizamiento lateral */
        @keyframes deslizar-entrada {
            from { 
                opacity: 0; 
                transform: translateX(-30px); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }
        
        .slide-in {
            animation: deslizar-entrada 0.6s ease-out;
        }
        
        /* Efectos hover para navegaci√≥n */
        .navbar-nav .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            transform: translateY(-2px);
        }
        
        /* Animaci√≥n de parpadeo suave */
        @keyframes parpadeo-suave {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        .parpadeo-suave {
            animation: parpadeo-suave 2s infinite;
        }
        
        /* Efectos hover para elementos interactivos */
        .clickable:hover {
            cursor: pointer;
            background: rgba(0, 123, 255, 0.05);
            border-radius: 8px;
            transform: scale(1.02);
        }
        
        /* Animaci√≥n de ondas para botones de acci√≥n */
        @keyframes onda {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .btn-onda {
            position: relative;
            overflow: hidden;
        }
        
        .btn-onda:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn-onda:active:before {
            width: 300px;
            height: 300px;
        }
        
        /* Efectos hover para elementos de estado */
        .estado-activo:hover {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-color: #28a745;
        }
        
        .estado-inactivo:hover {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-color: #dc3545;
        }
        
        /* Animaci√≥n de zoom suave */
        @keyframes zoom-suave {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .zoom-hover:hover {
            animation: zoom-suave 0.8s ease;
        }
        
        /* Efectos hover para elementos de men√∫ */
        .dropdown-menu .dropdown-item:hover {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            transform: translateX(5px);
            border-radius: 6px;
        }
        
        /* Animaci√≥n de flujo para elementos de progreso */
        @keyframes flujo {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .progress-animated {
            background: linear-gradient(-45deg, #007bff, #0056b3, #007bff, #0056b3);
            background-size: 400% 400%;
            animation: flujo 3s ease infinite;
        }
        
        /* Efectos hover para badges y etiquetas */
        .badge:hover {
            transform: scale(1.1) rotate(2deg);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        /* Animaci√≥n de escritura para texto */
        @keyframes escribir {
            from { width: 0; }
            to { width: 100%; }
        }
        
        .texto-escribir {
            overflow: hidden;
            border-right: 2px solid #007bff;
            white-space: nowrap;
            animation: escribir 3s steps(40, end), parpadeo-cursor 0.75s step-end infinite;
        }
        
        @keyframes parpadeo-cursor {
            from, to { border-color: transparent; }
            50% { border-color: #007bff; }
        }
        
        /* Efectos hover para iconos */
        .icono:hover {
            color: #007bff;
            transform: scale(1.2) rotate(10deg);
        }
        
        /* Animaci√≥n de flotaci√≥n suave */
        @keyframes flotar {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .flotante:hover {
            animation: flotar 2s ease-in-out infinite;
        }
        
        /* Efectos hover para controles de media */
        .control-media:hover {
            background: rgba(0, 123, 255, 0.1);
            border-radius: 50%;
            transform: scale(1.2);
        }
        
        /* Animaci√≥n de deslizamiento hacia arriba */
        @keyframes deslizar-arriba {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .slide-up {
            animation: deslizar-arriba 0.6s ease-out;
        }
        
        /* Efectos hover para elementos de notificaci√≥n */
        .notification:hover {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border-left: 5px solid #ffc107;
            transform: translateX(10px);
        }
        
        /* ===== SISTEMA DE NOTIFICACIONES PUSH EN TIEMPO REAL ===== */
        
        /* Contenedor principal de notificaciones */
        .notifications-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            max-width: 400px;
            width: 100%;
            pointer-events: none;
        }
        
        /* Icono contador de notificaciones */
        .notification-icon {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 9999;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 4px 20px rgba(255, 107, 107, 0.4);
            transition: all 0.3s ease;
            pointer-events: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .notification-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(255, 107, 107, 0.6);
        }
        
        /* Badge contador */
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            min-width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            animation: pulse-badge 2s infinite;
        }
        
        @keyframes pulse-badge {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        /* Notificaci√≥n individual */
        .notification-toast {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border-left: 4px solid #007bff;
            pointer-events: auto;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }
        
        .notification-toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .notification-toast.hide {
            transform: translateX(100%);
            opacity: 0;
            margin-bottom: 0;
            padding: 0;
            max-height: 0;
        }
        
        /* Tipos de notificaci√≥n */
        .notification-toast.success {
            border-left-color: #28a745;
        }
        
        .notification-toast.warning {
            border-left-color: #ffc107;
        }
        
        .notification-toast.error {
            border-left-color: #dc3545;
        }
        
        .notification-toast.info {
            border-left-color: #17a2b8;
        }
        
        .notification-toast.urgent {
            border-left-color: #fd7e14;
            background: linear-gradient(135deg, #fff5e6 0%, #ffe0b8 100%);
            animation: urgent-pulse 1s infinite;
        }
        
        @keyframes urgent-pulse {
            0%, 100% { box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15); }
            50% { box-shadow: 0 8px 30px rgba(253, 126, 20, 0.4); }
        }
        
        /* Header de notificaci√≥n */
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .notification-title {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
            line-height: 1.3;
            margin: 0;
            flex: 1;
            padding-right: 8px;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: #6c757d;
            cursor: pointer;
            font-size: 16px;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        
        .notification-close:hover {
            background: #f8f9fa;
            color: #dc3545;
        }
        
        /* Contenido de notificaci√≥n */
        .notification-body {
            color: #495057;
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        
        /* Footer de notificaci√≥n */
        .notification-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            color: #6c757d;
        }
        
        .notification-time {
            font-style: italic;
        }
        
        .notification-actions {
            display: flex;
            gap: 8px;
        }
        
        .notification-action {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 4px 8px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .notification-action:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }
        
        .notification-action.secondary {
            background: #6c757d;
        }
        
        .notification-action.secondary:hover {
            background: #545b62;
        }
        
        /* Barra de progreso para auto-dismiss */
        .notification-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: rgba(0, 123, 255, 0.3);
            width: 100%;
            transform-origin: left;
            transition: transform linear;
        }
        
        .notification-progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: #007bff;
            width: 100%;
            transform: scaleX(0);
            transform-origin: left;
            animation: progress-fill linear;
        }
        
        @keyframes progress-fill {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }
        
        /* Panel de notificaciones */
        .notifications-panel {
            position: fixed;
            top: 0;
            left: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
            z-index: 9998;
            transition: left 0.3s ease;
            overflow-y: auto;
            border-right: 1px solid #dee2e6;
        }
        
        .notifications-panel.open {
            left: 0;
        }
        
        .notifications-panel-header {
            padding: 20px;
            border-bottom: 1px solid #dee2e6;
            background: #f8f9fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notifications-panel-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }
        
        .notifications-panel-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #6c757d;
            padding: 0;
        }
        
        .notifications-panel-body {
            padding: 20px;
        }
        
        .notification-item {
            padding: 16px;
            border-bottom: 1px solid #f1f3f4;
            transition: background 0.2s ease;
            cursor: pointer;
        }
        
        .notification-item:hover {
            background: #f8f9fa;
        }
        
        .notification-item.unread {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        
        /* Configuraci√≥n de notificaciones */
        .notification-settings {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            z-index: 10001;
            max-width: 500px;
            width: 90%;
            display: none;
        }
        
        .notification-settings.show {
            display: block;
            animation: fadeInScale 0.3s ease;
        }
        
        /* Sonidos de notificaci√≥n */
        .notification-sound-test {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.2s ease;
        }
        
        .notification-sound-test:hover {
            background: #218838;
        }
        
        /* Responsive para notificaciones */
        @media (max-width: 768px) {
            .notifications-container {
                max-width: 320px;
                right: 10px;
                top: 10px;
            }
            
            .notification-icon {
                top: 10px;
                left: 10px;
                width: 50px;
                height: 50px;
                font-size: 18px;
            }
            
            .notifications-panel {
                width: 100%;
                left: -100%;
            }
            
            .notifications-panel.open {
                left: 0;
            }
        }
        
        /* Animaci√≥n de respiraci√≥n para elementos importantes */
        @keyframes respirar {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        .respirar {
            animation: respirar 4s ease-in-out infinite;
        }
        
        /* Efectos hover para elementos de b√∫squeda */
        .search-container:hover {
            box-shadow: 0 8px 25px rgba(0, 123, 255, 0.15);
            border-radius: 12px;
        }
        
        .search-input:focus + .search-button {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            transform: scale(1.05);
        }
        
        /* Animaci√≥n de ondulaci√≥n para superficie de agua */
        @keyframes ondular {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(1deg); }
            50% { transform: translateY(0px) rotate(0deg); }
            75% { transform: translateY(-2px) rotate(-1deg); }
        }
        
        .ondular:hover {
            animation: ondular 2s ease-in-out infinite;
        }
        
            
        .nivel-volumen:hover {
            box-shadow: 0 0 20px rgba(40, 167, 69, 0.5);
        }
        
        /* Animaci√≥n de latido para indicadores activos */
        @keyframes latido {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }
        
        .latido-activo {
            animation: latido 1.5s ease-in-out infinite;
        }
        
        /* Efectos de transici√≥n para cambios de estado */
        .transicion-estado {
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* Animaci√≥n de entrada en escena */
        @keyframes entrada-escena {
            0% { 
                opacity: 0; 
                transform: scale(0.3) rotate(-10deg); 
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.05) rotate(2deg); 
            }
            100% { 
                opacity: 1; 
                transform: scale(1) rotate(0deg); 
            }
        }
        
        .entrada-escena {
            animation: entrada-escena 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* Animaci√≥n de brillo para elementos destacados */
        @keyframes brillo {
            0% { box-shadow: 0 0 5px rgba(255, 255, 255, 0.5); }
            50% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.8), 0 0 30px rgba(0, 123, 255, 0.3); }
            100% { box-shadow: 0 0 5px rgba(255, 255, 255, 0.5); }
        }
        
        .brillo:hover {
            animation: brillo 2s ease-in-out infinite;
        }
        
        /* Efectos de escalado suave para interacciones */
        .escalar-suave:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease;
        }
        
        .escalar-suave:active {
            transform: scale(0.98);
            transition: transform 0.1s ease;
        }
        
        /* Animaci√≥n de desvanecimiento elegante */
        @keyframes desvanecer-elegante {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .desvanecer-elegante {
            animation: desvanecer-elegante 0.6s ease-out;
        }
        
        /* Efectos hover espec√≠ficos para el sistema de comunicaci√≥n */
        .modal-comunicacion .opcion-envio:hover {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            border: 2px solid #28a745;
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.2);
        }
        
        /* Animaci√≥n de carga punteada */
        @keyframes puntos-carga {
            0%, 20% { color: rgba(0, 0, 0, 0); text-shadow: 0.25em 0 0 rgba(0, 0, 0, 0), 0.5em 0 0 rgba(0, 0, 0, 0); }
            40% { color: #007bff; text-shadow: 0.25em 0 0 rgba(0, 0, 0, 0), 0.5em 0 0 rgba(0, 0, 0, 0); }
            60% { text-shadow: 0.25em 0 0 #007bff, 0.5em 0 0 rgba(0, 0, 0, 0); }
            80%, 100% { text-shadow: 0.25em 0 0 #007bff, 0.5em 0 0 #007bff; }
        }
        
        .carga-puntos:after {
            content: ' ...';
            animation: puntos-carga 1.5s steps(5, end) infinite;
        }
        
        /* Efectos hover para elementos de estado del sistema */
        .estado-sistema:hover {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            transform: translateX(5px);
            border-left: 4px solid #17a2b8;
            padding-left: 12px;
        }
        
        /* Suavizado de movimientos para elementos m√≥viles */
        .elemento-movil {
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        box-shadow 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        background 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .reloj-compacto,
        .calendario-compacto {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: var(--spacing-sm);
            background: rgba(232, 240, 245, 0.98);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-subtle);
            border: 1px solid #c8d5dc;
        }
        
        .reloj-display {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1976d2 0%, #42a5f5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            padding: var(--spacing-xs);
        }
        
        .fecha-display {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--text-color);
            text-align: center;
            padding: var(--spacing-xs);
        }
        
        @media (max-width: 1200px) {
            .seccion-formulario {
                grid-template-columns: 1fr;
                gap: var(--spacing-lg);
            }
            
            .botones-primarios {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            }
            
            .botones-consulta {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .container-principal {
                padding: var(--spacing-lg);
                margin: var(--spacing-sm);
            }
            
            .titulo {
                font-size: 2rem;
                margin-bottom: var(--spacing-lg);
            }
            
            .botones-primarios,
            .botones-consulta {
                grid-template-columns: 1fr;
            }
            
            .btn-herramienta {
                background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%); /* verde moderno */
                color: #fff;
                padding: var(--spacing-xs) var(--spacing-sm);
                border-radius: var(--radius-sm);
                font-size: 0.85rem;
                font-weight: 600;
            }

            .reloj-tiempo {
                font-size: 2rem;
                box-shadow: 0 6px 14px rgba(22, 163, 74, 0.25);
                transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
            }
            .calendario-reloj-compacto {
                flex-direction: column;
                gap: var(--spacing-md);
            }
            
            .btn-herramienta:hover { transform: translateY(-1px); box-shadow: 0 10px 20px rgba(22,163,74,.35); filter: brightness(1.05); }
            .btn-herramienta:active { transform: translateY(0); }
            .btn-herramienta:focus { outline: none; box-shadow: 0 0 0 3px rgba(34,197,94,.25); }
            .reloj-display {
                font-size: 1.3rem;
            }
            
            .fecha-display {
                font-size: 1rem;
            }
            
            .seccion-calendario-compacta > div {
                flex-direction: column;
                gap: var(--spacing-md);
            }
            
            .reloj-digital-compacto {
                min-width: auto !important;
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: var(--spacing-sm);
            }
            
            .container-principal {
                padding: var(--spacing-md);
            }
            
            .botones-herramientas {
                grid-template-columns: 1fr;
            }
            
            .btn-flotante-ep {
                top: var(--spacing-sm);
                right: var(--spacing-sm);
                padding: 12px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
<!-- Franja superior azul con texto desplaz√°ndose (ticker informativo) -->
<div class="banner-ticker" role="status" aria-live="polite" id="bannerTicker">
    <div class="banner-inner" id="bannerInner">
        <span class="banner-text" id="bannerText"> üïî Recuerda: nuestro TMO objetivo es de 5 minutos.
Enf√≥cate en resolver con empat√≠a, claridad y eficiencia.</span>
    </div>
    <button type="button" class="banner-toggle" id="bannerToggle" aria-label="Pausar desplazamiento" title="Pausar/Continuar" onclick="toggleBannerTicker()">‚ùö‚ùö</button>
</div>
<!-- Cuadro de b√∫squeda r√°pida (Ctrl+K) -->
<div id="busquedaRapidaOverlay" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:120000; background:rgba(30,41,59,0.18); justify-content:center; align-items:flex-start;">
    <div id="busquedaRapidaBox" style="margin-top:10vh; background:#fff; border-radius:14px; box-shadow:0 8px 32px rgba(0,33,71,0.18); padding:1.2rem 1.5rem 1.1rem 1.5rem; min-width:340px; max-width:90vw; width:420px;">
        <div style="display:flex; align-items:center; gap:10px;">
            <input id="busquedaRapidaInput" type="text" placeholder="Buscar acceso r√°pido..." autocomplete="off" style="flex:1; font-size:1.1em; padding:8px 12px; border-radius:8px; border:1px solid #cbd5e1; outline:none;" />
            <button id="busquedaRapidaCerrar" type="button" style="background:transparent; border:none; font-size:1.3em; color:#64748b; cursor:pointer; margin-left:4px;" aria-label="Cerrar b√∫squeda">‚úï</button>
        </div>
        <ul id="busquedaRapidaResultados" style="list-style:none; margin:14px 0 0 0; padding:0; max-height:260px; overflow-y:auto;"></ul>
        <div id="busquedaRapidaVacio" style="display:none; color:#64748b; font-size:.97em; margin-top:10px;">Sin resultados.</div>
    </div>
</div>
<!-- Banner superior de ayuda eliminado a solicitud del usuario -->
<!-- Bot√≥n flotante Ayuda Global (ubicado en primer body para que siempre cargue) -->
<button type="button" class="help-fab" onclick="abrirModalAyuda()" aria-label="Ayuda general del sistema">‚Ñπ <small>Ayuda</small></button>
<!-- Contenedor de notificaciones toast -->
<div id="notificationsContainer" style="position:fixed; top:70px; right:20px; z-index:10000; display:flex; flex-direction:column; gap:10px; pointer-events:none;">
    <!-- Aqu√≠ se agregar√°n las notificaciones din√°micamente -->
</div>
<!-- Modal Ayuda Global (overlay) -->
<div id="modalAyuda" class="modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:3000; justify-content:center; align-items:center;">
    <div class="modal-ayuda-contenido" role="dialog" aria-modal="true" aria-labelledby="ayudaTitulo">
        <div class="modal-ayuda-header">
            <h2 id="ayudaTitulo" class="modal-ayuda-title">Gu√≠a r√°pida y feriados</h2>
            <button class="modal-ayuda-close" aria-label="Cerrar ayuda" onclick="cerrarModalAyuda()">‚úï</button>
        </div>
        <div class="modal-ayuda-section">
            <h4>1. M√≥dulos principales</h4>
            <ul>
                <li><span class="badge">Calendario</span> Navega meses, destaca hoy y feriados (map en <code>app.js</code>).</li>
                <li><span class="badge">Modales</span> Informaci√≥n contextual (apertura/cierre gen√©rico).</li>
                <li><span class="badge">Submen√∫ SNL</span> Acceso r√°pido scripts SNL.</li>
                <li><span class="badge">Grabar</span> Guarda sin recargar, feedback visual.</li>
            </ul>
        </div>
        <div class="modal-ayuda-section">
            <h4>2. Actualizar feriados</h4>
            <p>Pasos para cambiar el a√±o o agregar feriados:</p>
            <ol style="margin:0 0 .75rem 1.2rem; padding:0;">
                <li>Abrir <code>assets/js/app.js</code>.</li>
                <li>Buscar <code>Feriados Chile</code>.</li>
                <li>Editar el <code>Map</code> <code>feriadosCL</code> agregando/eliminando l√≠neas: formato <code>'YYYY-MM-DD','Descripci√≥n'</code>.</li>
                <li>Si cambia el a√±o, ajustar comentario y fechas movibles.</li>
                <li>Guardar y recargar (Ctrl+F5).</li>
            </ol>
            <pre style="background:#1f2937;color:#f8fafc;padding:.75rem 1rem;border-radius:8px;overflow:auto;font-size:.7rem;line-height:1.25;">// Ejemplo
const feriadosCL = new Map([
    ['2026-01-01','A√±o Nuevo'],
    // ...
]);</pre>
        </div>
        <div class="modal-ayuda-section">
            <h4>3. Pr√≥ximas mejoras</h4>
            <ul>
                <li>Accesibilidad: foco inicial, ESC para cerrar.</li>
                <li>Persistencia avanzada (config).</li>
                <li>Lazy load y minificaci√≥n.</li>
                <li>Feriados desde JSON externo.</li>
            </ul>
        </div>
        <div class="modal-ayuda-section" style="margin-top:1rem;font-size:.7rem;color:#6b7280;">
            <em>Versi√≥n ayuda 2025-11-10</em>
        </div>
    </div>
</div>
    <div class="container-principal fade-in-scale">
        <div class="titulo">üè¢ ACHS EJECUTIVO CENTRALIZADO</div>
        <div class="subtitulo">Panel de gesti√≥n para ejecutivos </div>
        
        <div class="seccion-formulario">
            <div class="botones-principales slide-in-right">
                <!-- Botones Primarios (M√°s importantes) - Reorganizados -->
                <div class="seccion-botones">
                    <h3 style="color: var(--primary-blue); margin: 0 0 var(--spacing-sm) 0; font-size: 1rem; font-weight: 600; text-align: center; border-bottom: 2px solid var(--accent-blue); padding-bottom: var(--spacing-xs);">üéØ Acciones Principales</h3>
                    <div class="botones-primarios">
                        <button id="btnAccesoDirecto" class="btn-primario hover-lift escalar-suave zoom-hover" data-tooltip="Enlaces de acceso r√°pido" onclick="toggleAccesoLinks()">üìã ACCESO DIRECTO</button>
                        <button id="btnSalesforce" class="btn-primario hover-lift escalar-suave zoom-hover" data-tooltip="Ir a Salesforce" onclick="window.open('https://achs.lightning.force.com/lightning/o/Account/list?filterName=__Recent', '_blank')">üîó SALESFORCE</button>
                        <button id="btnNovedades" class="btn-primario hover-lift escalar-suave zoom-hover" data-tooltip="Ver novedades" onclick="abrirModalNovedades()">üÜï NOVEDADES</button>
                        <button id="exportar" class="btn-primario hover-lift escalar-suave" data-tooltip="Exportar datos a Excel">üì• EXPORTAR EXCEL</button>
                        <button id="btnAnexo" class="btn-anexo-entretenido" data-tooltip="üìä Anexo interactivo de contactos y transferencias - ¬°Haz clic para explorar!">
                            <span class="btn-anexo-icono">üìä</span>
                            <span class="btn-anexo-texto">ANEXO</span>
                            </button>
                        <button id="btnReclamo" class="btn-primario hover-lift escalar-suave zoom-hover" data-tooltip="Formulario de reclamos y quejas" onclick="abrirModalReclamo()">üì¢ RECLAMO</button>
                    </div>
                </div>
                
                <!-- Botones de Consulta (Frecuentes) -->
                <div class="seccion-botones">
                    <h3 style="color: var(--secondary-blue); margin: 0 0 var(--spacing-sm) 0; font-size: 0.9rem; font-weight: 600; text-align: center; border-bottom: 2px solid var(--accent-blue); padding-bottom: var(--spacing-xs);">üí¨ Consulta y Comunicaci√≥n</h3>
                    <div class="botones-consulta">
                        <button id="btnPrecios" class="btn-secundario hover-scale" data-tooltip="Valores de prestaciones ACHS">üí∞ PRECIOS</button>
                        <button id="btnMedicosBonos" class="btn-secundario hover-scale" data-tooltip="Ver profesionales para compra de bonos" onclick="abrirModalMedicosBonos()">ü©∫ Nombres de m√©dicos para compra de bonos</button>
<!-- Modal Nombres de M√©dico para Bonos -->
<div id="modalMedicosBonos" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:540px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(0,33,71,0.15); padding:2rem; position:relative;">
        <button onclick="cerrarModalMedicosBonos()" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#009688; cursor:pointer;">&times;</button>
        <h2 style="color:#009688; margin-bottom:1rem; text-align:center;">ü©∫ Profesionales por Zona ‚Äì Compra de Bonos ACHS</h2>
        <div style="margin-bottom:1.2rem;">
            <b>üë®‚Äç‚öïÔ∏è M√©dico General-Traumatolog√≠a-Dermatolog√≠a</b><br>
            <span>üî¢ <b>C√≥digo:</b> 0101001</span>
            <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                <li>üß≠ Norte: <b>Mar√≠a Jos√© Segu√≠ Arcos</b> (Antofagasta)</li>
                <li>üèôÔ∏è Centro: <b>Miguel Jos√© Ayala Angarita</b> (Maip√∫)</li>
                <li>üåßÔ∏è Sur: <b>Luis Diego Berm√∫dez Jim√©nez</b> (Valdivia)</li>
            </ul>
            <span style="color:#dc3545; font-size:0.98em;">üìù Importante: Al comprar el bono, debes elegir al profesional correspondiente seg√∫n la zona de la sede donde se atender√° el paciente.</span>
        </div>
        <div style="margin-bottom:1.2rem;">
            <b>üßò‚Äç‚ôÇÔ∏è Kinesiolog√≠a</b><br>
            <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                <li>üß≠ Norte: <b>Nelson Ignacio Arancibia Figueroa</b> (Antofagasta)</li>
                <li>üèôÔ∏è Centro: <b>Krish Rayen Garc√≠a Gonz√°lez</b> (Maip√∫)</li>
                <li>üåßÔ∏è Sur: <b>Claudia Andrea Daetz Medina</b> (Osorno)</li>
            </ul>
        </div>
        <div>
            <b>üß† Psicolog√≠a</b><br>
            <span>üìç Profesionales asignados por sede:</span>
            <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                <li><b>Francisca Pe√±afiel</b><br>
                    <span style="font-size:0.97em; color:#007bff;">üîπ La Serena<br>üîπ Valpara√≠so<br>üîπ San Antonio</span>
                </li>
                <li><b>Eileen Yamile Green Jara</b><br>
                    <span style="font-size:0.97em; color:#007bff;">üîπ San Felipe<br>üîπ San Miguel</span>
                </li>
            </ul>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->
<!-- Modal Novedades -->
<div id="modalNovedades" class="modal" style="display:none; justify-content:center; align-items:center;">
        <div class="modal-contenido" style="max-width:500px; background:white; border-radius:12px; box-shadow:0 8px 32px rgba(0,33,71,0.15); padding:1.2rem; position:relative; max-height:85vh; overflow-y:auto;">
                <button onclick="cerrarModalNovedades()" style="position:absolute; top:10px; right:10px; background:none; border:none; font-size:1.3rem; color:#1e3a8a; cursor:pointer;">&times;</button>
                <h2 style="color:#1e3a8a; margin-bottom:0.7rem; text-align:center; font-size:1.3rem;">üÜï Novedades</h2>
                <div style="margin-bottom:0.8rem; color:#334155; font-size:0.85rem;">
                        <p style="margin:0 0 0.6rem;">Aqu√≠ podr√°s listar comunicados, cambios y mejoras recientes de todos los procedimientos</p>
                        
                </div>
                <!-- Subtema solicitado (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:8px; background:#f8fafc; color:#0f172a; margin-bottom:6px;">
                    <summary style="list-style:none; cursor:pointer; padding:7px 10px; display:flex; align-items:center; gap:7px;">
                        <span style="flex:0 0 auto; width:14px; height:14px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a; font-size:0.75rem;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:0.85rem; font-weight:600;">Consultas sobre estado de solicitudes de reembolso por compras de bonos en forma presencial</span>
                    </summary>
                    <div style="padding:7px 10px; border-top:1px solid #e5e7eb; display:grid; gap:6px; font-size:0.8rem;">
                        <div style="background:#e8eef3; border-radius:6px; padding:7px;">
                            <b>Recordatorio:</b>
                            <p style="margin:4px 0 0;">
                                Las consultas sobre el estado de solicitudes de reembolso deben gestionarse directamente en los centros ACHS Salud, ya que se trata de compras de bonos realizadas en forma presencial.<br>
                                No se entregan actualizaciones por tel√©fono ni por otros canales.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:6px; padding:7px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:4px 0 0;">
                                Evita derivaciones incorrectas, reduce tiempos de espera y asegura que el paciente reciba informaci√≥n oficial y actualizada en el lugar correspondiente.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:6px; padding:7px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:4px 0 5px;">
                                En la llamada, puedes decir:<br>
                                ‚ÄúComo su bono fue comprado presencialmente, el estado de su reembolso debe consultarlo directamente en el centro donde lo gestion√≥. Ellos tienen acceso al detalle y podr√°n orientarlo mejor.‚Äù
                            </p>
                            <ul style="margin:0; padding-left:1rem; font-size:0.75rem;">
                                <li>Tarjeta de cr√©dito: se realiza la reversa del cobro, el plazo depender√° de cada banco.</li>
                                <li>Tarjeta de d√©bito: se realiza la devoluci√≥n del dinero a trav√©s de una transferencia bancaria (completar formulario) con un plazo de 21 d√≠as h√°biles.</li>
                                <li>Pago con efectivo: Devoluci√≥n inmediata.</li>
                            </ul>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Tipos de solicitudes por formulario SNL (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:8px; background:#f8fafc; color:#0f172a; margin-bottom:6px;">
                    <summary style="list-style:none; cursor:pointer; padding:7px 10px; display:flex; align-items:center; gap:7px;">
                        <span style="flex:0 0 auto; width:14px; height:14px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a; font-size:0.75rem;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:0.85rem; font-weight:600;">Tipos de solicitudes que se gestionan por formulario SNL</span>
                    </summary>
                    <div style="padding:7px 10px; border-top:1px solid #e5e7eb; display:grid; gap:6px; font-size:0.8rem;">
                        <div style="background:#fff; border:1px solid #e2e8f0; border-radius:6px; padding:7px;">
                            <p style="margin:0; color:#0f172a;">
                                üìå‚ÄØRecuerden que existen distintas solicitudes que deben ingresarse exclusivamente por el formulario oficial de <b>Solicitudes Salud No Laboral (SNL) ACHS</b>.
                            </p>
                        </div>
                        <div style="background:#f1f5f9; border-radius:6px; padding:7px;">
                            <b style="color:#334155;">üîπ Ejemplos de solicitudes v√°lidas:</b>
                            <ul style="margin:4px 0 0; padding-left:1rem; font-size:0.75rem;">
                                <li>üìÑ‚ÄØCertificado de atenci√≥n</li>
                                <li>‚ùå‚ÄØInforme de rechazo o reducci√≥n de licencia</li>
                                <li>ü©∫‚ÄØInforme m√©dico</li>
                                <li>üìã‚ÄØInforme de atenciones m√©dicas</li>
                                <li>üïí‚ÄØCita pendiente para entrega de diagn√≥stico</li>
                                <li>üîÑ‚ÄØPaciente derivado por Enfermedad Profesional u otras patolog√≠as</li>
                                <li>üì¶‚ÄØOtras solicitudes SNL (boletas, recetas, √≥rdenes cl√≠nicas, etc.)</li>
                            </ul>
                        </div>
                        <div style="background:#e8eef3; border-radius:6px; padding:7px;">
                            <p style="margin:0;">
                                üîó‚ÄØ<b>Formulario oficial</b> disponible en el canal interno o SharePoint correspondiente.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <p style="margin:0; color:#065f46;">
                                üí°‚ÄØ<b>Centralizar las solicitudes</b> agiliza la gesti√≥n y asegura trazabilidad.
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Tiempo l√≠mite para pagar cita de Telemedicina SNL (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Tiempo l√≠mite para pagar cita de Telemedicina SNL</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Una vez que se graba la cita, el paciente tiene <b>15 minutos</b> para realizar el pago.<br>
                                Si paga despu√©s de ese plazo, el sistema realiza el descuento, pero la cita se anula autom√°ticamente y no se agenda.<br>
                                Esto aplica especialmente para citas de <b>Telemedicina SNL</b>.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Evita que el paciente pierda su atenci√≥n y que se generen reclamos por cobros sin prestaci√≥n. Tambi√©n permite liberar el cupo para otro paciente.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Desde que se graba la cita, tiene 15 minutos para pagar. Si lo hace despu√©s, el sistema cobra igual, pero no agenda la atenci√≥n. Es importante pagar dentro del plazo para asegurar su cita."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Plazo de entrega de resultados de Rayos en centros ACHS (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Plazo de entrega de resultados de Rayos en centros ACHS</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Si el paciente se tom√≥ rayos en un centro ACHS, podr√° acceder a sus resultados dentro de <b>48 horas h√°biles</b>.<br>
                                Debe ingresar al siguiente enlace y validar su identidad:<br>
                                üîó <a href="https://www.hospitaldeltrabajador.cl/resultados-imagenologia/" target="_blank" style="color:#2563eb; text-decoration:underline;">Resultados de Imagenolog√≠a ‚Äì Hospital del Trabajador</a>
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Evita que el paciente espere innecesariamente o llame antes del plazo. Tambi√©n permite entregar una respuesta clara y confiable desde el primer contacto.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Sus resultados estar√°n disponibles en 48 horas h√°biles. Puede acceder directamente en el portal del Hospital del Trabajador, ingresando su RUT y clave."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: ¬øQui√©n entrega los diagn√≥sticos en SNL? (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">¬øQui√©n entrega los diagn√≥sticos en SNL?</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Todas las citas de diagn√≥stico en SNL son realizadas por un <b>M√©dico General</b>, con experiencia en traumatolog√≠a o dermatolog√≠a, seg√∫n corresponda.<br>
                                Este profesional se gu√≠a por las indicaciones del Traumat√≥logo tratante o Dermat√≥logo, asegurando una atenci√≥n precisa y alineada con el caso cl√≠nico.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Evita confusiones sobre el tipo de especialista que atiende y refuerza la confianza del paciente en el proceso. Tambi√©n permite entregar una respuesta clara y segura desde el primer contacto.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "La entrega de diagn√≥stico la realiza un M√©dico General con experiencia en el √°rea, guiado por las indicaciones del (Traumat√≥logo o Dermat√≥logo). As√≠ aseguramos continuidad y claridad en su atenci√≥n."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Agendamiento de citas por t√©rmino de licencia m√©dica ‚Äì Paciente SNL (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Agendamiento de citas por t√©rmino de licencia m√©dica ‚Äì Paciente SNL</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                El paciente debe agendar con anticipaci√≥n su cita m√©dica antes del t√©rmino de su licencia.<br>
                                Nosotros <b>no realizamos llamados</b> para programar estas citas.<br>
                                La extensi√≥n de la licencia ser√° determinada exclusivamente por el M√©dico tratante durante la atenci√≥n.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Evita que el paciente quede sin continuidad de atenci√≥n y aclara que la responsabilidad de agendar es del propio paciente. Tambi√©n previene expectativas err√≥neas sobre llamados autom√°ticos o garant√≠as de extensi√≥n.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Debe agendar su cita antes de que termine su licencia. Nosotros no llamamos para programarla, y ser√° el m√©dico quien eval√∫e si corresponde extenderla."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: ¬øCu√°l es el nombre del m√©dico que me va a atender? (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">¬øCu√°l es el nombre del m√©dico que me va a atender?</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                El sistema de asignaci√≥n de m√©dicos funciona seg√∫n la disponibilidad del centro, por lo que no se puede garantizar un nombre espec√≠fico al momento de agendar.<br>
                                Siempre se cuenta con <b>M√©dicos Generales de alto est√°ndar</b>, con experiencia en √°reas como traumatolog√≠a y dermatolog√≠a, seg√∫n el tipo de atenci√≥n.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Evita generar expectativas espec√≠ficas y refuerza la confianza en la calidad profesional del equipo m√©dico. Tambi√©n permite entregar una respuesta clara y segura desde el primer contacto.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "La asignaci√≥n del m√©dico depende de la disponibilidad del centro, pero siempre contamos con profesionales generales altamente capacitados para atender su caso."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Descuento de seguro complementario no aplicado al pagar bono (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Descuento de seguro complementario no aplicado al pagar bono</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Si al momento de pagar el bono no aparece el descuento del seguro complementario, el paciente debe realizar el reembolso <b>directamente con su aseguradora</b>.<br>
                                Este proceso se gestiona de forma externa, fuera del sistema ACHS Salud.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Evita que el paciente espere una correcci√≥n en el momento del pago y permite entregar una respuesta clara y orientadora desde el primer contacto.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Si su seguro complementario no aplic√≥ el descuento al pagar el bono, debe solicitar el reembolso directamente con su aseguradora. Nosotros no gestionamos ese proceso."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Renovaci√≥n de licencia/receta m√©dica sin hora disponible con psic√≥logo (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Renovaci√≥n de licencia/receta m√©dica sin hora disponible con psic√≥logo</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Si el paciente necesita renovar licencia o receta m√©dica con m√©dico de salud mental, pero no encuentra hora disponible con psic√≥logo, se debe <b>levantar el caso por Teams</b> para que sea gestionado por el Back Office.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Permite dar continuidad a tratamientos y evitar interrupciones en licencias o recetas, especialmente en casos de salud mental. Tambi√©n asegura que el paciente reciba atenci√≥n oportuna mediante gesti√≥n interna.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Si no encuentra hora con psic√≥logo, vamos a levantar el caso por nuestro canal interno para que lo gestione y pueda continuar con su tratamiento."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Derivaci√≥n a Traumat√≥logo Especialista ‚Äì Regi√≥n Metropolitana (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Derivaci√≥n a Traumat√≥logo Especialista ‚Äì Regi√≥n Metropolitana</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Si el paciente es de la Regi√≥n Metropolitana y busca atenci√≥n con Traumat√≥logo Especialista, puede ser derivado al <b>CEM ‚Äì Centro M√©dico del Hospital del Trabajador</b>, ubicado en:<br>
                                üìç <b>Vicu√±a Mackenna 210, Providencia</b> (a pasos del Metro Parque Bustamante).<br><br>
                                üîπ <b>Especialidades traumatol√≥gicas disponibles:</b><br>
                                ‚Ä¢ Cadera y Pelvis<br>
                                ‚Ä¢ Columna<br>
                                ‚Ä¢ Extremidad Superior<br>
                                ‚Ä¢ Hombro<br>
                                ‚Ä¢ Rodilla<br>
                                ‚Ä¢ Tobillo y Pie<br><br>
                                üìû Podemos transferir directamente al Centro M√©dico.<br>
                                üì≤ El ejecutivo debe marcar el <b>anexo 8021</b> para realizar la transferencia.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Facilita el acceso a atenci√≥n especializada, mejora la experiencia del paciente y permite una derivaci√≥n directa y efectiva.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Podemos transferirlo directamente al Centro M√©dico del Hospital del Trabajador, donde atienden especialistas en traumatolog√≠a. El centro est√° ubicado en Vicu√±a Mackenna 210, Providencia."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Derivaci√≥n a servicios de imagenolog√≠a ‚Äì Regi√≥n Metropolitana (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Derivaci√≥n a servicios de imagenolog√≠a ‚Äì Regi√≥n Metropolitana</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Si el paciente es de la Regi√≥n Metropolitana y busca servicios de imagenolog√≠a, puede ser derivado al <b>CEM ‚Äì Centro M√©dico del Hospital del Trabajador</b>, ubicado en:<br>
                                üìç <b>Vicu√±a Mackenna 210, Providencia</b> (a pasos del Metro Parque Bustamante).<br><br>
                                üîπ <b>Servicios disponibles en el CEM:</b><br>
                                ‚Ä¢ Resonancia Magn√©tica<br>
                                ‚Ä¢ Tomograf√≠a Computada<br>
                                ‚Ä¢ Radiolog√≠a<br>
                                ‚Ä¢ Ecocardiograma<br><br>
                                üìû Podemos transferir directamente al Centro M√©dico.<br>
                                üì≤ El ejecutivo debe marcar el <b>anexo 8023</b> para realizar la transferencia.<br><br>
                                ‚ö†Ô∏è <b>Importante:</b><br>
                                Solo se deriva al CEM si el servicio solicitado no est√° disponible en ACHS Salud. Validar siempre antes de transferir.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Facilita el acceso a servicios especializados, mejora la orientaci√≥n desde el primer contacto y evita derivaciones innecesarias.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Si necesita imagenolog√≠a como resonancia o ecocardiograma, podemos transferirlo al Centro M√©dico del Hospital del Trabajador. Est√° en Vicu√±a Mackenna 210, Providencia."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Ingreso EP-SM para colaboradores ACHS (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Ingreso EP-SM para colaboradores ACHS</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Cuando llama un ejecutivo de ACHS o cualquier colaborador de la instituci√≥n solicitando ingreso por <b>EP-SM (Evaluaci√≥n Psicol√≥gica ‚Äì Salud Mental)</b>, se debe aplicar el mismo protocolo que usamos para pacientes comunes.<br><br>
                                üîπ <b>Esto incluye:</b><br>
                                ‚Ä¢ Validar si ya tuvo ingreso previo en SAP.<br>
                                ‚Ä¢ Revisar carpeta de documentos en "TOTAL".<br>
                                ‚Ä¢ Confirmar si corresponde nueva cita o seguimiento.<br>
                                ‚Ä¢ Aplicar criterios de derivaci√≥n y atenci√≥n seg√∫n procedimiento vigente.<br><br>
                                ‚ö†Ô∏è No se debe asumir prioridad ni aplicar protocolos distintos por ser colaborador. La atenci√≥n debe ser igualitaria, clara y profesional.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Garantiza equidad en la atenci√≥n, evita sesgos o trato preferencial y mantiene la transparencia del proceso de gesti√≥n de salud mental.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Si llama un colaborador ACHS por ingreso EP-SM, seguimos el mismo protocolo que con cualquier paciente. Revisamos SAP, validamos ingreso y gestionamos seg√∫n procedimiento."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Validaci√≥n de siniestro y derivaci√≥n en EP Salud Mental (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Validaci√≥n de siniestro y derivaci√≥n en EP Salud Mental</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Antes de gestionar cualquier cita en <b>EP Salud Mental</b>, es fundamental revisar el siniestro del paciente para determinar el tipo de ingreso y aplicar el protocolo correspondiente.<br><br>
                                üîç <b>Pasos clave para validar y derivar correctamente:</b><br>
                                ‚Ä¢ Revisar el siniestro antes de considerar las horas visibles en SAP.<br>
                                ‚Ä¢ Identificar si el caso corresponde a una EP Salud Mental.<br>
                                ‚Ä¢ Verificar el estado del siniestro:<br>
                                &nbsp;&nbsp;&nbsp;- Si est√° <b>en estudio</b>, se gestiona como Enfermedad Profesional y se aplica el protocolo interno.<br>
                                &nbsp;&nbsp;&nbsp;- Si est√° <b>acogido</b>, es un paciente ley y debe ser derivado a <b>Informaciones</b>, quienes pueden reagendar usando el mismo formulario que el equipo.<br>
                                ‚Ä¢ Validar si el paciente est√° en tratamiento por accidente laboral traum√°tico. En ese caso, tambi√©n se deriva a Informaciones.<br><br>
                                ‚ö†Ô∏è Evitar agendar directamente sin revisar el siniestro, ya que muchas veces las horas en SAP no reflejan el contexto legal o cl√≠nico del paciente.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Garantiza que cada paciente reciba la atenci√≥n correcta seg√∫n su situaci√≥n legal y cl√≠nica, evita derivaciones incorrectas y asegura el cumplimiento de protocolos internos.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En el equipo, puedes recordar:<br>
                                "Antes de agendar una cita en EP Salud Mental, revisa el siniestro. Si es acogido, deriva a Informaciones. Si est√° en estudio, lo trabajamos como EP con protocolo."
                            </p>
                        </div>
                    </div>
                </details>
                <!-- Subtema: Horarios de continuidad en Kinesiolog√≠a (plegable) -->
                <details style="border:1px solid #e5e7eb; border-radius:12px; background:#f8fafc; color:#0f172a; margin-top:12px;">
                    <summary style="list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px;">
                        <span style="flex:0 0 auto; width:20px; height:20px; display:inline-flex; align-items:center; justify-content:center; color:#1e3a8a;">‚ñ∏</span>
                        <span style="color:#1e3a8a; font-size:1.05rem; font-weight:600;">Horarios de continuidad en Kinesiolog√≠a</span>
                    </summary>
                    <div style="padding:12px 14px; border-top:1px solid #e5e7eb; display:grid; gap:10px;">
                        <div style="background:#e8eef3; border-radius:8px; padding:10px;">
                            <b>Recordatorio:</b>
                            <p style="margin:6px 0 0;">
                                Los horarios de atenci√≥n para citas de continuidad en Kinesiolog√≠a (posteriores a la evaluaci√≥n inicial) <b>no pueden ser asegurados por el Call Center</b>.<br><br>
                                üîπ <b>Esto se debe a que:</b><br>
                                ‚Ä¢ Dependen del capacity y disponibilidad interna de cada centro.<br>
                                ‚Ä¢ Se ajustan seg√∫n la malla horaria del terapeuta y la organizaci√≥n local de la agencia.<br>
                                ‚Ä¢ El horario espec√≠fico ser√° definido directamente por el profesional tratante.<br><br>
                                ‚ö†Ô∏è No podemos garantizar si las sesiones ser√°n en jornada AM o PM. El paciente debe consultarlo directamente con el terapeuta en el centro.
                            </p>
                        </div>
                        <div style="background:#dbeafe; border-radius:8px; padding:10px;">
                            <b>Por qu√© es importante:</b>
                            <p style="margin:6px 0 0;">
                                Evita generar expectativas err√≥neas sobre horarios espec√≠ficos y permite entregar informaci√≥n clara y realista desde el primer contacto.
                            </p>
                        </div>
                        <div style="background:#ecfdf5; border-radius:8px; padding:10px;">
                            <b>Tip pr√°ctico:</b>
                            <p style="margin:6px 0 0;">
                                En la llamada, puedes decir:<br>
                                "Los horarios de continuidad en Kinesiolog√≠a dependen del terapeuta y la disponibilidad del centro. No podemos asegurar si ser√°n en la ma√±ana o tarde, eso se define directamente en la sede."
                            </p>
                        </div>
                    </div>
                </details>
        </div>
    </div>
    <script>
        function abrirModalNovedades(){
            const m = document.getElementById('modalNovedades');
            if (m) m.style.display = 'flex';
        }
        function cerrarModalNovedades(){
            const m = document.getElementById('modalNovedades');
            if (m) m.style.display = 'none';
        }
    </script>

                        <button id="btnCorreos" class="btn-secundario hover-scale" data-tooltip="Directorio de correos">‚úâÔ∏è CORREOS</button>
                        <button id="btnPacientesSMP" class="btn-secundario hover-scale" onclick="abrirModal('modalPacientesSMP')" style="background:white; color:#111; font-weight:600; border:2px solid #3076e3;">üè• SEDES BLOQUEADAS PARA AGENDAMIENTO PSICOL√ìGICO</button>
<!-- Modal PACIENTES QUE PUEDEN AGENDAR CENTROS SMP -->
<div id="modalPacientesSMP" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:600px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(48,118,227,0.15); padding:2rem; position:relative;">
    <button onclick="cerrarModal('modalPacientesSMP')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#3076e3; cursor:pointer;">&times;</button>
        <h2 style="color:#3076e3; margin-bottom:1rem; text-align:center;">üè• Pacientes que pueden agendar centros SMP</h2>
        <div style="overflow-x:auto; margin-bottom:1rem;">
            <table style="width:100%; border-collapse:collapse; font-size:1em;">
                <thead>
                    <tr style="background:#e8eef3; color:#222;">
                        <th style="padding:8px; border-bottom:2px solid #3076e3;">Centros Bloqueados</th>
                        <th style="padding:8px; border-bottom:2px solid #3076e3;">Psic√≥logo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Puerto Montt</td><td>Andr√©s C√©spedes Jara</td></tr>
                    <tr><td>Telemedicina</td><td>Valentina Andrea Gonz√°lez Cid</td></tr>
                    <tr><td>Temuco</td><td>Sebasti√°n Caniumil Candia</td></tr>
                    <tr><td>Copiapo</td><td>Macarena C√°ceres Morales</td></tr>
                    <tr><td>Talcahuano</td><td>Camila Soto Mel√≠n</td></tr>
                    <tr><td>San Antonio</td><td>Nanjareth Arriagada De Luzia</td></tr>
                    <tr><td>Los Andes</td><td>Crist√≥bal Celed√≥n Porzio</td></tr>
                    <tr><td>Vi√±a del Mar</td><td>Daniela Salazar Arancibia</td></tr>
                    <tr><td>Vi√±a del Mar</td><td>Silvia Moyano</td></tr>
                    <tr><td>La Serena</td><td>D√©bora Mu√±oz Z√∫√±iga</td></tr>
                    <tr><td>Talca</td><td>Javiera Rojas Espinosa</td></tr>
                    <tr><td>Antofagasta</td><td>Kimberliee Julio √ë√∫√±ez</td></tr>
                    <tr><td>Talca</td><td>Marcela Chac√≥n Fl√°ndez</td></tr>
                    <tr><td>Rancagua</td><td>Maximiliano Pe√±a Celis</td></tr>
                    <tr><td>Santiago Centro</td><td>Nicol√°s Castro Rodr√≠guez</td></tr>
                    <tr><td>Temuco</td><td>Paloma Baeza Fern√°ndez</td></tr>
                    <tr><td>San Miguel</td><td>Sebasti√°n Arias Corval√°n</td></tr>
                    <tr><td>Pe√±aflor</td><td>Alejandra Pavone</td></tr>
                    <tr><td>Calama</td><td>Valentina Vergara Maturana</td></tr>
                    <tr><td>Concepci√≥n</td><td>AdafFrancis Cid Pizarro</td></tr>
                    <tr><td>Rancagua</td><td>Felipe Plaza Espinoza</td></tr>
                    <tr><td>San Felipe</td><td>Yetsemani Castro</td></tr>
                    <tr><td>La Serena</td><td>Consuelo Elorza</td></tr>
                </tbody>
            </table>
        </div>
        <div style="margin-bottom:1rem; font-size:0.97em; color:#666;">
            <b>Nota:</b> Algunos centros tienen 2 psic√≥logos y solo uno de ellos tiene la malla cerrada, por lo que depender√° del psic√≥logo con quien se atiende el paciente.
        </div>
        <div style="margin-bottom:1rem;">
            <a href="https://achs.sharepoint.com/:x:/s/SaludIntegral/Eehipz2oYspAtLxZ5Onbs5UBQK4OU2bKfBBIAtDTw9GZwA?wdOrigin=TEAMS-MAGLEV.p2p_ns.rwc&wdExp=TEAMS-TREATMENT&wdhostclicktime=1759155374934&web=1" target="_blank" style="color:#3076e3; font-weight:600; text-decoration:underline;">üìÑ Ver Excel: Pacientes que pueden agendar centros</a>
        </div>
        <div style="background:#fff3cd; border:1px solid #ffc107; padding:12px; border-radius:6px; color:#856404; font-weight:600;">
            ‚ö†Ô∏è <b>Importante:</b> No se estar√°n aceptando nuevos pacientes por el minuto en estos centros.<br>
            <span style="font-size:0.97em; font-weight:400;">Refuerza: <b>NO agendar a ning√∫n paciente que no est√© en este listado para estos centros.</b></span>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

                        <button id="btnPlanillaRespuestas" class="btn-secundario hover-scale" data-tooltip="Respuestas predefinidas">üìã PLANILLA RESPUESTAS</button>
                        <button id="btnSiglasAgencias" class="btn-secundario hover-scale" onclick="abrirModal('modalSiglasAgencias')" data-tooltip="Ver siglas de agencias ACHS">üè∑Ô∏è SIGLAS DE AGENCIAS ACHS</button>
                        <button id="btnInformacionEP" class="btn-secundario hover-scale" onclick="abrirModal('modalInformacionEP')" data-tooltip="Informaci√≥n sobre Enfermedades Profesionales">üìö INFORMACION EP</button>
                        <button id="btnLeyKarin" class="btn-secundario hover-scale" onclick="abrirModal('modalLeyKarin')" data-tooltip="Preguntas Frecuentes Ley Karin">‚öñÔ∏è LEY KARIN</button>
<!-- Modal LEY KARIN -->
<div id="modalLeyKarin" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:700px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(0,33,71,0.15); padding:2rem; position:relative; overflow-y:auto; max-height:90vh;">
        <button onclick="cerrarModal('modalLeyKarin')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#1e3a8a; cursor:pointer;">&times;</button>
        <h2 style="color:#1e3a8a; margin-bottom:1rem; text-align:center;">‚öñÔ∏è Ley Karin ‚Äì Preguntas Frecuentes ACHS Seguro Laboral</h2>
        <div style="font-size:1em; color:#222; line-height:1.6; max-height:70vh; overflow-y:auto; padding-right:8px;">
            <ol style="padding-left:1.2em;">
                <li><b>üü¶ Nueva informaci√≥n ‚Äì Activaci√≥n de Ley Karin </b><br>
üìû Si llama el trabajador o afectado:</b><br>
‚û°Ô∏è El agendamiento se realiza de forma espont√°nea en la Agencia.</b><br>
üö´ No se solicita por formulario.</b><br>
üè¢ Si llama la empresa:</b><br>
‚û°Ô∏è Debe realizar la gesti√≥n por el 1404 opci√≥n 3 o por ACHS Virtual.</b><br>
üìù Esto permite que se realice la APT correspondiente.</b><br>
üü¢ Recordar: Esta actualizaci√≥n aplica de inmediato para todas las atenciones relacionadas con Ley Karin.</b><br>

Admisi√≥n y Agenda APT.
<li><b>PREGUNTAS FRECUENTES LEY KARIN ‚Äì GESTI√ìN CCENTER.</b><br>
<li><b>C√≥mo solicitar APT por Ley Karin?</b><br>
Puedes hacerlo ingresando en achsvirtual.achs.cl o llamando al 1404 opci√≥n 3
<li><b>Qui√©n debe solicitar la APT?</b><br>
El empleador.
<li><b>Qu√© necesito para solicitar la APT?</b><br>
Debes contar con los siguientes datos: Rut empresa, mail empresa + nombre, RUT, tel√©fono y mail del trabajador afectado
<li><b>La empresa recibe con alg√∫n comprobante de la solicitud? </b><br>
Si, recibir√° un mail confirmando el √©xito de la solicitud, el motivo y los datos del trabajador/a 
<li><b>C√≥mo se entera el trabajador de su ingreso en la achs? </b><br>
Una vez recibida la solicitud del empleador, en un plazo m√°ximo de 24 horas h√°biles un ejecutivo tomar√° contacto con el trabajador para realizar la admisi√≥n, y agendar la APT. 
<li><b>Qu√© ocurre si no se logra contacto con el trabajador? </b><br>
El empleador recibir√° una notificaci√≥n en caso de no poder contactar al trabajador luego de 3 intentos dentro de 24 horas h√°biles. 
<li><b>Qu√© ocurre si el trabajador no desea recibir la APT? </b><br>
En caso de rechazar la APT, el empleador recibir√° una notificaci√≥n al respecto. 
<li><b>Si el trabajador desiste del rechazo y desea ser atendido? </b><br>
El empleador deber√° realizar nuevamente la solicitud v√≠a achs virtual o llamando al 1404 opci√≥n 3 
<li><b>Cu√°l es el flujo una vez contactado el trabajador? </b><br>
Se realizar√° la admisi√≥n, y se agendar√° la APT (la cu√°l ocurrir√° en un plazo m√°ximo de 72 horas). 
<li><b>¬øQu√© ocurre si la empresa llama para activar APT, y el trabajador ya se present√≥ en un centro achs?? </b><br>
Si ya cuenta con un siniestro por el mismo motivo, no se debe Admisionar de forma remota por CCENTER. 
<li><b>La empresa debe subir una denuncia DIAT/DIEP?</b><br> 
Si, la empresa debe cargar en Achs Virtual la DIAT hasta 24 horas desde la notificaci√≥n del hecho. 
<li><b>Si el trabajador afectado por Ley Karin recibi√≥ agresi√≥n f√≠sica o f√≠sica y verbal, puedo activar ley Karin por ccenter?.</b><br>
No, todo caso donde exista agresi√≥n f√≠sica debe ser derivado presencial a su centro de salud achs m√°s cercano para que puedan evaluar su estado, independiente a que el trabajador 
indique no presentar molestias, dolor, etc...
<li><b>Es obligaci√≥n del trabajador asistir a la APT de achs?</b><br>
No, no es obligaci√≥n.
                <li><b>¬øSi los trabajadores presenciaron un turbazo en su lugar de trabajo en el que no hubo amenaza directa a ninguno, deben ser admisionados?</b><br>
                En este caso no existe un evento que haya expuesto la vida o integridad de los trabajadores, por lo que pueden recibir una prestaci√≥n preventiva UIC.<br>
                Por otro lado, si alguno de ellos fue agredido, amenazado con arma de fuego, arma blanca u otro objeto contundente, debe ser admisionado, agendado y atendido de manera individual. Esto asegurar√° que las prestaciones de salud que requiera, dado el evento de alto impacto que atraves√≥, est√©n garantizadas y sujetas al siniestro que se generar√° para su atenci√≥n.
                </li>
                <li><b>Si existen trabajadores que han sido expuestos a eventos de alto impacto emocional, ¬øpuede solicitar √∫nicamente la intervenci√≥n preventiva?</b><br>
                No puede solicitarse la intervenci√≥n preventiva para trabajadores que, seg√∫n la circular 3869, debe respaldar su APT con una DIAT/DIEP dada la gravedad del evento del que fue v√≠ctima.<br>
                La intervenci√≥n preventiva es √∫nicamente para los casos de bajo impacto y no reemplaza en ning√∫n caso la APT individual que el trabajador puede recibir por derecho.
                </li>
                <li><b>¬øLa atenci√≥n individual de los trabajadores que han sido admisionados genera informe para la empresa?</b><br>
                La atenci√≥n por violencia y alta complejidad, al igual que las atenciones Ley Karin, no generar√° un informe posterior a la atenci√≥n. La notificaci√≥n empresa as√≠ como el eventual avance y agendamientos posteriores del trabajador en el √°rea de salud ACHS, ser√° notificado por los medios regulares para estos fines.<br>
                La intervenci√≥n preventiva s√≠ genera informe de cierre.
                </li>
                <li><b>El trabajador que recibir√° su APT individual, ¬øpodr√≠a participar de la intervenci√≥n preventiva?</b><br>
                El trabajador que ya recibi√≥ su APT individual y desea participar en la instancia presencial y grupal, puede hacerlo sin inconvenientes. Esta instancia le permitir√° no solo validar su propia experiencia, sino tambi√©n enriquecerla al compartir y contrastar vivencias con sus colegas, fortaleciendo as√≠ la mirada de equipo frente al evento.
                </li>
                <li><b>¬øLa empresa puede activar a trav√©s del 1404 sin DIAT/DIEP y regularizarla posteriormente?</b><br>
                La empresa podr√° activar sin presentar la DIAT/DIEP. Cabe mencionar, sin embargo, que la normativa indica que la empresa tiene 24 horas para generarla una vez recibida la denuncia.<br>
                ACHS proceder√° a ingresar a su trabajador, agendar la APT y atenci√≥n m√©dica en agencia del trabajador afectado, independiente que la DIAT/DIEP haya sido cargada en ACHS virtual al momento de la activaci√≥n.
                </li>
                <li><b>Si la denuncia no se realiza, ¬øel trabajador puede recibir la atenci√≥n psicol√≥gica temprana?</b><br>
                El trabajador que no ha denunciado puede presentarse directamente en un centro de salud ACHS, donde recibir√° la APT en caso que corresponda, sin necesidad de presentar la DIAT/DIEP, donde ser√° el OAL quien genere el documento, seg√∫n lo instruido por la autoridad en esta materia.<br>
                Si el empleador solicita la activaci√≥n de la APT a trav√©s del canal empresa (1404 opci√≥n 3), en este caso el empleador deber√° cargar la DIAT/DIEP en los plazos normativos exigidos.
                </li>
                <li><b>¬øLa atenci√≥n por Ley Karin generar√° un informe posterior a la atenci√≥n?</b><br>
                La atenci√≥n por Ley Karin no generar√° un informe posterior a la atenci√≥n. La notificaci√≥n empresa as√≠ como el eventual avance y agendamientos posteriores del trabajador en el √°rea de salud ACHS, ser√° notificado por los medios regulares para estos fines.
                </li>
                <li><b>Si el trabajador no asiste a su cita para atenci√≥n psicol√≥gica temprana, ¬øse reagenda?</b><br>
                El trabajador podr√° tener hasta 1 reagendamiento si es que no rechaza la APT. Si en esta nueva instancia tampoco se puede realizar la atenci√≥n debido a inasistencia o incidencias relacionadas al trabajador, se cerrar√° el caso y avanzar√° en su calificaci√≥n.
                </li>
                <li><b>¬øQu√© informaci√≥n se necesita para activar el servicio de la UIC?</b><br>
                Al solicitante del servicio se le consultar√° el nombre y RUT de la empresa, datos de contacto para la posterior coordinaci√≥n del servicio, n√∫mero de personas afectadas y un resumen del evento por el que se activa. Es relevante poder diferenciar las personas de primera y segunda l√≠nea para organizar eficazmente las atenciones.<br>
                Para los casos asociados a acoso laboral, sexual o violencia en el trabajo (Ley Karin), el empleador podr√° activar a trav√©s del 1404 para solicitar la APT para los trabajadores que han denunciado ser v√≠ctimas de un evento declarado en la ley 21.643. Para esto, se solicitar√°n los datos b√°sicos de la empresa y del trabajador.
                </li>
                <li><b>¬øCu√°ndo aplica la activaci√≥n de la UIC?</b><br>
                La UIC puede recibir y atender casos Ley que no han sufrido violencia f√≠sica. Estos podr√°n incorporar tanto a las personas directamente afectadas por el evento, como a los trabajadores que participaron en la contenci√≥n o coordinaciones realizadas a ra√≠z del mismo (primera y segunda l√≠nea de exposici√≥n).
                </li>
                <li><b>¬øCu√°ndo no aplica la activaci√≥n de la UIC?</b><br>
                Los casos que no aplican para la contenci√≥n por parte de la UIC corresponden a los eventos no relacionados al contexto laboral o prestaci√≥n de servicios y los casos que han presentado violencia f√≠sica. Estos √∫ltimos tienen que hacer ingreso directo a centro de salud ACHS para evaluar el estado f√≠sico del trabajador afectado. En caso que corresponda, las prestaciones psicol√≥gicas ser√°n entregadas en centro de salud ACHS.
                </li>
                <li><b>¬øTodo proceso de atenci√≥n por Ley Karin implicar√° la atenci√≥n por la dupla de especialistas en centro de salud ACHS?</b><br>
                El colaborador que se ha visto afectado por alg√∫n evento asociado a Ley Karin y que presente sintomatolog√≠a ps√≠quica espec√≠fica, ser√° evaluado en agencia de salud ACHS, donde se pesquisar√° la existencia del alto impacto emocional. Si este √∫ltimo est√° presente, ser√° agendado con la dupla de especialistas.
                </li>
            </ol>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

<!-- Modal INFORMACION EP -->
<div id="modalInformacionEP" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:540px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(0,33,71,0.15); padding:2rem; position:relative;">
        <button onclick="cerrarModal('modalInformacionEP')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#1e3a8a; cursor:pointer;">&times;</button>
        <h2 style="color:#1e3a8a; margin-bottom:1rem; text-align:center;">üìö Informaci√≥n EP</h2>
        <div style="display:flex; justify-content:center; margin-bottom:1.2rem;">
            <div style="display:flex; flex-wrap:wrap; gap:12px; width:100%; justify-content:center;">
                <button onclick="abrirModal('modalRecetasEP')" style="background:linear-gradient(145deg, #009688, #26a69a); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(0,150,136,0.2);">üíä Retiro de Medicamento</button>
                <button onclick="abrirModal('modalPreguntasEP')" style="background:linear-gradient(145deg, #2563eb, #5ea0ef); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(30,99,235,0.15);">‚ùì Preguntas Frecuentes</button>
                <button onclick="abrirModal('modalQuiebreEPSM')" style="background:linear-gradient(145deg, #f59e42, #f7c873); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(245,158,66,0.15);">üß† Quiebre de ingreso EP-SM y cita psicol√≥gico</button>
                <button onclick="abrirModal('modalIngresoEPMEOP')" style="background:linear-gradient(145deg, #4caf50, #81c784); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(76,175,80,0.15);">ü©∫ Ingreso EP-ME / EP-OP</button>
                <button onclick="abrirModal('modalMediosPrueba')" style="background:linear-gradient(145deg, #1976d2, #64b5f6); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(25,118,210,0.15);">üìé Medios de Prueba</button>
                <button onclick="window.open('https://www.asociaciondemutuales.cl/buscador-mutualidades/', '_blank')" style="background:linear-gradient(145deg, #6d28d9, #a78bfa); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(109,40,217,0.15);">üîé Buscador Mutualidades</button>
                <button onclick="abrirModal('modalNotificacionEP')" style="background:linear-gradient(145deg, #2563eb, #5ea0ef); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(30,99,235,0.15);">üõéÔ∏è Notificaci√≥n EP</button>
                <button onclick="abrirModal('modalDocumentosEgreso')" style="background:linear-gradient(145deg, #d97706, #f59e0b); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(217,119,6,0.15);">üìÑ Documentos de egreso ‚Äì Pacientes EP-SM Telemedicina</button>
                <button onclick="abrirModal('modalEstacionamiento')" style="background:linear-gradient(145deg, #059669, #10b981); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(5,150,105,0.15);">üöó Estacionamiento</button>
            </div>
<!-- Modal Preguntas Frecuentes EP (submodal) -->
<!-- Modal Notificaci√≥n EP (submodal) -->
<div id="modalNotificacionEP" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:520px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(30,99,235,0.15); padding:2rem; position:relative;">
        <button onclick="cerrarModal('modalNotificacionEP')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#2563eb; cursor:pointer;">&times;</button>
        <h2 style="color:#2563eb; margin-bottom:1rem; text-align:center;">üõéÔ∏è Notificaci√≥n EP</h2>
        <div style="font-size:1.08em; color:#222; line-height:1.5;">
            <ol>
  <li>üïí Pacientes con tiempo perdido
    <ul>
      <li>Responsable de notificaci√≥n: Agencia de Tratamiento (√∫ltimo control EP).</li>
      <li>Telemedicina SM: Sede responsable es Providencia.</li>
    </ul>
  </li>
  <li>üåç Pacientes de regi√≥n
    <ul>
      <li>Retiro de resoluci√≥n: En sede ACHS m√°s cercana al domicilio del paciente.</li>
    </ul>
  </li>
  <li>üì¨ Plazo y acceso a resoluci√≥n
    <ul>
      <li>Plazo de notificaci√≥n: 5 d√≠as h√°biles.</li>
      <li>Si no recibe correo/carta: Puede acceder a resoluci√≥n en Achs Virtual ‚Üí Siniestro ‚Üí Descargar documento.</li>
      <li>Sin acceso tecnol√≥gico o zonas rurales: Notificaci√≥n presencial en sede de ingreso.</li>
    </ul>
  </li>
  <li>üèôÔ∏è Territorio Metropolitano
    <ul>
      <li>Eliminaci√≥n de distinci√≥n Metro EP: Ya no es exclusiva de Providencia.</li>
      <li>Notificaci√≥n seg√∫n sede de tratamiento final: El paciente debe acudir a esa sede.</li>
      <li>Telemedicina:
        <ul>
          <li>CTP: Cita presencial en Providencia.</li>
          <li>STP: Env√≠o por correo o carta certificada seg√∫n autorizaci√≥n.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>üö´ Inasistencias en pacientes con tiempo perdido
    <ul>
      <li>Alta administrativa: Se genera con una sola inasistencia injustificada.</li>
      <li>Call Center:
        <ul>
          <li>Verifica si resoluci√≥n fue enviada.</li>
          <li>Informa canal y plazo de entrega.</li>
          <li>Recuerda que luego del plazo, puede descargarse desde Achs Virtual.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>üè• Pacientes sin tiempo perdido
    <ul>
      <li>Responsable de notificaci√≥n: Agencia de Ingreso (urgencia, atenci√≥n ambulatoria o espont√°nea).</li>
    </ul>
  </li>
</ol>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

<!-- Modal Documentos de Egreso EP-SM Telemedicina -->
<div id="modalDocumentosEgreso" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:700px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(217,119,6,0.15); padding:2rem; position:relative; max-height:85vh; overflow-y:auto;">
        <button onclick="cerrarModalDocumentosEgreso()" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#d97706; cursor:pointer;">&times;</button>
        <h2 style="color:#d97706; margin-bottom:1rem; text-align:center;">üìÑ Documentos de egreso ‚Äì Pacientes EP-SM Telemedicina</h2>
        
        <div style="background:#fff7ed; border-left:4px solid #d97706; padding:15px; border-radius:8px; margin-bottom:20px;">
            <h3 style="color:#d97706; margin-top:0; font-size:1.15em;">üìå Recordatorio:</h3>
            <p style="margin:5px 0; color:#222; line-height:1.7;">
                Cuando un paciente EP-SM llama posterior a su atenci√≥n indicando que no ha recibido los documentos para firmar, se debe aplicar el siguiente protocolo:
            </p>
        </div>

        <div style="font-size:1.05em; color:#222; line-height:1.7;">
            <div style="background:#f0fdf4; border-left:4px solid #16a34a; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#16a34a; margin-top:0;">üîπ Plazo de env√≠o:</h4>
                <ul style="margin:8px 0; padding-left:20px;">
                    <li>Informar que el documento ser√° enviado dentro de un plazo de <strong>24 horas</strong>.</li>
                    <li>El remitente del correo es: <strong style="color:#2563eb;">Salud Digital TM sdtelemedicina@achs.cl</strong></li>
                    <li>El asunto del correo es: <strong>"Documentos de egreso paciente telemedicina"</strong></li>
                </ul>
            </div>

            <div style="background:#fef3c7; border-left:4px solid #f59e0b; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#f59e0b; margin-top:0;">üîπ Si han pasado m√°s de 24 horas y no ha recibido el documento:</h4>
                <p style="margin:8px 0;">
                    El paciente debe solicitarlo directamente al correo: <strong style="color:#2563eb;">ejecutivoachs@achs.cl</strong>
                </p>
            </div>

            <div style="background:#eff6ff; border-left:4px solid #2563eb; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#2563eb; margin-top:0;">üîπ Si el paciente no sabe c√≥mo firmar el documento:</h4>
                <p style="margin:8px 0;">Indicar que debe ingresar al siguiente enlace:</p>
                <p style="margin:8px 0; background:white; padding:10px; border-radius:6px; text-align:center;">
                    üëâ <a href="https://prod.salud.achs.cl/web-firmadigital/" target="_blank" style="color:#2563eb; font-weight:bold; text-decoration:none;">https://prod.salud.achs.cl/web-firmadigital/</a>
                </p>
                <p style="margin:8px 0;">Debe ingresar su n√∫mero de documento y aceptar.</p>
            </div>

            <div style="background:#fef2f2; border-left:4px solid #dc2626; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#dc2626; margin-top:0;">üîπ Si presenta problemas t√©cnicos, puede hacerlo:</h4>
                <p style="margin:8px 0;">
                    Transferir a <strong>Soporte Web</strong> para asistencia directa.
                </p>
            </div>

            <div style="background:#e0e7ff; border-left:4px solid #4f46e5; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4f46e5; margin-top:0;">üìé Correo que reciben los pacientes:</h4>
                <p style="margin:8px 0;">
                    Es importante que revisen su <strong>bandeja de entrada</strong> y <strong>correo no deseado</strong>.
                </p>
            </div>

            <div style="background:#fee2e2; border:2px solid #dc2626; padding:15px; border-radius:8px; margin-top:20px;">
                <h4 style="color:#dc2626; margin-top:0;">‚ö†Ô∏è Importante:</h4>
                <p style="margin:5px 0; font-weight:600;">
                    Siempre validar si el paciente est√° dentro del plazo de espera y ofrecer alternativas claras si no ha recibido el documento.
                </p>
            </div>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

<!-- Modal Estacionamiento -->
<div id="modalEstacionamiento" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:750px; max-height:90vh; overflow-y:auto; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(5,150,105,0.15); padding:2rem; position:relative;">
        <button onclick="cerrarModalEstacionamiento()" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#059669; cursor:pointer; z-index:10;">&times;</button>
        <h2 style="color:#059669; margin-bottom:1.5rem; text-align:center;">üöó Estacionamiento Hospital del Trabajador</h2>
        
        <div style="font-size:1.02em; color:#222; line-height:1.6;">
            <!-- Informaci√≥n General -->
            <div style="background:#d1fae5; border-left:4px solid #059669; padding:16px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#059669; margin-top:0; margin-bottom:12px;">üìå Informaci√≥n General</h4>
                <ul style="margin:0; padding-left:20px;">
                    <li><strong>Tarifa por minuto:</strong> $28</li>
                    <li><strong>Horario:</strong> Abierto 24 horas</li>
                    <li><strong>Monto l√≠mite de pago:</strong> No hay</li>
                    <li><strong>Direcci√≥n de acceso:</strong> Ram√≥n Carnicer 201</li>
                </ul>
            </div>

            <!-- Pago de Ticket -->
            <div style="background:#fef3c7; border-left:4px solid #f59e0b; padding:16px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#f59e0b; margin-top:0; margin-bottom:12px;">üí≥ Pago de Ticket</h4>
                <ul style="margin:0; padding-left:20px;">
                    <li><strong>Cajeros de pago ubicados en:</strong> Piso -5 y Piso -6</li>
                    <li><strong>Formas de pago:</strong> Efectivo o tarjeta de cr√©dito (en ambos pisos)</li>
                </ul>
            </div>

            <!-- P√©rdida de Ticket -->
            <div style="background:#fee2e2; border-left:4px solid #dc2626; padding:16px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#dc2626; margin-top:0; margin-bottom:12px;">üé´ En caso de P√©rdida de Ticket</h4>
                <p style="margin:0;">
                    Dirigirse al <strong>Piso -6</strong>, Oficina de Administraci√≥n EC Parking<br>
                    (Ubicada a un costado de las m√°quinas de pago)
                </p>
            </div>

            <!-- Lockers Gratuitos -->
            <div style="background:#e0f2fe; border-left:4px solid #0284c7; padding:16px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#0284c7; margin-top:0; margin-bottom:12px;">  Lockers Gratuitos</h4>
                <p style="margin:0;">
                    Disponibles en el <strong>Piso -6</strong>, a un costado de las m√°quinas de pago.
                </p>
            </div>

            <!-- Conexiones de Ascensores -->
            <div style="background:#f3e8ff; border-left:4px solid #9333ea; padding:16px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#9333ea; margin-top:0; margin-bottom:12px;">üè• Conexiones desde los Ascensores del Estacionamiento</h4>
                <p style="margin-bottom:10px; font-weight:600; color:#9333ea;">Los ascensores del estacionamiento conectan directamente con:</p>
                <ul style="margin:0; padding-left:20px; line-height:1.8;">
                    <li><strong>Piso -1:</strong> Urgencia (ingreso vehicular por el mismo acceso de estacionamientos p√∫blicos)</li>
                    <li><strong>Piso -2:</strong> Imagenolog√≠a y Conexi√≥n a Centro M√©dico</li>
                    <li><strong>Piso 1:</strong> Rehabilitaci√≥n, Policl√≠nico, Admisi√≥n Central y Hall Central</li>
                    <li><strong>Pisos 3 y 4:</strong> Hospitalizados Edificio E y B</li>
                    <li><strong>Piso 5:</strong> UPC, Cirug√≠a Pl√°stica y Quemados</li>
                    <li><strong>Piso 6:</strong> Pabell√≥n Central, Preanestesia y Recuperaci√≥n</li>
                </ul>
            </div>

            <!-- Resumen para Dem√°s Centros -->
            <div style="background:#fff1f2; border:2px solid #dc2626; padding:16px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#dc2626; margin-top:0; margin-bottom:8px;">‚ùå Dem√°s centros ACHS Salud</h4>
                <p style="margin:0; font-weight:600;">
                    No contamos con estacionamientos habilitados.
                </p>
            </div>

            <!-- Tip Pr√°ctico -->
            <div style="background:#ecfdf5; border-left:4px solid #10b981; padding:16px; border-radius:8px;">
                <h4 style="color:#10b981; margin-top:0; margin-bottom:10px;">üí¨ Tip para la llamada:</h4>
                <div style="background:white; padding:12px; border-radius:6px; border:1px solid #10b981; font-style:italic;">
                    <p style="margin:0; color:#334155;">
                        "El <strong>Hospital del Trabajador</strong> cuenta con estacionamiento disponible 24/7. El acceso es por <strong>Ram√≥n Carnicer 201</strong>. La tarifa es de <strong>$28 por minuto</strong> y puede pagar en efectivo o tarjeta en los pisos -5 o -6. Desde el estacionamiento hay ascensores directos a todos los servicios del hospital. Los dem√°s centros ACHS no tienen estacionamiento habilitado."
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

<div id="modalPreguntasEP" class="modal" style="display:none; justify-content:center; align-items:center;">
                <div class="modal-contenido" style="width:90vw; max-width:1200px; max-height:480px; background:white; border-radius:10px; box-shadow:0 4px 12px rgba(0,33,71,0.10); padding:0.12rem 0.12rem; position:relative; margin:0 auto; overflow-y:auto;">
        <button onclick="cerrarModal('modalPreguntasEP')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.7rem; color:#2563eb; cursor:pointer;">&times;</button>
        <h2 style="color:#2563eb; margin-bottom:1.2rem; text-align:center;">üõ°Ô∏è Enfermedades Profesionales (EP) ‚Äì Gu√≠a R√°pida ACHS</h2>
    <div style="font-size:1.40em; line-height:2.05;">
            <div style="margin-bottom:0.15em;"><b>1Ô∏è‚É£¬øQu√© es una Enfermedad Profesional?</b><br>üìò Seg√∫n la Ley N¬∞ 16.744, es una enfermedad causada directamente por el trabajo que realiza una persona y que puede provocar incapacidad o muerte.</div>
            <div style="margin-bottom:1.1em;"><b>2Ô∏è‚É£ ¬øQu√© son las Mutualidades?</b><br>üè• Son organismos que administran el seguro de la Ley 16.744. Protegen al trabajador con:<br>- Prevenci√≥n de riesgos<br>- Capacitaciones<br>- Cobertura m√©dica y compensaciones<br>üîπ Mutualidades reconocidas:<br>- ACHS ‚Äì Asociaci√≥n Chilena de Seguridad<br>- MUTUAL DE SEGURIDAD<br>- IST ‚Äì Instituto de Seguridad del Trabajo<br>- ISL ‚Äì Instituto de Seguridad Laboral</div>
            <div style="margin-bottom:1.1em;"><b>3Ô∏è‚É£ ¬øC√≥mo se inicia el proceso?</b><br>üìû Llamando al Call Center 600 600 2247<br>- Empleador: Opci√≥n 4 ‚Üí Empresa ‚Üí 2 EP<br>- Trabajador: Opci√≥n 3 ‚Üí 3 EP</div>
            <div style="margin-bottom:1.1em;"><b>4Ô∏è‚É£ ¬øQu√© tipos de EP se agendan?</b><br>üß† Salud Mental (SM): estr√©s, acoso, burnout<br>üí™ Musculoesquel√©tico (ME): dolor corporal, dermatitis, disfon√≠as, etc.<br>‚ö†Ô∏è Eventos puntuales ‚Üí se ingresan como accidente</div>
            <div style="margin-bottom:1.1em;"><b>5Ô∏è‚É£ Atenciones en Regi√≥n Metropolitana</b><br>üìç CEEP ‚Äì Vicu√±a Mackenna 200, 4¬∞ piso (Metro Parque Bustamante)<br>üïò Solo con cita previa<br>- ME presencial<br>- SM telemedicina (nacional)<br>- SM presencial (excepcional)</div>
            <div style="margin-bottom:1.1em;"><b>6Ô∏è‚É£ Atenciones en Regiones</b><br>üìÇ Consultar archivo PIZARRA 2023 para sucursales y agendamiento</div>
            <div style="margin-bottom:1.1em;"><b>7Ô∏è‚É£ Tipos de citas que se agendan</b><br>üìå Ingreso EP ME<br>üìå Ingreso EP SM (telemedicina preferente)<br>üìå Notificaci√≥n de resultado (solo RM en CEEP)<br>üìå Control EPMe-Otros (solo reagendamiento)</div>
            <div style="margin-bottom:1.1em;"><b>8Ô∏è‚É£ ¬øC√≥mo saber si se puede agendar?</b><br>üîç Verificar cotizaciones en SAP ‚Üí ZFI_CONSULTA con RUT del trabajador</div>
            <div style="margin-bottom:1.1em;"><b>9Ô∏è‚É£ ¬øY si no aparecen cotizaciones?</b><br>üîé Verificar RUT del empleador en Salesforce<br>üì¢ Si empresa no est√° vigente ‚Üí derivar a su mutualidad correspondiente</div>
            <div style="margin-bottom:1.1em;"><b>üîü ¬øSe agenda a trabajadores independientes?</b><br>‚úÖ S√≠, si tienen cotizaciones. Verificar en Salesforce como ‚Äúindependiente‚Äù</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£1Ô∏è‚É£ ¬øPacientes con Licencia M√©dica?</b><br>‚úÖ Se agendan si tienen:<br>- Licencia tipo 6 (EP)<br>- Licencia tipo 1 rechazada por Isapre<br>- Derivaci√≥n m√©dica<br>- Licencia por otra patolog√≠a</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£2Ô∏è‚É£ ¬øPacientes ISL?</b><br>‚ùå No se agendan directamente<br>üìå Deben denunciar en ISL<br>üìû Si ISL deriva a ACHS ‚Üí se contacta al paciente<br>üë©‚Äç‚öïÔ∏è Agendamiento autorizado: Paloma Crett√≥n / Constanza Vel√°squez<br>üìù Registrar en nota externa</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£3Ô∏è‚É£ ¬øC√≥mo es el proceso de evaluaci√≥n?</b><br>ü©∫ M√©dico general + comit√© ‚Üí investigaci√≥n (30 d√≠as)<br>üè≠ Puede incluir visita al puesto de trabajo<br>üìã Si se confirma origen laboral ‚Üí derivaci√≥n a especialistas<br>üìå Para SM: traer nombre y tel√©fono de 2 testigos<br>üé• Video explicativo</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£4Ô∏è‚É£ ¬øQu√© es la DIEP?</b><br>üìÑ Formulario de Denuncia Individual de EP<br>üì• Descargar aqu√≠</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£5Ô∏è‚É£ ¬øLa denuncia es an√≥nima?</b><br>üö´ No. Se debe notificar a la empresa y evaluar el puesto de trabajo</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£6Ô∏è‚É£ ¬øSe puede reagendar si se pierde la cita?</b><br>‚úÖ Solo si es:<br>- Primera cita<br>- Control EPMe<br>- Notificaci√≥n en CEEP<br>üìå Para otras especialidades ‚Üí justificar presencialmente<br>üìã Para ingreso SM perdido ‚Üí llenar formulario con datos del paciente</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£7Ô∏è‚É£ ¬øQu√© es el Estudio de Puesto de Trabajo?</b><br>üîç An√°lisis de condiciones laborales para evaluar riesgos</div>
            <div style="margin-bottom:1.1em;"><b>1Ô∏è‚É£8Ô∏è‚É£ a 2Ô∏è‚É£2Ô∏è‚É£ ¬øD√≥nde se agenda cada tipo?</b><br>üìå SM Telemedicina ‚Üí malla nacional<br>üìå SM Presencial ‚Üí RM: Providencia / Regiones: agencia local<br>üìå ME ‚Üí RM: Providencia / Regiones: agencia local<br>üìå Control EPMe-Otros ‚Üí solo reagendamos en Providencia<br>üìå Notificaciones ‚Üí RM: Providencia / Regiones: presencial en agencia</div>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

<!-- Modal Ingreso EP-ME / EP-OP (submodal) -->
<div id="modalIngresoEPMEOP" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:600px; background:white; border-radius:14px; box-shadow:0 4px 16px rgba(76,175,80,0.13); padding:1.2rem 1rem; position:relative;">
        <button onclick="cerrarModal('modalIngresoEPMEOP')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#4caf50; cursor:pointer;">&times;</button>
        <h2 style="color:#4caf50; margin-bottom:1rem; text-align:center;">ü©∫ Malla de Agendamiento seg√∫n Situaci√≥n del Paciente</h2>
        <div style="font-size:1em; line-height:1.5;">
            <div style="margin-bottom:0.8em;">üîπ <b>Dolor o molestia desde la punta del dedo hasta el cuello (extremidades superiores):</b><br>‚û°Ô∏è Agendar en <b>Ingreso EP ME</b></div>
            <div style="margin-bottom:0.8em;">üîπ <b>Lesiones cut√°neas, alergias o problemas en la piel:</b><br>‚û°Ô∏è Agendar en <b>Ingreso EP OP</b></div>
            <div style="margin-bottom:0.8em;">üîπ <b>S√≠ntomas respiratorios (tos, dificultad para respirar, etc.):</b><br>‚û°Ô∏è Agendar en <b>Ingreso EP OP</b></div>
            <div style="margin-bottom:0.8em;">üîπ <b>S√≠ntomas auditivos (p√©rdida de audici√≥n, zumbidos, etc.):</b><br>‚û°Ô∏è Agendar en <b>Ingreso EP OP</b></div>
            <div style="margin-bottom:0.8em;">üîπ <b>Dolor o molestia en piernas, rodillas, caderas o regi√≥n inguinal (extremidades inferiores):</b><br>‚û°Ô∏è Agendar en <b>Ingreso EP OP</b></div>
            <div style="margin-bottom:0.8em;">üîπ <b>Dolor en extremidades superiores + otra dolencia adicional:</b><br>‚û°Ô∏è Agendar <b>1 cupo en Ingreso EP ME</b> + <b>1 cupo en Ingreso EP OP</b></div>
            <div style="margin-bottom:0.8em;">üîπ <b>¬øNo sabes d√≥nde encaja la consulta del paciente?</b><br>‚û°Ô∏è Ante la duda, agendar en <b>Ingreso EP OP</b></div>
            <div style="margin-bottom:1.2em;">üìå <b>Tip √∫til:</b> Si el paciente presenta m√°s de una dolencia, aseg√∫rate de agendar los cupos necesarios para una evaluaci√≥n completa.</div>
            <div style="margin-bottom:0.8em;">üîé <b>¬øQu√© significa ‚Äú+ 1 cupo adicional‚Äù?</b><br>üìå Se debe agendar una segunda cita en la misma malla de Ingreso EP ME para asegurar evaluaci√≥n completa del caso con irradiaci√≥n.</div>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

<!-- Modal Medios de Prueba (submodal) -->
<div id="modalMediosPrueba" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:540px; background:white; border-radius:14px; box-shadow:0 4px 16px rgba(25,118,210,0.13); padding:1.2rem 1rem; position:relative;">
        <button onclick="cerrarModal('modalMediosPrueba')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#1976d2; cursor:pointer;">&times;</button>
        <h2 style="color:#1976d2; margin-bottom:1rem; text-align:center;">üìé Medios de Prueba</h2>
        <div style="font-size:1em; line-height:1.5;">
            <div style="margin-bottom:1em;">üìå <b>¬°Importante!</b> Si est√°s en proceso de estudio por Enfermedad Profesional (EP) y deseas agregar m√°s evidencia, sigue estos pasos:</div>
            <div style="margin-bottom:1em;">‚úâÔ∏è <b>¬øD√≥nde enviar?</b><br>üìß <b>Correo:</b> <span style="color:#1976d2; font-weight:600;">mediosdeprueba@achs.cl</span><br>üïí Env√≠a tu informaci√≥n lo antes posible para que sea revisada antes de tu calificaci√≥n.</div>
            <div style="margin-bottom:1em;">üìé <b>Requisitos para los documentos:</b><br>‚úÖ <b>Formato:</b> PDF<br>üì¶ <b>Peso m√°ximo:</b> 25 MB<br>üìù <b>Asunto del correo:</b> N√∫mero de siniestro<br>üîç (Lo encuentras en el documento de indicaciones m√©dicas que recibiste por email)</div>
            <div style="margin-bottom:1em;">üö´ <b>No se aceptan:</b><br>- Audios ni videos<br>- Testigos (deben entregarse en ingreso m√©dico o psicol√≥gico)</div>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

<!-- Modal Quiebre de ingreso EP-SM y cita psicol√≥gico (submodal) -->
<div id="modalQuiebreEPSM" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:540px; background:white; border-radius:14px; box-shadow:0 4px 16px rgba(245,158,66,0.13); padding:1.2rem 1rem; position:relative;">
        <button onclick="cerrarModal('modalQuiebreEPSM')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#f59e42; cursor:pointer;">&times;</button>
        <h2 style="color:#f59e42; margin-bottom:1rem; text-align:center;">üß† Quiebre de ingreso EP-SM y cita psicol√≥gico</h2>
        <div style="font-size:1em; line-height:1.5;">
            <div style="margin-bottom:1em;">‚úÖ‚ÄØ<b>1. Paciente sin llamado administrativo y hora ya pasada m√°s 20 minutos:</b><br>‚û°Ô∏è‚ÄØDeben gestionar directamente el reagendamiento a trav√©s de Forms.</div>
            <div style="margin-bottom:1em;">‚úÖ‚ÄØ<b>2. Paciente en sala de espera:</b><br>‚û°Ô∏è‚ÄØDebe permanecer en espera.<br>‚û°Ô∏è‚ÄØSi no es atendido oportunamente, ser√° contactado para reagendar.<br>‚û°Ô∏è‚ÄØSi es la segunda vez que ocurre, gestionar directamente el reagendamiento a trav√©s de Forms.</div>
            <div style="margin-bottom:1em;"><b>Por qu√© es importante:</b><br>Evita que el paciente se retire sin atenci√≥n ni seguimiento, y permite mantener trazabilidad de los casos reagendados.</div>
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

        </div>
    </div>
</div>
<!-- Modal RECETAS EP -->
<div id="modalRecetasEP" class="modal" style="display:none; justify-content:center; align-items:center;">
    <div class="modal-contenido" style="max-width:600px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(0,33,71,0.15); padding:2rem; position:relative;">
        <button onclick="cerrarModal('modalRecetasEP')" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#009688; cursor:pointer;">&times;</button>
        <h2 style="color:#009688; margin-bottom:1rem; text-align:center;">ü©∫üíä Retiro de Medicamentos Indicados por tu M√©dico</h2>
        <div style="margin-bottom:1.2rem;">
            <b>üìç ¬øD√≥nde y cu√°ndo retirar?</b>
            <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                <li>üß† <b>Atenci√≥n de Salud Mental:</b><br>Retiro en agencia ACHS m√°s cercana, 24 horas h√°biles despu√©s de tu atenci√≥n, entre 09:00 y 16:00 hrs.</li>
                <li>üßë‚Äç‚öïÔ∏è <b>Atenci√≥n Psiqui√°trica:</b><br>Retiro en agencia ACHS m√°s cercana, 48 a 72 horas h√°biles despu√©s de tu atenci√≥n, entre 09:00 y 16:00 hrs.</li>
            </ul>
            <b>üè• Si retiras en el Hospital del Trabajador:</b>
            <ul>
                <li><b>Receta retenida:</b><br>Ingresa por Vicu√±a Mackenna 200, sube al 4¬∞ piso (CEEP) para regularizar tu receta, luego baja al piso -1 (farmacia).</li>
            </ul>
            <b>üè¢ Si retiras en Agencia con receta retenida:</b>
            <ul>
                <li>‚è≥ Tu receta debe ser regularizada por el m√©dico antes del retiro.<br>Esto puede tomar algunos minutos. ¬°Organiza tus tiempos!</li>
            </ul>
        </div>
        <div style="margin-bottom:1.2rem;">
            <b>‚úÖ Requisitos para el retiro:</b>
            <ul>
                <li>üéüÔ∏è Sacar ticket de farmacia o botiqu√≠n para ser atendido.</li>
                <li>ü™™ Llevar tu documento de identidad.</li>
                <li>üë• Puede retirar un tercero con poder simple y mayor de 18 a√±os.</li>
            </ul>
        </div>
        <div>
            <b>üìå Recuerda:</b><br>
            Sigue siempre las indicaciones de tu m√©dico para el uso correcto de tus medicamentos. ¬°Tu salud es lo primero!
        </div>
    </div>
</div>

<!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->

                    </div>
                </div>
                
                <!-- Botones de herramientas (entre Consulta y Formulario) -->

                                <!-- Modal Reclamo -->
                                                <div id="modalReclamo" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:4000; justify-content:center; align-items:center;">
                                                                        <div style="background:linear-gradient(135deg,#fff,#e3f2fd 80%); border-radius:24px; padding:40px 32px; max-width:480px; width:95%; box-shadow:0 12px 40px rgba(30,58,138,0.13); position:relative;">
                                                                            <div style="display:flex;align-items:center;gap:12px;justify-content:center;margin-bottom:12px;">
                                                                                <span style="font-size:2.2em;">üõë</span>
                                                                                <h2 style="color:#2563eb; margin:0; font-size:1.25em; letter-spacing:1px;">Levantamiento de Quiebre Paciente</h2>
                                                                            </div>
                                                                            <div style="background:#e3f2fd; color:#1e3a8a; border-radius:10px; padding:12px 18px; margin-bottom:20px; font-size:1em; text-align:center;">
                                                                                <b>Un ejecutivo ACHS est√° reportando una situaci√≥n cr√≠tica o quiebre en la atenci√≥n de un paciente.</b><br>
                                                                                Por favor, describe el caso con claridad para que el equipo EP-SNL pueda gestionarlo de forma prioritaria.
                                                                            </div>
                                                                            <form onsubmit="enviarReclamo(event)">
                                                                                  <label style="font-weight:600; color:#1e3a8a;">Nombre del paciente:</label>
                                                                                  <input type="text" id="reclamoNombre" required placeholder="Nombre completo del paciente" style="width:100%;margin-bottom:10px;padding:10px;border-radius:8px;border:1.5px solid #b8c2c9;">
                                                                                  <label style="font-weight:600; color:#1e3a8a;">RUT del paciente:</label>
                                                                                  <input type="text" id="reclamoRut" required placeholder="12.345.678-9" style="width:100%;margin-bottom:10px;padding:10px;border-radius:8px;border:1.5px solid #b8c2c9;">
                                                                                  <label style="font-weight:600; color:#1e3a8a;">Correo del paciente:</label>
                                                                                  <input type="email" id="reclamoCorreo" required placeholder="paciente@correo.com" style="width:100%;margin-bottom:10px;padding:10px;border-radius:8px;border:1.5px solid #b8c2c9;">
                                                                                  <label style="font-weight:600; color:#1e3a8a;">Detalle del quiebre/situaci√≥n:</label>
                                                                                  <textarea id="reclamoDetalle" required rows="4" placeholder="Describe la situaci√≥n, motivo y urgencia..." style="width:100%;margin-bottom:18px;padding:10px;border-radius:8px;border:1.5px solid #b8c2c9;"></textarea>
                                                                                <div style="display:flex;flex-direction:column;gap:12px;">
                                                                                    <button type="submit" style="background:linear-gradient(90deg,#2563eb,#5ea0ef);color:white;border:none;border-radius:8px;padding:14px 0;font-weight:bold;font-size:1.08em;cursor:pointer;box-shadow:0 2px 8px #b3d1ff;">Reportar Quiebre</button>
                                                                                    <button type="button" onclick="copiarReclamoATexto()" style="background:linear-gradient(90deg,#00b894,#5ea0ef);color:white;border:none;border-radius:8px;padding:14px 0;font-weight:bold;font-size:1.08em;cursor:pointer;box-shadow:0 2px 8px #b3d1ff;display:flex;align-items:center;justify-content:center;gap:8px;">
                                                                                        <img src='https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/microsoftteams.svg' alt='Teams' style='width:1.3em;height:1.3em;vertical-align:middle;filter:invert(1);'> Copiar reclamo para Teams
                                                                                    </button>
                                                                                    <button type="button" onclick="derivarATeams()" style="background:linear-gradient(90deg,#0078d4,#5ea0ef);color:white;border:none;border-radius:8px;padding:14px 0;font-weight:bold;font-size:1.08em;cursor:pointer;box-shadow:0 2px 8px #b3d1ff;display:flex;align-items:center;justify-content:center;gap:8px;">
                                                                                        <img src='https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/microsoftteams.svg' alt='Teams' style='width:1.3em;height:1.3em;vertical-align:middle;filter:invert(1);'> Derivar Quiebre a EP-SNL Teams
                                                                                    </button>
                                                                                    <button type="button" onclick="cerrarModalReclamo()" style="background:#6c757d;color:white;border:none;border-radius:8px;padding:10px 0;font-weight:bold;font-size:1em;cursor:pointer;">Cerrar</button>
                                                                                </div>
                                                                            </form>
                                                                        </div>
                                                                    </div>

                                <script>
                                function derivarATeams() {
                                    window.open('https://teams.microsoft.com/l/chat/19:2f38f239bed249eeb7eacf9be535c94d@thread.v2/conversations?context=%7B%22contextType%22%3A%22chat%22%7D', '_blank');
                                }

                                function copiarReclamoATexto() {
                                    var nombre = document.getElementById('reclamoNombre').value;
                                    var rut = document.getElementById('reclamoRut').value;
                                    var correo = document.getElementById('reclamoCorreo').value;
                                    var detalle = document.getElementById('reclamoDetalle').value;
                                    var texto = `üõë Reclamo/Quiebre Paciente\nNombre: ${nombre}\nRUT: ${rut}\nCorreo: ${correo}\nDetalle: ${detalle}`;
                                    if (navigator.clipboard && window.isSecureContext) {
                                        navigator.clipboard.writeText(texto).then(function() {
                                            alert('‚úÖ Reclamo copiado. Ahora puedes pegarlo en Teams.');
                                        }, function() {
                                            fallbackCopyTextToClipboard(texto);
                                        });
                                    } else {
                                        fallbackCopyTextToClipboard(texto);
                                    }
                                }

                                function fallbackCopyTextToClipboard(text) {
                                    var textArea = document.createElement('textarea');
                                    textArea.value = text;
                                    textArea.style.position = 'fixed';
                                    textArea.style.top = '-1000px';
                                    textArea.style.left = '-1000px';
                                    document.body.appendChild(textArea);
                                    textArea.focus();
                                    textArea.select();
                                    try {
                                        var successful = document.execCommand('copy');
                                        if (successful) {
                                            alert('‚úÖ Reclamo copiado. Ahora puedes pegarlo en Teams.');
                                        } else {
                                            alert('‚ùå Error al copiar el reclamo.');
                                        }
                                    } catch (err) {
                                        alert('‚ùå Error al copiar el reclamo.');
                                    }
                                    document.body.removeChild(textArea);
                                }
                                function abrirModalReclamo() {
                                    var modal = document.getElementById('modalReclamo');
                                    modal.style.display = 'flex';
                                    modal.style.justifyContent = 'center';
                                    modal.style.alignItems = 'center';
                                }
                                function cerrarModalReclamo() {
                                    document.getElementById('modalReclamo').style.display = 'none';
                                }
                                function enviarReclamo(event) {
                                    event.preventDefault();
                                    cerrarModalReclamo();
                                    alert('‚úÖ Reclamo enviado correctamente. ¬°Gracias por tu feedback!');
                                }
                                </script>

                <!-- Modal Siglas de Agencias ACHS -->
                <div id="modalSiglasAgencias" class="modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:3000; justify-content:center; align-items:center;">
                    <div class="modal-contenido" style="background:white; border-radius:16px; padding:32px 24px; max-width:480px; width:95%; box-shadow:0 8px 32px rgba(30,58,138,0.18); position:relative;">
                        <button onclick="cerrarModal('modalSiglasAgencias')" class="btn-cerrar-modal" aria-label="Cerrar" style="position:absolute; top:10px; right:12px; background:none; border:none; font-size:1.5rem; color:#1e3a8a; cursor:pointer; line-height:1;">&times;</button>
                        <h2 style="color:#1e3a8a; margin-top:0; margin-bottom:22px; font-size:1.5em; text-align:center; letter-spacing:1px;">Siglas de Agencias ACHS</h2>
                                                <!-- estilos migrados a assets/css/styles.css -->
                        <div class="sigla-lista-vertical">
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">TEMTCAPR</span><span class="sigla-tarjeta-agencia">TEMUCO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">VINTCAPR</span><span class="sigla-tarjeta-agencia">VI√ëA DEL MAR</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">STGTCAPR</span><span class="sigla-tarjeta-agencia">SANTIAGO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">PMOTCAPR</span><span class="sigla-tarjeta-agencia">PUERTO MONTT</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">CNCTCAPR</span><span class="sigla-tarjeta-agencia">CONCEPCION</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">VLDTCAPR</span><span class="sigla-tarjeta-agencia">VALDIVIA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">MAITCAPR</span><span class="sigla-tarjeta-agencia">MAIPU</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">LANTCAPR</span><span class="sigla-tarjeta-agencia">LOS ANGELEZ</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">TLCTCAPR</span><span class="sigla-tarjeta-agencia">TALCA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">IQUTCAPR</span><span class="sigla-tarjeta-agencia">IQUIQUE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">MIGTCAPR</span><span class="sigla-tarjeta-agencia">SAN MIGUEL</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">FELTCAPR</span><span class="sigla-tarjeta-agencia">SAN FELIPE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">RANTCAPR</span><span class="sigla-tarjeta-agencia">RANCAGUA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">VLPTCAPR</span><span class="sigla-tarjeta-agencia">VALPARAISO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">PALTCAPR</span><span class="sigla-tarjeta-agencia">PUENTE ALTO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">LCNTCAPR</span><span class="sigla-tarjeta-agencia">LAS CONDES</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">OVATCAPR</span><span class="sigla-tarjeta-agencia">OVALLE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">CURTCAPR</span><span class="sigla-tarjeta-agencia">CURICO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">PUNTCAPR</span><span class="sigla-tarjeta-agencia">PUNTA ARENAS</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">TLHTCAPR</span><span class="sigla-tarjeta-agencia">TALCAHUANO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">REITCAPR</span><span class="sigla-tarjeta-agencia">LA REINA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">QUITCAPR</span><span class="sigla-tarjeta-agencia">QUILICURA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">COLTCAPR</span><span class="sigla-tarjeta-agencia">COLINA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">FERTCAPR</span><span class="sigla-tarjeta-agencia">SAN FERNANDO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">CASTCAPR</span><span class="sigla-tarjeta-agencia">CASTRO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">COQTCAPR</span><span class="sigla-tarjeta-agencia">COQUIMBO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">CORTCAPR</span><span class="sigla-tarjeta-agencia">CORONEL</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">COYTCAPR</span><span class="sigla-tarjeta-agencia">COYAIQUE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">SVCTCAPR</span><span class="sigla-tarjeta-agencia">SAN VICENTE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">COPTCAPR</span><span class="sigla-tarjeta-agencia">COPIAPO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">MELTCAPR</span><span class="sigla-tarjeta-agencia">MELIPILLA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">PLATCAPR</span><span class="sigla-tarjeta-agencia">PARQUE LAS AMERICAS</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">ILLTCAPR</span><span class="sigla-tarjeta-agencia">ILLAPEL</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">CHITCAPR</span><span class="sigla-tarjeta-agencia">CHILLAN</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">OSOTCAPR</span><span class="sigla-tarjeta-agencia">OSORNO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">ANGTCAPR</span><span class="sigla-tarjeta-agencia">ANGOL</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">ANFTCAPR</span><span class="sigla-tarjeta-agencia">ANTOFAGASTA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">AYSTCAPR</span><span class="sigla-tarjeta-agencia">AYSEN</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">CLMTCAPR</span><span class="sigla-tarjeta-agencia">CALAMA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">TLGTCAPR</span><span class="sigla-tarjeta-agencia">TALAGANTE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">ANDTCAPR</span><span class="sigla-tarjeta-agencia">LOS ANDES</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">BUITCAPR</span><span class="sigla-tarjeta-agencia">BUIN</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">SBDTCAPR</span><span class="sigla-tarjeta-agencia">SAN BERNARDO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">FLOTCAPR</span><span class="sigla-tarjeta-agencia">LA FLORIDA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">SERTCAPR</span><span class="sigla-tarjeta-agencia">LA SERENA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">SANTCAPR</span><span class="sigla-tarjeta-agencia">SAN ANTONIO</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">PENTCAPR</span><span class="sigla-tarjeta-agencia">PE√ëAFLOR</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">ARITCAPR</span><span class="sigla-tarjeta-agencia">ARICA</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">CRNTCAPR</span><span class="sigla-tarjeta-agencia">CURANILAHUE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">VOETCAPR</span><span class="sigla-tarjeta-agencia">VESPUCIO OESTE</span></span></div>
                          <div class="sigla-tarjeta-grande"><span class="sigla-tarjeta-icono">üè∑Ô∏è</span><span class="sigla-tarjeta-info"><span class="sigla-tarjeta-sigla">PARTCAPR</span><span class="sigla-tarjeta-agencia">PARRAL</span></span></div>
                        </div>
                        <div style="text-align:center; margin-top:22px; display:flex; justify-content:center; gap:12px; flex-wrap:wrap;">
                            <button onclick="cerrarModal('modalSiglasAgencias')" style="background:#2563eb; color:white; border:none; border-radius:8px; padding:10px 28px; font-weight:bold; font-size:1.05em; cursor:pointer; box-shadow:0 2px 8px rgba(30,58,138,0.10);">Cerrar</button>
                        </div>
                    </div>
                </div>

                <!-- ‚úÖ Script migrado a assets/js/app.js - Sistema de Modales (10/11/2025) -->
                
                <div class="botones-herramientas">
                    <button id="btnTerapiaFisica" class="btn-herramienta" onclick="abrirTerapiaFisica()">üè• Terapia F√≠sica</button>
                    <button id="btnBuscadorTF" class="btn-herramienta" onclick="abrirModalBuscadorTF()" style="background:linear-gradient(135deg, #10b981 0%, #059669 100%); color:white; border:none;">üîé Buscador Terapia F√≠sica</button>
                    <button id="btnDuracionTF" class="btn-herramienta" onclick="abrirModalDuracionTF()">‚è±Ô∏è Duraci√≥n de la atenci√≥n en Terapia F√≠sica</button>
                                <!-- Modal Duraci√≥n Terapia F√≠sica -->
                                <div id="modalDuracionTF" class="modal" style="display:none; justify-content:center; align-items:center;">
                                    <div class="modal-contenido" style="max-width:500px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(30,58,138,0.15); padding:2rem; position:relative;">
                                        <button onclick="cerrarModalDuracionTF()" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#1e3a8a; cursor:pointer;">&times;</button>
                                        <h2 style="color:#348fff; margin-bottom:1rem; text-align:center;">‚è±Ô∏è Duraci√≥n de la atenci√≥n en Terapia F√≠sica</h2>
                                        <div style="margin-bottom:1.2rem;">
                                            <span style="font-size:1.1rem; color:#059669; font-weight:bold;">üïí‚ÄØLa atenci√≥n en Terapia F√≠sica (TF) tiene una duraci√≥n de 45 a 60 minutos.</span>
                                            <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                                                <li>üë•‚ÄØModalidad simult√°nea, hasta 4 pacientes por sesi√≥n.</li>
                                                <li>üìù‚ÄØEvaluaci√≥n inicial: 30 minutos.</li>
                                            </ul>
                                        </div>
                                        <div style="background:#e8eef3; border-radius:8px; padding:1rem; margin-bottom:1rem; color:#1e3a8a;">
                                            <b>¬øPor qu√© es importante?</b><br>
                                            <span>Permite entregar informaci√≥n clara al paciente sobre tiempos y modalidad de atenci√≥n, evitando confusiones o expectativas err√≥neas.</span>
                                        </div>
                                        <div style="background:#dbeafe; border-radius:8px; padding:1rem; color:#3b82f6;">
                                            <b>Tip pr√°ctico para la llamada:</b><br>
                                            <span>‚ÄúLa evaluaci√≥n dura 30 minutos. Luego, las sesiones de terapia f√≠sica duran entre 45 y 60 minutos, en atenci√≥n simult√°nea con otros tres pacientes.‚Äù</span>
                                            <span> üë•‚ÄØSe realiza en modalidad de atenci√≥n simult√°nea, con hasta 4 pacientes por sesi√≥n.</span>
                                        </div>
                                    </div>
                                </div>
                                <script>
                                function abrirModalDuracionTF() {
                                    document.getElementById('modalDuracionTF').style.display = 'flex';
                                }
                                function cerrarModalDuracionTF() {
                                    document.getElementById('modalDuracionTF').style.display = 'none';
                                }
                                </script>
                                                                <!-- Modal Buscador Terapia F√≠sica (Diagn√≥sticos) -->
                                                                <div id="modalBuscadorTF" class="modal" style="display:none; justify-content:center; align-items:center;">
                                                                        <div class="modal-contenido" style="max-width:780px; width:96%; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(30,58,138,0.15); padding:1.5rem; position:relative;">
                                                                                <button onclick="cerrarModalBuscadorTF()" style="position:absolute; top:14px; right:16px; background:none; border:none; font-size:1.6rem; color:#1e3a8a; cursor:pointer;" aria-label="Cerrar">&times;</button>
                                                                                <h2 style="color:#1e3a8a; margin:0 0 0.8rem; text-align:center;">üîé Buscador de diagn√≥sticos para Terapia F√≠sica</h2>
                                                                                <div style="display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:12px;">
                                                                                        <input id="inputBuscarTF" type="text" placeholder="Escribe para filtrar‚Ä¶" oninput="filtrarDiagnosticosTF()" style="flex:1; min-width:240px; padding:10px 12px; border:2px solid #dbeafe; border-radius:10px; font-size:0.98rem; outline:none;">
                                                                                        <div style="display:flex; gap:8px; align-items:center;">
                                                                                                <span id="contadorTF" style="color:#475569; font-size:0.95rem;">0 resultados</span>
                                                                                                <button onclick="limpiarBusquedaTF()" style="background:#eef2ff; color:#3730a3; border:none; border-radius:8px; padding:8px 12px; font-weight:600; cursor:pointer;">Limpiar</button>
                                                                                        </div>
                                                                                </div>
                                                                                <div id="contenedorListaTF" style="max-height:52vh; overflow:auto; border:1px solid #e5e7eb; border-radius:12px;">
                                                                                        <ul id="listaDiagnosticosTF" style="list-style:none; margin:0; padding:0;">
                                                                                                <!-- items renderizados por JS -->
                                                                                        </ul>
                                                                                </div>
                                                                                <div id="toastTF" style="position:absolute; left:50%; bottom:12px; transform:translateX(-50%); background:rgba(16,185,129,0.95); color:white; padding:8px 12px; border-radius:8px; font-weight:600; font-size:0.95rem; display:none; box-shadow:0 6px 16px rgba(16,185,129,0.25);">Copiado</div>
                                                                        </div>
                                                                </div>
                                                                <script>
                                                                // Dataset de diagn√≥sticos para el buscador de TF
                                                                const DIAGNOSTICOS_TF = `
CONTUSION DE DEDO DE LA MANO, SIN DA√ëO DE LA(S) U
ABSCESO FALANGE DISTAL DEDO IZQUIERDO
ACORTAMIENTO DEL TENDON DE AQUILES (ADQUIRIDO) 
AFLOJAMIENTO DE PROTESIS TOTAL DE CADERA
AMPUTACION TRAUMATICA DE DEDOS DE LA MAN
AMPUTACION TRAUMATICA DE EXTREMIDAD INFERIOR  A NI
AMPUTACION TRAUMATICA DE EXTREMIDAD SUPERIOR A NIV
AMPUTACION TRAUMATICA DE EXTREMIDADES SUPERIOR(ES)
AMPUTACION TRAUMATICA DE ORTEJOS 
AMPUTACION TRAUMATICA DEL PULGAR (COMPLETA O PARCI
ARTRALGIA RODILLA 
ARTRITIS EN OTRAS ENFERMEDADES BACTERIANAS CLASIFI
ARTRITIS NO ESPECIFICADA
ARTRITIS SEPTICA DE CODO 
ARTRITIS SEPTICA DE RODILLA 
ARTRITIS SEPTICA DE TOBILLO 
ARTRITIS SEPTICA INFERFALANGICA 
ARTROPATIA DE CHARCOT
ARTROSIS  DE LA  PRIMERA ARTICULACION CARPOMETACAR
ARTROSIS ACROMIOCLAVICULAR
ARTROSIS CARPOMETACARPIANA 
ARTROSIS CODO 
ARTROSIS DE CADERA 
ARTROSIS DE TOBILLO
ARTROSIS GLENOHUMERAL
ARTROSIS GLENOHUMERAL POST INSUFICIENCIACR√ìNICA MA
ARTROSIS INTERFALANGICAS
ARTROSIS MANO
ARTROSIS MU√ëECA
ARTROSIS PIE 
ARTROSIS RODILLA . GONARTROSIS
ARTROSIS SECUNDARIA DE CUALQUIER ARTICULACION
ARTROSIS SECUNDARIA DE EXTREMIDAD INFERIOR
ARTROSIS TIBIO-TALAR 
ARTROSIS TOBILLO
ARTROSIS, NO ESPECIFICADA
ATROFIA Y DESGASTE MUSCULARES, NO CLASIFICADOS EN
BRAQUIALGIA MIOFASCIAL 
BUNIONETTE DERECHA(O)
BURSITIS  DE LA MANO
BURSITIS DE CODO
BURSITIS DE RODILLA
BURSITIS DEL OLECRANON
BURSITIS DEL PIE 
BURSITIS PRERROTULIANA
BURSITIS SUBACROMIAL
BURSITIS SUBACROMIODELTOIDEA 
BURSITIS TROCANTERIANA
CAPSULITIS ADHESIVA DE HOMBRO
CELULITIS DE ANTEBRAZO
CELULITIS DE EXTREMIDAD INFERIOR
CELULITIS DE LOS DEDOS  DEL PIE
CELULITIS DE MANO O DEDOS
CELULITIS DE SITIO NO ESPECIFICADO
CERVICALGIA
CIATICA
CONDROMALACIA
CONDROMALACIA DE LA ROTULA
CONTRACTURA ARTICULAR
CONTRACTURA MUSCULAR
CONTUSION ANTEPIE LEVE
CONTUSION ANTEPIE MODERADA
CONTUSION ANTEPIE SEVERA
CONTUSION DE ANTEBRAZO LEVE
CONTUSION DE ANTEBRAZO MODERADA
CONTUSION DE ANTEBRAZO SEVERA
CONTUSION DE BRAZO LEVE
CONTUSION DE BRAZO MODERADA
CONTUSION DE BRAZO SEVERA
CONTUSION DE CADERA LEVE
CONTUSION DE CADERA MODERADA
CONTUSION DE CADERA SEVERA
CONTUSION DE CODO LEVE
CONTUSION DE DEDO DE LA MANO, CON DA√ëO D
CONTUSION DE DEDO DE LA MANO, CON DA√ëO DE LA(S) U√ë
CONTUSION DE DEDO DE LA MANO, SIN DA√ëO D
CONTUSION DE DEDO(S) DEL PIE, CON DA√ëO DE LA(S) U√ë
CONTUSION DE DEDO(S) DEL PIE, SIN DA√ëO D
CONTUSION DE DEDO(S) DEL PIE, SIN DA√ëO DE LA(S) U√ë
CONTUSION DE HOMBRO LEVE
CONTUSION DE HOMBRO MODERADA
CONTUSION DE HOMBRO SEVERA
CONTUSION DE LA MANO
CONTUSION DE LA MANO Y/O MU√ëECA SEVERA
CONTUSI√ìN DE MANO LEVE
CONTUSION DE MEPIE SEVERA 
CONTUSION DE MUSLO MODERADA
CONTUSION DE MUSLO SEVERA
CONTUSION DE PIE LEVE
CONTUSION DE PIE MODERADA
CONTUSION DE PIE SEVERA
CONTUSION DE PIERNA LEVE
CONTUSION DE PIERNA MODERADA
CONTUSION DE PIERNA SEVERA
CONTUSION DE RODILLA LEVE
CONTUSION DE RODILLA MODERADA
CONTUSION DE RODILLA SEVERA
CONTUSION DE TOBILLO  LEVE
CONTUSION DE TOBILLO MODERADA
CONTUSION DE TOBILLO SEVERA
CONTUSION DE TRONCO LEVE
CONTUSION DEL CODO MODERADA
CONTUSION DEL CODO SEVERA
CONTUSION LUMBAR SEVERA
CONTUSION LUMBOSACRA Y PELVIS LEVE
CONTUSION LUMBOSACRA Y PELVIS MODERADA
CONTUSION MEDIOPIE LEVE
CONTUSION MEDIOPIE MODERADA
CONTUSION MEDIOPIE MODERADA IZQUIERDA(O)
CONTUSION MUSLO LEVE
CONTUSION PRIMER ORTEJO
CONTUSION RETROPIE LEVE
CONTUSION RETROPIE MODERADA
CONTUSION RETROPIE SEVERA 
CONTUSION SEVERA DEDO PULGAR MANO DERECHA
CONTUSI√ìN TENDON DE AQUILES
COSTOCONDRITIS
COXARTROSIS A CONSECUENCIA DE DISPLASIA
COXARTROSIS BILATERAL
COXARTROSIS PRIMARIA (ARTROSIS DE CADERA)
COXIGODINIA
CUERPO EXTRA√ëO PARTES BLANDAS DE EXTREMIDAD SUPERI
CUERPO LIBRE INTRA-ARTICULAR EN LA RODILLA 
DEDO EN GATILLO
DEDO EN GATILLO, TENOVAGINOSIS ESTENOSANTE
DEFORMIDAD EN BOUTONIERE 
DEFORMIDADES ADQUIRIDAS DE LOS DEDOS DELA MANO 
DEFORMIDADES ADQUIRIDAS DE LOS DEDOS DELPIE IZQUIE
DERRAME ARTICULAR
DESGARRO MUSCULAR DE EXTREMIDAD INFERIOR
DESGARRO MUSCULAR EXTREMIDAD SUPERIOR LEVE
DESGARRO MUSCULAR EXTREMIDAD SUPERIOR MODERADO
DESGARRO MUSCULAR EXTREMIDAD SUPERIOR SEVERO
DESGARRO PARAVERTEBRAL CUALQUIER NIVEL
DISFUNCION PATELO FEMORAL 
DISYUNCION ACROMIOCLAVICULAR GRADO I
DISYUNCION ACROMIOCLAVICULAR GRADO II
DISYUNCION ACROMIOCLAVICULAR GRADO III
DISYUNCION ACROMIOCLAVICULAR GRADO V
DOLOR CRONICO DE ANTEBRAZO
DOLOR CRONICO DE BRAZO
DOLOR CRONICO DE CADERA
DOLOR CRONICO DE CODO
DOLOR CRONICO DE HOMBRO
DOLOR CRONICO DE MANO
DOLOR CRONICO DE MU√ëECA
DOLOR CRONICO DE PIE
DOLOR CRONICO DE TOBILLO
DOLOR DE CADERA 
DOLOR DE CODO EN ESTUDIO
DOLOR DE DEDOS
DOLOR DE EXTREMIDAD INFERIOR EN ESTUDO
DOLOR DE EXTREMIDAD SUPERIOR EN ESTUDIO
DOLOR DE HOMBRO EN ESTUDO
DOLOR DE MU√ëECA
DOLOR DE PIE
DOLOR DE RODILLA EN ESTUDIO
DOLOR DE TOBILLO EN ESTUDIO
DOLOR DEL TALO EN ESTUDIO, TALALGIA
DOLOR LUMBAR CRONICO MULTIFACTORIAL
DORSALGIA
ENFERMEDAD DE DUPUYTREN 
ENTESOPATIA DE PATA DE GANSO 
ENTESOPATIA, NO ESPECIFICADA 
EPICONDILITIS  
EPITROCLEITIS (EPICONDILITS MEDIAL)
ESGUINCE CERVICAL
ESGUINCE CERVICAL   CONTRACTURA MUSCULAR
ESGUINCE DE CODO LEVE
ESGUINCE DE LOS ORTEJOS Y ANTEPIE GRADOI
ESGUINCE DE LOS ORTEJOS Y ANTEPIE GRADOI-II 
ESGUINCE DE LOS ORTEJOS Y ANTEPIE GRADOIII
ESGUINCE DE MU√ëECA GRADO I
ESGUINCE DE MU√ëECA GRADO II
ESGUINCE DE MU√ëECA GRADO III
ESGUINCE DE TOBILLO GRADO III
ESGUINCE DEL PIE GRADO I
ESGUINCE DEL PIE GRADO II-III 
ESGUINCE GRADO I ARTICULACI√ìN TRAPECIO-MTC
ESGUINCE INTERFAL√ÅNGICO DEDO DE LA MANO GRADO II 
ESGUINCE INTERFAL√ÅNGICO DEDO DE LA MANO GRADO II-I
ESGUINCE INTERFAL√ÅNGICO DEDO DE LA MANOGRADO I
ESGUINCE LUMBAR
ESGUINCE METACARPOFAL√ÅNGICO GRADO I
ESGUINCE METACARPOFAL√ÅNGICO GRADO II
ESGUINCE METACARPOFAL√ÅNGICO GRADO III
ESGUINCE O DESGARRO DE CADERA LEVE
ESGUINCE O DESGARRO DE CADERA MODERADO
ESGUINCE O DESGARRO DE CADERA SEVERO
ESGUINCE O DESGARRO DE CODO MODERADO
ESGUINCE O DESGARRO DE CODO SEVERO
ESGUINCE O DESGARRO MUSCULAR DEL HOMBRO LEVE
ESGUINCE O DESGARRO MUSCULAR DEL HOMBRO SEVERO IZQ
ESGUINCE O DESGARRO MUSCULAR DEL HOMBROMODERADO
ESGUINCE O DESGARRO SACROILIACO
ESGUINCE PIE GRADO I-II
ESGUINCE RODILLA G III
ESGUINCE RODILLA GRADO I
ESGUINCE RODILLA GRADO II
ESGUINCE TOBILLO GRADO I
ESGUINCE TOBILLO GRADO I-II
ESPOLON CALCANEO
ESPONDILOLISIS
ESPONDILOLISTESIS
ESPONDILOLISTESIS CERVICAL DEGENERATIVA
ESPONDILOLISTESIS LUMBAR
ESPONDILOLISTESIS LUMBAR DEGENERATIVA
ESPONDILOPATIA EN OTRAS ENFERMEDADES INFECCIOSAS Y
ESPONDILOSIS SIN MIELOPATIA
ESPONDILOSIS, NO ESPECIFICADA
ESTENOSIS RAQUIDEA DORSAL O LUMBAR
FALTA DE CONSOLIDACION DE  FRACTURA  PSEUDOARTROSI
FASCITIS PLANTAR
FRACTURA ABIERTA  DE COSTILLA 
FRACTURA ABIERTA DE APOFISIS TRANSVERSADE VERTEBRA
FRACTURA ABIERTA DE PELVIS IZQUIERDA(O)
FRACTURA ABIERTA FALANGE DISTAL DEL PULGAR
FRACTURA ABIERTA FALANGE PROXIMAL DEL PULGAR
FRACTURA ASTRAGALO CERRADA
FRACTURA AVULSIVA DEL CARPO
FRACTURA BASE PRIMER METACARPIANO 
FRACTURA CALCANEO CERRADA
FRACTURA CERRADA  DE APOFISIS TRANSVERSA DE VERTEB
FRACTURA CERRADA  DE COLUMNA LUMBOSACRA
FRACTURA CERRADA  DE ISQUION IZQUIERDA(O)
FRACTURA CERRADA  DE PELVIS
FRACTURA CERRADA  DE VERTEBRA LUMBAR
FRACTURA CERRADA  DE VERTEBRA LUMBOSACRA
FRACTURA CERRADA  DEL ACETABULO 
FRACTURA CERRADA  DEL COCCIX
FRACTURA CERRADA  DEL SACRO
FRACTURA CERRADA DE APOFISIS ESPINOSA DEVERTEBRA C
FRACTURA CERRADA DE APOFISIS ESPINOSA DEVERTEBRA T
FRACTURA CERRADA DE APOFISIS TRANSVERSADE VERTEBRA
FRACTURA CERRADA DE CARTILAGO TIROIDES
FRACTURA CERRADA DE COLUMNA CERVICAL
FRACTURA CERRADA DE COLUMNA DORSAL
FRACTURA CERRADA DE COSTILLA
FRACTURA CERRADA DE LA SEGUNDA VERTEBRACERVICAL
FRACTURA CERRADA DE OTRAS VERTEBRAS CERVICALES ESP
FRACTURA CERRADA DE VERTEBRA TORACICA
FRACTURA CERRADA DEL ACROMION (APOFISIS) IZQUIERDA
FRACTURA CERRADA DEL ESTERNON
FRACTURA CERRADA DEL HUESO GANCHOSO  UNCIFORME
FRACTURA CERRADA DEL HUESO GRANDE  OS MAGNUM  DERE
FRACTURA CERRADA DEL HUESO PIRAMIDAL
FRACTURA CERRADA DEL HUESO PISIFORME 
FRACTURA CERRADA DEL HUESO SEMILUNAR  LUNAR 
FRACTURA CERRADA DEL HUESO TRAPECIO  MULTANGULAR M
FRACTURA CERRADA DEL HUESO TRAPEZOIDE Y HUESO GRAN
FRACTURA CERRADA FALANGE DISTAL DEL PULGAR
FRACTURA CERRADA FALANGE PROXIMAL DEL PULGAR
FRACTURA CERRADA S MULTIPLES DE LA COLUMNA LUMBAR
FRACTURA CERRADAS MULTIPLES DE COLUMNA TORACICA
FRACTURA CLAVICULA, DIAFISIARIA CERRADA
FRACTURA CLAVICULA, TERCIO LATERAL CERRADA
FRACTURA CLAVICULA, TERCIO MEDIAL ABIERTA 
FRACTURA CLAVICULA, TERCIO MEDIAL CERRADA
FRACTURA CUBITO DIAFISIARIA NO DESPLAZADA CERRADA
FRACTURA CUBITO EPIFISIS SUPERIOR CERRADA 
FRACTURA CUBITO, DIAFISIARIA ABIERTA
FRACTURA CUBITO, EPIFISIS INFERIOR ABIERTA
FRACTURA CUBITO, EPIFISIS INFERIOR CERRADA
FRACTURA CUELLO HUMERO IZQUIERDO
FRACTURA CUELLO TALO CERRADA 
FRACTURA CUERPO TALO CERRADA
FRACTURA CUPULA RADIAL
FRACTURA DE CADERA CERRADA SIN ESPECIFICAR
FRACTURA DE CODO CORONOIDES CERRADA
FRACTURA DE CU√ëAS PIE 
FRACTURA DE LA EPIFISIS INFERIOR DEL FEMUR CERRADA
FRACTURA DORSAL SIN COMPROMISO NEUROLOGICO
FRACTURA EDR (MU√ëECA) CERRADA 
FRACTURA EDR MU√ëECA DERECHA
FRACTURA EN HUESO PATOLOGICO DE COSTILLAS 
FRACTURA EN HUESO PATOLOGICO DE EXTREMIDAD SUPERIOR
FRACTURA ESCAFOIDES ABIERTA
FRACTURA ESCAFOIDES CERRADA
FRACTURA ESCAPULA CON COMPROMISO DE GLENOIDES CERR
FRACTURA ESCAPULA SIN COMPROMISO DE GLENOIDES CERR
FRACTURA ESTERNAL
FRACTURA EXPUESTA TIBIA DERECHA
FRACTURA FALANGE DISTAL ABIERTA
FRACTURA FALANGE DISTAL CERRADA
FRACTURA FALANGE MEDIA ABIERTA
FRACTURA FALANGE MEDIA CERRADA
FRACTURA FALANGE PROXIMAL ABIERTA
FRACTURA FALANGE PROXIMAL CERRADA 
FRACTURA FEMUR, DIAFISIARIA CERRADA
FRACTURA HUESO PIRAMIDAL DERECHO
FRACTURA HUESO SESAMOIDEO
FRACTURA HUMERO, DIAFISIARIA ABIERTA
FRACTURA HUMERO, DIAFISIARIA CERRADA
FRACTURA HUMERO, EPICONDILO DERECHO
FRACTURA LUMBAR CON COMPROMISO NEUROLOGICO Y ESFIN
FRACTURA LUMBAR SIN COMPROMISO NEUROLOGICO
FRACTURA MALEOLO PERONEO ABIERTA
FRACTURA MALEOLO PERONEO CERRADA
FRACTURA MALEOLO PERONEO CERRADA IZQUIERDA(O)
FRACTURA MALEOLO TIBIAL CERRADA
FRACTURA METACARPIANA ABIERTA
FRACTURA METACARPIANO CERRADA
FRACTURA METATARSIANO ABIERTA 
FRACTURA METATARSIANO CERRADA
FRACTURA OLECRANON ABIERTA
FRACTURA OLECRANON CERRADA
FRACTURA ORTEJO DISTAL ABIERTA
FRACTURA ORTEJO MAYOR
FRACTURA ORTEJOS CERRADA (EXCEPTO PRIMERORTEJO)
FRACTURA PERONE, CABEZA O CUELLO CERRADA
FRACTURA PERONE, DIAFISIARIA ABIERTA 
FRACTURA PERONE, DIAFISIARIA CERRADA
FRACTURA PILON TIBIAL ABIERTA 
FRACTURA PILON TIBIAL CERRADA
FRACTURA PLATILLOS TIBIALES ABIERTA
FRACTURA PLATILLOS TIBIALES CERRADA
FRACTURA PRIMER METACARPIANO 
FRACTURA PRIMER ORTEJO CERRADA
FRACTURA PROTESIS TOTAL DE CADERA DERECHA(O)
FRACTURA RADIO Y CUBITO, DIAFISIARIAS ABIERTA 
FRACTURA RADIO Y CUBITO, DIAFISIARIAS CERRADA
FRACTURA RADIO, DIAFISIARIA ABIERTA 
FRACTURA RADIO, DIAFISIARIA CERRADA
FRACTURA RADIO, EPIFISIS INFERIOR CERRADA 
FRACTURA RADIO, EPIFISIS INFERIOR DEL ABIERTA DERE
FRACTURA RADIO, EPIFISIS SUPERIOR ABIERTA
FRACTURA ROTULA ABIERTA
FRACTURA ROTULA CERRADA
FRACTURA SACROCOXIS CON COMPROMISO NEUROLOGICO
FRACTURA SACROCOXIS SIN COMPROMISO NEUROLOGICO
FRACTURA SEMILUNAR CERRADA
FRACTURA TALO
FRACTURA TIBIA Y PERONE, DIAFISIARIAS ABIERTA
FRACTURA TIBIA Y PERONE, DIAFISIARIAS CERRADA
FRACTURA TIBIA, DIAFISIARIA CERRADA
FRACTURA TOBILLO BIMALEOLAR ABIERTA 
FRACTURA TOBILLO BIMALEOLAR CERRADA
FRACTURA TOBILLO TRIMALEOLAR CERRADA
FRACTURA TOBILLO WEBER C
FRACTURA TROCANTERIANA DE FEMUR CERRADA IZQUIERDA(
FRACTURAS ABIERTA  MULTIPLES DE COSTILLAS 
FRACTURAS ABIERTAS MULTIPLES DE LOS DEDOS DE LA MA
FRACTURAS CERRADAS MULTIPLES DE COSTILLAS
FRACTURAS CERRADAS MULTIPLES DE LOS DEDOS DE LA MA
FRACTURAS CERRADAS MULTIPLES DEL FEMUR IZQUIERDA(O
FRACTURAS CERRADAS MULTIPLES METACARPIANOS
FRACTURAS PERIFERICAS TALO CERRADA
GANGLION
GONARTROSIS POSTRAUMATICA, BILATERAL
GONARTROSIS PRIMARIA 
GONARTROSIS, NO ESPECIFICADA
GRANULOMA POR CUERPO EXTRA√ëO EN TEJIDO BLANDO, NO
HALLUX VALGUS
HEMARTROSIS DE RODILLA DERECHA(O)
HERIDA  MU√ëECA CON LESION DE TENDON 
HERIDA ANTEBRAZO  CON LESION DE TENDON
HERIDA ANTEBRAZO COMPLICADA
HERIDA CONTUSA CODO 
HERIDA DE  O BRAZO CON COMPROMISO DE TENDON 
HERIDA DE BRAZO COMPLICADA
HERIDA DE CADERA O MUSLO COMPLICADA
HERIDA DE CADERA O MUSLO MODERADA
HERIDA DE CADERA O MUSLO SIMPLE
HERIDA DE DEDO CON LESION DE TENDON EXTENSOR
HERIDA DE DEDO CON LESION DE TENDON FLEX
HERIDA DE DEDOS DEL PIE
HERIDA DE DEDOS DEL PIE SIMPLE
HERIDA DE LA MANO CON PERDIDA DE SUSTANCIA 
HERIDA DE LA MANO MODERADA 
HERIDA DE LA MANO MODERADA DERECHA
HERIDA DE LA MANO SIMPLE
HERIDA DE LA PIERNA BILATERAL
HERIDA DE LA PIERNA CON LESION DE TENDON
HERIDA DE LA PIERNA MODERADA
HERIDA DE LA PIERNA SIMPLE
HERIDA DE LA REGION LUMBOSACRA Y DE LA PELVIS
HERIDA DE LA RODILLA COMPLICADA
HERIDA DE LA RODILLA CON LESION DE TENDON 
HERIDA DE LA RODILLA MODERADA
HERIDA DE LA RODILLA SIMPLE
HERIDA DE LOS DEDOS DE LA MANO COMPLICA 
HERIDA DE LOS DEDOS DE LA MANO LEVE
HERIDA DE LOS DEDOS DE LA MANO MODERADA
HERIDA DE MANO CON LESION DE TENDON
HERIDA DE MIEMBRO INFERIOR, NIVEL NO ESPECIFICADO
HERIDA DE MU√ëECA MODERADA
HERIDA DE MU√ëECA SIMPLE
HERIDA DE PIE MODERADA
HERIDA DE PIE U ORTEJOS CON COMPROMISO DE TENDON
HERIDA DE PIE U ORTEJOS SIMPLE
HERIDA DE PIERNA CON LESION NEUROVASCULAR 
HERIDA DE PIERNA SIMPLE
HERIDA DE RODILLA
HERIDA DE RODILLA CON LESION TENDINEA
HERIDA DE RODILLA SIMPLE
HERIDA DE TOBILLO SIMPLE
HERIDA DEDO DE LA MANO CON PERDIDA DE SUSTANCIA
HERIDA DEL ANTEBRAZO MODERADA
HERIDA DEL ANTEBRAZO SIMPLE
HERIDA DEL BRAZO MODERADA
HERIDA DEL BRAZO SEVERA
HERIDA DEL BRAZO SIMPLE
HERIDA DEL CODO CON LESION DE TENDON IZQUIERDA(O)
HERIDA DEL CODO MODERADA
HERIDA DEL CODO SIMPLE
HERIDA DEL HOMBRO MODERADA
HERIDA DEL HOMBRO SIMPLE
HERIDA DEL TOBILLO MODERADA
HERIDA DEL TOBILLO SIMPLE
HERIDA MU√ëECA COMPLEJA
HERIDA PIE MODERADA
HERIDA REFRACTARIA
HERIDAS DE OTRAS PARTES DEL ANTEBRAZO
HERIDAS MULTIPLES DE LA CADERA Y DEL MUSLO
HERIDAS MULTIPLES DE LA MU√ëECA Y DE LA MANO
HERIDAS MULTIPLES DE LA PIERNA
HERIDAS MULTIPLES DEL ANTEBRAZO 
HERIDAS MULTIPLES DEL HOMBRO Y DEL BRAZO
HERIDAS MULTIPLES, EN CODO Y BRAZO IZQUIERDOS
HERIDAS QUE AFECTAN MULTIPLES REGIONES DEL(DE LOS)
HERIDAS QUE AFECTAN OTRAS COMBINACIONESDE REGIONES
HIDROARTROSIS DE RODILLA 
HIPERTROFIA SINOVIAL Y TENDINOSO, NO ESPECIFICADO
HNP CERVICAL
HNP DORSAL
HNP LUMBAR
HOMBRO DOLOROSO
INESTABILIDAD CRONICA DE LA RODILLA
INFLAMACI√ìN DE ARTICULACION ESTERNOCLAVICULAR IZQU
LAXITUD LIGAMENTOSA DE RODILLA
LESION DE LIGAMENTO ESCAFOLUNAR AGUDO IZQUIERDA(O)
LESION DE LIGAMENTO ESCAFOLUNAR CR√ìNICO
LESION DE M√öLTIPLES TENDONES EXTENSORESEN MANO/MU√ë
LESION DE M√öLTIPLES TENDONES FLEXORES ENANTEBRAZO
LESION DE M√öLTIPLES TENDONES FLEXORES ENMANO/MU√ëEC
LESION DE NERVIO CUBITAL EN ANTEBRAZO/CODO 
LESION DE NERVIO CUBITAL EN MU√ëECA/MANO DERECHA(O)
LESION DE TENDON EXTENSOR DEDOS  EN MANO/MU√ëECA (E
LESION DE TENDON EXTENSOR DEDOS EN ANTEBRAZO 
LESION DE TENDON EXTENSOR DEL CARPO DERECHA(O)
LESION DE TENDON EXTENSOR LARGO PULGAR
LESION DE TENDON EXTENSOR PULGAR  EN ANTEBRAZO 
LESION DE TENDON EXTENSOR PULGAR  EN MANO/MU√ëECA
LESION DE TENDON FLEXOR DEDOS  EN ANTEBRAZO (EXCEP
LESION DE TENDON FLEXOR DEDOS  EN MANO/MU√ëECA (EXC
LESION DE TENDON FLEXOR DEL CARPO 
LESION DE TENDON FLEXOR PULGAR EN MANO/MU√ëECA 
LESION LIGAMENTOSA MULTIPLE RODILLA
LESI√ìN MUSCULO TENDINEA CADERA
LESION STENER PULGAR 
LESION TENDONES EXTENSORES EN ANTEBRAZO
LESIONES DEL HOMBRO, NO ESPECIFICADA
LUMBAGO MECANICO
LUMBOCIATICA
LUMBOCRURALGIA 
LUXACI√ìN CODO DERECHO
LUXACION DE ARTICULACION SACROCOCCIGEA YSACROILIAC
LUXACION DE CODO
LUXACION DE DEDO (MCF, IFP, IFD)
LUXACION DE DEDOS DE LA MANO 
LUXACION DE HOMBRO 
LUXACION DE LA MU√ëECA
LUXACION DE ORTEJOS
LUXACION DE OTRAS PARTES DE LA CINTURA ESCAPULAR Y
LUXACION DE OTRAS PARTES Y DE LAS NO ESP
LUXACION DE OTROS SITIOS Y LOS NO ESPECIFICADOS DE
LUXACION DE RODILLA
LUXACION DE ROTULA
LUXACION DE TOBILLO
LUXACION DEL PIE IZQUIERDA(O)
LUXACION ESTERNOCLAVICULAR
LUXACION GLENOHUMERAL
LUXACION HOMBRO DERECHA(O)
LUXACION HUESOS DEL CARPO O CARPOMETACARPIANA 
LUXACION INTERFALANGICA DISTAL DEDO
LUXACION INTERFALANGICA PROXIMAL DEDO
LUXACI√ìN RECIDIVANTE DE PATELA BILATERAL
LUXACION RECIDIVANTE DE ROTULA
LUXACION TRAUMATICA DE CADERA 
LUXACION Y SUBLUXACION RECIDIVANTE DE LAARTICULACI
LUXACION, ESGUINCE O TORCEDURA DE ARTICULACION Y L
LUXACION/LUXOFRACTURA  PERILUNAR DEL CARPO DERECHA
LUXACIONES MULTIPLES DE DEDOS DE LA MANO
LUXACIONES, TORCEDURAS Y ESGUINCES MULTIPLES, NO E
LUXACIONES, TORCEDURAS Y ESGUINCES QUE AFECTAN MUL
LUXOFRACTURA DE BENNET CERRADA
LUXOFRACTURA DE CHOPART CERRADA 
LUXOFRACTURA DE CODO
LUXOFRACTURA DE GALEAZZI CERRADA
LUXOFRACTURA DE LISFRANC CERRADA
LUXOFRACTURA DEL PIE ABIERTA
LUXOFRACTURA DEL PIE CERRADA
LUXOFRACTURA DEL PIE CERRADA DERECHA(O)
LUXOFRACTURA DEL PIE CERRADA IZQUIERDA(O)
MALLET FINGER O MALLET FRACTURE
man
MANO GRAVEMENTE LESIONADA
MANO O PIE EN GARRA O EN TALIPES, PIE EQUINOVARO O
MENISCO DISCOIDEO 
MENISCO QUISTICO 
METATARSALGIA
MIALGIA
MONOARTRITIS DE EXTREMIDAD INFERIOR 
MONOARTRITIS DE EXTREMIDAD SUPERIOR 
MONOARTRITIS, NO CLASIFICADA EN OTRA PARTE
NECROSIS AVASCULAR DEL SEMILUNAR 
NEURORRAFIA
NODULOS DE HEBERDEN (CON ARTROPATIA) IZQUIERDA(O)
NODULOS DE SCHMORL
NODULOS INTERFALANGICOS
OBS. ROTURA DEL MANGUITO DE LOS ROTADORES
OBS.S√çNDROME DE TUNEL DEL TARSO DER.
OSTEOARTROSIS PRIMARIA GENERALIZADA
OSTEOCONDRITIS
OSTEOCONDROPATIA, NO  ESPECIFICADA
OSTEOLISIS DE CLAVICULAR DISTAL 
OSTEONECROSIS DISB√ÅRICA
OSTEONECROSIS DISBARICA CABEZA HUMERAL
PANADIZO DE ORTEJO DERECHA(O)
PANADIZO DEDO DE LA MANO
PERDIDA DE PULPEJO DEDO MEDIO IZQUIERDO
PERIARTRITIS DE LA MU√ëECA 
PLICA MEDIOPATELAR 
POLIARTRITIS, NO ESPECIFICADA
PSEUDOARTROSIS DE COLUMNA
PSEUDOARTROSIS DE ESCAFOIDES 
PSEUDOARTROSIS DE LOS HUESOS DEL PIE 
PSEUDOARTROSIS FALANGE 
PSEUDOARTROSIS TOBILLO 
PSEUDOCOXALGIA
QUISTE SINOVIAL DE EXTREMIDAD INFERIOR
QUISTE SINOVIAL DEL HUECO POPLITEO  DE BAKER  DERE
RABDOMIOLISIS
RADICULOPATIA
RETARDO DE CONSOLIDACION DE FRACTURA
RIGIDEZ ARTICULAR  METACARPOFALANGICA 
RIGIDEZ ARTICULAR DE HOMBRO
RIGIDEZ ARTICULAR DE MANO 
RIGIDEZ ARTICULAR DE MU√ëECA BILATERAL
RIGIDEZ ARTICULAR DE RODILLA
RIGIDEZ ARTICULAR DE TOBILLO
RIGIDEZ ARTICULAR INTERFALANGICA
ROTURA  TENDON TIBIAL POSTERIOR
ROTURA ANTIGUA DE LIGAMENTO DE RODILLA 
ROTURA ANTIGUA DE MENISCO EXTERNO
ROTURA ANTIGUA DE MENISCO INTERNO
ROTURA CERRADA DE TENDON DE EXTREMIDAD INFERIOR 
ROTURA CERRADA DE TENDON DE EXTREMIDAD SUPERIOR
ROTURA DE LIGAMENTO COLATERAL LATERAL DE RODILLA 
ROTURA DE LIGAMENTO COLATERAL MEDIAL DE RODILLA
ROTURA DE LIGAMENTO CRUZADO ANTERIOR 
ROTURA DE LIGAMENTOS A NIVEL DEL TOBILLO Y DEL PIE
ROTURA DE QUISTE SINOVIAL POPLITEO 
ROTURA DEGENERATIVA DEL TENDON DE AQUILES
ROTURA DEGENERATIVA PORCI√ìN LARGA DEL B√çCEPS DEREC
ROTURA ESPONTANEA  DE TENDONES EXTENSORES
ROTURA ESPONTANEA DE  TENDONES FLEXORES
ROTURA ESPONTANEA DE OTROS TENDONES
ROTURA LIGAMENTO CRUZADO POSTERIOR
ROTURA RECIENTE DE MENISCO EXTERNO
ROTURA RECIENTE DE MENISCO INTERNO
ROTURA TENDON DE AQUILES AGUDA
ROTURA TENDON DE AQUILES CRONICA 
ROTURA TENDONES EXTENSORES ORTEJO DERECHA(O)
ROTURA TRAUMATICA DE DISCO INTERVERTEBRAL LUMBAR
ROTURA TRAUMATICA DE LIGAMENTOS DE LA MU√ëECA Y DEL
ROTURA TRAUM√ÅTICA MANGUITO ROTADOR
ROTURA TRAUM√ÅTICA PORCI√ìN LARGA DEL B√çCEPS IZQUIER
SACROILIITIS,  NO CLASIFICADA EN OTRA PARTE
SECCION DE ARTERIA Y VENA ILIACA BILATERAL
SECUELA DE FRACTURA DE EXTREMIDAD SUPERIOR
SECUELAS DE FRACTURA DE LA COLUMNA VERTEBRAL
SECUELAS DE OTRA FRACTURA DEL TORAX Y DELA PELVIS
SINDROME DE DOLOR LUMBAR
SINDROME DE ENTRECRUZAMIENTO
SINDROME DE PELLIZCAMIENTO FEMORO-ACETABULAR
SINDROME DE PELLIZCAMIENTO SUBACROMIAL
SINDROME DEL TENDON DEL  TENSOR DE LA FASCIA LATA
SINDROME DOLOR REGIONAL COMPLEJO MIEMBRO INFERIOR
SINDROME DOLOR REGIONAL COMPLEJO MIEMBRO SUPERIOR
SINDROME FACETARIO, LUMBAGO
SINDROME HIPERLAXITUD LIGAMENTOSA ARTICULAR.  ESGU
SINDROME MIOFASCIAL
SINOVITIS CREPITANTE CRONICA MANO Y MU√ëECA
SINOVITIS DE RODILLA
SINOVITIS TRANSITORIA
SINOVITIS Y TENOSINOVITIS DE EXTREMIDAD INFERIOR
TENDINITIS AQUILIANA
TENDINITIS BICIPITAL
TENDINITIS CALCICA MANGUITO ROTADOR
TENDINITIS CALCIFICADA
TENDINITIS DE FLEXORES DE MU√ëECA
TENDINITIS DE PIE
TENDINITIS DE QUERVAIN
TENDINITIS DEL PSOAS
TENDINITIS GLUTEA
TENDINITIS LEVE
TENDINITIS PIE
TENDINITIS ROTULIANA
TENDINOPAT√çA BICEPS DISTAL
TENDINOPATIA DEGENERATIVA BICIPITAL 
TENDINOPATIA EXTENSORES  ORTEJOS
TENDINOPATIA TENDON DE AQUILES INSERCIONAL
TENDINOPATIA TENDON DE AQUILES NO INSERCIONAL
TENDINOPATIA TENDON TIBIAL ANTERIOR
TENDINOPATIA TENDON TIBIAL POSTERIOR
TENDINOPATIA TENDONES PERONEOS CON LUXACION 
TENDINOPATIA TENDONES PERONEOS SIN LUXACION 
TENOSINOVITIS DE  FLEXORES DE LOS DEDOS
TENOSINOVITIS DE EXTENSORES DE LOS DEDOS
TENOSINOVITIS SEPTICA DE TENDONES IZQUIERDA(O)
TENOSINOVITIS Y/O SINOVITIS DE EXTREMIDAD SUPERIOR
TENOSINOVITIS Y/O TENDINITIS DE MANO Y/O MU√ëECA
TERCIO MEDIO
TRASTORNO DE DISCO  LUMBAR Y OTROS, CONRADICULOPAT
TRASTORNO DE DISCO CERVICAL CON RADICULOPATIA
TRASTORNO DE DISCO CERVICAL, NO ESPECIFICADO
TRASTORNO DE LA ROTULA, NO ESPECIFICADO
TRASTORNO DE LOS TEJIDOS BLANDOS, NO ESPECIFICADO
TRASTORNO MUSCULAR, NO ESPECIFICADO
TRASTORNOS DE DISCOS INTERVERTEBRALES LUMBARES Y O
TRASTORNOS DE LOS DISCOS INTERVERTEBRALES, NO ESPE
TRASTORNOS INTERNO DE LA RODILLA, GONALGIA
TRASTORNOS ROTULOFEMORALES
TRASTORNOS SACROCOCCIGEOS, NO CLASIFICADOS EN OTRA
TRAUMATISMO (contusion leve) DE  COLUMNA SACRA
TRAUMATISMO DE ESTRUCTURAS MULTIPLES DELA RODILLA
TRAUMATISMO DE LA PIERNA, NO ESPECIFICADO DERECHA(
TRAUMATISMO DE MULTIPLES TENDONES Y MUSCULOS A NIV
TRAUMATISMO DE MULTIPLES TENDONES Y MUSCULOS EXTEN
TRAUMATISMO DE MULTIPLES TENDONES Y MUSCULOS Y LOS
TRAUMATISMO DE NERVIO NO ESPECIFICADO DEMIEMBRO SU
TRAUMATISMO DE NERVIOS MULTIPLES A NIVELDE LA CADE
TRAUMATISMO DE OTRO TENDON Y MUSCULO EXTENSOR A NI
TRAUMATISMO DE OTROS TENDONES Y MUSCULOS
TRAUMATISMO DE OTROS TENDONES Y MUSCULOSA NIVEL DE
TRAUMATISMO DE OTROS TENDONES Y MUSCULOSY DE LOS N
TRAUMATISMO DE OTROS TENDONES Y MUSCULOSY LOS NO E
TRAUMATISMO DE TENDON DEL MANGUITO ROTATORIO DEL H
TRAUMATISMO DE TENDON Y MUSCULO DE LA CABEZA LARGA
TRAUMATISMO DE TENDON Y MUSCULO DEL TRICEPS 
TRAUMATISMO DE TENDON Y MUSCULO NO ESPECIFICADO, A
TRAUMATISMO DE TENDON Y MUSCULO NO ESPECIFICADOS
TRAUMATISMO DE TENDON Y MUSCULO NO ESPECIFICADOS A
TRAUMATISMO DE TENDONES Y MUSCULOS ABDUCTORES Y EX
TRAUMATISMO DE TENDONES Y MUSCULOS INTRINSECOS A N
TRAUMATISMO DE TENDONES Y MUSCULOS NO ESPECIFICADO
TRAUMATISMO DE VASO(S) SANGUINEO(S) DE OTRO DEDO
TRAUMATISMO DEL MUSCULO Y TENDON INTRINSECO DE OTR
TRAUMATISMO DEL NERVIO CIATICO A NIVEL DE LA CADER
TRAUMATISMO DEL NERVIO CUBITAL A NIVEL DE LA MU√ëEC
TRAUMATISMO DEL NERVIO DIGITAL DE OTRO DEDO DERECH
TRAUMATISMO DEL NERVIO FEMOROCUTANEO A NIVEL DE LA
TRAUMATISMO DEL NERVIO SENSORIAL CUTANEOA NIVEL DE
TRAUMATISMO DEL PLEXO LUMBOSACRO
TRAUMATISMO DEL TENDON DE AQUILES
TRAUMATISMO DEL TENDON Y MUSCULO ADUCTORMAYOR DEL
TRAUMATISMO DEL TENDON Y MUSCULO CUADRICEPS
TRAUMATISMO DEL TENDON Y MUSCULO DE LA CADERA IZQU
TRAUMATISMO DEL TENDON Y MUSCULO DEL EXTENSOR LARG
TRAUMATISMO DEL TENDON Y MUSCULO DEL GRUPO MUSCULA
TRAUMATISMO DEL TENDON Y MUSCULO EXTENSOR DE OTRO(
TRAUMATISMO DEL TENDON Y MUSCULO EXTENSOR DEL PULG
TRAUMATISMO DEL TENDON Y MUSCULO FLEXORDE OTRO DED
TRAUMATISMO DEL TENDON Y MUSCULO FLEXORLARGO DEL P
TRAUMATISMO NO ESPECIFICADO DE LA CADERAY DEL MUSL
TRAUMATISMO POR APLASTAMIENTO DE DEDO(S)DEL PIE 
TRAUMATISMO POR APLASTAMIENTO DE LA RODILLA 
TRAUMATISMO POR APLASTAMIENTO DE OTRAS PARTES DEL
TRAUMATISMO POR APLASTAMIENTO DE OTRAS PARTES Y DE
TRAUMATISMO POR APLASTAMIENTO DEL ANTEBRAZO, PARTE
TRAUMATISMO POR APLASTAMIENTO DEL CODO DERECHA(O)
TRAUMATISMO POR APLASTAMIENTO DEL HOMBROY DEL BRAZ
TRAUMATISMO POR APLASTAMIENTO DEL TOBILLO 
TRAUMATISMO SUPERFICIAL DE LA CADERA Y DEL MUSLO,
TRAUMATISMO SUPERFICIAL DE LA MU√ëECA Y DE LA MANO
TRAUMATISMO SUPERFICIAL DEL PIE Y DEL TOBILLO, NO
TRAUMATISMOS MULTIPLES DE LA PIERNA- FISTULA PIERN
TRAUMATISMOS SUPERFICIALES MULTIPLES DELA CADERA Y
TRAUMATISMOS SUPERFICIALES MULTIPLES DELA PIERNA 
TRAUMATISMOS SUPERFICIALES MULTIPLES DELPIE Y DEL
TRIADA TERRIBLE DE CODO 
VERTEBRA COLAPSADA, NO CLASIFICADA EN OTRA PARTE
QUISTE SENOVIAL MU√ëECA IZQUIERDA
DESGARRO MENISCAL RODILLA
EDEMA OSEO RODILLA IZQUIERDA
PINZAMIENTO FEMURO ACETABULAR DERECHO (CADERA)
HIPERLORDOSIS LUMBAR
BANDA LIDIOTIDAL DISCAL DE RODILLA
LUMBAGO TENDINITIS
BERTOLOTTI
RADICULOPAT√çA LUMBAR
`.split('\n').map(s => s.trim()).filter(Boolean);

                                                                const normalizarTF = (s) => s
                                                                    .toLowerCase()
                                                                    .normalize('NFD')
                                                                    .replace(/[\u0300-\u036f]/g, '');

                                                                function abrirModalBuscadorTF() {
                                                                    const modal = document.getElementById('modalBuscadorTF');
                                                                    if (!modal) return;
                                                                    modal.style.display = 'flex';
                                                                    // Render inicial (sin filtro)
                                                                    renderDiagnosticosTF(DIAGNOSTICOS_TF);
                                                                    // Focus input
                                                                    setTimeout(()=> document.getElementById('inputBuscarTF')?.focus(), 50);
                                                                }

                                                                function cerrarModalBuscadorTF() {
                                                                    const modal = document.getElementById('modalBuscadorTF');
                                                                    if (!modal) return;
                                                                    modal.style.display = 'none';
                                                                }

                                                                function limpiarBusquedaTF() {
                                                                    const input = document.getElementById('inputBuscarTF');
                                                                    if (input) { input.value = ''; }
                                                                    renderDiagnosticosTF(DIAGNOSTICOS_TF);
                                                                    input?.focus();
                                                                }

                                                                function filtrarDiagnosticosTF() {
                                                                    const termino = document.getElementById('inputBuscarTF')?.value || '';
                                                                    const t = normalizarTF(termino);
                                                                    if (!t) { renderDiagnosticosTF(DIAGNOSTICOS_TF); return; }
                                                                    const filtrados = DIAGNOSTICOS_TF.filter(item => normalizarTF(item).includes(t));
                                                                    renderDiagnosticosTF(filtrados);
                                                                }

                                                                function renderDiagnosticosTF(lista) {
                                                                    const ul = document.getElementById('listaDiagnosticosTF');
                                                                    const contador = document.getElementById('contadorTF');
                                                                    if (!ul) return;
                                                                    ul.innerHTML = '';
                                                                    const termRaw = document.getElementById('inputBuscarTF')?.value || '';
                                                                    const term = normalizarTF(termRaw);
                                                                    lista.forEach(txt => {
                                                                        const li = document.createElement('li');
                                                                        li.textContent = txt;
                                                                        li.style.padding = '10px 12px';
                                                                        li.style.borderBottom = '1px solid #eef2f7';
                                                                        li.style.cursor = 'pointer';
                                                                        li.style.userSelect = 'none';
                                                                        // Resaltar coincidencias cambiando color cuando hay t√©rmino de b√∫squeda
                                                                        if (term) {
                                                                            li.style.color = '#059669';
                                                                            li.style.fontWeight = '600';
                                                                        } else {
                                                                            li.style.color = '';
                                                                            li.style.fontWeight = '';
                                                                        }
                                                                        li.onmouseenter = () => { li.style.background = '#f8fafc'; };
                                                                        li.onmouseleave = () => { li.style.background = 'transparent'; };
                                                                        li.onclick = () => copiarDiagnosticoTF(txt);
                                                                        ul.appendChild(li);
                                                                    });
                                                                    if (contador) {
                                                                        contador.textContent = `${lista.length} resultado${lista.length === 1 ? '' : 's'}`;
                                                                    }
                                                                }

                                                                async function copiarDiagnosticoTF(texto) {
                                                                    try {
                                                                        if (navigator.clipboard?.writeText) {
                                                                            await navigator.clipboard.writeText(texto);
                                                                        } else {
                                                                            const ta = document.createElement('textarea');
                                                                            ta.value = texto; document.body.appendChild(ta);
                                                                            ta.select(); document.execCommand('copy');
                                                                            ta.remove();
                                                                        }
                                                                        mostrarToastTF('Copiado');
                                                                    } catch (e) {
                                                                        console.warn('No se pudo copiar autom√°ticamente', e);
                                                                        mostrarToastTF('No se pudo copiar');
                                                                    }
                                                                }

                                                                function mostrarToastTF(msg) {
                                                                    const toast = document.getElementById('toastTF');
                                                                    if (!toast) return;
                                                                    toast.textContent = msg || 'Copiado';
                                                                    toast.style.display = 'block';
                                                                    setTimeout(() => { toast.style.display = 'none'; }, 1200);
                                                                }
                                                                </script>
                    <button id="btnPizarra" class="btn-herramienta" onclick="window.open('https://docs.google.com/spreadsheets/d/1Ns8SHbNU0IbPt__zqj6PPXAgzsuerTz2/edit?usp=drive_link&ouid=105816801899706270671&rtpof=true&sd=true', '_blank')">üßë‚Äçüè´ Pizarra</button>
                    <button id="btnHoario" class="btn-herramienta" onclick="window.open('https://docs.google.com/spreadsheets/d/12T6gNxczkdbRAaga8-Yt42aVA8hzQO7y/edit?usp=sharing&ouid=105816801899706270671&rtpof=true&sd=true', '_blank')">üß∞ Horario de Botiquin</button>
                    <button id="btnHorarioImagen" class="btn-herramienta" onclick="abrirModalHorarioImagen()">ü©ª Horario de Imagolog√≠a</button>
                    <button id="btnBloqueTF" class="btn-herramienta" onclick="window.open('https://docs.google.com/spreadsheets/d/1B3_8skimxD8C-MFv37FIWcoAMciyyMq8/edit?usp=sharing&ouid=105816801899706270671&rtpof=true&sd=true', '_blank')">üìÖ Bloque Horario TF Ley y SNL (No HT)</button>
                    <button id="btnRutificador2025" class="btn-herramienta" onclick="window.open('https://rutificador.net/rut/', '_blank')">üÜî Rutificador 2025</button>
                    <button id="btnBuscadorMutualidades" class="btn-herramienta" onclick="window.open('https://www.asociaciondemutuales.cl/buscador-mutualidades/', '_blank')">üîé Buscador Mutualidades</button>
                    <button id="btnCitaGratis" class="btn-herramienta" onclick="window.open('https://achs.sharepoint.com/:x:/s/SaludIntegral/Edm5ZMDTNj5Et-T1CQFCF_sB1NTPBvBoSbWsiLQkgR4vWA?wdOrigin=TEAMS-MAGLEV.p2p_ns.rwc&wdExp=TEAMS-TREATMENT&wdhostclicktime=1758921351341&web=1', '_blank')">üéÅ Beneficio de Cita Gratis</button>
                                <!-- Modal Horario Imagolog√≠a -->
                                <div id="modalHorarioImagen" class="modal" style="display:none; justify-content:center; align-items:center;">
                                    <div class="modal-contenido" style="max-width:500px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(30,58,138,0.15); padding:2rem; position:relative;">
                                        <button onclick="cerrarModalHorarioImagen()" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#1e3a8a; cursor:pointer;">&times;</button>
                                        <h2 style="color:#1e3a8a; margin-bottom:1rem; text-align:center;">ü©ª Horario de Imagolog√≠a SNL</h2>
                                        <div style="margin-bottom:1.2rem;">
                                            <span style="font-size:1.1rem; color:#059669; font-weight:bold;">üïò‚ÄØRadiograf√≠as (RX) de 9:00 a 18:00 hrs</span>
                                            <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                                                <li>üë•‚ÄØAtenci√≥n por orden de llegada, <b>sin agendar</b>.</li>
                                                <li>‚ö†Ô∏è‚ÄØSolo RX de <b>extremidades superiores e inferiores</b>.</li>
                                                <li>üö´‚ÄØNo se realizan im√°genes de columna, tronco, TAC ni resonancia.</li>
                                                <li>üîé‚ÄØValida si el centro ofrece RX en ‚ÄúCentros Abiertos RX‚Äù (SharePoint SNL) o web oficial.</li>
                                            </ul>
                                        </div>
                                        <div style="background:#e8eef3; border-radius:8px; padding:1rem; margin-bottom:1rem; color:#1e3a8a;">
                                            <b>¬øPor qu√© es importante?</b><br>
                                            <span>Permite entregar informaci√≥n clara y completa desde el primer contacto, evitando confusiones sobre horarios, modalidad y tipo de atenci√≥n.</span>
                                        </div>
                                        <div style="background:#dbeafe; border-radius:8px; padding:1rem; color:#3b82f6;">
                                            <b>Tip pr√°ctico para la llamada:</b><br>
                                            <span>‚ÄúPuede acudir entre las 9 y las 18 horas, por orden de llegada. Solo se realizan radiograf√≠as de extremidades, y no todos los centros ofrecen el servicio, por lo que es importante validar antes.‚Äù</span>
                                        </div>
                                    </div>
                                </div>
                                <script>
                                function abrirModalHorarioImagen() {
                                    document.getElementById('modalHorarioImagen').style.display = 'flex';
                                }
                                function cerrarModalHorarioImagen() {
                                    document.getElementById('modalHorarioImagen').style.display = 'none';
                                }
                                </script>
                    <button id="btnDireccion" class="btn-herramienta" onclick="abrirDireccion()">üìç Direcci√≥n</button>
                    <button id="btnAtencion" class="btn-herramienta">‚ö†Ô∏è Atenci√≥n</button>
                    <button id="borrarTodo" class="btn-herramienta btn-especial">üóëÔ∏è Borrar Todo</button>
                    
                
                <script>
                // --- Paginaci√≥n ---
                var paginaActualBloqueoCitas = 1;
                var registrosPorPaginaBloqueoCitas = 5;
                // --- Persistencia en localStorage ---
                function getRegistrosBloqueoCitas() {
                  let datos = localStorage.getItem('bloqueoCitasRegistros');
                  return datos ? JSON.parse(datos) : [];
                }
                function setRegistrosBloqueoCitas(registros) {
                  localStorage.setItem('bloqueoCitasRegistros', JSON.stringify(registros));
                }

                function renderTablaBloqueoCitas() {
                  var tabla = document.getElementById('tablaBloqueoCitas').getElementsByTagName('tbody')[0];
                  tabla.innerHTML = '';
                  var registros = getRegistrosBloqueoCitas();
                  // Paginaci√≥n
                  var totalRegistros = registros.length;
                  var totalPaginas = Math.ceil(totalRegistros / registrosPorPaginaBloqueoCitas) || 1;
                  if (paginaActualBloqueoCitas > totalPaginas) paginaActualBloqueoCitas = totalPaginas;
                  var inicio = totalRegistros - (paginaActualBloqueoCitas * registrosPorPaginaBloqueoCitas);
                  var fin = inicio + registrosPorPaginaBloqueoCitas;
                  if (inicio < 0) { fin += inicio; inicio = 0; }
                  for (var i = fin - 1; i >= inicio; i--) {
                    var r = registros[i];
                    var fila = tabla.insertRow(-1);
                    fila.insertCell(0).innerText = r.profesional;
                    fila.insertCell(1).innerText = r.fecha;
                    fila.insertCell(2).innerText = r.remitente;
                    fila.insertCell(3).innerText = r.gestionado;
                    var celdaAccion = fila.insertCell(4);
                    celdaAccion.style.textAlign = 'center';
                    var btn = document.createElement('button');
                    btn.innerHTML = 'üóëÔ∏è';
                    btn.title = 'Eliminar este registro';
                    btn.style.background = '#dc2626';
                    btn.style.color = 'white';
                    btn.style.border = 'none';
                    btn.style.borderRadius = '4px';
                    btn.style.padding = '4px 10px';
                    btn.style.cursor = 'pointer';
                    btn.onclick = (function(idxReal) {
                      return function() { eliminarRegistroBloqueoCitasPorIndice(idxReal); };
                    })(i);
                    celdaAccion.appendChild(btn);
                  }
                  renderPaginacionBloqueoCitas(totalPaginas);
                function renderPaginacionBloqueoCitas(totalPaginas) {
                  var cont = document.getElementById('paginacionBloqueoCitas');
                  cont.innerHTML = '';
                  if (totalPaginas <= 1) return;
                  var btnPrev = document.createElement('button');
                  btnPrev.textContent = 'Anterior';
                  btnPrev.disabled = paginaActualBloqueoCitas === 1;
                  btnPrev.style.background = '#e5e7eb';
                  btnPrev.style.border = 'none';
                  btnPrev.style.borderRadius = '4px';
                  btnPrev.style.padding = '4px 10px';
                  btnPrev.style.cursor = 'pointer';
                  btnPrev.onclick = function() {
                    if (paginaActualBloqueoCitas > 1) {
                      paginaActualBloqueoCitas--;
                      renderTablaBloqueoCitas();
                    }
                  };
                  cont.appendChild(btnPrev);
                  for (var p = 1; p <= totalPaginas; p++) {
                    var btnPag = document.createElement('button');
                    btnPag.textContent = p;
                    btnPag.disabled = p === paginaActualBloqueoCitas;
                    btnPag.style.background = p === paginaActualBloqueoCitas ? '#eab308' : '#e5e7eb';
                    btnPag.style.border = 'none';
                    btnPag.style.borderRadius = '4px';
                    btnPag.style.padding = '4px 10px';
                    btnPag.style.cursor = 'pointer';
                    btnPag.style.margin = '0 2px';
                    btnPag.onclick = (function(pag) {
                      return function() {
                        paginaActualBloqueoCitas = pag;
                        renderTablaBloqueoCitas();
                      };
                    })(p);
                    cont.appendChild(btnPag);
                  }
                  var btnNext = document.createElement('button');
                  btnNext.textContent = 'Siguiente';
                  btnNext.disabled = paginaActualBloqueoCitas === totalPaginas;
                  btnNext.style.background = '#e5e7eb';
                  btnNext.style.border = 'none';
                  btnNext.style.borderRadius = '4px';
                  btnNext.style.padding = '4px 10px';
                  btnNext.style.cursor = 'pointer';
                  btnNext.onclick = function() {
                    if (paginaActualBloqueoCitas < totalPaginas) {
                      paginaActualBloqueoCitas++;
                      renderTablaBloqueoCitas();
                    }
                  };
                  cont.appendChild(btnNext);
                }
                function eliminarTodosBloqueoCitas() {
                  paginaActualBloqueoCitas = 1;
                  if (confirm('¬øSeguro que deseas eliminar todos los registros de Bloqueo Citas?')) {
                    localStorage.removeItem('bloqueoCitasRegistros');
                    renderTablaBloqueoCitas();
                  }
                }

                function exportarBloqueoCitasExcel() {
                  var registros = getRegistrosBloqueoCitas();
                  if (!registros.length) {
                    alert('No hay registros para exportar.');
                    return;
                  }
                  var csv = 'Profesional,Fecha,Remitente,Gestionado\n';
                  registros.forEach(function(r) {
                    csv += '"' + r.profesional.replace(/"/g,'""') + '",';
                    csv += '"' + r.fecha + '",';
                    csv += '"' + r.remitente.replace(/"/g,'""') + '",';
                    csv += '"' + r.gestionado + '"\n';
                  });
                  var blob = new Blob([csv], { type: 'text/csv' });
                  var url = URL.createObjectURL(blob);
                  var a = document.createElement('a');
                  a.href = url;
                  a.download = 'bloqueo_citas.csv';
                  document.body.appendChild(a);
                  a.click();
                  setTimeout(function() {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                  }, 100);
                }

                function eliminarRegistroBloqueoCitasPorIndice(idx) {
                  // Si la p√°gina queda vac√≠a tras eliminar, retroceder una p√°gina si es posible
                  setTimeout(function() {
                    var registros = getRegistrosBloqueoCitas();
                    var totalPaginas = Math.ceil(registros.length / registrosPorPaginaBloqueoCitas) || 1;
                    if (paginaActualBloqueoCitas > totalPaginas) {
                      paginaActualBloqueoCitas = totalPaginas;
                      renderTablaBloqueoCitas();
                    }
                  }, 0);
                  var registros = getRegistrosBloqueoCitas();
                  registros.splice(idx, 1);
                  setRegistrosBloqueoCitas(registros);
                  renderTablaBloqueoCitas();
                }
                }

                function abrirModalBloqueoCitas() {
                  document.getElementById('modalBloqueoCitas').style.display = 'flex';
                  document.getElementById('modalBloqueoCitas').style.justifyContent = 'center';
                  document.getElementById('modalBloqueoCitas').style.alignItems = 'center';
                  renderTablaBloqueoCitas();
                }
                function cerrarModalBloqueoCitas() {
                  document.getElementById('modalBloqueoCitas').style.display = 'none';
                }
                function guardarBloqueoCitas(event) {
                  event.preventDefault();
                  var profesional = document.getElementById('bloqueoProfesional').value.trim();
                  var fecha = document.getElementById('bloqueoFecha').value;
                  var remitente = document.getElementById('bloqueoRemitente').value.trim();
                  var gestionado = document.getElementById('bloqueoGestionado').value;
                  if (!profesional || !fecha || !remitente || !gestionado) return;
                  var registros = getRegistrosBloqueoCitas();
                  registros.push({ profesional, fecha, remitente, gestionado });
                  setRegistrosBloqueoCitas(registros);
                  renderTablaBloqueoCitas();
                  document.getElementById('formBloqueoCitas').reset();
                }

                // Renderizar al cargar la p√°gina si el modal ya est√° abierto (por si acaso)
                window.addEventListener('DOMContentLoaded', function() {
                  // Solo renderizar si existe la tabla (por si el modal a√∫n no est√° en el DOM)
                  if (document.getElementById('tablaBloqueoCitas')) {
                    renderTablaBloqueoCitas();
                  }
                });
                </script>
                </div>
                
                <!-- Formulario horizontal despu√©s de Consulta y Comunicaci√≥n -->
                <form class="formulario-principal hover-lift" onsubmit="event.preventDefault();" style="margin-left: calc(-1 * var(--spacing-2xl)); margin-right: calc(-1 * var(--spacing-2xl)); width: calc(100% + 2 * var(--spacing-2xl)); max-width: none; border-radius: 0;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-lg); align-items: start; padding: var(--spacing-xl);">
                        
                        <!-- Fila 1: Fecha y RUT (lado a lado) -->
                        <div class="form-group">
                            <label for="fecha" class="form-label">üìÖ Fecha:</label>
                            <input type="date" id="fecha" name="fecha" readonly class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="rut" class="form-label">üÜî RUT:</label>
                            <input type="text" id="rut" name="rut" class="form-input" placeholder="12.345.678-9">
                        </div>
                        
                        <!-- Fila 2: Nombre (ocupa todo el ancho) -->
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label for="nombre" class="form-label">üë§ Nombre:</label>
                            <input type="text" id="nombre" name="nombre" class="form-input" placeholder="Nombre completo del cliente">
                        </div>
                        
                        <!-- Fila 3: Motivo y Sub-motivo (lado a lado) -->
                        <div class="form-group">
                            <label for="motivo" class="form-label">üìã Motivo:</label>
                            <select id="motivo" name="motivo" class="form-select">
                                <option>ELIGE UNA OPCI√ìN</option>
                                <option>SNL</option>
                                <option>EP</option>
                                <option>TRANSFERENCIA</option>
                                <option>AGENCIA</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="submotivo" class="form-label">üìù Sub-motivo:</label>
                            <select id="submotivo" name="submotivo" class="form-select">
                                <option>ELIGE UNA OPCI√ìN</option>
                                <option>Consulta SNL</option>
                                <option>Anula Hora</option>
                                <option>Consulta EP</option>
                                <option>TRANSFERENCIA</option>
                                <option>Ingreso EP-SM flujo normal</option>
                                <option>Ley Karin // Ingreso EP-SM</option>
                                <option>Ingreso EP-ME</option>
                                <option>Paciente solicita ingreso de EP-SM y PSICO se ingresa por form</option>
                                <option>Sin ingreso administrativo se agenda por Form</option>
                                <option>Reagendamiento administrativo se agenda por Form</option>
                                <option>Reagendamiento PSICO se agenda por Form</option>
                                <option>Reagendamiento de EP-SM y PSICO se agenda por Form</option>
                                <option>Se agenda notificaci√≥n</option>
                                <option>Ingreso EP-SM presencial</option>
                            </select>
                        </div>
                        
                        <!-- Fila 4: Observaci√≥n (ocupa todo el ancho) -->
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label for="observacion" class="form-label">üí≠ Observaci√≥n:</label>
                            <textarea id="observacion" name="observacion" rows="4" class="form-textarea" placeholder="Detalles adicionales..." style="min-height: 100px; resize: vertical;"></textarea>
                        </div>
                        <div class="form-group" style="grid-column: 1 / -1; margin-top: 8px;">
                            <button id="grabar" type="button" class="btn-primario hover-lift escalar-suave btn-bounce" data-tooltip="Guardar registro actual">‚úÖ GRABAR REGISTRO</button>
                        </div>
                        
                    </div>
                </form>
                <script>
                // Evitar recarga y dar feedback visual al grabar sin parpadeo
                (function() {
                    try {
                        var form = document.querySelector('form.formulario-principal');
                        if (form) {
                            form.addEventListener('submit', function(e) { e.preventDefault(); });
                        }

                        var btn = document.getElementById('grabar');
                        if (!btn) return;
                        var originalHTML = btn.innerHTML;
                        var guardando = false;

                        btn.addEventListener('click', async function(e) {
                            if (guardando) return; // evitar clicks m√∫ltiples
                            guardando = true;
                            btn.disabled = true;
                            btn.innerHTML = '‚è≥ Guardando...';
                            try {
                                // TODO: Reemplazar con l√≥gica real de guardado si aplica
                                await new Promise(function(r) { setTimeout(r, 600); });
                                btn.innerHTML = '‚úÖ Guardado';
                            } catch (err) {
                                console.error('Error al guardar', err);
                                btn.innerHTML = '‚ùå Error, reintenta';
                            } finally {
                                setTimeout(function() {
                                    btn.innerHTML = originalHTML;
                                    btn.disabled = false;
                                    guardando = false;
                                }, 1200);
                            }
                        });
                    } catch (e) {
                        console.error('Init grabar handler error:', e);
                    }
                })();
                </script>
                
                <!-- Men√∫ desplegable de ACCESO DIRECTO mejorado -->
                <div id="accesoLinks" class="acceso-links-container" style="display:none;">
                                <script>
                                function toggleAccesoLinks() {
                                    var menu = document.getElementById('accesoLinks');
                                    if (menu.style.display === 'none' || menu.style.display === '') {
                                        menu.style.display = 'block';
                                    } else {
                                        menu.style.display = 'none';
                                    }
                                }
                                // Cerrar el men√∫ si se hace clic fuera
                                document.addEventListener('click', function(e) {
                                    var btn = document.getElementById('btnAccesoDirecto');
                                    var menu = document.getElementById('accesoLinks');
                                    if (!btn.contains(e.target) && !menu.contains(e.target)) {
                                        menu.style.display = 'none';
                                    }
                                });
                                </script>
                    <div class="acceso-header">
                        <h4 style="color: var(--primary-blue); margin: 0; font-weight: 600;">üîó Enlaces de Acceso Directo</h4>
                    </div>
                    
                    <div class="acceso-grid">
                        <a href="https://forms.office.com/pages/responsepage.aspx?id=Cr5LbVRWaUymgr99za7Y54zBkYtXGQFNm-bkdCACrIlUQlpUVDRXNVJCOTJMSkpIV1VGWkRWUkpQOS4u&origin=lprLink&route=shorturl" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">üß†</span>
                            <span class="acceso-text">Ingreso EP Salud Mental</span>
                        </a>

                        <a href="https://achs.sharepoint.com/:x:/r/sites/SaludIntegral/_layouts/15/Doc.aspx?sourcedoc=%7B81C27AB8-E408-411F-813B-2FB30D79C78C%7D&file=Preguntas%20Frecuentes%20BO%20-%20Call%20Center.xlsx&action=default&mobileredirect=true" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">‚ùì</span>
                            <span class="acceso-text">Preguntas Frecuentes</span>
                        </a>
                        
                        <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=Cr5LbVRWaUymgr99za7Y57U9PtZU_wFOgk_1LJx_qvZUMzBTTTJXRlQ5N0RLUzhFQzRWOVgzRDRVSS4u" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">üìã</span>
                            <span class="acceso-text">Solicitudes SNL ACHS</span>
                        </a>
                        
                        <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=Cr5LbVRWaUymgr99za7Y5-0-yAyIGqdLjTQ7442j2KtURDJXTVZDR1k5TkZGUTM3VEtKMUZWN0M3TC4u" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">üìû</span>
                            <span class="acceso-text">Env√≠o Links Contact Center</span>
                        </a>
                        
                        <a href="https://achs.sharepoint.com/teams/ListasdeEspera/Lists/ListaDeEspera/Vista02_Contactabilidad.aspx" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">‚è∞</span>
                            <span class="acceso-text">Listas de Espera</span>
                        </a>
                        
                        <a href="https://www.clinicasachssalud.cl/" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">üè•</span>
                            <span class="acceso-text">Cl√≠nica ACHS Salud</span>
                        </a>


                        <a href="https://www.achssalud.cl/convenios/centros" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">ü§ù </span>
                            <span class="acceso-text">Cl√≠nica ACHS Salud-CONVENIO</span>
                        </a>
                        
                        <a href="https://www.achssalud.cl/centros/" target="_blank" class="acceso-link hover-scale">
                            <span class="acceso-icon">‚öïÔ∏è</span>
                            <span class="acceso-text">Centros ACHS Salud</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Secci√≥n del historial mejorada -->
        <div class="seccion-historial fade-in-up">
            <h2 class="historial-header">üìã Historial de Registros</h2>
            
            </div>
            
            <!-- Secci√≥n de calendario y reloj compacto -->
            <div class="calendario-reloj-compacto">
                <div class="reloj-compacto">
                    <div class="reloj-display">
                        <span id="reloj-compacto">00:00:00</span>
                    </div>
                </div>
                <div class="calendario-compacto">
                    <div class="fecha-display">
                        <span id="fecha-compacta">Cargando...</span>
                    </div>
                </div>
            </div>
            
            <!-- Tabla con dise√±o mejorado -->
            <div class="tabla-container">
                <table id="historial" class="tabla-historial">
                    <thead>
                        <tr>
                            <th>üìÖ Fecha</th>
                            <th>üÜî RUT</th>
                            <th>üë§ Nombre</th>
                            <th>üìã Motivo</th>
                            <th>üìù Sub-Motivo</th>
                            <th>üí≠ Observaci√≥n</th>
                            <th style="text-align: center;">üóëÔ∏è Eliminar</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Filas se agregar√°n aqu√≠ din√°micamente -->
                    </tbody>
                </table>
                <div id="paginacionHistorial" style="display:flex; justify-content:center; align-items:center; gap:8px; margin-top:10px;"></div>
            </div>
        </div>

    <script>
    // --- Paginaci√≥n para Historial de Registros ---
    var paginaActualHistorial = 1;
    var registrosPorPaginaHistorial = 10;

    // Simulaci√≥n: funci√≥n para obtener los registros del historial (ajusta seg√∫n tu l√≥gica de almacenamiento)
    function getRegistrosHistorial() {
      // Aqu√≠ deber√≠as obtener los datos reales, por ejemplo desde localStorage o una variable global
      // Ejemplo: return JSON.parse(localStorage.getItem('historialRegistros')) || [];
      // Por ahora, se asume que hay una funci√≥n global llamada getRegistrosHistorial
      return window.historialRegistros || [];
    }

    function setRegistrosHistorial(registros) {
      // Aqu√≠ deber√≠as guardar los datos reales, por ejemplo en localStorage
      // localStorage.setItem('historialRegistros', JSON.stringify(registros));
      window.historialRegistros = registros;
    }

    function renderTablaHistorial() {
      var tabla = document.getElementById('historial').getElementsByTagName('tbody')[0];
      tabla.innerHTML = '';
      var registros = getRegistrosHistorial();
      var totalRegistros = registros.length;
      var totalPaginas = Math.ceil(totalRegistros / registrosPorPaginaHistorial) || 1;
      if (paginaActualHistorial > totalPaginas) paginaActualHistorial = totalPaginas;
      var inicio = (paginaActualHistorial - 1) * registrosPorPaginaHistorial;
      var fin = Math.min(inicio + registrosPorPaginaHistorial, totalRegistros);
      for (var i = inicio; i < fin; i++) {
        var r = registros[i];
        var fila = tabla.insertRow(-1);
        fila.insertCell(0).innerText = r.fecha || '';
        fila.insertCell(1).innerText = r.rut || '';
        fila.insertCell(2).innerText = r.nombre || '';
        fila.insertCell(3).innerText = r.motivo || '';
        fila.insertCell(4).innerText = r.submotivo || '';
        fila.insertCell(5).innerText = r.observacion || '';
        var celdaAccion = fila.insertCell(6);
        celdaAccion.style.textAlign = 'center';
        var btn = document.createElement('button');
        btn.innerHTML = 'üóëÔ∏è';
        btn.title = 'Eliminar este registro';
        btn.style.background = '#dc2626';
        btn.style.color = 'white';
        btn.style.border = 'none';
        btn.style.borderRadius = '4px';
        btn.style.padding = '4px 10px';
        btn.style.cursor = 'pointer';
        btn.onclick = (function(idx) {
          return function() { eliminarRegistroHistorialPorIndice(idx); };
        })(i);
        celdaAccion.appendChild(btn);
      }
      renderPaginacionHistorial(totalPaginas);
    }

    function renderPaginacionHistorial(totalPaginas) {
      var cont = document.getElementById('paginacionHistorial');
      cont.innerHTML = '';
      if (totalPaginas <= 1) return;
      var btnPrev = document.createElement('button');
      btnPrev.textContent = 'Anterior';
      btnPrev.disabled = paginaActualHistorial === 1;
      btnPrev.style.background = '#e5e7eb';
      btnPrev.style.border = 'none';
      btnPrev.style.borderRadius = '4px';
      btnPrev.style.padding = '4px 10px';
      btnPrev.style.cursor = 'pointer';
      btnPrev.onclick = function() {
        if (paginaActualHistorial > 1) {
          paginaActualHistorial--;
          renderTablaHistorial();
        }
      };
      cont.appendChild(btnPrev);
      for (var p = 1; p <= totalPaginas; p++) {
        var btnPag = document.createElement('button');
        btnPag.textContent = p;
        btnPag.disabled = p === paginaActualHistorial;
        btnPag.style.background = p === paginaActualHistorial ? '#eab308' : '#e5e7eb';
        btnPag.style.border = 'none';
        btnPag.style.borderRadius = '4px';
        btnPag.style.padding = '4px 10px';
        btnPag.style.cursor = 'pointer';
        btnPag.style.margin = '0 2px';
        btnPag.onclick = (function(pag) {
          return function() {
            paginaActualHistorial = pag;
            renderTablaHistorial();
          };
        })(p);
        cont.appendChild(btnPag);
      }
      var btnNext = document.createElement('button');
      btnNext.textContent = 'Siguiente';
      btnNext.disabled = paginaActualHistorial === totalPaginas;
      btnNext.style.background = '#e5e7eb';
      btnNext.style.border = 'none';
      btnNext.style.borderRadius = '4px';
      btnNext.style.padding = '4px 10px';
      btnNext.style.cursor = 'pointer';
      btnNext.onclick = function() {
        if (paginaActualHistorial < totalPaginas) {
          paginaActualHistorial++;
          renderTablaHistorial();
        }
      };
      cont.appendChild(btnNext);
    }

    function eliminarRegistroHistorialPorIndice(idx) {
      var registros = getRegistrosHistorial();
      registros.splice(idx, 1);
      setRegistrosHistorial(registros);
      // Si la p√°gina queda vac√≠a tras eliminar, retroceder una p√°gina si es posible
      setTimeout(function() {
        var totalPaginas = Math.ceil(registros.length / registrosPorPaginaHistorial) || 1;
        if (paginaActualHistorial > totalPaginas) {
          paginaActualHistorial = totalPaginas;
          renderTablaHistorial();
        }
      }, 0);
      renderTablaHistorial();
    }

    // Renderizar historial al cargar la p√°gina
    window.addEventListener('DOMContentLoaded', function() {
      if (document.getElementById('historial')) {
        renderTablaHistorial();
      }
    });
    </script>
    </div>

    <!-- Bot√≥n Flotante SCRIPT EP -->
    <button id="btnFloranteEP" class="btn-flotante-ep" onclick="abrirModalScriptEP()">
        üè• SCRIPT EP
    </button>

    <!-- Bot√≥n Flotante SCRIPT SNL 2.0 (Contact Center ACHS Salud) -->
    <button id="btnFloranteSNL2" class="btn-flotante-snl2" onclick="toggleSubmenuSNL2()">
        üìû SCRIPT SNL 2.0
    </button>

    <!-- Submen√∫ desplegable SNL 2.0 -->
    <div id="submenuSNL2" class="submenu-snl2" style="display:none;">
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('intro')">
            üé§ Intro Contact Center ACHS Salud
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('menu')">
            üìã Men√∫ Principal y Submen√∫s
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('procedimiento')">
            üìù Procedimiento de Agendamiento
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('saludmental')">
            üß† Agendamiento Salud Mental
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('traumatologia')">
            ü¶¥ Agendamiento Traumatolog√≠a
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('kinesiologia')">
            üèÉ Agendamiento Kinesiolog√≠a
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('medicinageneral')">
            ü©∫ Agendamiento Medicina General
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('medicinacuidado')">
            üíö Agendamiento Medicina del Cuidado
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('dermatologia')">
            üß¥ Agendamiento Dermatolog√≠a
        </div>
        <div class="submenu-snl2-item" onclick="abrirModalScriptSNL2('despedida')">
            üëã Despedida
        </div>
    </div>

    <!-- Overlay para cerrar submen√∫ SNL 2.0 -->
    <div id="overlaySubmenuSNL2" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:9997; background:transparent;" onclick="cerrarSubmenuSNL2()"></div>

    <!-- Bot√≥n Flotante Calendario Chile -->
    <button id="btnCalendarioCL" class="btn-flotante-cal" onclick="toggleCalendarioCL()">üìÖ Calendario</button>

    <!-- Panel Calendario Chile -->
    <div id="panelCalendarioCL" class="panel-calendario" style="display:none;">
        <div class="cal-header">
            <div id="calTitulo">Calendario Chile</div>
            <div class="cal-nav">
                <button id="calPrev" onclick="calCambiarMes(-1)">‚óÄ</button>
                <button id="calHoy" onclick="calIrAHoy()">Hoy</button>
                <button id="calNext" onclick="calCambiarMes(1)">‚ñ∂</button>
                <button onclick="toggleCalendarioCL()" title="Cerrar" style="margin-left:6px;">‚úñ</button>
            </div>
        </div>
        <div class="cal-body">
            <div class="cal-weekdays">
                <div>L</div><div>M</div><div>X</div><div>J</div><div>V</div><div>S</div><div>D</div>
            </div>
            <div id="calGrid" class="cal-grid"></div>
            <div class="cal-legend">
                <span class="cal-dot feriado"></span> Feriado en Chile
            </div>
        </div>
        <div id="calFooter" class="cal-footer"></div>
    </div>

    <!-- Bot√≥n Flotante SCRIPT LE -->
    <button id="btnFloranteLE" class="btn-flotante-le" onclick="abrirModalScriptLE()">
        üè• SCRIPT LE
    </button>

    <!-- Overlay para modales -->
    <div id="notificationOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.5); z-index: 10000;" onclick="closeNotificationSettings()"></div>

    <!-- Audio para notificaciones -->
    <audio id="notificationSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShsGIHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTCOzOPgSQoUXrTo66hUFAlFn+HyvmEZBTCOzOPgShs=" type="audio/wav">
    </audio>

    <!-- ‚úÖ Script Calendario migrado a assets/js/app.js (10/11/2025) -->

    <!-- Modal Script SNL 2.0 (Contact Center ACHS Salud) -->
    <div id="modalScriptSNL2" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:20px; padding:36px; max-width:95vw; max-height:95vh; width:850px; min-width:320px; position:relative; display:flex; flex-direction:column; box-shadow:0 12px 40px rgba(0,210,255,0.18); overflow-y:auto;">
            <!-- Bot√≥n cerrar -->
            <button onclick="cerrarModalScriptSNL2()" style="position:absolute; top:18px; right:18px; background:rgba(255,255,255,0.2); color:#00d2ff; border:2px solid #00d2ff; border-radius:50%; width:48px; height:48px; cursor:pointer; font-size:1.7em; font-weight:bold; transition:all 0.3s ease;" onmouseover="this.style.background='rgba(0,210,255,0.1)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">&times;</button>
            
            <!-- Header -->
            <div style="text-align:center; margin-bottom:30px; padding:20px 0; border-bottom:3px solid #00d2ff;">
                <h1 style="color:#006494; font-size:2.1em; font-weight:bold; margin:0; text-shadow:2px 2px 4px rgba(0,100,148,0.2); letter-spacing:0.5px;">
                    üìû SCRIPT SNL 2.0 - Contact Center ACHS Salud
                </h1>
                <div style="background:linear-gradient(90deg, #00d2ff, #3a7bd5); height:4px; width:220px; margin:15px auto; border-radius:2px; box-shadow:0 2px 10px rgba(0,210,255,0.3);"></div>
            </div>
            
            <!-- Contenido din√°mico -->
            <div id="modalScriptSNL2Content" style="flex:1; overflow-y:auto;">
                <!-- El contenido se cargar√° aqu√≠ din√°micamente -->
            </div>
            
            <!-- Botones de acci√≥n -->
            <div style="display:flex; gap:12px; justify-content:center; margin-top:24px; padding-top:18px; border-top:1px solid #e0e0e0;">
                <button onclick="imprimirScriptSNL2()" style="background:linear-gradient(145deg, #00d2ff, #3a7bd5); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(0,210,255,0.2);">üñ®Ô∏è Imprimir</button>
                <button onclick="copiarScriptSNL2()" style="background:linear-gradient(145deg, #3a7bd5, #006494); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(58,123,213,0.2);">üìã Copiar</button>
                <button onclick="cerrarModalScriptSNL2()" style="background:#6c757d; color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease;">‚ùå Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal Script LE -->
    <div id="modalScriptLE" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:20px; padding:36px; max-width:95vw; max-height:95vh; width:750px; min-width:320px; position:relative; display:flex; flex-direction:column; box-shadow:0 12px 40px rgba(155,89,182,0.18); overflow-y:auto;">
            <!-- Header del modal -->
                        <div style="display:flex; gap:15px; justify-content:center; margin-bottom:18px;">
                                <button onclick="abrirModalMedicosBonos()" style="background:linear-gradient(145deg, #009688, #26a69a); color:white; border:none; padding:14px 28px; border-radius:12px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 5px 20px rgba(0,150,136,0.2);">ü©∫ Nombres de m√©dico para compra de bonos</button>
                        </div>
                        <!-- Modal Nombres de M√©dico para Bonos -->
                        <div id="modalMedicosBonos" class="modal" style="display:none; justify-content:center; align-items:center;">
                            <div class="modal-contenido" style="max-width:540px; background:white; border-radius:16px; box-shadow:0 8px 32px rgba(0,33,71,0.15); padding:2rem; position:relative;">
                                <button onclick="cerrarModalMedicosBonos()" style="position:absolute; top:18px; right:18px; background:none; border:none; font-size:1.5rem; color:#009688; cursor:pointer;">&times;</button>
                                <h2 style="color:#009688; margin-bottom:1rem; text-align:center;">ü©∫ Profesionales por Zona ‚Äì Compra de Bonos ACHS</h2>
                                <div style="margin-bottom:1.2rem;">
                                    <b>üë®‚Äç‚öïÔ∏è M√©dico General-Traumatolog√≠a-Dermatolog√≠a</b><br>
                                    <span>üî¢ <b>C√≥digo:</b> 0101001</span>
                                    <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                                        <li>üß≠ Norte: <b>Mar√≠a Jos√© Segu√≠ Arcos</b> (Antofagasta)</li>
                                        <li>üèôÔ∏è Centro: <b>Miguel Jos√© Ayala Angarita</b> (Maip√∫)</li>
                                        <li>üåßÔ∏è Sur: <b>Luis Diego Berm√∫dez Jim√©nez</b> (Valdivia)</li>
                                    </ul>
                                    <span style="color:#dc3545; font-size:0.98em;">üìù Importante: Al comprar el bono, debes elegir al profesional correspondiente seg√∫n la zona de la sede donde se atender√° el paciente.</span>
                                </div>
                                <div style="margin-bottom:1.2rem;">
                                    <b>üßò‚Äç‚ôÇÔ∏è Kinesiolog√≠a</b><br>
                                    <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                                        <li>üß≠ Norte: <b>Nelson Ignacio Arancibia Figueroa</b> (Antofagasta)</li>
                                        <li>üèôÔ∏è Centro: <b>Krish Rayen Garc√≠a Gonz√°lez</b> (Maip√∫)</li>
                                        <li>üåßÔ∏è Sur: <b>Claudia Andrea Daetz Medina</b> (Osorno)</li>
                                    </ul>
                                </div>
                                <div>
                                    <b>üß† Psicolog√≠a</b><br>
                                    <span>üìç Profesionales asignados por sede:</span>
                                    <ul style="margin-top:0.7rem; margin-bottom:0.7rem;">
                                        <li><b>Francisca Pe√±afiel</b><br>
                                            <span style="font-size:0.97em; color:#007bff;">üîπ La Serena<br>üîπ Valpara√≠so<br>üîπ San Antonio</span>
                                        </li>
                                        <li><b>Eileen Yamile Green Jara</b><br>
                                            <span style="font-size:0.97em; color:#007bff;">üîπ San Felipe<br>üîπ San Miguel</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <script>
                        function abrirModalMedicosBonos() {
                            document.getElementById('modalMedicosBonos').style.display = 'flex';
                        }
                        function cerrarModalMedicosBonos() {
                            document.getElementById('modalMedicosBonos').style.display = 'none';
                        }
                        </script>
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:3px solid #9b59b6; padding-bottom:14px; margin-bottom:18px;">
                <h2 style="color:#9b59b6; margin:0; font-size:1.5em; font-weight:bold; letter-spacing:0.5px;">‚ú® Contactabilidad pacientes LE (Lista Espera Fonasa) <span style='color:#673ab7;'>2024-2027</span></h2>
                <button onclick="cerrarModalScriptLE()" style="background:#d9534f; color:white; border:none; border-radius:50%; width:36px; height:36px; cursor:pointer; font-size:1.4em;">&times;</button>
            </div>
            <div style="margin:10px 0 20px 0; color:#222; font-size:1.08em; line-height:1.7;">
                <div style="background:#f3e9fa; border-radius:10px; padding:18px 22px; margin-bottom:18px; box-shadow:0 2px 10px rgba(155,89,182,0.07);">
                    <b style="color:#8e44ad; font-size:1.15em;">üéØ Objetivos de la contactabilidad</b>
                    <ol style="margin-top:10px;">
                        <li><span style="color:#2e86de; font-weight:bold;">Notificar</span> al paciente que fue derivado al HT desde Fonasa/Hospital de base por su problema de salud</li>
                        <li><span style="color:#27ae60; font-weight:bold;">Solicitar confirmaci√≥n</span> de intenci√≥n de resolver su problema de salud en el HT</li>
                        <li><span style="color:#e67e22; font-weight:bold;">Obtener informaci√≥n m√©dica relevante</span> para evaluar si somos resolutivos</li>
                        <li><span style="color:#9b59b6; font-weight:bold;">Entregar informaci√≥n clara</span> sobre el proceso y pr√≥ximos pasos</li>
                    </ol>
                </div>
                <div style="background:#eafaf1; border-radius:10px; padding:14px 20px; margin-bottom:18px;">
                    <b style="color:#27ae60; font-size:1.08em;">üìù Registro de pacientes</b><br>
                    <span style="color:#222;">Plataforma de registro:</span> <a href="https://achs.sharepoint.com/teams/ListasdeEspera/Lists/ListaDeEspera/Vista02_Contactabilidad.aspx" target="_blank" style="color:#2e86de; font-weight:bold;">Ir a registro</a><br>
                    <ul style="margin-top:8px;">
                        <li>Buscar paciente por <b>nombre, rut o ID de derivaci√≥n</b></li>
                        <li>Apretar en <span style="color:#9b59b6; font-weight:bold;">‚ÄúEditar Formulario‚Äù</span></li>
                        <li>Completar informaci√≥n en base a guion. <span style="color:#27ae60; font-weight:bold;">Dependiendo de respuesta:</span>
                            <ul>
                                <li><span style="color:#27ae60;">Paciente acepta cirug√≠a:</span> llenar informaci√≥n relevante y apretar <b>‚ÄúAprobar registro‚Äù</b></li>
                                <li><span style="color:#e74c3c;">Paciente rechaza cirug√≠a:</span> seleccionar <b>‚ÄúPcte Rechaza Cirug√≠a‚Äù</b> y apretar <b>‚ÄúRechazar Paciente‚Äù</b></li>
                                <li><span style="color:#f39c12;">Dudas:</span> apretar <b>‚ÄúGuardar Cambios‚Äù</b></li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <div style="background:#fffbe6; border-radius:10px; padding:16px 20px; margin-bottom:18px;">
                    <b style="color:#e67e22; font-size:1.08em;">üì¢ Script de atenci√≥n</b>
                    <ol style="margin-top:10px;">
                        <li><b style="color:#2e86de;">Notificaci√≥n:</b><br>
                            <span style="color:#222;">Hola, ¬øhablo con <b>[Nombre del Paciente]</b>? Soy <b>[Tu Nombre]</b> y te llamo del <b>Hospital del Trabajador Achs Salud</b>. ¬øC√≥mo est√°s hoy?<br>
                            Te llamo para informarte que <b style='color:#9b59b6;'>Fonasa/Tu hospital</b> nos deriv√≥ tu caso para resolver tu problema de salud <b>[Problema de salud]</b>.<br>
                            <span style="color:#e74c3c; font-weight:bold;">Fonasa solo nos deriv√≥ el caso para la resoluci√≥n de ese problema de salud.</span><br>
                            <span style="color:#e67e22;">Si no es el paciente, reforzar que se llama por una cirug√≠a pendiente de LE y pedir n√∫meros de paciente o que indiquen horario de llamado.</span></span>
                        </li>
                        <li><b style="color:#27ae60;">Proceso y participaci√≥n:</b><br>
                            <span style="color:#222;">Todo el proceso se realiza en el <b>Centro M√©dico del Hospital del Trabajador</b>. Incluye ex√°menes, consulta y cirug√≠a <span style="color:#27ae60; font-weight:bold;">sin costo para el paciente</span> (solo traslado).<br>
                            <span style="color:#2e86de; font-weight:bold;">¬øDeseas atenderte con nosotros?</span></span>
                        </li>
                        <li><b style="color:#9b59b6;">Informaci√≥n de contacto</b> <span style="color:#222;">(si acepta operarse):</span><br>
                            <span style="color:#222;">¬øTe puedo hacer algunas preguntas?</span>
                            <ul>
                                <li>¬øN√∫mero de tel√©fono principal y secundario?</li>
                                <li>¬øCorreo electr√≥nico?</li>
                                <li>¬øFecha de nacimiento?</li>
                                <li>¬øDirecci√≥n y comuna?</li>
                            </ul>
                        </li>
                        <li><b style="color:#e67e22;">Informaci√≥n m√©dica</b> <span style="color:#222;">(si acepta operarse):</span><br>
                            <ul>
                                <li>¬øLa condici√≥n afecta un lado en particular? ¬øCu√°l?</li>
                                <li>¬øOperaci√≥n previa por este diagn√≥stico?</li>
                                <li>¬øCu√°nto tiempo esperando cirug√≠a?</li>
                                <li>¬øEmbarazo? (si aplica)</li>
                                <li>¬øInfarto?</li>
                                <li>¬øDializado?</li>
                            </ul>
                        </li>
                        <li><b style="color:#e74c3c;">Informaci√≥n rechazo</b> <span style="color:#222;">(si rechaza):</span><br>
                            <ul>
                                <li>¬øCu√°ndo y d√≥nde se oper√≥?</li>
                                <li>¬øCu√°ndo falleci√≥?</li>
                                <li>Motivo rechazo: <span style="color:#e67e22;">Lejan√≠a</span>, <span style="color:#e74c3c;">Salud</span>, <span style="color:#9b59b6;">No lo necesita</span></li>
                            </ul>
                        </li>
                        <li><b style="color:#27ae60;">Despedida e informaci√≥n:</b><br>
                            <span style="color:#222;">Todas tus atenciones ser√°n en <b>Vicu√±a Mackenna 210, Providencia</b> (metro Parque Bustamante).<br>
                            <span style="color:#2e86de; font-weight:bold;">¬°Estate atento a tu tel√©fono!</span><br>
                            <span style="color:#9b59b6; font-weight:bold;">Gracias por tu tiempo üôå</span></span>
                        </li>
                    </ol>
                </div>
                <div style="background:#e8f6ff; border-radius:10px; padding:16px 20px; margin-bottom:18px;">
                    <b style="color:#3498db; font-size:1.08em;">‚ùì Preguntas frecuentes</b>
                    <ul style="margin-top:8px;">
                        <li><b style="color:#e74c3c;">¬øEsto tiene alg√∫n costo para m√≠?</b><br>
                            <span style="color:#222;">Consultas, ex√°menes y cirug√≠a <b style='color:#27ae60;'>no tienen costo</b>. <span style='color:#e74c3c; font-weight:bold;'>El traslado s√≠ es por cuenta del paciente</span> <span style='background:#fffbe6; border-radius:4px; padding:2px 6px;'>[¬°Recalcar a pacientes de regi√≥n!]</span></span>
                        </li>
                        <li><b style="color:#e67e22;">¬øQu√© sucede si no puedo decidir ahora?</b><br>
                            <span style="color:#222;">Fonasa da <b>24 horas</b> para decidir.</span>
                        </li>
                        <li><b style="color:#9b59b6;">¬øPuedo iniciar el proceso en el HT si ya estoy en otro hospital?</b><br>
                            <span style="color:#222;">S√≠, pero debe avisar si decide mantenerse en su hospital de base.</span>
                        </li>
                        <li><b style="color:#2e86de;">¬øTodas mis atenciones pasan al HT?</b><br>
                            <span style="color:#222;">Solo el diagn√≥stico y cirug√≠a derivada por Fonasa.</span>
                        </li>
                        <li><b style="color:#27ae60;">¬øCu√°ndo inicia el proceso?</b><br>
                            <span style="color:#222;">Inicia tras la ficha. <span style='color:#2e86de;'>¬°Te contactar√°n esta semana!</span></span>
                        </li>
                        <li><b style="color:#e67e22;">¬øCu√°ndo tengo mi consulta/cirug√≠a?</b><br>
                            <span style="color:#222;">Te contactar√°n para agendar ex√°menes y consulta. La cirug√≠a ser√° dentro de un mes aprox.</span>
                        </li>
                        <li><b style="color:#9b59b6;">¬øDebo repetir ex√°menes?</b><br>
                            <span style="color:#222;">Si tienes ex√°menes de menos de 3 meses, tr√°elos igual. Se repetir√°n todos.</span>
                        </li>
                        <li><b style="color:#e74c3c;">¬øD√≥nde est√°n ubicados?</b><br>
                            <span style="color:#222;">Vicu√±a Mackenna 210, metro Parque Bustamante.</span>
                        </li>
                        <li><b style="color:#27ae60;">¬øPor qu√© necesitan mi informaci√≥n?</b><br>
                            <span style="color:#222;">Es esencial para crear tu ficha y contactarte.</span>
                        </li>
                        <li><b style="color:#2e86de;">¬øD√≥nde puedo revisar que esto no es una estafa?</b><br>
                            <span style="color:#222;">Revisa <a href="https://www.hospitaldeltrabajador.cl/" target="_blank" style="color:#2e86de; font-weight:bold;">hospitaldeltrabajador.cl</a> o <a href="https://www.hospitaldeltrabajador.cl/detalle-noticia/2024/hospital-del-trabajador-achs-salud-es-uno-de-los-prestadores-que-resolvera-parte-de-las-cirugias-de-lista-de-espera-fonasa-durante-los-proximos-3-anos" target="_blank" style="color:#2e86de; font-weight:bold;">noticia Fonasa</a>, o consulta a Fonasa/hospital de base.</span>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- Botones de acci√≥n -->
            <div style="display:flex; gap:15px; justify-content:center; margin-top:10px;">
                <button onclick="copiarScriptLE()" style="background:linear-gradient(145deg, #9b59b6, #8e44ad); color:white; border:none; padding:14px 28px; border-radius:12px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 5px 20px rgba(155,89,182,0.3);">üìã Copiar Script</button>
                <button onclick="imprimirScriptLE()" style="background:linear-gradient(145deg, #3498db, #5dade2); color:white; border:none; padding:14px 28px; border-radius:12px; cursor:pointer; font-size:1.08em; font-weight:600; transition:all 0.3s ease; box-shadow:0 5px 20px rgba(52,152,219,0.3);">üñ®Ô∏è Imprimir Script</button>
                <button onclick="cerrarModalScriptLE()" style="background:linear-gradient(145deg, #6c757d, #545b62); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(108,117,125,0.3);">‚ùå Cerrar</button>
            </div>
        </div>
    </div>
            
            <!-- Modal de Precios -->
    <div id="modalPrecios" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:12px; padding:25px; max-width:900px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 8px 32px rgba(0,33,71,0.2); position:relative;">
            
            <!-- Header del modal -->
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:3px solid #002147; padding-bottom:15px; margin-bottom:20px;">
                <h2 style="color:#002147; margin:0; font-size:1 em;">üí∞ Valores de Prestaciones ACHS</h2>
                <h4 style="color:#002147; margin:0; font-size:1 em;"> Convenio con Banm√©dica, Colmena y Vida Tres </h4>
                <button onclick="cerrarModalPrecios()" style="background:#dc3545; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease;">&times;</button>
            </div>
            
            <!-- Tabla de precios -->
            <div style="overflow-x:auto;">
                <table style="width:100%; border-collapse:collapse; font-size:0.9em; box-shadow:0 2px 8px rgba(0,0,0,0.1);">
                    <thead>
                        <tr style="background:linear-gradient(145deg, #002147, #003366); color:white;">
                            <th style="border:1px solid #002147; padding:12px 8px; text-align:left; font-weight:bold;">Especialidad</th>
                            <th style="border:1px solid #002147; padding:12px 8px; text-align:left; font-weight:bold;">Prestaci√≥n</th>
                            <th style="border:1px solid #002147; padding:12px 8px; text-align:center; font-weight:bold;">Copago Fonasa</th>
                            <th style="border:1px solid #002147; padding:12px 8px; text-align:center; font-weight:bold;">Isapre / Particular</th>
                            <th style="border:1px solid #002147; padding:12px 8px; text-align:center; font-weight:bold;">C√≥digo Fonasa en IMED</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Salud Mental -->
                        <tr style="background:#f8f9fa;">
                            <td rowspan="2" style="border:1px solid #ddd; padding:10px 8px; font-weight:bold; color:#002147; vertical-align:top;">
                                Salud Mental<br>
                                <small style="color:#666; font-weight:normal;">RUT: 70360100-6</small>
                            </td>
                            <td style="border:1px solid #ddd; padding:10px 8px;">Consulta online</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$5.470</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$23.847</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Consulta presencial</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$6.440</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$28.048</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#dc3545;">902002</td>
                        </tr>
                        
                        <!-- Traumatolog√≠a -->
                        <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:10px 8px; font-weight:bold; color:#002147;">Traumatolog√≠a</td>
                            <td style="border:1px solid #ddd; padding:10px 8px;">Consulta presencial</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$4.750</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$24.704</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#dc3545;">101001</td>
                        </tr>
 
                       <!-- Dermatolog√≠a -->
                       <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:10px 8px; font-weight:bold; color:#002147;">Dermatolog√≠a</td>
                            <td style="border:1px solid #ddd; padding:10px 8px;">Consulta presencial</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$4.750</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$24.704</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#dc3545;">101001</td>
                        </tr>
                                        

                        <!-- Kinesiolog√≠a -->
                        <tr style="background:#ffffff;">
                            <td rowspan="9" style="border:1px solid #ddd; padding:10px 8px; font-weight:bold; color:#002147; vertical-align:top;">Kinesiolog√≠a</td>
                            <td style="border:1px solid #ddd; padding:10px 8px;">Evaluaci√≥n integra</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$1.130</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$6.573</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#dc3545;">601101</td>
                        </tr>
                        <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Sesi√≥n de Kinesiolog√≠a</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$3.500</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$20.242</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#dc3545;">601105</td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Radiograf√≠a de extremidades superiores e inferiores</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$4.730</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$15.150</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Radiograf√≠a de hombro, f√©mur, rodilla, pierna, costilla o estern√≥n frontal y lateral</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$5.600</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$17.920</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Radiograf√≠a de proyecciones especiales oblicuas u otras</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$3.890</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$12.460</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#f9f9f9;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Radiograf√≠a de clav√≠cula</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$5.540</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$17.730</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Estudio radiol√≥gico de mu√±eca o tobillo frontal, lateral y oblicuas</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$5.350</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$17.140</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Estudio radiol√≥gico de escafoide</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$6.190</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$19.820</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:10px 8px; font-weight:bold; color:#6f42c1;">10 Sesiones m√°s 2 Evaluaciones integrales</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$37.260</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$228.712</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        
                        <!-- Medicina General -->
                        <tr style="background:#f8f9fa;">
                            <td rowspan="2" style="border:1px solid #ddd; padding:10px 8px; font-weight:bold; color:#002147; vertical-align:top;">Medicina General</td>
                            <td style="border:1px solid #ddd; padding:10px 8px;">Consulta online</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$4.030</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$21.005</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; color:#666;">-</td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:10px 8px;">Consulta presencial</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#28a745;">$4.750</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#007bff;">$24.704</td>
                            <td style="border:1px solid #ddd; padding:10px 8px; text-align:center; font-weight:bold; color:#dc3545;">101001</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Footer con informaci√≥n adicional -->
            <div style="margin-top:20px; padding:15px; background:#f8f9fa; border-radius:8px; border-left:4px solid #002147;">
                <p style="margin:0; font-size:0.9em; color:#666;">
                    <strong style="color:#002147;">üìã Informaci√≥n importante:</strong><br>
                    ‚Ä¢ Los precios est√°n vigentes al ${new Date().toLocaleDateString()}<br>
                    ‚Ä¢ Copago Fonasa: Valor que paga el paciente con Fonasa<br>
                    ‚Ä¢ Isapre/Particular: Valor total de la prestaci√≥n<br>
                    ‚Ä¢ Los c√≥digos IMED son necesarios para facturaci√≥n Fonasa
                    
                </p>
            </div>
        </div>
    </div>

    <!-- Modal de Anexo -->
    <div id="modalAnexo" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:12px; padding:25px; max-width:1200px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 8px 32px rgba(0,33,71,0.2); position:relative;">
            
            <!-- Header del modal -->
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:3px solid #002147; padding-bottom:15px; margin-bottom:20px;">
                <h2 style="color:#002147; margin:0; font-size:1.8em;">üìä Anexo de Contactos y Transferencias ACHS</h2>
                <button onclick="cerrarModalAnexo()" style="background:#dc3545; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease;">&times;</button>
            </div>
            
            <!-- Contenido del modal dividido en secciones -->
            <div style="display:grid; gap:25px;">
                
                <!-- Secci√≥n 1: Servicios de Transferencia -->
                <div style="background:#f8f9fa; border-radius:8px; padding:20px; border-left:4px solid #002147;">
                    <h3 style="color:#002147; margin-top:0; margin-bottom:15px;">üìû Servicios de Transferencia</h3>
                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse; font-size:0.9em;">
                            <thead>
                                <tr style="background:#002147; color:white;">
                                    <th style="border:1px solid #002147; padding:10px; text-align:left; font-weight:bold;">Servicio</th>
                                    <th style="border:1px solid #002147; padding:10px; text-align:left; font-weight:bold;">Transferir a</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#002147;">INFORMACIONES ACHS</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_INFORMACIONES</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#002147;">TRANSPORTE ACHS (RED)</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_TRANSPORTES</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#002147;">RESCATE AMBULANCIA</td>
                                    <td style="border:1px solid #ddd; padding:10px; color:#dc3545; font-weight:bold;">+568000</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#002147;">LICENCIAS M√âDICAS</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_LICENCIAS_MEDICAS</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#002147;">SOPORTE P√ÅGINA WEB</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_EMPRESAS_SOP_PAG_WEB<br>AG_VOZ_ACHS_TRABAJADORES_SOP_PAG_WEB</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Secci√≥n 2: Servicios SNL -->
                <div style="background:#e8f5e8; border-radius:8px; padding:20px; border-left:4px solid #28a745;">
                    <h3 style="color:#28a745; margin-top:0; margin-bottom:15px;">üè• Servicios SNL (Salud No Laboral)</h3>
                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse; font-size:0.9em;">
                            <thead>
                                <tr style="background:#28a745; color:rgb(22, 1, 1);">
                                    <th style="border:1px solid #28a745; padding:10px; text-align:left; font-weight:bold;">Servicio SNL</th>
                                    <th style="border:1px solid #28a745; padding:10px; text-align:left; font-weight:bold;">Transferir a</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#28a745;">SNL IM√ÅGENES</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_SNL_IMAGENES</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#28a745;">SNL KINE</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_SNL_AGENDAMIENTO_KINESIOLOGIA</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#28a745;">SNL MED GRAL</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_SNL_AGENDAMIENTO_MED_GRAL</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#28a745;">SNL SM</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_SNL_AGENDAMIENTO_SALUD_MENTAL</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#28a745;">SNL ANULACI√ìN</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_SNL_ANULACI√ìN_DE_HORAS</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#28a745;">SNL OTRAS CONSULTAS</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_SNL_OTRAS_CONSULTAS</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#28a745;">SNL TMT</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_SNL_AGENDAMIENTO_TRAUMATOLOGIA</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Secci√≥n 3: Otros Servicios -->
                <div style="background:#fff3cd; border-radius:8px; padding:20px; border-left:4px solid #ffc107;">
                    <h3 style="color:#856404; margin-top:0; margin-bottom:15px;">üè¢ Otros Servicios ACHS</h3>
                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse; font-size:0.9em;">
                            <thead>
                                <tr style="background:#ffc107; color:#212529;">
                                    <th style="border:1px solid #ffc107; padding:10px; text-align:left; font-weight:bold;">Servicio</th>
                                    <th style="border:1px solid #ffc107; padding:10px; text-align:left; font-weight:bold;">Transferir a</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#856404;">ENFERMEDADES PROFESIONALES (EMPRESAS)</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_EMPRESAS_EP</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#856404;">ENFERMEDADES PROFESIONALES (TRABAJADORES)</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_TRABAJADORES_EP</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#856404;">EXPERTO PREVENCI√ìN</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_PREVENCI√ìN</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#856404;">ASESOR COMERCIAL</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_COMERCIAL</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#856404;">CAPTACI√ìN</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_ACHS_CAPTACI√ìN</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#856404;">1404</td>
                                    <td style="border:1px solid #ddd; padding:10px;">AG_VOZ_1404_INFORMACIONES</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Secci√≥n 5: Tel√©fonos y WhatsApp -->
                <div style="background:#f0f8f0; border-radius:8px; padding:20px; border-left:4px solid #198754;">
                    <h3 style="color:#198754; margin-top:0; margin-bottom:15px;">üì± Tel√©fonos y WhatsApp</h3>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                        <div>
                            <h4 style="color:#198754; margin-top:0;">üìû Tel√©fonos Principales</h4>
                            <ul style="list-style:none; padding:0; margin:0;">
                                <li style="padding:8px 0; border-bottom:1px solid #ddd;"><strong>Cuentas Corrientes:</strong> 226853735 / 3752</li>
                                <li style="padding:8px 0; border-bottom:1px solid #ddd;"><strong>SNL:</strong> 225157000</li>
                                <li style="padding:8px 0; border-bottom:1px solid #ddd;"><strong>CEM / Hora Particular:</strong> 7970801 - 225157777</li>
                                <li style="padding:8px 0; border-bottom:1px solid #ddd;"><strong>Vacunaci√≥n:</strong> 228714444 - 226853333 - 225157777</li>
                                <li style="padding:8px 0; border-bottom:1px solid #ddd;"><strong>Prevenci√≥n al Suicidio:</strong> *4141</li>
                                <li style="padding:8px 0; border-bottom:1px solid #ddd;"><strong>Rescate/Ambulancia 1404:</strong> 9226782910</li>
                                <li style="padding:8px 0; border-bottom:1px solid #ddd;"><strong>Resonancia de Temuco</strong> 452218118</li>
                            </ul>
                        </div>
                        <div>
                            
                  
                        </div>
                    </div>
                </div

                <!-- Secci√≥n 6: Otras Instituciones -->
                <div style="background:#fdf2e9; border-radius:8px; padding:20px; border-left:4px solid #fd7e14;">
                    <h3 style="color:#fd7e14; margin-top:0; margin-bottom:15px;">üèõÔ∏è Otras Instituciones</h3>
                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse; font-size:0.9em;">
                            <thead>
                                <tr style="background:#fd7e14; color:rgb(22, 2, 2);">
                                    <th style="border:1px solid #fd7e14; padding:10px; text-align:left; font-weight:bold;">Instituci√≥n</th>
                                    <th style="border:1px solid #fd7e14; padding:10px; text-align:left; font-weight:bold;">Tel√©fono</th>
                                    <th style="border:1px solid #fd7e14; padding:10px; text-align:left; font-weight:bold;">Informaci√≥n Adicional</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">CURSOS EMPRESAS NO AFILIADAS</td>
                                    <td style="border:1px solid #ddd; padding:10px;">226852022 - 225746900</td>
                                    <td style="border:1px solid #ddd; padding:10px;">-</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">SUSESO</td>
                                    <td style="border:1px solid #ddd; padding:10px;">226204500 - 226204400</td>
                                    <td style="border:1px solid #ddd; padding:10px;">Superintendencia de Seguridad Social</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">ISL</td>
                                    <td style="border:1px solid #ddd; padding:10px;">600 586 90 90</td>
                                    <td style="border:1px solid #ddd; padding:10px;">Instituto de Seguridad Laboral</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">IST</td>
                                    <td style="border:1px solid #ddd; padding:10px;">600 58 40 000</td>
                                    <td style="border:1px solid #ddd; padding:10px;">Instituto de Seguridad del Trabajo</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">MUTUAL DE SEGURIDAD</td>
                                    <td style="border:1px solid #ddd; padding:10px;">600 2000 555</td>
                                    <td style="border:1px solid #ddd; padding:10px;">-</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">VIOLENCIA INTRAFAMILIAR</td>
                                    <td style="border:1px solid #ddd; padding:10px;">1455</td>
                                    <td style="border:1px solid #ddd; padding:10px;">-</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">MINSAL SALUD RESPONDE</td>
                                    <td style="border:1px solid #ddd; padding:10px;">6003607777</td>
                                    <td style="border:1px solid #ddd; padding:10px;">-</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">ASISTENCIA VICTORIA</td>
                                    <td style="border:1px solid #ddd; padding:10px;">228976600 - 233397600</td>
                                    <td style="border:1px solid #ddd; padding:10px;">-</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:10px; font-weight:bold; color:#fd7e14;">MESA PUC</td>
                                    <td style="border:1px solid #ddd; padding:10px;">800004155</td>
                                    <td style="border:1px solid #ddd; padding:10px;">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Secci√≥n 7: Directorio Equipo SM-ME -->
                <div style="background:#f8f4ff; border-radius:8px; padding:20px; border-left:4px solid #6f42c1;">
                    <h3 style="color:#6f42c1; margin-top:0; margin-bottom:15px;">üë• Directorio Equipo SM-ME (Salud Mental - Medicina Especializada)</h3>
                    <div style="overflow-x:auto;">
                        <table style="width:100%; border-collapse:collapse; font-size:0.85em;">
                            <thead>
                                <tr style="background:#6f42c1; color:rgb(19, 4, 4);">
                                    <th style="border:1px solid #6f42c1; padding:8px; text-align:left; font-weight:bold;">Nombre</th>
                                    <th style="border:1px solid #6f42c1; padding:8px; text-align:center; font-weight:bold;">√Årea</th>
                                    <th style="border:1px solid #6f42c1; padding:8px; text-align:left; font-weight:bold;">Agencias a Cargo</th>
                                    <th style="border:1px solid #6f42c1; padding:8px; text-align:center; font-weight:bold;">Tel√©fono</th>
                                    <th style="border:1px solid #6f42c1; padding:8px; text-align:left; font-weight:bold;">Correo Institucional</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Javiera San Mart√≠n</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#28a745;">ME</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">Araucan√≠a - Ays√©n - B√≠ob√≠o - Libertador - Los Lagos - Los R√≠os</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">9465480256</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptmeregiones@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Pedro Araya</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#007bff;">SM</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">Sur (Desde Libertador Bernardo O'Higgins)</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">-</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptsmregiones@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Nadia Chandia</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#007bff;">SM</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">RM</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">-</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptsm@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Cesar vergara</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#28a745;">ME</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">Antofagasta - Coquimbo - Valpara√≠so - Maule - √ëuble</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">967313649</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptmenorte@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Valeria Rivera</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#007bff;">SM</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">Norte (Arica - Coquimbo - Valpara√≠so)</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">939242835</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptsmnorte@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Valeria Salgado</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#007bff;">SM</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">RM</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">944246059</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptsm@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Carolina Gatica</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#28a745;">ME</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">RM</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">934440457</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptmeregiones@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#f8f9fa;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Yvonne Vargas</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#007bff;">SM</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">Sur (Desde Libertador Bernardo O'Higgins)</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">939103141</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptsmregiones@achsservicios.cl</td>
                                </tr>
                                <tr style="background:#ffffff;">
                                    <td style="border:1px solid #ddd; padding:8px; font-weight:bold; color:#6f42c1;">Fernanda Recabarren</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center; font-weight:bold; color:#28a745;">SM</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">Norte (Iquique - Antofagasta - Calama - Copiap√≥)</td>
                                    <td style="border:1px solid #ddd; padding:8px; text-align:center;">962286406</td>
                                    <td style="border:1px solid #ddd; padding:8px; font-size:0.8em;">eptsmnorte@achsservicios.cl</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Footer con informaci√≥n adicional -->
                <div style="margin-top:20px; padding:15px; background:#f8f9fa; border-radius:8px; border-left:4px solid #002147; text-align:center;">
                    <p style="margin:0; font-size:0.9em; color:#666;">
                        <strong style="color:#002147;">üìã Informaci√≥n del Anexo ACHS</strong><br>
                        Actualizado al 6 de julio de 2025 ‚Ä¢ Para uso interno del Contact Center ACHS
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Correos -->
    <div id="modalCorreos" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:12px; padding:25px; max-width:800px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 8px 32px rgba(0,33,71,0.2); position:relative;">
            
            <!-- Header del modal -->
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:3px solid #002147; padding-bottom:15px; margin-bottom:20px;">
                <h2 style="color:#002147; margin:0; font-size:1.8em;">‚úâÔ∏è Directorio de Correos ACHS</h2>
                <button onclick="cerrarModalCorreos()" style="background:#dc3545; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease;">&times;</button>
            </div>
            
            <!-- Tabla de correos -->
            <div style="overflow-x:auto;">
                <table style="width:100%; border-collapse:collapse; font-size:0.95em; box-shadow:0 2px 8px rgba(0,0,0,0.1);">
                    <thead>
                        <tr style="background:linear-gradient(145deg, #002147, #003366); color:white;">
                            <th style="border:1px solid #002147; padding:15px 12px; text-align:left; font-weight:bold;">üìã √Årea / Servicio</th>
                            <th style="border:1px solid #002147; padding:15px 12px; text-align:left; font-weight:bold;">üìß Correo Electr√≥nico</th>
                            <th style="border:1px solid #002147; padding:15px 12px; text-align:center; font-weight:bold;">üîó Acci√≥n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:12px; font-weight:bold; color:#002147;">
                                üè• M√©dico General/Traumatolog√≠a
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; font-family:monospace; color:#007bff;">
                                traumatologiasi@achs.cl
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; text-align:center;">
                                <button onclick="copiarCorreo('traumatologiasi@achs.cl')" style="background:#28a745; color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8em; transition:all 0.3s ease;">
                                    üìã Copiar
                                </button>
                            </td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:12px; font-weight:bold; color:#002147;">
                                üè• M√©dico General/Dermatolog√≠a
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; font-family:monospace; color:#007bff;">
                                dermatologiasnl@achs.cl
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; text-align:center;">
                                <button onclick="copiarCorreo('dermatologiasnl@achs.cl')" style="background:#28a745; color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8em; transition:all 0.3s ease;">
                                    üìã Copiar
                                </button>
                            </td>
                        </tr>
                        <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:12px; font-weight:bold; color:#002147;">
                                üìÑ Solicitudes SNL
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; font-family:monospace; color:#007bff;">
                                solicitudessnl@achs.cl
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; text-align:center;">
                                <button onclick="copiarCorreo('solicitudessnl@achs.cl')" style="background:#28a745; color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8em; transition:all 0.3s ease;">
                                    üìã Copiar
                                </button>
                            </td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:12px; font-weight:bold; color:#002147;">
                                üß™ Pruebas
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; font-family:monospace; color:#007bff;">
                                mediosdeprueba@achs.cl
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; text-align:center;">
                                <button onclick="copiarCorreo('mediosdeprueba@achs.cl')" style="background:#28a745; color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8em; transition:all 0.3s ease;">
                                    üìã Copiar
                                </button>
                            </td>
                        </tr>
                        <tr style="background:#f8f9fa;">
                            <td style="border:1px solid #ddd; padding:12px; font-weight:bold; color:#002147;">
                                üìã Licencias Rechazadas
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; font-family:monospace; color:#007bff;">
                                sdtelemedicina@achs.cl
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; text-align:center;">
                                <button onclick="copiarCorreo('sdtelemedicina@achs.cl')" style="background:#28a745; color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8em; transition:all 0.3s ease;">
                                    üìã Copiar
                                </button>
                            </td>
                        </tr>
                        <tr style="background:#ffffff;">
                            <td style="border:1px solid #ddd; padding:12px; font-weight:bold; color:#002147;">
                                üì¢ Reclamos
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; font-family:monospace; color:#007bff;">
                                achs@achs.cl
                            </td>
                            <td style="border:1px solid #ddd; padding:12px; text-align:center;">
                                <button onclick="copiarCorreo('achs@achs.cl')" style="background:#28a745; color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8em; transition:all 0.3s ease;">
                                    üìã Copiar
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Footer con informaci√≥n adicional -->
            <div style="margin-top:20px; padding:15px; background:#f8f9fa; border-radius:8px; border-left:4px solid #002147;">
                <p style="margin:0; font-size:0.9em; color:#666; text-align:center;">
                    <strong style="color:#002147;">‚úâÔ∏è Directorio de Correos ACHS</strong><br>
                    Haz clic en "Copiar" para copiar el correo al portapapeles ‚Ä¢ Actualizado al 6 de julio de 2025
                </p>
            </div>
        </div>
    </div>

    <!-- Modal de Atenci√≥n -->
    <div id="modalAtencion" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:12px; padding:25px; max-width:900px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 8px 32px rgba(0,33,71,0.2); position:relative;">
            
            <!-- Header del modal -->
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:3px solid #dc3545; padding-bottom:15px; margin-bottom:20px;">
                <h2 style="color:#dc3545; margin:0; font-size:1.8em;">‚ö†Ô∏è Registro de Atenci√≥n - Incidencias y Cambios</h2>
                <button onclick="cerrarModalAtencion()" style="background:#dc3545; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease;">&times;</button>
            </div>
            
            <!-- Formulario de registro -->
            <div style="background:#fff3cd; border-radius:8px; padding:20px; margin-bottom:20px; border-left:4px solid #ffc107;">
                <h3 style="color:#856404; margin-top:0; margin-bottom:15px;">üìù Nuevo Registro de Atenci√≥n</h3>
                
                <div style="display:grid; gap:15px;">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üìÖ Fecha:</label>
                            <input type="datetime-local" id="fechaAtencion" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px; background:#fff;" readonly>
                        </div>
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üë§ Registrado por:</label>
                            <input type="text" id="usuarioAtencion" placeholder="Nombre del usuario" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                        </div>
                    </div>
                    
                    <div>
                        <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üè∑Ô∏è Tipo de Registro:</label>
                        <select id="tipoAtencion" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                            <option value="">Seleccionar tipo...</option>
                            <option value="Incidencia">üö® Incidencia</option>
                            <option value="Cambio de Procedimiento">üîÑ Cambio de Procedimiento</option>
                            <option value="Mejora">üí° Mejora</option>
                            <option value="Observaci√≥n">üëÅÔ∏è Observaci√≥n</option>
                            <option value="Capacitaci√≥n">üìö Capacitaci√≥n</option>
                            <option value="Otro">üìå Otro</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üìã T√≠tulo:</label>
                        <input type="text" id="tituloAtencion" placeholder="T√≠tulo breve del registro" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                    </div>
                    
                    <div>
                        <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üìù Descripci√≥n:</label>
                        <textarea id="descripcionAtencion" rows="4" placeholder="Descripci√≥n detallada del registro..." style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px; resize:vertical;"></textarea>
                    </div>
                    
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">‚ö° Prioridad:</label>
                            <select id="prioridadAtencion" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                                <option value="Baja">üü¢ Baja</option>
                                <option value="Media" selected>üü° Media</option>
                                <option value="Alta">üü† Alta</option>
                                <option value="Cr√≠tica">üî¥ Cr√≠tica</option>
                            </select>
                        </div>
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üìä Estado:</label>
                            <select id="estadoAtencion" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                                <option value="Pendiente" selected>‚è≥ Pendiente</option>
                                <option value="En Proceso">üîÑ En Proceso</option>
                                <option value="Resuelto">‚úÖ Resuelto</option>
                                <option value="Cancelado">‚ùå Cancelado</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="text-align:center; margin-top:10px;">
                        <button onclick="guardarRegistroAtencion()" style="background:#28a745; color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:bold; margin-right:10px;">
                            ‚úÖ Guardar Registro
                        </button>
                        <button onclick="limpiarFormularioAtencion()" style="background:#6c757d; color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:bold;">
                            üóëÔ∏è Limpiar
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Lista de registros -->
            <div style="background:#f8f9fa; border-radius:8px; padding:20px; border-left:4px solid #dc3545;">
                <h3 style="color:#dc3545; margin-top:0; margin-bottom:15px;">üìã Historial de Registros de Atenci√≥n</h3>
                
                <div style="margin-bottom:15px; text-align:right;">
                    <button onclick="exportarRegistrosAtencion()" style="background:#17a2b8; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9em;">
                        üì• Exportar a Excel
                    </button>
                </div>
                
                <div style="overflow-x:auto; max-height:400px; overflow-y:auto; border:1px solid #ddd; border-radius:6px; background:white;">
                    <table id="tablaAtencion" style="width:100%; border-collapse:collapse; font-size:0.85em;">
                        <thead style="background:#dc3545; color:black; position:sticky; top:0;">
                            <tr>
                                <th style="border:1px solid #dc3545; padding:8px; text-align:left;">üìÖ Fecha</th>
                                <th style="border:1px solid #dc3545; padding:8px; text-align:left;">üë§ Usuario</th>
                                <th style="border:1px solid #dc3545; padding:8px; text-align:left;">üè∑Ô∏è Tipo</th>
                                <th style="border:1px solid #dc3545; padding:8px; text-align:left;">üìã T√≠tulo</th>
                                <th style="border:1px solid #dc3545; padding:8px; text-align:center;">‚ö° Prioridad</th>
                                <th style="border:1px solid #dc3545; padding:8px; text-align:center;">üìä Estado</th>
                                <th style="border:1px solid #dc3545; padding:8px; text-align:center;">üóëÔ∏è Eliminar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Los registros se agregar√°n aqu√≠ din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Alertas -->
    <div id="modalAlerta" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:12px; padding:25px; max-width:900px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 8px 32px rgba(255,193,7,0.3); position:relative; border:3px solid #ffc107;">
            
            <!-- Header del modal -->
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:3px solid #ffc107; padding-bottom:15px; margin-bottom:20px;">
                <h2 style="color:#856404; margin:0; font-size:1.8em;">üö® Sistema de Alertas y Recordatorios</h2>
                <button onclick="cerrarModalAlerta()" style="background:#ffc107; color:#856404; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease; font-weight:bold;">&times;</button>
            </div>
            
            <!-- Formulario de nueva alerta -->
            <div style="background:#fff3cd; border-radius:8px; padding:20px; margin-bottom:20px; border-left:4px solid #ffc107;">
                <h3 style="color:#856404; margin-top:0; margin-bottom:15px;">üìù Agendar Nueva Tarea/Recordatorio</h3>
                
                <div style="display:grid; gap:15px;">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üìÖ Fecha y Hora de Recordatorio:</label>
                            <input type="datetime-local" id="fechaAlerta" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                        </div>
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">‚ö° Prioridad:</label>
                            <select id="prioridadAlerta" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                                <option value="Baja">üü¢ Baja</option>
                                <option value="Media" selected>üü° Media</option>
                                <option value="Alta">üü† Alta</option>
                                <option value="Cr√≠tica">üî¥ Cr√≠tica</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üè∑Ô∏è T√≠tulo de la Tarea:</label>
                        <input type="text" id="tituloAlerta" placeholder="Ej: Revisar informes pendientes" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                    </div>
                    
                    <div>
                        <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üìù Descripci√≥n:</label>
                        <textarea id="descripcionAlerta" rows="3" placeholder="Descripci√≥n detallada de la tarea..." style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px; resize:vertical;"></textarea>
                    </div>
                    
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üîî Tipo de Recordatorio:</label>
                            <select id="tipoAlerta" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                                <option value="Tarea">üìã Tarea Pendiente</option>
                                <option value="Reuni√≥n">üë• Reuni√≥n</option>
                                <option value="Llamada">üìû Llamada</option>
                                <option value="Revisi√≥n">üîç Revisi√≥n</option>
                                <option value="Entrega">üì§ Entrega</option>
                                <option value="Otro">üìå Otro</option>
                            </select>
                        </div>
                        <div>
                            <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">üîÅ Repetir:</label>
                            <select id="repetirAlerta" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                                <option value="No">‚ùå No repetir</option>
                                <option value="Diario">üìÖ Diario</option>
                                <option value="Semanal">üìÜ Semanal</option>
                                <option value="Mensual">üóìÔ∏è Mensual</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="text-align:center; margin-top:10px;">
                        <button onclick="guardarAlerta()" style="background:#ffc107; color:#856404; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:bold; margin-right:10px;">
                            ‚è∞ Programar Alerta
                        </button>
                        <button onclick="limpiarFormularioAlerta()" style="background:#6c757d; color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:bold;">
                            üóëÔ∏è Limpiar
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Lista de alertas programadas -->
            <div style="background:#f8f9fa; border-radius:8px; padding:20px; border-left:4px solid #ffc107;">
                <h3 style="color:#856404; margin-top:0; margin-bottom:15px;">‚è∞ Alertas Programadas</h3>
                
                <div style="margin-bottom:15px; display:flex; justify-content:space-between; align-items:center;">
                    <button onclick="verificarAlertas()" style="background:#28a745; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9em;">
                        üîÑ Verificar Alertas Pendientes
                    </button>
                    <button onclick="exportarAlertas()" style="background:#17a2b8; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9em;">
                        üì• Exportar Alertas
                    </button>
                </div>
                
                <div style="overflow-x:auto; max-height:400px; overflow-y:auto; border:1px solid #ddd; border-radius:6px; background:white;">
                    <table id="tablaAlertas" style="width:100%; border-collapse:collapse; font-size:0.85em;">
                        <thead style="background:#ffc107; color:#856404; position:sticky; top:0;">
                            <tr>
                                <th style="border:1px solid #ffc107; padding:8px; text-align:left;">üìÖ Fecha/Hora</th>
                                <th style="border:1px solid #ffc107; padding:8px; text-align:left;">üè∑Ô∏è T√≠tulo</th>
                                <th style="border:1px solid #ffc107; padding:8px; text-align:left;">üîî Tipo</th>
                                <th style="border:1px solid #ffc107; padding:8px; text-align:center;">‚ö° Prioridad</th>
                                <th style="border:1px solid #ffc107; padding:8px; text-align:center;">üìä Estado</th>
                                <th style="border:1px solid #ffc107; padding:8px; text-align:center;">üóëÔ∏è Eliminar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Las alertas se agregar√°n aqu√≠ din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Pendientes -->
    <div id="modalPendiente" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:15px; padding:30px; max-width:800px; width:90%; max-height:90vh; overflow-y:auto; box-shadow:0 20px 40px rgba(0,0,0,0.3); border:3px solid #007bff;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px; border-bottom:2px solid #007bff; padding-bottom:15px;">
                <h2 style="color:#0056b3; margin:0; font-size:1.8em;">üìù Gesti√≥n de Tareas Pendientes</h2>
                <button onclick="cerrarModalPendiente()" style="background:#007bff; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease; font-weight:bold;">&times;</button>
            </div>
            
            <!-- Formulario de nueva tarea pendiente -->
            <div style="background:#f8f9fa; padding:25px; border-radius:12px; margin-bottom:25px; border:2px solid #007bff;">
                <h3 style="color:#0056b3; margin-top:0; margin-bottom:20px; font-size:1.4em;">üìã Registrar Nueva Tarea Pendiente</h3>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px;">
                    <div>
                        <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìÖ Fecha de Registro:</label>
                        <input type="date" id="fechaRegistroPendiente" readonly style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px; background:#e9ecef;">
                    </div>
                    <div>
                        <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">‚è∞ Fecha/Hora de Recordatorio:</label>
                        <input type="datetime-local" id="fechaRecordatorioPendiente" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                    </div>
                </div>
                <div style="margin-bottom:20px;">
                    <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üè∑Ô∏è T√≠tulo de la Tarea:</label>
                    <input type="text" id="tituloPendiente" placeholder="Ej: Revisar documentos de cliente X" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                </div>
                <div style="margin-bottom:20px;">
                    <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìù Observaciones:</label>
                    <textarea id="observacionesPendiente" rows="4" placeholder="Describe los detalles de la tarea pendiente..." style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px; resize:vertical;"></textarea>
                </div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px;">
                    <div>
                        <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">‚ö° Prioridad:</label>
                        <select id="prioridadPendiente" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                            <option value="Baja">üü¢ Baja</option>
                            <option value="Media" selected>üü° Media</option>
                            <option value="Alta">üî¥ Alta</option>
                            <option value="Cr√≠tica">üö® Cr√≠tica</option>
                        </select>
                    </div>
                    <div>
                        <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìã Categor√≠a:</label>
                        <select id="categoriaPendiente" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                            <option value="Administraci√≥n">üìä Administraci√≥n</option>
                            <option value="Cliente">üë• Cliente</option>
                            <option value="Documentos">üìÑ Documentos</option>
                            <option value="Seguimiento">üîç Seguimiento</option>
                            <option value="Urgente">‚ö° Urgente</option>
                            <option value="Otro">üìå Otro</option>
                        </select>
                    </div>
                </div>
                <div style="text-align:center;">
                    <button onclick="guardarPendiente()" style="background:#007bff; color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:bold; margin-right:10px; font-size:1.1em;">
                        üíæ Guardar y Programar Recordatorio
                    </button>
                    <button onclick="limpiarFormularioPendiente()" style="background:#6c757d; color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-weight:bold; font-size:1.1em;">
                        üßπ Limpiar Formulario
                    </button>
                </div>
            </div>
            
            <!-- Lista de tareas pendientes -->
            <div style="background:white; padding:20px; border-radius:12px; border:2px solid #007bff;">
                <h3 style="color:#0056b3; margin-top:0; margin-bottom:15px;">üìã Tareas Pendientes Registradas</h3>
                <div style="margin-bottom:15px; display:flex; gap:10px; flex-wrap:wrap;">
                    <button onclick="verificarRecordatoriosPendientes()" style="background:#28a745; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9em;">
                        üîÑ Verificar Recordatorios
                    </button>
                    <button onclick="exportarPendientes()" style="background:#17a2b8; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9em;">
                        üì• Exportar Pendientes
                    </button>
                </div>
                
                <div style="overflow-x:auto; max-height:400px; overflow-y:auto; border:1px solid #ddd; border-radius:6px; background:white;">
                    <table id="tablaPendientes" style="width:100%; border-collapse:collapse; font-size:0.85em;">
                        <thead style="background:#007bff; color:black; position:sticky; top:0;">
                            <tr>
                                <th style="border:1px solid #007bff; padding:8px; text-align:left; font-weight:bold;">üìÖ Registro</th>
                                <th style="border:1px solid #007bff; padding:8px; text-align:left; font-weight:bold;">‚è∞ Recordatorio</th>
                                <th style="border:1px solid #007bff; padding:8px; text-align:left; font-weight:bold;">üè∑Ô∏è T√≠tulo</th>
                                <th style="border:1px solid #007bff; padding:8px; text-align:left; font-weight:bold;">üìã Categor√≠a</th>
                                <th style="border:1px solid #007bff; padding:8px; text-align:center; font-weight:bold;">‚ö° Prioridad</th>
                                <th style="border:1px solid #007bff; padding:8px; text-align:center; font-weight:bold;">üìä Estado</th>
                                <th style="border:1px solid #007bff; padding:8px; text-align:center; font-weight:bold;">üóëÔ∏è Eliminar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Las tareas pendientes se agregar√°n aqu√≠ din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Bandeja de Entrada de Emails -->
    <div id="modalEmails" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:15px; padding:30px; max-width:1200px; width:95%; max-height:95vh; overflow-y:auto; box-shadow:0 20px 40px rgba(0,0,0,0.3); border:3px solid #28a745;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px; border-bottom:2px solid #28a745; padding-bottom:15px;">
                <h2 style="color:#155724; margin:0; font-size:1.8em;">üìß Bandeja de Entrada Integrada</h2>
                <button onclick="cerrarModalEmails()" style="background:#28a745; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease; font-weight:bold;">&times;</button>
            </div>
            
          
                
                <!-- Filtros y b√∫squeda -->
                <div style="display:grid; grid-template-columns:1fr 200px 200px; gap:15px; align-items:center;">
                    <input type="text" id="buscarEmail" placeholder="üîç Buscar por remitente, asunto o contenido..." style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                    <select id="filtroEstado" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                        <option value="todos">üìß Todos los emails</option>
                        <option value="no-leidos">üì© No le√≠dos</option>
                        <option value="leidos">üìñ Le√≠dos</option>
                        <option value="importantes">‚≠ê Importantes</option>
                        <option value="archivados">üìÅ Archivados</option>
                    </select>
                    <select id="filtroFecha" style="width:100%; padding:8px; border:1px solid #ddd; border-radius:4px;">
                        <option value="todos">üìÖ Todas las fechas</option>
                        <option value="hoy">üìÖ Hoy</option>
                        <option value="ayer">üìÖ Ayer</option>
                        <option value="semana">üìÖ Esta semana</option>
                        <option value="mes">üìÖ Este mes</option>
                    </select>
                </div>
            </div>
            
            <!-- Lista de emails -->
            <div style="background:white; border-radius:12px; border:2px solid #28a745;">
                <div style="background:#28a745; color:white; padding:15px; border-radius:10px 10px 0 0; display:flex; justify-content:space-between; align-items:center;">
                    <h3 style="margin:0; font-size:1.3em;">üì¨ Lista de Emails</h3>
                    <div style="display:flex; gap:10px; align-items:center;">
                        <span id="contadorEmails" style="background:rgba(255,255,255,0.2); padding:5px 12px; border-radius:20px; font-size:0.9em;">
                            üìä 0 emails
                        </span>
                        <span id="contadorNoLeidos" style="background:#dc3545; padding:5px 12px; border-radius:20px; font-size:0.9em;">
                            üì© 0 no le√≠dos
                        </span>
                    </div>
                </div>
                
                <div style="overflow-x:auto; max-height:500px; overflow-y:auto; border:1px solid #ddd; border-radius:0 0 10px 10px;">
                    <table id="tablaEmails" style="width:100%; border-collapse:collapse; font-size:0.9em;">
                        <thead style="background:#e8f5e8; position:sticky; top:0;">
                            <tr>
                                <th style="border:1px solid #28a745; padding:10px; text-align:center; font-weight:bold; width:40px;">üìå</th>
                                <th style="border:1px solid #28a745; padding:10px; text-align:left; font-weight:bold; width:200px;">üì§ Remitente</th>
                                <th style="border:1px solid #28a745; padding:10px; text-align:left; font-weight:bold;">üìù Asunto</th>
                                <th style="border:1px solid #28a745; padding:10px; text-align:center; font-weight:bold; width:150px;">üìÖ Fecha</th>
                                <th style="border:1px solid #28a745; padding:10px; text-align:center; font-weight:bold; width:100px;">üìä Estado</th>
                                <th style="border:1px solid #28a745; padding:10px; text-align:center; font-weight:bold; width:120px;">üîß Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="listaEmails">
                            <tr>
                                <td colspan="6" style="text-align:center; padding:30px; color:#666; border:1px solid #ddd;">
                                    üì≠ No hay emails para mostrar. Haga clic en "Actualizar Bandeja" para cargar emails.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Redacci√≥n de Email -->
    <div id="modalRedactarEmail" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2100; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:15px; padding:30px; max-width:800px; width:90%; max-height:90vh; overflow-y:auto; box-shadow:0 20px 40px rgba(0,0,0,0.3); border:3px solid #007bff;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:2px solid #007bff; padding-bottom:15px;">
                <h2 style="color:#0056b3; margin:0; font-size:1.6em;">‚úçÔ∏è Redactar Nuevo Email</h2>
                <button onclick="cerrarModalRedactar()" style="background:#007bff; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; font-weight:bold;">&times;</button>
            </div>
            
            <div style="margin-bottom:20px;">
                <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìß Para:</label>
                <input type="email" id="emailPara" placeholder="destinatario@achs.cl" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:4px;">
            </div>
            
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:20px;">
                <div>
                    <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìã CC:</label>
                    <input type="email" id="emailCC" placeholder="copia@achs.cl (opcional)" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:4px;">
                </div>
                <div>
                    <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">‚ö° Prioridad:</label>
                    <select id="prioridadEmail" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:4px;">
                        <option value="normal">üìß Normal</option>
                        <option value="alta">üî¥ Alta</option>
                        <option value="baja">üü¢ Baja</option>
                    </select>
                </div>
            </div>
            
            <div style="margin-bottom:20px;">
                <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìù Asunto:</label>
                <input type="text" id="asuntoEmail" placeholder="Asunto del mensaje" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:4px;">
            </div>
            
            <div style="margin-bottom:20px;">
                <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìÑ Mensaje:</label>
                <textarea id="contenidoEmail" rows="10" placeholder="Escriba su mensaje aqu√≠..." style="width:100%; padding:10px; border:1px solid #ddd; border-radius:4px; resize:vertical;"></textarea>
            </div>
            
            <div style="margin-bottom:20px;">
                <label style="display:block; font-weight:bold; color:#495057; margin-bottom:5px;">üìé Plantillas R√°pidas:</label>
                <select id="plantillasEmail" onchange="aplicarPlantilla()" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:4px;">
                    <option value="">Seleccionar plantilla...</option>
                    <option value="saludo">üëã Saludo formal</option>
                    <option value="seguimiento">üìã Seguimiento de caso</option>
                    <option value="informacion">‚ÑπÔ∏è Solicitud de informaci√≥n</option>
                    <option value="cierre">‚úÖ Cierre de gesti√≥n</option>
                    <option value="derivacion">‚ÜóÔ∏è Derivaci√≥n a especialista</option>
                </select>
            </div>
            
            <div style="text-align:center; border-top:1px solid #ddd; padding-top:20px;">
                <button onclick="enviarEmail()" style="background:#28a745; color:white; border:none; padding:12px 30px; border-radius:8px; cursor:pointer; font-weight:bold; margin-right:10px; font-size:1.1em;">
                    üì§ Enviar Email
                </button>
                <button onclick="guardarBorrador()" style="background:#ffc107; color:#856404; border:none; padding:12px 30px; border-radius:8px; cursor:pointer; font-weight:bold; margin-right:10px; font-size:1.1em;">
                    üíæ Guardar Borrador
                </button>
                <button onclick="limpiarFormularioEmail()" style="background:#6c757d; color:white; border:none; padding:12px 30px; border-radius:8px; cursor:pointer; font-weight:bold; font-size:1.1em;">
                    üßπ Limpiar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Planilla de Respuestas -->
    <div id="modalPlanillaRespuestas" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:2000; justify-content:center; align-items:center;">
        <div style="background:white; border-radius:15px; padding:30px; max-width:1200px; width:95%; max-height:95vh; overflow-y:auto; box-shadow:0 20px 40px rgba(0,0,0,0.3); border:3px solid #6f42c1;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px; border-bottom:2px solid #6f42c1; padding-bottom:15px;">
                <h2 style="color:#5a2d91; margin:0; font-size:1.8em;">üìã Planilla de Respuestas Predefinidas</h2>
                <button onclick="cerrarModalPlanillaRespuestas()" style="background:#6f42c1; color:white; border:none; border-radius:50%; width:35px; height:35px; cursor:pointer; font-size:1.3em; transition:all 0.3s ease; font-weight:bold;">&times;</button>
            </div>
            
            <!-- Barra de b√∫squeda y herramientas -->
            <div style="background:#f8f9fa; padding:20px; border-radius:12px; margin-bottom:25px; border:2px solid #6f42c1;">
                <div style="display:flex; gap:15px; align-items:center; flex-wrap:wrap; margin-bottom:15px;">
                    <input type="text" id="buscarRespuesta" placeholder="üîç Buscar respuesta..." style="flex:1; min-width:300px; padding:10px; border:1px solid #ddd; border-radius:6px;">
                    <select id="filtroCategoria" style="padding:10px; border:1px solid #ddd; border-radius:6px;">
                        <option value="todas">üìÇ Todas las categor√≠as</option>
                        <option value="acuso-recibo">‚úÖ Acuso de recibo</option>
                        <option value="bloqueos">üîí Bloqueos</option>
                        <option value="cambios-cita">üìÖ Cambios de cita</option>
                        <option value="opciones-completas">üí¨ Opciones completas</option>
                        <option value="finalizacion">‚úÖ Finalizaci√≥n</option>
                        <option value="contacto-paciente">üìû Contacto con paciente</option>
                        <option value="agenda-ingreso-ep">üóìÔ∏è Agenda Ingreso EP</option>
                    </select>
                    <button onclick="limpiarBusqueda()" style="background:#6c757d; color:white; border:none; padding:10px 15px; border-radius:6px; cursor:pointer;">
                        üßπ Limpiar
                    </button>
                </div>
                <p style="margin:0; color:#666; font-size:0.9em;">üí° Haz clic en cualquier respuesta para copiarla al portapapeles</p>
            </div>
            
            <!-- Contenedor de respuestas -->
            <div id="contenedorRespuestas">
                
                <!-- Categoria: Acuso de Recibo -->
                <div class="categoria-respuestas" data-categoria="acuso-recibo" style="background:white; border-radius:12px; margin-bottom:20px; border:2px solid #28a745;">
                    <div style="background:#28a745; color:white; padding:15px; border-radius:10px 10px 0 0; cursor:pointer;" onclick="toggleCategoria('acuso-recibo')">
                        <h3 style="margin:0; font-size:1.3em;">‚úÖ FORMAS DE ACUSAR RECIBO Y DECIR QUE SE EST√Å GESTIONANDO</h3>
                        <span id="toggle-acuso-recibo" style="float:right; font-size:1.2em;">‚ñº</span>
                    </div>
                    <div id="content-acuso-recibo" style="padding:20px;">
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e8f5e8'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Acusamos recibo de su correo y ya estamos gestionando lo solicitado.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e8f5e8'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Gracias por la informaci√≥n, procederemos con las gestiones correspondientes.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e8f5e8'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Hemos recibido su mensaje y estamos trabajando en ello.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e8f5e8'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Recibido. Nos encontramos coordinando las acciones necesarias.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e8f5e8'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Confirmamos recepci√≥n y comenzamos la gesti√≥n de inmediato.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Categoria: Bloqueos -->
                <div class="categoria-respuestas" data-categoria="bloqueos" style="background:white; border-radius:12px; margin-bottom:20px; border:2px solid #dc3545;">
                    <div style="background:#dc3545; color:white; padding:15px; border-radius:10px 10px 0 0; cursor:pointer;" onclick="toggleCategoria('bloqueos')">
                        <h3 style="margin:0; font-size:1.3em;">üîí FORMAS DE DECIR QUE SE REALIZAR√ÅN LOS BLOQUEOS</h3>
                        <span id="toggle-bloqueos" style="float:right; font-size:1.2em;">‚ñº</span>
                    </div>
                    <div id="content-bloqueos" style="padding:20px;">
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fde2e2'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Se proceder√° con el bloqueo de las citas a la brevedad.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fde2e2'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Estamos programando los bloqueos seg√∫n lo indicado.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fde2e2'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Los bloqueos ser√°n ejecutados durante la jornada.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fde2e2'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">En cuanto el sistema lo permita, se realizar√°n los bloqueos correspondientes.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fde2e2'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Estamos a la espera del sistema para efectuar los bloqueos solicitados.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Categoria: Cambios de Cita -->
                <div class="categoria-respuestas" data-categoria="cambios-cita" style="background:white; border-radius:12px; margin-bottom:20px; border:2px solid #fd7e14;">
                    <div style="background:#fd7e14; color:white; padding:15px; border-radius:10px 10px 0 0; cursor:pointer;" onclick="toggleCategoria('cambios-cita')">
                        <h3 style="margin:0; font-size:1.3em;">üìÖ FORMAS DE INDICAR QUE SE INFORMAR√ÅN LOS CAMBIOS DE CITA</h3>
                        <span id="toggle-cambios-cita" style="float:right; font-size:1.2em;">‚ñº</span>
                    </div>
                    <div id="content-cambios-cita" style="padding:20px;">
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fef0e6'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Una vez realizadas las modificaciones, informaremos los cambios de cita.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fef0e6'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Les enviaremos la confirmaci√≥n de los cambios una vez finalizados.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fef0e6'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Apenas tengamos el nuevo calendario, se lo haremos llegar.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fef0e6'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Informaremos oportunamente a los pacientes sobre las nuevas fechas.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#fef0e6'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Confirmaremos los nuevos horarios tan pronto est√©n disponibles.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Categoria: Opciones Completas -->
                <div class="categoria-respuestas" data-categoria="opciones-completas" style="background:white; border-radius:12px; margin-bottom:20px; border:2px solid #6f42c1;">
                    <div style="background:#6f42c1; color:white; padding:15px; border-radius:10px 10px 0 0; cursor:pointer;" onclick="toggleCategoria('opciones-completas')">
                        <h3 style="margin:0; font-size:1.3em;">üí¨ OPCIONES COMPLETAS (respuesta directa)</h3>
                        <span id="toggle-opciones-completas" style="float:right; font-size:1.2em;">‚ñº</span>
                    </div>
                    <div id="content-opciones-completas" style="padding:20px;">
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#f3e8ff'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Gracias por su mensaje. Ya estamos gestionando lo solicitado y procederemos con los bloqueos. Informaremos los cambios de cita a la brevedad.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#f3e8ff'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Recibido. Estamos coordinando los bloqueos seg√∫n lo indicado. En cuanto est√©n realizados, les enviaremos la confirmaci√≥n con los nuevos horarios.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#f3e8ff'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Acusamos recibo del correo. En cuanto el sistema lo permita, haremos los bloqueos y notificaremos los ajustes en la agenda.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#f3e8ff'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Gracias por la informaci√≥n. Estamos gestionando internamente, realizaremos los bloqueos y luego comunicaremos los cambios de cita correspondientes.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#f3e8ff'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Confirmamos recepci√≥n. La gesti√≥n est√° en curso; los bloqueos se har√°n hoy y se informar√°n los cambios de cita a los pacientes afectados.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Categoria: Finalizaci√≥n -->
                <div class="categoria-respuestas" data-categoria="finalizacion" style="background:white; border-radius:12px; margin-bottom:20px; border:2px solid #20c997;">
                    <div style="background:#20c997; color:white; padding:15px; border-radius:10px 10px 0 0; cursor:pointer;" onclick="toggleCategoria('finalizacion')">
                        <h3 style="margin:0; font-size:1.3em;">‚úÖ RESPUESTAS DE FINALIZACI√ìN (por tono)</h3>
                        <span id="toggle-finalizacion" style="float:right; font-size:1.2em;">‚ñº</span>
                    </div>
                    <div id="content-finalizacion" style="padding:20px;">
                        <h4 style="color:#20c997; margin-top:0;">üßæ Formal / Profesional</h4>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Se efectuaron los bloqueos correspondientes, se estableci√≥ contacto con el paciente y se reprogram√≥ la atenci√≥n.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Los procedimientos fueron reagendados tras confirmar con el paciente, quien fue debidamente informado.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Bloqueos realizados y reagendamiento coordinado exitosamente con el paciente.</span>
                        </div>
                        
                        <h4 style="color:#20c997; margin-top:20px;">üí¨ Neutro / Claro y directo</h4>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Los bloques ya est√°n realizados, se contact√≥ al paciente y qued√≥ reagendado.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Se bloque√≥ la agenda, se habl√≥ con el paciente y se reagend√≥ sin inconvenientes.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Todo listo: bloqueos hechos, paciente informado, cita reagendada.</span>
                        </div>
                        
                        <h4 style="color:#20c997; margin-top:20px;">üôÇ Cercano / Agradable</h4>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Ya se hizo el bloqueo, hablamos con el paciente y reagendamos con su confirmaci√≥n.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Agenda actualizada: se bloque√≥ la hora, se contact√≥ al paciente y ya qued√≥ reprogramado.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e6fffe'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Reagendado con √©xito üòä Bloqueos realizados y paciente notificado.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Categoria: Contacto con Paciente -->
                <div class="categoria-respuestas" data-categoria="contacto-paciente" style="background:white; border-radius:12px; margin-bottom:20px; border:2px solid #17a2b8;">
                    <div style="background:#17a2b8; color:white; padding:15px; border-radius:10px 10px 0 0; cursor:pointer;" onclick="toggleCategoria('contacto-paciente')">
                        <h3 style="margin:0; font-size:1.3em;">üìû RESPUESTAS SOBRE CONTACTO CON PACIENTES</h3>
                        <span id="toggle-contacto-paciente" style="float:right; font-size:1.2em;">‚ñº</span>
                    </div>
                    <div id="content-contacto-paciente" style="padding:20px;">
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e1f7fa'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Nos encontramos en proceso de contactar a los pacientes para coordinar nuevas fechas.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e1f7fa'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Ya hemos comenzado a comunicarnos con los pacientes para reprogramar sus citas.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e1f7fa'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Estamos gestionando el contacto con los pacientes para agendar nuevamente sus horas.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e1f7fa'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Ya iniciamos el proceso de reagendamiento, contactando directamente a los pacientes.</span>
                        </div>
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:12px; margin:8px 0; border:1px solid #ddd; border-radius:6px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#e1f7fa'" onmouseout="this.style.backgroundColor='white'">
                            <span class="texto-respuesta">Se est√° realizando el contacto con los pacientes con el fin de reprogramar sus citas.</span>
                        </div>
                    </div>
                </div>

                <!-- Categoria: Agenda Ingreso Enfermedad Profesional ACHS -->
                <div class="categoria-respuestas" data-categoria="agenda-ingreso-ep" style="background:white; border-radius:12px; margin-bottom:20px; border:2px solid #1976d2;">
                    <div style="background:#1976d2; color:white; padding:15px; border-radius:10px 10px 0 0; cursor:pointer;" onclick="toggleCategoria('agenda-ingreso-ep')">
                        <h3 style="margin:0; font-size:1.3em;">üóìÔ∏è Agenda Ingreso Enfermedad Profesional ACHS</h3>
                        <span id="toggle-agenda-ingreso-ep" style="float:right; font-size:1.2em;">‚ñº</span>
                    </div>
                    <div id="content-agenda-ingreso-ep" style="padding:20px;">
                        <div class="respuesta-item" onclick="copiarRespuesta(this)" style="padding:18px; margin:8px 0; border:1px solid #1976d2; border-radius:8px; background:#e3f2fd; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.backgroundColor='#bbdefb'" onmouseout="this.style.backgroundColor='#e3f2fd'">
                            <span class="texto-respuesta">
                                <strong>Asunto:</strong> Agenda Ingreso Enfermedad Profesional ACHS<br><br>
                                Estimado/a [Nombre del paciente]:<br><br>
                                Junto con saludar, hago env√≠o de su cita de ingreso por posible enfermedad profesional / Musculoesquel√©tico / Notificaci√≥n.<br><br>
                                La cita est√° agendada para el d√≠a [XX de XXXX de 2025] a las [HH:MM horas].<br>
                                Debe presentarse en ejemplo: Vicu√±a Mackenna 200, cuarto piso.<br>
                                Recuerde llegar 15 minutos antes (CEEP) o 30 minutos antes (Regiones), con su c√©dula de identidad.<br><br>
                                Ante cualquier duda, puede contactarnos al 600 600 2247, opci√≥n 3, subopci√≥n 3.<br><br>
                                Se despide cordialmente,<br><br>
                                Ejecutiva de Atenci√≥n ACHS
                            </span>
                        </div>
                    </div>
                </div>
                
            </div>
            
            <!-- Estad√≠sticas -->
            <div style="background:#f8f9fa; padding:15px; border-radius:8px; margin-top:20px; text-align:center; border:1px solid #ddd;">
                <span id="estadisticasRespuestas" style="color:#666; font-size:0.9em;">
                    üìä Total de respuestas: <strong>31</strong> | üìÇ Categor√≠as: <strong>7</strong>
                </span>
            </div>
        </div>
    </div>

    <!-- Modal Script EP (Enfermedades Profesionales) -->
    <div id="modalScriptEP" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.6); z-index:2500; justify-content:center; align-items:center;">
        <div style="background:linear-gradient(135deg, #fff 0%, #f8f9fa 100%); border-radius:20px; padding:30px; max-width:1000px; width:95%; max-height:95vh; overflow-y:auto; box-shadow:0 25px 50px rgba(220,53,69,0.4); border:4px solid #dc3545; position:relative;">
            
            <!-- Header destacado -->
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:25px; background:linear-gradient(135deg, #dc3545, #c82333); color:white; padding:20px; border-radius:15px; margin:-30px -30px 25px -30px;">
                <div>
                    <h2 style="margin:0; font-size:2.2em; text-shadow:2px 2px 4px rgba(0,0,0,0.3);">üè• SCRIPT EP</h2>
                    <p style="margin:5px 0 0 0; font-size:1.1em; opacity:0.9;">Protocolo de Atenci√≥n para Enfermedades Profesionales</p>
                </div>
                <button onclick="cerrarModalScriptEP()" style="background:rgba(255,255,255,0.2); color:white; border:2px solid white; border-radius:50%; width:45px; height:45px; cursor:pointer; font-size:1.5em; font-weight:bold; transition:all 0.3s ease;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">&times;</button>
            </div>
            
            <!-- Contenido del script -->
            <div style="line-height:1.7; font-size:1.1em;">
                
                <!-- Secci√≥n 1: Clasificaci√≥n de la enfermedad -->
                <div style="background:#e8f4fd; border-left:6px solid #007bff; padding:20px; margin-bottom:20px; border-radius:10px;">
                    <h3 style="color:#007bff; margin:0 0 15px 0; font-size:1.4em;">üè• CLASIFICACI√ìN DE LA ENFERMEDAD</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #007bff;">
                        <p style="margin:0 0 15px 0; font-weight:600; background:#ffeb3b; padding:8px; border-radius:4px; color:#000;">"¬øMe podr√≠a indicar por favor si su posible enfermedad profesional corresponde a la categor√≠a de Salud Mental o es Musculo esquel√©tico (como por ejemplo dolor de hombro, codo, mu√±eca)?"</p>
                        <p style="margin:15px 0 0 0; font-weight:600;">"¬øHab√≠a asistido anteriormente a alguna agencia de ACHS por esta misma enfermedad?"</p>
                        <p style="margin:15px 0 0 0; font-weight:600;">"¬øEn qu√© regi√≥n se encuentra ubicado usted?"</p>
                    </div>
                </div>
                
                <!-- Secci√≥n 2: Validaci√≥n de datos -->
                <div style="background:#f0f8e7; border-left:6px solid #28a745; padding:20px; margin-bottom:20px; border-radius:10px;">
                    <h3 style="color:#28a745; margin:0 0 15px 0; font-size:1.4em;">‚úÖ VALIDACI√ìN DE DATOS PERSONALES</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #28a745;">
                        <p style="margin:0 0 10px 0; font-weight:600;">"Perfecto. A continuaci√≥n, pasar√© a validar sus datos personales:"</p>
                        <p style="margin:10px 0; font-weight:600; background:#ffeb3b; padding:8px; border-radius:4px; color:#000;">"¬øSu n√∫mero de tel√©fono es &lt;XXXXXXXXX&gt;?"</p>
                        <p style="margin:10px 0; font-weight:600; background:#ffeb3b; padding:8px; border-radius:4px; color:#000;">"correo: xxxxx"</p>
                    </div>
                </div>
                
                <!-- Secci√≥n 3: Explicaci√≥n del proceso -->
                <div style="background:#fff3e0; border-left:6px solid #ff9800; padding:20px; margin-bottom:20px; border-radius:10px;">
                    <h3 style="color:#ff9800; margin:0 0 15px 0; font-size:1.4em;">üìã PROCESO DE ENFERMEDADES PROFESIONALES</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #ff9800;">
                        <p style="margin:0 0 15px 0; font-weight:600;">"Quiero comentarle acerca del proceso de enfermedades profesionales."</p>
                        
                        <p style="margin:10px 0; line-height:1.8;">Primero, ser√° atendido por un <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">m√©dico general</span> y recibir√° las indicaciones para su tratamiento. En paralelo, un <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">comit√© iniciar√° un estudio</span> por su patolog√≠a que tomar√° alrededor de <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">30 d√≠as aproximadamente</span>.</p>
                        
                        <p style="margin:10px 0; line-height:1.8;">Esta investigaci√≥n se realizar√° para identificar si su patolog√≠a es de <span style="background:#c8e6c9; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">origen laboral</span>, es decir, ocasionada por el trabajo o de <span style="background:#ffcdd2; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">origen com√∫n</span>, enfermedad producto de situaciones externas a lo laboral.</p>
                        
                        <div style="background:#e3f2fd; padding:12px; border-radius:6px; margin:15px 0; border:1px solid #2196f3;">
                            <p style="margin:0; font-weight:600; color:#1976d2;">"¬øSe entiende?"</p>
                        </div>
                    </div>
                </div>
                
                <!-- Secci√≥n 4: Cobertura seg√∫n origen -->
                <div style="background:#e8f5e8; border-left:6px solid #4caf50; padding:20px; margin-bottom:20px; border-radius:10px;">
                    <h3 style="color:#4caf50; margin:0 0 15px 0; font-size:1.4em;">üí∞ COBERTURA SEG√öN ORIGEN</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #4caf50;">
                        <div style="background:#c8e6c9; padding:15px; border-radius:8px; margin-bottom:15px; border:1px solid #4caf50;">
                            <p style="margin:0; font-weight:600; color:#2e7d32;">‚úÖ Si su enfermedad es de <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000;">ORIGEN LABORAL</span>, sus atenciones y tratamiento estar√°n cubiertas por el seguro de la ley.</p>
                        </div>
                        
                        <div style="background:#ffcdd2; padding:15px; border-radius:8px; margin-bottom:15px; border:1px solid #f44336;">
                            <p style="margin:0; font-weight:600; color:#c62828;">‚ùå Si su patolog√≠a es definida de <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000;">ORIGEN COM√öN</span>, los gastos asociados a su atenci√≥n y tratamiento ser√°n derivados a su previsi√≥n de salud (ISAPRE o FONASA).</p>
                        </div>
                        
                        <div style="background:#fff3cd; border:1px solid #ffc107; padding:12px; border-radius:6px;">
                            <p style="margin:0; color:#856404; font-weight:600;">"¬øDesea tomar la cita?"</p>
                        </div>
                    </div>
                </div>
                
                <!-- Secci√≥n 5: Modalidad de atenci√≥n -->
                <div style="background:#fce4ec; border-left:6px solid #e91e63; padding:20px; margin-bottom:20px; border-radius:10px;">
                    <h3 style="color:#e91e63; margin:0 0 15px 0; font-size:1.4em;">  MODALIDAD DE ATENCI√ìN</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #e91e63;">
                        <p style="margin:0 0 15px 0; font-weight:600;">"Para su tipo de atenci√≥n, la modalidad es a trav√©s de <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000;">telemedicina</span>."</p>
                        <p style="margin:0; font-weight:600;">"¬øConoce esta modalidad? ¬øSe ha atendido previamente por telemedicina?"</p>
                    </div>
                </div>
                
                <!-- Secci√≥n 6: Instrucciones importantes -->
                <div style="background:#ffebee; border-left:6px solid #f44336; padding:20px; margin-bottom:20px; border-radius:10px;">
                    <h3 style="color:#f44336; margin:0 0 15px 0; font-size:1.4em;">‚ö†Ô∏è INSTRUCCIONES IMPORTANTES</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #f44336;">
                        <div style="background:#fff3cd; border:2px solid #ffc107; padding:15px; border-radius:8px; margin-bottom:15px;">
                            <p style="margin:0 0 10px 0; font-weight:bold; color:#856404;">üìû LLAMADA TELEF√ìNICA OBLIGATORIA:</p>
                            <p style="margin:0; line-height:1.8;">Ese d√≠a tambi√©n lo llamar√°n a su celular para hacer su admisi√≥n de manera telef√≥nica <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">20 min antes aproximadamente</span>. Por favor est√© atento a su tel√©fono el d√≠a de su ingreso y tenga su <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">c√©dula de identidad a mano</span>.</p>
                        </div>
                        
                        <div style="background:#ffcdd2; border:2px solid #f44336; padding:15px; border-radius:8px; margin-bottom:15px;">
                            <p style="margin:0; font-weight:bold; color:#c62828; text-align:center;">üö® ESTA LLAMADA ES OBLIGATORIA üö®</p>
                            <p style="margin:10px 0 0 0; color:#c62828; text-align:center; font-weight:600;">Si no contestan el llamado y se conectan NO SER√ÅN ATENDIDOS</p>
                        </div>
                        
                        <p style="margin:15px 0; line-height:1.8;">En su atenci√≥n con el m√©dico, deber√° indicar <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">dos testigos de la empresa</span> para su caso, nombre y n√∫mero de tel√©fono. A ellos se les realizar√°n entrevistas de car√°cter confidencial. Si los testigos no est√°n ese d√≠a o no quisieran declarar, se deber√° tomar el testimonio a otros testigos que est√©n presentes ese d√≠a.</p>
                        
                        <p style="margin:15px 0 0 0; background:#e3f2fd; padding:10px; border-radius:6px; border:1px solid #2196f3;">üì± Le informo que recibir√° un <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">mensaje v√≠a WhatsApp</span> con un video explicativo del proceso de evaluaci√≥n.</p>
                    </div>
                </div>
                
                <!-- Secci√≥n 7: Agendamiento -->
                <div style="background:#e8f5e8; border-left:6px solid #4caf50; padding:20px; margin-bottom:20px; border-radius:10px;">
                    <h3 style="color:#4caf50; margin:0 0 15px 0; font-size:1.4em;">  AGENDAMIENTO</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #4caf50;">
                        <p style="margin:0 0 15px 0; line-height:1.8;">Quiero comentarle que su agendamiento para ingreso de enfermedad profesional de <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">salud mental</span>, tanto para la <span style="background:#c8e6c9; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">consulta m√©dica</span> como para la <span style="background:#c8e6c9; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">cita con el psic√≥logo</span>, ser√° gestionado y le llegar√° la informaci√≥n con detalles del d√≠a y hora de atenci√≥n dentro de las pr√≥ximas <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">24 horas h√°biles</span> a su correo electr√≥nico &lt;xxxx@xxx.xx&gt;.</p>
                        
                        <div style="background:#fff3cd; border:1px solid #ffc107; padding:12px; border-radius:6px; margin:15px 0;">
                            <p style="margin:0; color:#856404; font-weight:600;">"¬øTiene alguna preferencia AM (8 AM ‚Äì 13 PM) o PM (13 PM ‚Äì 18 PM) de su citaci√≥n?"</p>
                            <p style="margin:10px 0 0 0; color:#856404;">Intentaremos agendarlo en el bloque que nos indique seg√∫n disponibilidad.</p>
                            <p style="margin:10px 0 0 0; font-style:italic; color:#666;">Paciente: AM/PM/No tiene preferencia</p>
                        </div>
                        
                        <div style="background:#e3f2fd; border:1px solid #2196f3; padding:12px; border-radius:6px;">
                            <p style="margin:0; color:#1976d2; line-height:1.8;">Le recomiendo que revise su <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">bandeja de entrada</span> de su correo electr√≥nico en 24 horas h√°biles, y tambi√©n la carpeta de <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">"Spam" o "Correo no deseado"</span>, ya que los correos autom√°ticos pueden llegar all√≠. Este correo deber√≠a llegar en la ma√±ana del siguiente d√≠a h√°bil.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Secci√≥n 8: Licencias y documentaci√≥n -->
                <div style="background:#f3e5f5; border-left:6px solid #9c27b0; padding:20px; border-radius:10px;">
                    <h3 style="color:#9c27b0; margin:0 0 15px 0; font-size:1.4em;">üìÑ LICENCIAS Y DOCUMENTACI√ìN</h3>
                    <div style="background:white; padding:15px; border-radius:8px; border:1px solid #9c27b0;">
                        <p style="margin:0 0 15px 0; font-weight:600; background:#ffeb3b; padding:8px; border-radius:4px; color:#000;">"¬øCuenta con licencias rechazadas o alg√∫n antecedente de su patolog√≠a?"</p>
                        
                        <div style="background:#fff3cd; border:1px solid #ffc107; padding:15px; border-radius:8px; margin:15px 0;">
                            <h4 style="color:#856404; margin:0 0 10px 0;">üìß Env√≠o de licencias rechazadas:</h4>
                            <p style="margin:0; color:#856404; line-height:1.8;">Deber√° enviar la licencia m√©dica rechazada y la resoluci√≥n del motivo de rechazo a la casilla <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000; font-weight:bold;">SDTELEMEDICINA@ACHS.CL</span>. Con su nombre y apellido en el asunto del correo.</p>
                        </div>
                        
                        <div style="background:#e3f2fd; border:1px solid #2196f3; padding:15px; border-radius:8px; margin:15px 0;">
                            <h4 style="color:#1976d2; margin:0 0 10px 0;">üìé Medios de prueba:</h4>
                            <p style="margin:0; color:#1976d2; font-weight:600;"><span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000;">MEDIOSDEPRUEBA@ACHS.CL</span></p>
                        </div>
                        
                        <div style="background:#ffebee; border:1px solid #f44336; padding:15px; border-radius:8px;">
                            <p style="margin:0; color:#c62828; font-weight:600;">‚ö†Ô∏è Debe llevar el d√≠a de su atenci√≥n <span style="background:#ffeb3b; padding:2px 6px; border-radius:4px; color:#000;">cualquier antecedente que aporte a su patolog√≠a</span>.</p>
                        </div>
                    </div>
                </div>
                
            </div>
            
            <!-- Botones de acci√≥n -->
            <div style="display:flex; gap:15px; margin-top:25px; justify-content:center; flex-wrap:wrap;">
                <button onclick="imprimirScript()" style="background:linear-gradient(145deg, #007bff, #0056b3); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(0,123,255,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0,123,255,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,123,255,0.3)'">
                    üñ®Ô∏è Imprimir Script
                </button>
                <button onclick="copiarScript()" style="background:linear-gradient(145deg, #28a745, #1e7e34); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(40,167,69,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(40,167,69,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(40,167,69,0.3)'">
                    üìã Copiar Script
                </button>
                <button onclick="cerrarModalScriptEP()" style="background:linear-gradient(145deg, #6c757d, #545b62); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(108,117,125,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(108,117,125,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(108,117,125,0.3)'">
                    ‚ùå Cerrar
                </button>
            </div>
            
        </div>
    </div>


           <!-- Modal de Comunicaci√≥n (WhatsApp/Teams) -->
    <div id="modalComunicacion" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); z-index:3100; justify-content:center; align-items:center;" class="entrada-escena">
        <div style="background:linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius:20px; padding:30px; max-width:900px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 25px 50px rgba(0,0,0,0.3); border:4px solid #25D366; position:relative;" class="desvanecer-elegante escalar-suave">
            
            <!-- Bot√≥n de cerrar -->
            <div style="position:absolute; top:15px; right:15px;">
                <button onclick="cerrarModalComunicacion()" style="background:rgba(255,255,255,0.2); color:#25D366; border:2px solid #25D366; border-radius:50%; width:45px; height:45px; cursor:pointer; font-size:1.5em; font-weight:bold; transition:all 0.3s ease;" onmouseover="this.style.background='rgba(37,211,102,0.1)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'" class="escalar-suave flotante">&times;</button>
            </div>
            
            <!-- Header del modal -->
            <div style="text-align:center; margin-bottom:30px; padding:20px 0; border-bottom:3px solid #25D366;">
                <h1 style="color:#25D366; font-size:2.2em; font-weight:bold; margin:0; text-shadow:2px 2px 4px rgba(37,211,102,0.2);">
                    üì± ENVIAR REPORTE
                </h1>
                <p style="color:#20BA5A; font-size:1.3em; margin:10px 0 0 0; font-weight:600;">
                    WhatsApp ‚Ä¢ Microsoft Teams ‚Ä¢ Email
                </p>
                <div style="background:linear-gradient(90deg, #25D366, #20BA5A); height:4px; width:250px; margin:15px auto; border-radius:2px; box-shadow:0 2px 10px rgba(37,211,102,0.3);"></div>
            </div>
            
            <!-- Contenido principal en dos columnas -->
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:30px; margin-bottom:30px;">
                
                <!-- Columna izquierda: Res√∫menes -->
                <div>
                    <h3 style="color:#495057; margin-bottom:15px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#25D366; color:white; padding:5px 10px; border-radius:15px; font-size:0.8em;">VISTA PREVIA</span>
                        üìã Res√∫menes Generados
                    </h3>
                    
                    <!-- Resumen corto -->
                    <div style="margin-bottom:20px;">
                        <label style="display:block; font-weight:bold; color:#495057; margin-bottom:8px;">üì± Resumen Corto (WhatsApp):</label>
                        <textarea id="resumenCorto" readonly style="width:100%; height:150px; padding:12px; border:2px solid #25D366; border-radius:8px; font-family:monospace; font-size:0.9em; line-height:1.4; background:#f8f9fa; resize:vertical;"></textarea>
                        <button onclick="copiarReporte('corto')" style="background:#ffc107; color:white; border:none; padding:6px 12px; border-radius:5px; cursor:pointer; font-size:0.8em; margin-top:5px;">
                            üìã Copiar
                        </button>
                    </div>
                    
                    <!-- Resumen completo -->
                    <div>
                        <label style="display:block; font-weight:bold; color:#495057; margin-bottom:8px;">üìÑ Resumen Completo (Teams/Email):</label>
                        <textarea id="resumenCompleto" style="width:100%; height:200px; padding:12px; border:2px solid #6264A7; border-radius:8px; font-family:monospace; font-size:0.9em; line-height:1.4; resize:vertical;"></textarea>
                        <button onclick="copiarReporte('completo')" style="background:#ffc107; color:white; border:none; padding:6px 12px; border-radius:5px; cursor:pointer; font-size:0.8em; margin-top:5px;">
                            üìã Copiar
                        </button>
                    </div>
                </div>
                
                <!-- Columna derecha: Opciones de env√≠o -->
                <div>
                    <h3 style="color:#495057; margin-bottom:15px; display:flex; align-items:center; gap:10px;">
                        <span style="background:#6264A7; color:white; padding:5px 10px; border-radius:15px; font-size:0.8em;">ENVIAR</span>
                        üöÄ Opciones de Comunicaci√≥n
                    </h3>
                    
                    <!-- WhatsApp -->
                    <div style="background:#f8f9fa; border:2px solid #25D366; border-radius:12px; padding:20px; margin-bottom:20px;">
                        <h4 style="color:#25D366; margin:0 0 15px 0; display:flex; align-items:center; gap:8px;">
                            üì± WhatsApp
                        </h4>
                        
                        <div style="margin-bottom:15px;">
                            <button onclick="enviarPorWhatsApp('corto')" style="background:linear-gradient(145deg, #25D366, #20BA5A); color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(37,211,102,0.3); width:100%; margin-bottom:10px;">
                                üí¨ Enviar Resumen Corto
                            </button>
                            <button onclick="enviarPorWhatsApp('completo')" style="background:linear-gradient(145deg, #128C7E, #25D366); color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(18,140,126,0.3); width:100%;">
                                üìÑ Enviar Resumen Completo
                            </button>
                        </div>
                        
                        <div style="border-top:1px solid #ddd; padding-top:15px;">
                            <label style="display:block; font-weight:bold; color:#495057; margin-bottom:8px; font-size:0.9em;">
                                üìû Enviar a n√∫mero espec√≠fico:
                            </label>
                            <div style="display:flex; gap:10px;">
                                <input type="tel" id="numeroWhatsApp" placeholder="+56 9 1234 5678" style="flex:1; padding:8px 12px; border:1px solid #ddd; border-radius:6px; font-size:0.9em;">
                                <button onclick="enviarWhatsAppANumero()" style="background:#25D366; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9em; font-weight:600;">
                                    Enviar
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Microsoft Teams -->
                    <div style="background:#f8f9fa; border:2px solid #6264A7; border-radius:12px; padding:20px; margin-bottom:20px;">
                        <h4 style="color:#6264A7; margin:0 0 15px 0; display:flex; align-items:center; gap:8px;">
                            üíº Microsoft Teams
                        </h4>
                        <button onclick="enviarPorTeams()" style="background:linear-gradient(145deg, #6264A7, #464775); color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(98,100,167,0.3); width:100%;">
                            üöÄ Abrir en Teams
                        </button>
                        <p style="color:#666; font-size:0.8em; margin:10px 0 0 0; text-align:center;">
                            Se abrir√° Teams con el mensaje preparado
                        </p>
                    </div>
                    
                    <!-- Email -->
                    <div style="background:#f8f9fa; border:2px solid #0078D4; border-radius:12px; padding:20px;">
                        <h4 style="color:#0078D4; margin:0 0 15px 0; display:flex; align-items:center; gap:8px;">
                            üìß Email
                        </h4>
                        <button onclick="enviarPorEmail()" style="background:linear-gradient(145deg, #0078D4, #106EBE); color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(0,120,212,0.3); width:100%;">
                            ‚úâÔ∏è Abrir Cliente Email
                        </button>
                        <p style="color:#666; font-size:0.8em; margin:10px 0 0 0; text-align:center;">
                            Se abrir√° tu cliente de email predeterminado
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Botones finales -->
            <div style="text-align:center; padding:20px 0; border-top:2px solid #25D366; margin-top:20px;">
                <button onclick="generarResumenParaEnvio()" style="background:linear-gradient(145deg, #17a2b8, #138496); color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(23,162,184,0.3); margin-right:15px;">
                    üîÑ Actualizar Res√∫menes
                </button>
                <button onclick="cerrarModalComunicacion()" style="background:linear-gradient(145deg, #6c757d, #545b62); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(108,117,125,0.3);">
                    ‚ùå Cerrar
                </button>
            </div>
            
        </div>
        </div>
    
        <!-- Modal Base de Conocimientos (Wiki Interna) -->
        <div id="modalBaseConocimientos" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); z-index:3200; justify-content:center; align-items:center;" class="entrada-escena">
            <div style="background:white; border-radius:20px; width:95%; max-width:1200px; height:90%; box-shadow:0 25px 50px rgba(0,0,0,0.3); overflow:hidden; display:flex; flex-direction:column; animation:slideInFromTop 0.5s ease-out;">
                
                <!-- Header del Modal -->
                <div style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding:20px; color:white; position:relative;">
                    <button onclick="cerrarModalBaseConocimientos()" style="position:absolute; top:15px; right:20px; background:rgba(255,255,255,0.2); border:none; color:white; font-size:24px; cursor:pointer; border-radius:50%; width:40px; height:40px; display:flex; align-items:center; justify-content:center; transition:all 0.3s ease;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                        √ó
                    </button>
                    <h2 style="margin:0; font-size:1.8rem; display:flex; align-items:center; gap:12px;">
                        üìö Base de Conocimientos ACHS
                    </h2>
                    <p style="margin:8px 0 0 0; opacity:0.9; font-size:1rem;">
                        Wiki Interna Colaborativa - Gesti√≥n del Conocimiento
                    </p>
                </div>
    
                <!-- Barra de Navegaci√≥n -->
                <div style="background:#f8f9fa; border-bottom:2px solid #dee2e6; padding:15px 20px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
                    <button id="btnNuevoArticulo" onclick="crearNuevoArticulo()" style="background:linear-gradient(145deg, #28a745, #20c997); color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; display:flex; align-items:center; gap:6px;">
                        ‚úèÔ∏è Nuevo Art√≠culo
                    </button>
                    <button onclick="exportarWiki()" style="background:linear-gradient(145deg, #17a2b8, #20c997); color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; display:flex; align-items:center; gap:6px;">
                        üì§ Exportar
                    </button>
                    <button onclick="importarWiki()" style="background:linear-gradient(145deg, #ffc107, #fd7e14); color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; display:flex; align-items:center; gap:6px;">
                        üì• Importar
                    </button>
                    <button onclick="abrirConvertidorPDF()" style="background:linear-gradient(145deg, #6f42c1, #5a32a3); color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; display:flex; align-items:center; gap:6px;">
                        üìÑ PDF a JSON
                    </button>
                    <input type="file" id="inputImportarWiki" accept=".json" style="display:none;" onchange="procesarImportacion(this)">
                    
                    <!-- Buscador -->
                    <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
                        <input type="text" id="buscadorWiki" placeholder="üîç Buscar art√≠culos..." style="padding:8px 12px; border:2px solid #dee2e6; border-radius:6px; font-size:0.9rem; width:200px;" oninput="buscarArticulos()">
                        <select id="filtroCategoria" onchange="filtrarPorCategoria()" style="padding:8px; border:2px solid #dee2e6; border-radius:6px; font-size:0.9rem;">
                            <option value="">Todas las categor√≠as</option>
                            <option value="general">üìã General</option>
                            <option value="procedimientos">‚öôÔ∏è Procedimientos</option>
                            <option value="politicas">üìú Pol√≠ticas</option>
                            <option value="herramientas">üõ†Ô∏è Herramientas</option>
                            <option value="faq">‚ùì FAQ</option>
                        </select>
                        <select id="filtroTipoDocumento" onchange="filtrarPorTipoDocumento()" style="padding:8px; border:2px solid #dee2e6; border-radius:6px; font-size:0.9rem;">
                            <option value="">Todos los tipos</option>
                            <option value="JSON">üìÑ JSON</option>
                            <option value="WORD">üìù WORD</option>
                            <option value="PDF">üìã PDF</option>
                            <option value="MANUAL">‚úèÔ∏è Manual</option>
                        </select>
                    </div>
                </div>
    
                <!-- Contenido Principal -->
                <div style="flex:1; display:flex; overflow:hidden;">
                    
                    <!-- Panel Izquierdo - Lista de Art√≠culos -->
                    <div style="width:350px; background:#f8f9fa; border-right:2px solid #dee2e6; display:flex; flex-direction:column;">
                        
                        <!-- Estad√≠sticas -->
                        <div id="estadisticasWiki" style="padding:15px; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white;">
                            <h4 style="margin:0 0 8px 0; font-size:1rem;">üìä Estad√≠sticas</h4>
                            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; font-size:0.85rem;">
                                <div>üìÑ <span id="totalArticulos">0</span> art√≠culos</div>
                                <div>üëÄ <span id="totalVistas">0</span> vistas</div>
                                <div>üí¨ <span id="totalComentarios">0</span> comentarios</div>
                                <div>üìÖ <span id="ultimaActualizacion">-</span></div>
                            </div>
                        </div>
                        
                        <!-- Lista de Art√≠culos -->
                        <div style="flex:1; overflow-y:auto; padding:10px;">
                            <div id="listaArticulos" style="display:flex; flex-direction:column; gap:8px;">
                                <!-- Los art√≠culos se cargar√°n aqu√≠ din√°micamente -->
                            </div>
                        </div>
                    </div>
    
                    <!-- Panel Central - Contenido del Art√≠culo -->
                    <div style="flex:1; display:flex; flex-direction:column; overflow:hidden;">
                        
                        <!-- Vista de Art√≠culo -->
                        <div id="vistaArticulo" style="flex:1; overflow-y:auto; padding:0;">
                            <div style="padding:30px; text-align:center; color:#6c757d; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center;">
                                <div style="font-size:4rem; margin-bottom:20px;">üìö</div>
                                <h3 style="color:#495057; margin-bottom:15px;">Base de Conocimientos ACHS</h3>
                                <p style="font-size:1.1rem; line-height:1.6; max-width:500px;">
                                    Selecciona un art√≠culo de la lista para verlo, o crea uno nuevo para comenzar a construir nuestra base de conocimientos colaborativa.
                                </p>
                                <button onclick="crearNuevoArticulo()" style="background:linear-gradient(145deg, #667eea, #764ba2); color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-size:1rem; font-weight:600; margin-top:20px; transition:all 0.3s ease;">
                                    ‚úèÔ∏è Crear Primer Art√≠culo
                                </button>
                            </div>
                        </div>
    
                        <!-- Editor de Art√≠culo -->
                        <div id="editorArticulo" style="display:none; flex:1; flex-direction:column; overflow:hidden;">
                            <div style="padding:20px; border-bottom:2px solid #dee2e6; background:#f8f9fa;">
                                <div style="display:flex; gap:10px; margin-bottom:15px; flex-wrap:wrap;">
                                    <input type="text" id="tituloEditor" placeholder="T√≠tulo del art√≠culo..." style="flex:1; padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1.1rem; font-weight:600; min-width:300px;">
                                    <select id="categoriaEditor" style="padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1rem;">
                                        <option value="general">üìã General</option>
                                        <option value="procedimientos">‚öôÔ∏è Procedimientos</option>
                                        <option value="politicas">üìú Pol√≠ticas</option>
                                        <option value="herramientas">üõ†Ô∏è Herramientas</option>
                                        <option value="faq">‚ùì FAQ</option>
                                    </select>
                                    <select id="tipoDocumentoEditor" style="padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1rem;">
                                        <option value="JSON">üìÑ JSON</option>
                                        <option value="WORD">üìù WORD</option>
                                        <option value="PDF">üìã PDF</option>
                                        <option value="MANUAL">‚úèÔ∏è Manual</option>
                                    </select>
                                </div>
                                <div style="display:flex; gap:8px; flex-wrap:wrap;">
                                    <button onclick="guardarArticulo()" style="background:linear-gradient(145deg, #28a745, #20c997); color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:600; transition:all 0.3s ease;">
                                        üíæ Guardar
                                    </button>
                                    <button onclick="cancelarEdicion()" style="background:linear-gradient(145deg, #6c757d, #5a6268); color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:600; transition:all 0.3s ease;">
                                        ‚ùå Cancelar
                                    </button>
                                    <button onclick="previsualizarArticulo()" style="background:linear-gradient(145deg, #17a2b8, #138496); color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:600; transition:all 0.3s ease;">
                                        üëÅÔ∏è Preview
                                    </button>
                                </div>
                            </div>
                            <textarea id="contenidoEditor" placeholder="Escribe el contenido del art√≠culo aqu√≠...
    
    Tips:
    - Usa **texto** para negritas
    - Usa *texto* para cursivas  
    - Usa # T√≠tulo para encabezados
    - Usa - Item para listas
    - Usa [enlace](url) para enlaces" style="flex:1; padding:20px; border:none; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size:1rem; line-height:1.6; resize:none; outline:none;"></textarea>
                        </div>
                    </div>
    
                    <!-- Panel Derecho - Informaci√≥n del Art√≠culo -->
                    <div id="panelInfo" style="width:300px; background:#f8f9fa; border-left:2px solid #dee2e6; display:none; flex-direction:column; overflow-y:auto;">
                        
                        <!-- Informaci√≥n del Art√≠culo -->
                        <div style="padding:20px; border-bottom:1px solid #dee2e6;">
                            <h4 style="margin:0 0 15px 0; color:#495057; display:flex; align-items:center; gap:8px;">
                                ‚ÑπÔ∏è Informaci√≥n
                            </h4>
                            <div id="infoArticulo" style="font-size:0.9rem; color:#6c757d; line-height:1.5;">
                                <!-- Informaci√≥n se cargar√° aqu√≠ -->
                            </div>
                        </div>
    
                        <!-- Acciones -->
                        <div style="padding:20px; border-bottom:1px solid #dee2e6;">
                            <h4 style="margin:0 0 15px 0; color:#495057; display:flex; align-items:center; gap:8px;">
                                ‚ö° Acciones
                            </h4>
                            <div style="display:flex; flex-direction:column; gap:8px;">
                                <button onclick="editarArticulo()" style="background:linear-gradient(145deg, #ffc107, #e0a800); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease;">
                                    ‚úèÔ∏è Editar
                                </button>
                                <button onclick="duplicarArticulo()" style="background:linear-gradient(145deg, #6f42c1, #5a32a3); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease;">
                                    üìã Duplicar
                                </button>
                                <button onclick="compartirArticulo()" style="background:linear-gradient(145deg, #17a2b8, #138496); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease;">
                                    üì§ Compartir
                                </button>
                                <button onclick="imprimirArticulo()" style="background:linear-gradient(145deg, #6c757d, #5a6268); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease;">
                                    üñ®Ô∏è Imprimir
                                </button>
                                <button onclick="eliminarArticulo()" style="background:linear-gradient(145deg, #dc3545, #c82333); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease;">
                                    üóëÔ∏è Eliminar
                                </button>
                            </div>
                        </div>
    
                        <!-- Comentarios -->
                        <div style="flex:1; padding:20px;">
                            <h4 style="margin:0 0 15px 0; color:#495057; display:flex; align-items:center; gap:8px;">
                                üí¨ Comentarios
                            </h4>
                            
                            <!-- Nuevo Comentario -->
                            <div style="margin-bottom:15px;">
                                <textarea id="nuevoComentario" placeholder="Escribe un comentario..." style="width:100%; padding:8px; border:2px solid #dee2e6; border-radius:6px; font-size:0.9rem; resize:vertical; min-height:60px; font-family:inherit;"></textarea>
                                <button onclick="agregarComentario()" style="background:linear-gradient(145deg, #28a745, #20c997); color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer; font-size:0.8rem; font-weight:600; margin-top:8px; width:100%; transition:all 0.3s ease;">
                                    üí¨ Agregar Comentario
                                </button>
                            </div>
    
                            <!-- Lista de Comentarios -->
                            <div id="listaComentarios" style="display:flex; flex-direction:column; gap:10px;">
                                <!-- Los comentarios se cargar√°n aqu√≠ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Modal Convertidor PDF a JSON -->
        <div id="modalConvertidorPDF" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); z-index:3300; justify-content:center; align-items:center;" class="entrada-escena">
            <div style="background:white; border-radius:20px; width:90%; max-width:800px; max-height:90vh; box-shadow:0 25px 50px rgba(0,0,0,0.3); overflow:hidden; display:flex; flex-direction:column;">
                
                <!-- Header del Modal -->
                <div style="background:linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%); padding:20px; color:white; position:relative;">
                    <button onclick="cerrarModalConvertidor()" style="position:absolute; top:15px; right:20px; background:rgba(255,255,255,0.2); border:none; color:white; font-size:24px; cursor:pointer; border-radius:50%; width:40px; height:40px; display:flex; align-items:center; justify-content:center; transition:all 0.3s ease;">
                        √ó
                    </button>
                    <h2 style="margin:0; font-size:1.8rem; display:flex; align-items:center; gap:12px;">
                        üìÑ Convertidor PDF a JSON
                    </h2>
                    <p style="margin:8px 0 0 0; opacity:0.9; font-size:1rem;">
                        Convierte documentos PDF en art√≠culos para la Base de Conocimientos
                    </p>
                </div>
    
                <!-- Contenido del Modal -->
                <div style="flex:1; padding:30px; overflow-y:auto;">
                    
                    <!-- Paso 1: Seleccionar archivo -->
                    <div class="paso-convertidor" id="paso1" style="margin-bottom:30px;">
                        <h3 style="color:#6f42c1; margin-bottom:15px; display:flex; align-items:center; gap:8px;">
                            üìÅ Paso 1: Selecciona tu archivo PDF
                        </h3>
                        <div style="border:2px dashed #6f42c1; border-radius:12px; padding:40px; text-align:center; background:#f8f9ff;">
                            <div style="font-size:3rem; margin-bottom:15px;">üìÑ</div>
                            <input type="file" id="inputPDF" accept=".pdf" style="display:none;" onchange="procesarPDF(this)">
                            <button onclick="document.getElementById('inputPDF').click()" style="background:linear-gradient(145deg, #6f42c1, #5a32a3); color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-size:1rem; font-weight:600; margin-bottom:10px;">
                                üìÅ Seleccionar PDF
                            </button>
                            <p style="color:#6c757d; margin:10px 0 0 0; font-size:0.9rem;">
                                O arrastra y suelta tu archivo PDF aqu√≠
                            </p>
                        </div>
                    </div>
    
                    <!-- Paso 2: Informaci√≥n del art√≠culo -->
                    <div class="paso-convertidor" id="paso2" style="display:none; margin-bottom:30px;">
                        <h3 style="color:#6f42c1; margin-bottom:15px; display:flex; align-items:center; gap:8px;">
                            ‚úèÔ∏è Paso 2: Completa la informaci√≥n del art√≠culo
                        </h3>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px;">
                            <div>
                                <label style="display:block; font-weight:600; margin-bottom:8px; color:#495057;">T√≠tulo del art√≠culo:</label>
                                <input type="text" id="tituloConvertidor" placeholder="Ej: Manual de Procedimientos SNL" style="width:100%; padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1rem;">
                            </div>
                            <div>
                                <label style="display:block; font-weight:600; margin-bottom:8px; color:#495057;">Categor√≠a:</label>
                                <select id="categoriaConvertidor" style="width:100%; padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1rem;">
                                    <option value="general">üìã General</option>
                                    <option value="procedimientos">‚öôÔ∏è Procedimientos</option>
                                    <option value="politicas">üìú Pol√≠ticas</option>
                                    <option value="herramientas">üõ†Ô∏è Herramientas</option>
                                    <option value="faq">‚ùì FAQ</option>
                                </select>
                            </div>
                        </div>
                        <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:20px; margin-bottom:20px;">
                            <div>
                                <label style="display:block; font-weight:600; margin-bottom:8px; color:#495057;">Tipo de Documento:</label>
                                <select id="tipoDocumentoConvertidor" style="width:100%; padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1rem;">
                                    <option value="PDF">üìã PDF</option>
                                    <option value="WORD">üìù WORD</option>
                                    <option value="JSON">üìÑ JSON</option>
                                    <option value="MANUAL">‚úèÔ∏è Manual</option>
                                </select>
                            </div>
                            <div>
                                <label style="display:block; font-weight:600; margin-bottom:8px; color:#495057;">Prioridad:</label>
                                <select id="prioridadConvertidor" style="width:100%; padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1rem;">
                                    <option value="normal">üìÑ Normal</option>
                                    <option value="importante">‚≠ê Importante</option>
                                    <option value="urgente">üî• Urgente</option>
                                </select>
                            </div>
                            <div>
                                <label style="display:block; font-weight:600; margin-bottom:8px; color:#495057;">Tags (separados por comas):</label>
                                <input type="text" id="tagsConvertidor" placeholder="Ej: SNL, manual, procedimiento" style="width:100%; padding:12px; border:2px solid #dee2e6; border-radius:6px; font-size:1rem;">
                            </div>
                        </div>
                    </div>
    
                    <!-- Paso 3: Vista previa del contenido -->
                    <div class="paso-convertidor" id="paso3" style="display:none; margin-bottom:30px;">
                        <h3 style="color:#6f42c1; margin-bottom:15px; display:flex; align-items:center; gap:8px;">
                            üëÅÔ∏è Paso 3: Vista previa del contenido extra√≠do
                        </h3>
                        <div style="background:#f8f9fa; border:2px solid #dee2e6; border-radius:8px; padding:20px; max-height:300px; overflow-y:auto;">
                            <div id="contenidoExtraido" style="white-space:pre-wrap; font-family:monospace; font-size:0.9rem; line-height:1.5;">
                                <!-- El contenido extra√≠do aparecer√° aqu√≠ -->
                            </div>
                        </div>
                        <p style="color:#6c757d; font-size:0.9rem; margin-top:10px;">
                            üí° Puedes editar este contenido antes de generar el JSON
                        </p>
                    </div>
    
                    <!-- Botones de acci√≥n -->
                    <div style="display:flex; gap:12px; justify-content:flex-end; align-items:center; padding-top:20px; border-top:1px solid #dee2e6;">
                        <span id="estadoConversion" style="color:#6c757d; font-size:0.9rem; flex:1;"></span>
                        <button onclick="cerrarModalConvertidor()" style="background:#6c757d; color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:600;">
                            ‚ùå Cancelar
                        </button>
                        <button id="btnGenerarJSON" onclick="generarJSONDesdeTexto()" style="display:none; background:linear-gradient(145deg, #28a745, #20c997); color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:600;">
                            üîÑ Generar JSON
                        </button>
                        <button id="btnDescargarJSON" onclick="descargarJSON()" style="display:none; background:linear-gradient(145deg, #17a2b8, #138496); color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:600;">
                            üíæ Descargar JSON
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Reclamos y Quejas -->
        <div id="modalReclamo" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); z-index:3400; justify-content:center; align-items:center;" class="entrada-escena">
            <div style="background:linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius:20px; padding:30px; max-width:1000px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 25px 50px rgba(0,0,0,0.3); border:4px solid #dc3545; position:relative;" class="desvanecer-elegante escalar-suave">
                
                <!-- Bot√≥n de cerrar -->
                <div style="position:absolute; top:15px; right:15px; z-index:3500;">
                    <button onclick="console.log('üîÑ Bot√≥n X clickeado'); cerrarModalReclamo();" style="background:rgba(255,255,255,0.9); color:#dc3545; border:2px solid #dc3545; border-radius:50%; width:45px; height:45px; cursor:pointer; font-size:1.5em; font-weight:bold; transition:all 0.3s ease; z-index:3501;" onmouseover="this.style.background='rgba(220,53,69,0.1)'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255,255,255,0.9)'; this.style.transform='scale(1)'" class="escalar-suave flotante">&times;</button>
                </div>
                
                <!-- Header del modal -->
                <div style="text-align:center; margin-bottom:30px; padding:20px 0; border-bottom:3px solid #dc3545;">
                    <h1 style="color:#dc3545; font-size:2.2em; font-weight:bold; margin:0; text-shadow:2px 2px 4px rgba(220,53,69,0.2);">
                        üì¢ Sistema de Reclamos y Quejas
                    </h1>
                    <p style="color:#6c757d; margin:10px 0 0 0; font-size:1.1em; opacity:0.9;">
                        Complete el formulario para registrar y enviar su reclamo o queja
                    </p>
                </div>
                
                <!-- Formulario de Reclamo -->
                <div style="padding:0 20px;">
                    
                    <!-- Informaci√≥n del Cliente -->
                    <div style="background:#fff3cd; border-radius:12px; padding:25px; margin-bottom:25px; border-left:5px solid #ffc107;">
                        <h3 style="color:#856404; margin:0 0 20px 0; font-size:1.3em; display:flex; align-items:center; gap:10px;">
                            üë§ Informaci√≥n del Cliente
                        </h3>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:15px;">
                            <div>
                                <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">Nombre Completo:</label>
                                <input type="text" id="nombreCliente" placeholder="Ingrese nombre completo del cliente" style="width:100%; padding:12px; border:2px solid #ffc107; border-radius:8px; font-size:1rem;">
                            </div>
                            <div>
                                <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">RUT:</label>
                                <input type="text" id="rutCliente" placeholder="12.345.678-9" style="width:100%; padding:12px; border:2px solid #ffc107; border-radius:8px; font-size:1rem;">
                            </div>
                        </div>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                            <div>
                                <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">Tel√©fono:</label>
                                <input type="tel" id="telefonoCliente" placeholder="+56 9 1234 5678" style="width:100%; padding:12px; border:2px solid #ffc107; border-radius:8px; font-size:1rem;">
                            </div>
                            <div>
                                <label style="color:#856404; font-weight:bold; display:block; margin-bottom:5px;">Email:</label>
                                <input type="email" id="emailCliente" placeholder="cliente@correo.com" style="width:100%; padding:12px; border:2px solid #ffc107; border-radius:8px; font-size:1rem;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Detalles del Reclamo -->
                    <div style="background:#f8d7da; border-radius:12px; padding:25px; margin-bottom:25px; border-left:5px solid #dc3545;">
                        <h3 style="color:#721c24; margin:0 0 20px 0; font-size:1.3em; display:flex; align-items:center; gap:10px;">
                            üìù Detalles del Reclamo/Queja
                        </h3>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px;">
                            <div>
                                <label style="color:#721c24; font-weight:bold; display:block; margin-bottom:5px;">Tipo de Reclamo:</label>
                                <select id="tipoReclamo" style="width:100%; padding:12px; border:2px solid #dc3545; border-radius:8px; font-size:1rem;">
                                    <option value="">Seleccione tipo de reclamo</option>
                                    <option value="atencion_deficiente">Atenci√≥n Deficiente</option>
                                    <option value="demora_atencion">Demora en Atenci√≥n</option>
                                    <option value="error_administrativo">Error Administrativo</option>
                                    <option value="problema_medico">Problema M√©dico</option>
                                    <option value="facturacion">Problema de Facturaci√≥n</option>
                                    <option value="sistema_tecnologico">Sistema Tecnol√≥gico</option>
                                    <option value="instalaciones">Instalaciones</option>
                                    <option value="otro">Otro</option>
                                </select>
                            </div>
                            <div>
                                <label style="color:#721c24; font-weight:bold; display:block; margin-bottom:5px;">Prioridad:</label>
                                <select id="prioridadReclamo" style="width:100%; padding:12px; border:2px solid #dc3545; border-radius:8px; font-size:1rem;">
                                    <option value="baja">üü¢ Baja</option>
                                    <option value="media" selected>üü° Media</option>
                                    <option value="alta">üü† Alta</option>
                                    <option value="urgente">üî¥ Urgente</option>
                                </select>
                            </div>
                        </div>
                        <div style="margin-bottom:20px;">
                            <label style="color:#721c24; font-weight:bold; display:block; margin-bottom:5px;">Descripci√≥n del Reclamo:</label>
                            <textarea id="descripcionReclamo" rows="4" placeholder="Describa detalladamente su reclamo o queja..." style="width:100%; padding:12px; border:2px solid #dc3545; border-radius:8px; font-size:1rem; resize:vertical;"></textarea>
                        </div>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                            <div>
                                <label style="color:#721c24; font-weight:bold; display:block; margin-bottom:5px;">Fecha del Incidente:</label>
                                <input type="date" id="fechaIncidente" style="width:100%; padding:12px; border:2px solid #dc3545; border-radius:8px; font-size:1rem;">
                            </div>
                            <div>
                                <label style="color:#721c24; font-weight:bold; display:block; margin-bottom:5px;">√Årea/Departamento:</label>
                                <select id="areaDepartamento" style="width:100%; padding:12px; border:2px solid #dc3545; border-radius:8px; font-size:1rem;">
                                    <option value="">Seleccione √°rea</option>
                                    <option value="contact_center">Contact Center</option>
                                    <option value="atencion_medica">Atenci√≥n M√©dica</option>
                                    <option value="administracion">Administraci√≥n</option>
                                    <option value="farmacia">Farmacia</option>
                                    <option value="examenes">Ex√°menes</option>
                                    <option value="urgencias">Urgencias</option>
                                    <option value="hospitalizacion">Hospitalizaci√≥n</option>
                                    <option value="otro">Otro</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informaci√≥n Interna -->
                    <div style="background:#d1ecf1; border-radius:12px; padding:25px; margin-bottom:25px; border-left:5px solid #17a2b8;">
                        <h3 style="color:#0c5460; margin:0 0 20px 0; font-size:1.3em; display:flex; align-items:center; gap:10px;">
                            üè¢ Informaci√≥n Interna (ACHS)
                        </h3>
                        <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:15px;">
                            <div>
                                <label style="color:#0c5460; font-weight:bold; display:block; margin-bottom:5px;">Ejecutivo que Recibe:</label>
                                <input type="text" id="ejecutivoRecibe" placeholder="Nombre del ejecutivo" style="width:100%; padding:12px; border:2px solid #17a2b8; border-radius:8px; font-size:1rem;">
                            </div>
                            <div>
                                <label style="color:#0c5460; font-weight:bold; display:block; margin-bottom:5px;">N√∫mero de Caso:</label>
                                <input type="text" id="numeroCaso" placeholder="CASO-2024-XXXX" style="width:100%; padding:12px; border:2px solid #17a2b8; border-radius:8px; font-size:1rem;">
                            </div>
                        </div>
                        <div style="margin-bottom:15px;">
                            <label style="color:#0c5460; font-weight:bold; display:block; margin-bottom:5px;">Observaciones Internas:</label>
                            <textarea id="observacionesInternas" rows="3" placeholder="Observaciones adicionales para uso interno..." style="width:100%; padding:12px; border:2px solid #17a2b8; border-radius:8px; font-size:1rem; resize:vertical;"></textarea>
                        </div>
                        <div>
                            <label style="color:#0c5460; font-weight:bold; display:block; margin-bottom:5px;">Estado del Reclamo:</label>
                            <select id="estadoReclamo" style="width:100%; padding:12px; border:2px solid #17a2b8; border-radius:8px; font-size:1rem;">
                                <option value="recibido" selected>üì• Recibido</option>
                                <option value="en_proceso">‚è≥ En Proceso</option>
                                <option value="escalado">‚¨ÜÔ∏è Escalado</option>
                                <option value="resuelto">‚úÖ Resuelto</option>
                                <option value="cerrado">üîí Cerrado</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Botones de Acci√≥n -->
                    <div style="display:flex; gap:15px; justify-content:center; margin-top:30px; padding-top:20px; border-top:2px solid #dee2e6;">
                        <button onclick="limpiarFormularioReclamo()" style="background:linear-gradient(145deg, #6c757d, #545b62); color:white; border:none; padding:15px 30px; border-radius:10px; cursor:pointer; font-size:1.1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(108,117,125,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(108,117,125,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(108,117,125,0.3)'">
                            üßπ Limpiar Formulario
                        </button>
                        <button onclick="guardarReclamo()" style="background:linear-gradient(145deg, #ffc107, #e0a800); color:#856404; border:none; padding:15px 30px; border-radius:10px; cursor:pointer; font-size:1.1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(255,193,7,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255,193,7,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255,193,7,0.3)'">
                            üíæ Guardar Reclamo
                        </button>
                        <button onclick="enviarReclamoTeams()" style="background:linear-gradient(145deg, #6264A7, #464775); color:white; border:none; padding:15px 30px; border-radius:10px; cursor:pointer; font-size:1.1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(98,100,167,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(98,100,167,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(98,100,167,0.3)'">
                            üì§ Enviar por Teams
                        </button>
                        <button onclick="enviarReclamoEmail()" style="background:linear-gradient(145deg, #dc3545, #c82333); color:white; border:none; padding:15px 30px; border-radius:10px; cursor:pointer; font-size:1.1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(220,53,69,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(220,53,69,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(220,53,69,0.3)'">
                            üìß Enviar por Email
                        </button>
                    </div>
                </div>
            </div>
        </div>

    <!-- Modal Sistema de Respaldos -->
    <div id="modalRespaldo" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.6); z-index:2500; justify-content:center; align-items:center;">
        <div style="background:linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius:20px; padding:30px; max-width:900px; width:95%; max-height:90vh; overflow-y:auto; box-shadow:0 25px 50px rgba(111,66,193,0.4); border:4px solid #6f42c1; position:relative;">
            
            <!-- Bot√≥n de cerrar -->
            <div style="position:absolute; top:15px; right:15px;">
                <button onclick="cerrarModalRespaldo()" style="background:rgba(255,255,255,0.2); color:#6f42c1; border:2px solid #6f42c1; border-radius:50%; width:45px; height:45px; cursor:pointer; font-size:1.5em; font-weight:bold; transition:all 0.3s ease;" onmouseover="this.style.background='rgba(111,66,193,0.1)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">&times;</button>
            </div>
            
            <!-- Header del modal -->
            <div style="text-align:center; margin-bottom:30px; padding:20px 0; border-bottom:3px solid #6f42c1;">
                <h1 style="color:#6f42c1; margin:0; font-size:2.2em; font-weight:bold; text-shadow:2px 2px 4px rgba(111,66,193,0.2);">
                    üíæ SISTEMA DE RESPALDOS ACHS
                </h1>
                <p style="color:#6c757d; margin:10px 0 0; font-size:1.1em; font-weight:500;">
                    Gesti√≥n avanzada de backup y recuperaci√≥n de datos
                </p>
            </div>
            
            <!-- Estad√≠sticas del sistema -->
            <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:20px; margin-bottom:30px;">
                <div style="background:linear-gradient(145deg, #e3f2fd, #bbdefb); padding:20px; border-radius:12px; text-align:center; border:2px solid #2196f3;">
                    <div style="font-size:2em; color:#1976d2; margin-bottom:8px;">üìä</div>
                    <div style="font-size:1.8em; font-weight:bold; color:#1976d2;" id="totalRegistros">0</div>
                    <div style="color:#555; font-weight:500;">Registros Totales</div>
                </div>
                <div style="background:linear-gradient(145deg, #e8f5e8, #c8e6c9); padding:20px; border-radius:12px; text-align:center; border:2px solid #4caf50;">
                    <div style="font-size:2em; color:#388e3c; margin-bottom:8px;">üíæ</div>
                    <div style="font-size:1.8em; font-weight:bold; color:#388e3c;" id="ultimoRespaldo">Nunca</div>
                    <div style="color:#555; font-weight:500;">√öltimo Respaldo</div>
                </div>
                <div style="background:linear-gradient(145deg, #fff3e0, #ffe0b2); padding:20px; border-radius:12px; text-align:center; border:2px solid #ff9800;">
                    <div style="font-size:2em; color:#f57c00; margin-bottom:8px;">üìÅ</div>
                    <div style="font-size:1.8em; font-weight:bold; color:#f57c00;" id="tamanoData">0 KB</div>
                    <div style="color:#555; font-weight:500;">Tama√±o de Datos</div>
                </div>
            </div>
            
            <!-- Controles de respaldo -->
            <div style="background:#f8f9fa; border-radius:15px; padding:25px; margin-bottom:25px; border-left:6px solid #6f42c1;">
                <h3 style="color:#6f42c1; margin:0 0 20px; font-size:1.3em; font-weight:600;">üîß Controles de Respaldo</h3>
                
                <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:15px; margin-bottom:20px;">
                    <button onclick="crearRespaldoCompleto()" style="background:linear-gradient(145deg, #28a745, #20c997); color:white; border:none; padding:15px 20px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(40,167,69,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(40,167,69,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(40,167,69,0.3)'">
                        üì¶ Respaldo Completo
                    </button>
                    
                    <button onclick="crearRespaldoRapido()" style="background:linear-gradient(145deg, #007bff, #0056b3); color:white; border:none; padding:15px 20px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(0,123,255,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0,123,255,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,123,255,0.3)'">
                        ‚ö° Respaldo R√°pido
                    </button>
                    
                    <button onclick="programarRespaldoAutomatico()" style="background:linear-gradient(145deg, #ffc107, #e0a800); color:#212529; border:none; padding:15px 20px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(255,193,7,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255,193,7,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255,193,7,0.3)'">
                        ‚è∞ Programar Auto
                    </button>
                    
                    <button onclick="restaurarRespaldo()" style="background:linear-gradient(145deg, #dc3545, #c82333); color:white; border:none; padding:15px 20px; border-radius:10px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(220,53,69,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(220,53,69,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(220,53,69,0.3)'">
                        üîÑ Restaurar
                    </button>
                </div>
            </div>
            
            <!-- Configuraci√≥n de respaldo autom√°tico -->
            <div style="background:#e3f2fd; border-radius:15px; padding:25px; margin-bottom:25px; border-left:6px solid #2196f3;">
                <h3 style="color:#1976d2; margin:0 0 20px; font-size:1.3em; font-weight:600;">‚öôÔ∏è Configuraci√≥n Autom√°tica</h3>
                
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px;">
                    <div>
                        <label style="display:block; margin-bottom:8px; font-weight:600; color:#1976d2;">üìÖ Frecuencia:</label>
                        <select id="frecuenciaRespaldo" style="width:100%; padding:10px; border:2px solid #2196f3; border-radius:8px; font-size:1em;">
                            <option value="diario">Diario</option>
                            <option value="semanal" selected>Semanal</option>
                            <option value="mensual">Mensual</option>
                            <option value="manual">Solo Manual</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display:block; margin-bottom:8px; font-weight:600; color:#1976d2;">‚è∞ Hora:</label>
                        <input type="time" id="horaRespaldo" value="02:00" style="width:100%; padding:10px; border:2px solid #2196f3; border-radius:8px; font-size:1em;">
                    </div>
                </div>
                
                <div style="margin-bottom:15px;">
                    <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                        <input type="checkbox" id="notificarRespaldo" checked style="transform:scale(1.2);">
                        <span style="font-weight:500; color:#1976d2;">üìß Notificar cuando se complete el respaldo</span>
                    </label>
                </div>
                
                <div>
                    <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                        <input type="checkbox" id="comprimirRespaldo" checked style="transform:scale(1.2);">
                        <span style="font-weight:500; color:#1976d2;">üóúÔ∏è Comprimir respaldos para ahorrar espacio</span>
                    </label>
                </div>
            </div>
            
            <!-- Historial de respaldos -->
            <div style="background:#fff; border-radius:15px; padding:25px; border:2px solid #dee2e6;">
                <h3 style="color:#6f42c1; margin:0 0 20px; font-size:1.3em; font-weight:600;">üìã Historial de Respaldos</h3>
                
                <div style="overflow-x:auto; max-height:300px; overflow-y:auto;">
                    <table style="width:100%; border-collapse:collapse; font-size:0.9em;" id="tablaHistorialRespaldos">
                        <thead>
                            <tr style="background:#6f42c1; color:white;">
                                <th style="border:1px solid #6f42c1; padding:12px; text-align:left;">üìÖ Fecha</th>
                                <th style="border:1px solid #6f42c1; padding:12px; text-align:left;">üè∑Ô∏è Tipo</th>
                                <th style="border:1px solid #6f42c1; padding:12px; text-align:center;">üìä Registros</th>
                                <th style="border:1px solid #6f42c1; padding:12px; text-align:center;">üìÅ Tama√±o</th>
                                <th style="border:1px solid #6f42c1; padding:12px; text-align:center;">üéØ Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="historialRespaldosBody">
                            <tr>
                                <td colspan="5" style="text-align:center; padding:20px; color:#6c757d; font-style:italic;">
                                    No hay respaldos registrados
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Botones de acci√≥n -->
            <div style="display:flex; gap:15px; justify-content:center; margin-top:30px; flex-wrap:wrap;">
                <button onclick="exportarConfiguracion()" style="background:linear-gradient(145deg, #17a2b8, #138496); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(23,162,184,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(23,162,184,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(23,162,184,0.3)'">
                    üì§ Exportar Config
                </button>
                
                <button onclick="importarConfiguracion()" style="background:linear-gradient(145deg, #28a745, #1e7e34); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(40,167,69,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(40,167,69,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(40,167,69,0.3)'">
                    üì• Importar Config
                </button>
                
                <button onclick="limpiarHistorialRespaldos()" style="background:linear-gradient(145deg, #dc3545, #c82333); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(220,53,69,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(220,53,69,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(220,53,69,0.3)'">
                    üóëÔ∏è Limpiar Historial
                </button>
                
                <button onclick="cerrarModalRespaldo()" style="background:linear-gradient(145deg, #6c757d, #545b62); color:white; border:none; padding:12px 25px; border-radius:8px; cursor:pointer; font-size:1em; font-weight:600; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(108,117,125,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(108,117,125,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(108,117,125,0.3)'">
                    ‚ùå Cerrar
                </button>
            </div>
            
        </div>
    </div>

    <script>
    // ================ SISTEMA DE NOTIFICACIONES PUSH EN TIEMPO REAL ================
    
    // Variables globales del sistema de notificaciones
    let notificationsEnabled = true;
    let notificationSounds = false; // DESACTIVADO
    let notificationDuration = 5000; // 5 segundos
    let maxNotifications = 5;
    let notificationCount = 0;
    let notificationHistory = [];
    let notificationId = 0;
    let isNotificationsPanelOpen = false;
    
    // Configuraci√≥n de sonidos (DESACTIVADO)
    const notificationAudio = null; // document.getElementById('notificationSound');
    
    // Funci√≥n para inicializar el sistema de notificaciones
    function initNotificationSystem() {
        console.log('üîî Inicializando sistema de notificaciones push');
        
        // (Desactivado) Solicitar permisos de notificaci√≥n del navegador
        // No se solicita permiso para evitar el popup
        
        // Cargar configuraci√≥n guardada
        loadNotificationSettings();
        
        // Configurar event listeners
        setupNotificationListeners();
        
        // Iniciar notificaciones de prueba para tareas importantes (DESACTIVADO)
        // startImportantTaskMonitoring();
        
        console.log('‚úÖ Sistema de notificaciones inicializado (notificaciones autom√°ticas desactivadas)');
    }
    
    // Funci√≥n para cargar configuraci√≥n
    function loadNotificationSettings() {
        const settings = localStorage.getItem('notificationSettings');
        if (settings) {
            const config = JSON.parse(settings);
            notificationsEnabled = config.enabled !== false;
            notificationSounds = config.sounds !== false;
            notificationDuration = config.duration || 5000;
            maxNotifications = config.maxNotifications || 5;
            
            // Actualizar UI
            document.getElementById('enableNotifications').checked = notificationsEnabled;
            document.getElementById('enableSounds').checked = notificationSounds;
            document.getElementById('notificationDuration').value = notificationDuration / 1000;
            document.getElementById('maxNotifications').value = maxNotifications;
        }
    }
    
    // Funci√≥n para guardar configuraci√≥n
    function saveNotificationSettings() {
        const settings = {
            enabled: document.getElementById('enableNotifications').checked,
            sounds: document.getElementById('enableSounds').checked,
            duration: parseInt(document.getElementById('notificationDuration').value) * 1000,
            maxNotifications: parseInt(document.getElementById('maxNotifications').value)
        };
        
        notificationsEnabled = settings.enabled;
        notificationSounds = settings.sounds;
        notificationDuration = settings.duration;
        maxNotifications = settings.maxNotifications;
        
        localStorage.setItem('notificationSettings', JSON.stringify(settings));
        
        showNotification('‚úÖ Configuraci√≥n guardada', 'La configuraci√≥n de notificaciones ha sido actualizada.', 'success');
        closeNotificationSettings();
        
        console.log('üíæ Configuraci√≥n de notificaciones guardada:', settings);
    }
    
    // Funci√≥n principal para mostrar notificaciones
    function showNotification(title, message, type = 'info', isUrgent = false, actions = null) {
        if (!notificationsEnabled) return;
        
        const id = ++notificationId;
        const timestamp = new Date();
        
        const notification = {
            id: id,
            title: title,
            message: message,
            type: type,
            isUrgent: isUrgent,
            timestamp: timestamp,
            actions: actions,
            read: false
        };
        
        // Agregar a historial
        notificationHistory.unshift(notification);
        if (notificationHistory.length > 100) {
            notificationHistory = notificationHistory.slice(0, 100);
        }
        
        // Crear toast notification
        createToastNotification(notification);
        
        // Reproducir sonido si est√° habilitado
        if (notificationSounds) {
            playNotificationSound();
        }
        
        // Mostrar notificaci√≥n del navegador si es urgente
        if (isUrgent && 'Notification' in window && Notification.permission === 'granted') {
            new Notification(title, {
                body: message,
                icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJDMTMuMSAyIDE0IDIuOSAxNCA0VjVDMTcuMyA2LjcgMTkuOCAxMC4xIDE5LjggMTRWMjBMMjIgMjJIMlYyMEw0LjIgMTRDNC4yIDEwLjEgNi43IDYuNyAxMCA1VjRDMTAgMi45IDEwLjkgMiAxMiAyWiIgZmlsbD0iIzAwN2JmZiIvPgo8L3N2Zz4K',
                badge: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJDMTMuMSAyIDE0IDIuOSAxNCA0VjVDMTcuMyA2LjcgMTkuOCAxMC4xIDE5LjggMTRWMjBMMjIgMjJIMlYyMEw0LjIgMTRDNC4yIDEwLjEgNi43IDYuNyAxMCA1VjRDMTAgMi45IDEwLjkgMiAxMiAyWiIgZmlsbD0iI2ZmNmI2YiIvPgo8L3N2Zz4K'
            });
        }
        
        // Actualizar contador
        updateNotificationCount();
        
        // Actualizar panel
        updateNotificationsPanel();
        
        console.log(`üîî Notificaci√≥n mostrada: ${title} (${type})`);
        
        return id;
    }
    
    // Funci√≥n para crear toast notification
    function createToastNotification(notification) {
        const container = document.getElementById('notificationsContainer');
        
        // Limitar n√∫mero de notificaciones
        const existing = container.querySelectorAll('.notification-toast:not(.hide)');
        if (existing.length >= maxNotifications) {
            removeToastNotification(existing[0]);
        }
        
        const toast = document.createElement('div');
        toast.className = `notification-toast ${notification.type}${notification.isUrgent ? ' urgent' : ''}`;
        toast.setAttribute('data-notification-id', notification.id);
        
        const progressDuration = notification.isUrgent ? notificationDuration * 2 : notificationDuration;
        
        toast.innerHTML = `
            <div class="notification-header">
                <h4 class="notification-title">${notification.title}</h4>
                <button class="notification-close" onclick="removeToastNotification(this.closest('.notification-toast'))">&times;</button>
            </div>
            <div class="notification-body">${notification.message}</div>
            <div class="notification-footer">
                <span class="notification-time">${formatTime(notification.timestamp)}</span>
                ${notification.actions ? `
                    <div class="notification-actions">
                        ${notification.actions.map(action => 
                            `<button class="notification-action ${action.type || ''}" onclick="${action.onclick || ''}">${action.text}</button>`
                        ).join('')}
                    </div>
                ` : ''}
            </div>
            <div class="notification-progress">
                <div style="animation-duration: ${progressDuration}ms;"></div>
            </div>
        `;
        
        container.appendChild(toast);
        
        // Animaci√≥n de entrada
        setTimeout(() => toast.classList.add('show'), 10);
        
        // Auto-dismiss despu√©s del tiempo configurado
        if (!notification.isUrgent) {
            setTimeout(() => removeToastNotification(toast), progressDuration);
        }
    }
    
    // Funci√≥n para remover toast notification
    function removeToastNotification(toastElement) {
        if (!toastElement) return;
        
        toastElement.classList.add('hide');
        setTimeout(() => {
            if (toastElement.parentNode) {
                toastElement.parentNode.removeChild(toastElement);
            }
        }, 500);
    }
    
    // Funci√≥n para reproducir sonido (DESACTIVADO)
    function playNotificationSound() {
        // Sonidos completamente desactivados
        return;
    }
    
    // Funci√≥n para actualizar contador
    function updateNotificationCount() {
        const unreadCount = notificationHistory.filter(n => !n.read).length;
        notificationCount = unreadCount;
        
        const badge = document.getElementById('notificationBadge');
        if (unreadCount > 0) {
            badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
            badge.style.display = 'flex';
        } else {
            badge.style.display = 'none';
        }
    }
    
    // Funci√≥n para toggle del panel de notificaciones
    function toggleNotificationsPanel() {
        const panel = document.getElementById('notificationsPanel');
        isNotificationsPanelOpen = !isNotificationsPanelOpen;
        
        if (isNotificationsPanelOpen) {
            panel.classList.add('open');
            // Marcar notificaciones como le√≠das
            notificationHistory.forEach(n => n.read = true);
            updateNotificationCount();
            updateNotificationsPanel();
        } else {
            panel.classList.remove('open');
        }
    }
    
    // Funci√≥n para actualizar panel de notificaciones
    function updateNotificationsPanel() {
        const list = document.getElementById('notificationsList');
        if (!list) return;

        if (notificationHistory.length === 0) {
            list.innerHTML = `
                <div style="text-align: center; color: #6c757d; padding: 40px 20px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">üîï</div>
                    <p>No hay notificaciones</p>
                    <p style="font-size: 12px;">Las notificaciones aparecer√°n aqu√≠</p>
                </div>
            `;
            return;
        }
        
        list.innerHTML = notificationHistory.map(notification => `
            <div class="notification-item ${!notification.read ? 'unread' : ''}" onclick="markAsRead(${notification.id})">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                    <h5 style="margin: 0; font-size: 14px; color: #2c3e50;">${getTypeIcon(notification.type)} ${notification.title}</h5>
                    <small style="color: #6c757d; font-size: 11px;">${formatTime(notification.timestamp)}</small>
                </div>
                <p style="margin: 0; font-size: 13px; color: #495057; line-height: 1.4;">${notification.message}</p>
                ${notification.isUrgent ? '<div style="margin-top: 8px;"><span style="background: #fd7e14; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">üö® URGENTE</span></div>' : ''}
            </div>
        `).join('');
    }
    
    // Funci√≥n para obtener icono por tipo
    function getTypeIcon(type) {
        const icons = {
            success: '‚úÖ',
            warning: '‚ö†Ô∏è',
            error: '‚ùå',
            info: '‚ÑπÔ∏è',
            urgent: 'üö®'
        };
        return icons[type] || '‚ÑπÔ∏è';
    }
    
    // Funci√≥n para formatear tiempo
    function formatTime(date) {
        const now = new Date();
        const diff = now - date;
        
        if (diff < 60000) return 'Ahora';
        if (diff < 3600000) return `${Math.floor(diff / 60000)}m`;
        if (diff < 86400000) return `${Math.floor(diff / 3600000)}h`;
        return date.toLocaleDateString();
    }
    
    // Funci√≥n para marcar como le√≠da
    function markAsRead(id) {
        const notification = notificationHistory.find(n => n.id === id);
        if (notification) {
            notification.read = true;
            updateNotificationCount();
            updateNotificationsPanel();
        }
    }
    
    // Funci√≥n para limpiar todas las notificaciones
    function clearAllNotifications() {
        if (confirm('¬øEst√°s seguro de que quieres limpiar todas las notificaciones?')) {
            notificationHistory = [];
            updateNotificationCount();
            updateNotificationsPanel();
            
            // Limpiar toasts
            const container = document.getElementById('notificationsContainer');
            const toasts = container.querySelectorAll('.notification-toast');
            toasts.forEach(toast => removeToastNotification(toast));
            
            showNotification('üßπ Notificaciones limpiadas', 'Se han eliminado todas las notificaciones.', 'info');
        }
    }
    
    // Funci√≥n para abrir configuraci√≥n
    function openNotificationSettings() {
        const settings = document.getElementById('notificationSettings');
        const overlay = document.getElementById('notificationOverlay');
        
        settings.classList.add('show');
        overlay.style.display = 'block';
        
        // Actualizar valores en la UI
        document.getElementById('durationValue').textContent = document.getElementById('notificationDuration').value + 's';
        
        // Event listeners para el slider
        document.getElementById('notificationDuration').addEventListener('input', function() {
            document.getElementById('durationValue').textContent = this.value + 's';
        });
    }
    
    // Funci√≥n para cerrar configuraci√≥n
    function closeNotificationSettings() {
        const settings = document.getElementById('notificationSettings');
        const overlay = document.getElementById('notificationOverlay');
        
        settings.classList.remove('show');
        overlay.style.display = 'none';
    }
    
    // Funci√≥n para restablecer configuraci√≥n
    function resetNotificationSettings() {
        document.getElementById('enableNotifications').checked = true;
        document.getElementById('enableSounds').checked = true;
        document.getElementById('notificationDuration').value = 5;
        document.getElementById('maxNotifications').value = 5;
        document.getElementById('durationValue').textContent = '5s';
    }
    
    // Funci√≥n para probar sonido
    function testNotificationSound() {
        playNotificationSound();
        showNotification('üîä Prueba de sonido', 'Este es el sonido que escuchar√°s con las notificaciones.', 'info');
    }
    
    // Funci√≥n para configurar event listeners
    function setupNotificationListeners() {
        // Cerrar panel al hacer clic fuera
        document.addEventListener('click', function(e) {
            const panel = document.getElementById('notificationsPanel');
            const icon = document.getElementById('notificationIcon');
            
            if (isNotificationsPanelOpen && !panel.contains(e.target) && !icon.contains(e.target)) {
                toggleNotificationsPanel();
            }
        });
        
        // Teclas de acceso r√°pido
        document.addEventListener('keydown', function(e) {
            // Ctrl + Shift + N para toggle de notificaciones
            if (e.ctrlKey && e.shiftKey && e.key === 'N') {
                e.preventDefault();
                toggleNotificationsPanel();
            }
        });
    }
    
    // Funci√≥n para monitorear tareas importantes
    function startImportantTaskMonitoring() {
        // Ejemplos de notificaciones para tareas importantes del sistema ACHS
        
        // Notificaci√≥n de bienvenida
        setTimeout(() => {
            showNotification(
                'üéâ Sistema ACHS Iniciado',
                'Bienvenido al Panel de Gesti√≥n Ejecutivo. Sistema de notificaciones activado.',
                'success',
                false,
                [{text: 'üëç Entendido', onclick: 'markAsRead(' + (notificationId + 1) + ')'}]
            );
        }, 2000);
        
        // Recordatorio de tareas pendientes cada 30 minutos
        setInterval(() => {
            const pendientes = document.querySelectorAll('[data-pendiente="true"]').length;
            if (pendientes > 0) {
                showNotification(
                    'üìã Tareas Pendientes',
                    `Tienes ${pendientes} tarea(s) pendiente(s) por revisar.`,
                    'warning',
                    false,
                    [
                        {text: 'üìù Ver', onclick: 'mostrarPendientes()', type: 'primary'},
                        {text: '‚è∞ Recordar m√°s tarde', onclick: 'snoozeReminder()', type: 'secondary'}
                    ]
                );
            }
        }, 1800000); // 30 minutos
        
        // Monitorear formularios sin guardar
        let formChanged = false;
        const formInputs = document.querySelectorAll('input, select, textarea');
        formInputs.forEach(input => {
            input.addEventListener('change', () => {
                formChanged = true;
                // Advertir si hay cambios sin guardar despu√©s de 5 minutos
                setTimeout(() => {
                    if (formChanged) {
                        showNotification(
                            '‚ö†Ô∏è Cambios sin Guardar',
                            'Tienes cambios en el formulario que no has guardado.',
                            'warning',
                            false,
                            [
                                {text: 'üíæ Guardar', onclick: 'grabar()', type: 'primary'},
                                {text: '‚ùå Descartar', onclick: 'resetForm()', type: 'secondary'}
                            ]
                        );
                    }
                }, 300000); // 5 minutos
            });
        });
        
        // Notificaciones sobre RUTs inv√°lidos
        const rutInput = document.getElementById('rut');
        if (rutInput) {
            rutInput.addEventListener('blur', function() {
                const rut = this.value.trim();
                if (rut && !validarRut(rut)) {
                    showNotification(
                        '‚ùå RUT Inv√°lido',
                        'El RUT ingresado no tiene un formato v√°lido. Por favor verifica.',
                        'error',
                        true
                    );
                }
            });
        }
        
        // Notificaciones de recordatorio para citas importantes
        setInterval(() => {
            const ahora = new Date();
            const horaActual = ahora.getHours();
            
            // Recordatorio de almuerzo
            if (horaActual === 12 && ahora.getMinutes() === 0) {
                showNotification(
                    'üçΩÔ∏è Hora de Almuerzo',
                    'Es hora de tu descanso. Recuerda mantener un horario saludable.',
                    'info'
                );
            }
            
            // Recordatorio de fin de jornada
            if (horaActual === 17 && ahora.getMinutes() === 30) {
                showNotification(
                    'üïê Fin de Jornada',
                    'Tu jornada laboral est√° terminando. Revisa tus tareas pendientes.',
                    'info',
                    false,
                    [{text: 'üìä Ver Resumen', onclick: 'showDailySummary()'}]
                );
            }
        }, 60000); // Cada minuto
        
        console.log('üìä Monitoreo de tareas importantes iniciado');
    }
    
    // Deshabilitar inicio autom√°tico de notificaciones
    // startImportantTaskMonitoring();
    
    // Funciones auxiliares para las notificaciones
    function snoozeReminder() {
        showNotification('‚è∞ Recordatorio Pospuesto', 'Te recordaremos nuevamente en 15 minutos.', 'info');
        setTimeout(() => {
            showNotification('üîî Recordatorio', 'A√∫n tienes tareas pendientes por revisar.', 'warning');
        }, 900000); // 15 minutos
    }
    
    function showDailySummary() {
        const totalRegistros = document.querySelectorAll('#historial tbody tr').length;
        const pendientes = document.querySelectorAll('[data-pendiente="true"]').length;
        
        showNotification(
            'üìà Resumen del D√≠a',
            `Registros procesados: ${totalRegistros} | Pendientes: ${pendientes}`,
            'info',
            false,
            [{text: 'üìä Ver Detalles', onclick: 'openDetailedReport()'}]
        );
    }
    
    function resetForm() {
        if (confirm('¬øEst√°s seguro de que quieres descartar los cambios?')) {
            document.querySelector('form').reset();
            formChanged = false;
            showNotification('üîÑ Formulario Reiniciado', 'Los cambios han sido descartados.', 'info');
        }
    }
    
    // Funci√≥n para validar RUT (simple)
    function validarRut(rut) {
        // Eliminar puntos y gui√≥n
        rut = rut.replace(/\./g, '').replace(/-/g, '');
        
        // Verificar formato b√°sico
        if (rut.length < 8 || rut.length > 9) return false;
        
        // Extraer d√≠gito verificador
        const dv = rut.slice(-1).toLowerCase();
        const numero = rut.slice(0, -1);
        
        // Calcular d√≠gito verificador
        let suma = 0;
        let multiplicador = 2;
        
        for (let i = numero.length - 1; i >= 0; i--) {
            suma += parseInt(numero[i]) * multiplicador;
            multiplicador = multiplicador === 7 ? 2 : multiplicador + 1;
        }
        
        const resto = suma % 11;
        const dvCalculado = resto === 0 ? '0' : resto === 1 ? 'k' : (11 - resto).toString();
        
        return dv === dvCalculado;
    }
    
    // FUNCI√ìN PARA BOT√ìN CARPETA - DEFINIDA INMEDIATAMENTE
    function abrirModalCarpeta() {
        console.log('üîÑ Funci√≥n abrirModalCarpeta ejecutada');
        
        const modal = document.getElementById('modalPdf');
        if (modal) {
            modal.style.display = 'flex';
            console.log('‚úÖ Modal PDF abierto correctamente');
            
            // Cargar documentos si existen
            cargarDocumentosGuardados();
            actualizarListaDocumentos();
        } else {
            console.error('‚ùå Modal modalPdf no encontrado');
            alert('‚ùå Error: Modal no encontrado');
        }
    }

    // FUNCI√ìN DE PRUEBA GLOBAL
    function testGlobal() {
        alert('‚úÖ JavaScript funcionando correctamente');
        console.log('‚úÖ Test ejecutado correctamente');
    }

    // FUNCI√ìN PARA BOT√ìN OUTBOUND
    function abrirOutbound() {

    }

    // FUNCI√ìN PARA BOT√ìN TERAPIA F√çSICA
    function abrirTerapiaFisica() {
        console.log('üîÑ Abriendo enlace TERAPIA F√çSICA');
        const url = 'https://docs.google.com/spreadsheets/d/17QUP9LFgIzqDBuc1j6oYi-kh8hyECIos/edit?usp=drive_link&ouid=109971191188208299343&rtpof=true&sd=true';
        window.open(url, '_blank');
        console.log('‚úÖ Enlace TERAPIA F√çSICA abierto en nueva pesta√±a');
    }

    // FUNCI√ìN PARA BOT√ìN DIRECCI√ìN
    function abrirDireccion() {
        console.log('üîÑ Abriendo enlace DIRECCI√ìN');
        const url = 'https://www.achs.cl/nosotros/ubicacion';
        window.open(url, '_blank');
        console.log('‚úÖ Enlace DIRECCI√ìN abierto en nueva pesta√±a');
    }

    // FUNCI√ìN PARA BOT√ìN ATENCI√ìN
    function abrirModalAtencion() {
        console.log('üîÑ Abriendo modal de ATENCI√ìN');
        const modal = document.getElementById('modalAtencion');
        if (modal) {
            modal.style.display = 'flex';
            // Establecer fecha y hora actual
            const ahora = new Date();
            const fechaLocal = new Date(ahora.getTime() - (ahora.getTimezoneOffset() * 60000));
            document.getElementById('fechaAtencion').value = fechaLocal.toISOString().slice(0, 16);
            cargarRegistrosAtencion();
            console.log('‚úÖ Modal de ATENCI√ìN abierto');
        } else {
            console.error('‚ùå Modal de ATENCI√ìN no encontrado');
        }
    }

    function cerrarModalAtencion() {
        console.log('üîÑ Cerrando modal de ATENCI√ìN');
        const modal = document.getElementById('modalAtencion');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de ATENCI√ìN cerrado');
        }
    }

    // Variables globales
    let documentosGuardados = [];
    let historialRegistros = [];
    let registrosAtencion = [];
    let alertasProgramadas = [];
    let intervalosAlerta = [];
    let tareasPendientes = [];
    let intervalosRecordatorio = [];
    let bandejaEmails = [];
    let emailsBorradores = [];
    let configuracionEmail = {
        servidor: 'outlook.office365.com',
        puerto: 993,
        usuario: '',
        activo: false
    };

    // Variables del calendario
    let fechaActualCalendario = new Date();
    let tooltipFeriado = null;

    // Feriados chilenos 2025
    const feriadosChilenos = {
        '2025-01-01': 'A√±o Nuevo',
        '2025-04-18': 'Viernes Santo',
        '2025-04-19': 'S√°bado Santo',
        '2025-05-01': 'D√≠a del Trabajador',
        '2025-05-21': 'D√≠a de las Glorias Navales',
        '2025-06-26': 'San Pedro y San Pablo',
        '2025-07-16': 'D√≠a de la Virgen del Carmen',
        '2025-08-15': 'Asunci√≥n de la Virgen',
        '2025-09-18': 'Independencia Nacional',
        '2025-09-19': 'D√≠a de las Glorias del Ej√©rcito',
        '2025-10-12': 'Encuentro de Dos Mundos',
        '2025-10-31': 'D√≠a de las Iglesias Evang√©licas',
        '2025-11-01': 'D√≠a de Todos los Santos',
        '2025-12-08': 'Inmaculada Concepci√≥n',
        '2025-12-25': 'Navidad'
    };

    // ============ FUNCIONES DEL RELOJ Y CALENDARIO ============
    
    // Funci√≥n para actualizar el reloj
    function actualizarReloj() {
        const ahora = new Date();
        
        // Actualizar reloj digital
        const horas = ahora.getHours().toString().padStart(2, '0');
        const minutos = ahora.getMinutes().toString().padStart(2, '0');
        const segundos = ahora.getSeconds().toString().padStart(2, '0');
        
        const relojElement = document.getElementById('relojDigital');
        if (relojElement) {
            relojElement.textContent = `${horas}:${minutos}:${segundos}`;
        }
        
        // Actualizar reloj compacto
        const relojCompacto = document.getElementById('reloj-compacto');
        if (relojCompacto) {
            relojCompacto.textContent = `${horas}:${minutos}:${segundos}`;
        }
        
        // Actualizar fecha
        const diasSemana = ['Domingo', 'Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado'];
        const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 
                      'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
        
        const diaSemana = diasSemana[ahora.getDay()];
        const dia = ahora.getDate();
        const mes = meses[ahora.getMonth()];
        const ano = ahora.getFullYear();
        
        const fechaElement = document.getElementById('fechaActual');
        if (fechaElement) {
            fechaElement.textContent = `${diaSemana}, ${dia} de ${mes} de ${ano}`;
        }
        
        // Actualizar fecha compacta
        const fechaCompacta = document.getElementById('fecha-compacta');
        if (fechaCompacta) {
            fechaCompacta.textContent = `${diaSemana}, ${dia} de ${mes} de ${ano}`;
        }
    }
    
    // Funci√≥n para generar el calendario
    function generarCalendario(fecha = new Date()) {
        const cuerpoCalendario = document.getElementById('cuerpoCalendario');
        const mesAnoElement = document.getElementById('mesAnoActual');
        
        if (!cuerpoCalendario || !mesAnoElement) return;
        
        const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                      'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
        
        const ano = fecha.getFullYear();
        const mes = fecha.getMonth();
        
        // Actualizar t√≠tulo del mes
        mesAnoElement.textContent = `${meses[mes]} ${ano}`;
        
        // Limpiar calendario
        cuerpoCalendario.innerHTML = '';
        
        // Primer d√≠a del mes y √∫ltimo d√≠a del mes anterior
        const primerDia = new Date(ano, mes, 1);
        const ultimoDia = new Date(ano, mes + 1, 0);
        const diasEnMes = ultimoDia.getDate();
        const diaSemanaInicio = primerDia.getDay();
        
        // D√≠as del mes anterior para completar la primera semana
        const ultimoDiaMesAnterior = new Date(ano, mes, 0).getDate();
        
        let diaActual = 1;
        let diaSiguienteMes = 1;
        
        // Generar 6 semanas (42 d√≠as)
        for (let semana = 0; semana < 6; semana++) {
            const fila = cuerpoCalendario.insertRow();
            
            for (let diaSemana = 0; diaSemana < 7; diaSemana++) {
                const celda = fila.insertCell();
                celda.className = 'calendario-dia';
                
                let diaTexto = '';
                let fechaCompleta = '';
                let esOtroMes = false;
                
                if (semana === 0 && diaSemana < diaSemanaInicio) {
                    // D√≠as del mes anterior
                    diaTexto = ultimoDiaMesAnterior - (diaSemanaInicio - diaSemana - 1);
                    fechaCompleta = `${ano}-${(mes).toString().padStart(2, '0')}-${diaTexto.toString().padStart(2, '0')}`;
                    esOtroMes = true;
                } else if (diaActual <= diasEnMes) {
                    // D√≠as del mes actual
                    diaTexto = diaActual;
                    fechaCompleta = `${ano}-${(mes + 1).toString().padStart(2, '0')}-${diaActual.toString().padStart(2, '0')}`;
                    diaActual++;
                } else {
                    // D√≠as del mes siguiente
                    diaTexto = diaSiguienteMes;
                    fechaCompleta = `${ano}-${(mes + 2).toString().padStart(2, '0')}-${diaSiguienteMes.toString().padStart(2, '0')}`;
                    diaSiguienteMes++;
                    esOtroMes = true;
                }
                
                celda.textContent = diaTexto;
                
                // Aplicar clases CSS
                if (esOtroMes) {
                    celda.classList.add('dia-otro-mes');
                }
                
                // Marcar d√≠a actual
                const hoy = new Date();
                if (!esOtroMes && 
                    diaTexto == hoy.getDate() && 
                    mes == hoy.getMonth() && 
                    ano == hoy.getFullYear()) {
                    celda.classList.add('dia-actual');
                }
                
                // Marcar fines de semana
                if (diaSemana === 0 || diaSemana === 6) {
                    celda.classList.add('dia-fin-semana');
                }
                
                // Marcar feriados
                if (feriadosChilenos[fechaCompleta]) {
                    celda.classList.add('dia-feriado');
                    celda.dataset.feriado = feriadosChilenos[fechaCompleta];
                    
                    // Agregar eventos de tooltip
                    celda.addEventListener('mouseenter', mostrarTooltipFeriado);
                    celda.addEventListener('mouseleave', ocultarTooltipFeriado);
                }
                
                // Evento click
                celda.addEventListener('click', function() {
                    if (!esOtroMes) {
                        seleccionarDia(this, fechaCompleta);
                    }
                });
            }
        }
        
        // Actualizar pr√≥ximos feriados
        actualizarProximosFeriados();
    }
    
    // Funci√≥n para mostrar tooltip de feriado
    function mostrarTooltipFeriado(event) {
        if (tooltipFeriado) {
            document.body.removeChild(tooltipFeriado);
        }
        
        tooltipFeriado = document.createElement('div');
        tooltipFeriado.className = 'tooltip-feriado';
        tooltipFeriado.textContent = event.target.dataset.feriado;
        tooltipFeriado.style.opacity = '1';
        
        document.body.appendChild(tooltipFeriado);
        
        const rect = event.target.getBoundingClientRect();
        tooltipFeriado.style.left = (rect.left + rect.width / 2 - tooltipFeriado.offsetWidth / 2) + 'px';
        tooltipFeriado.style.top = (rect.top - tooltipFeriado.offsetHeight - 10) + 'px';
    }
    
    // Funci√≥n para ocultar tooltip de feriado
    function ocultarTooltipFeriado() {
        if (tooltipFeriado) {
            tooltipFeriado.style.opacity = '0';
            setTimeout(() => {
                if (tooltipFeriado && tooltipFeriado.parentNode) {
                    document.body.removeChild(tooltipFeriado);
                    tooltipFeriado = null;
                }
            }, 300);
        }
    }
    
    // Funci√≥n para seleccionar un d√≠a
    function seleccionarDia(celda, fecha) {
        // Remover selecci√≥n anterior
        const seleccionAnterior = document.querySelector('.calendario-dia.seleccionado');
        if (seleccionAnterior) {
            seleccionAnterior.classList.remove('seleccionado');
        }
        
        // Agregar nueva selecci√≥n
        celda.classList.add('seleccionado');
        
        // Mostrar informaci√≥n del d√≠a
        const esFeriado = feriadosChilenos[fecha];
        if (esFeriado) {
            mostrarMensajeTemp(`üéä ${esFeriado}`, '#e91e63');
        } else {
            const fechaObj = new Date(fecha);
            const opciones = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const fechaTexto = fechaObj.toLocaleDateString('es-CL', opciones);
            mostrarMensajeTemp(`üìÖ ${fechaTexto}`, '#007bff');
        }
    }
    
    // Funci√≥n para actualizar pr√≥ximos feriados
    function actualizarProximosFeriados() {
        const proximosElement = document.getElementById('proximosFeriados');
        if (!proximosElement) return;
        
        const hoy = new Date();
        const proximosFeriados = [];
        
        for (const [fecha, nombre] of Object.entries(feriadosChilenos)) {
            const fechaFeriado = new Date(fecha);
            if (fechaFeriado >= hoy) {
                proximosFeriados.push({ fecha: fechaFeriado, nombre });
            }
        }
        
        proximosFeriados.sort((a, b) => a.fecha - b.fecha);
        
        proximosElement.innerHTML = '';
        
        const primerosTres = proximosFeriados.slice(0, 3);
        primerosTres.forEach(feriado => {
            const div = document.createElement('div');
            div.style.cssText = 'margin-bottom: 5px; padding: 3px 0; border-bottom: 1px solid #eee;';
            
            const diasRestantes = Math.ceil((feriado.fecha - hoy) / (1000 * 60 * 60 * 24));
            const fechaTexto = feriado.fecha.toLocaleDateString('es-CL', { day: 'numeric', month: 'short' });
            
            div.innerHTML = `
                <div style="font-weight: bold; color: #e91e63;">${feriado.nombre}</div>
                <div style="color: #666; font-size: 0.7em;">${fechaTexto} (${diasRestantes} d√≠as)</div>
            `;
            
            proximosElement.appendChild(div);
        });
    }
    
    // Funci√≥n para navegar meses
    function cambiarMes(direccion) {
        fechaActualCalendario.setMonth(fechaActualCalendario.getMonth() + direccion);
        generarCalendario(fechaActualCalendario);
    }
    
    // Funci√≥n para ir al d√≠a de hoy
    function irAHoy() {
        fechaActualCalendario = new Date();
        generarCalendario(fechaActualCalendario);
    }
    
    // Funci√≥n para configurar eventos del calendario
    function configurarEventosCalendario() {
        const mesAnterior = document.getElementById('mesAnterior');
        const mesSiguiente = document.getElementById('mesSiguiente');
        const hoyBtn = document.getElementById('hoyBtn');
        
        if (mesAnterior) {
            mesAnterior.addEventListener('click', () => cambiarMes(-1));
        }
        
        if (mesSiguiente) {
            mesSiguiente.addEventListener('click', () => cambiarMes(1));
        }
        
        if (hoyBtn) {
            hoyBtn.addEventListener('click', irAHoy);
        }
        
        // Generar calendario inicial
        generarCalendario();
        
        console.log('‚úÖ Eventos del calendario configurados');
    }

    // ============ FUNCIONES DEL HISTORIAL DE REGISTROS ============
    
    // Funci√≥n para cargar historial desde localStorage
    function cargarHistorialGuardado() {
        try {
            console.log('üîÑ Cargando historial desde localStorage...');
            const datos = localStorage.getItem('historialRegistrosAchs');
            if (datos && datos !== 'null' && datos !== 'undefined') {
                historialRegistros = JSON.parse(datos);
                console.log('‚úÖ Historial cargado desde localStorage. Total:', historialRegistros.length);
                actualizarTablaHistorial();
                return true;
            }
            console.log('‚ÑπÔ∏è No hay registros de historial guardados');
            historialRegistros = [];
            return false;
        } catch (e) {
            console.error('‚ùå Error al cargar historial:', e);
            historialRegistros = [];
            return false;
        }
    }

    // Funci√≥n para guardar historial en localStorage
    function guardarHistorialEnStorage() {
        try {
            localStorage.setItem('historialRegistrosAchs', JSON.stringify(historialRegistros));
            console.log('‚úÖ Historial guardado en localStorage. Total:', historialRegistros.length);
        } catch (e) {
            console.error('‚ùå Error al guardar historial:', e);
            alert('Error al guardar los registros. El almacenamiento puede estar lleno.');
        }
    }

    // Funci√≥n para actualizar la tabla del historial
    function actualizarTablaHistorial() {
        const tabla = document.getElementById('historial');
        if (!tabla) {
            console.warn('‚ö†Ô∏è Tabla historial no encontrada');
            return;
        }
        
        const tbody = tabla.getElementsByTagName('tbody')[0];
        if (!tbody) {
            console.warn('‚ö†Ô∏è tbody de tabla historial no encontrado');
            return;
        }
        
        tbody.innerHTML = ''; // Limpiar tabla
        
        if (historialRegistros.length === 0) {
            console.log('‚ÑπÔ∏è No hay registros para mostrar');
            return;
        }
        
        // Mostrar registros ordenados por fecha de creaci√≥n (m√°s recientes primero)
        const registrosOrdenados = [...historialRegistros].sort((a, b) => {
            const fechaA = new Date(a.fechaCreacion || a.fecha);
            const fechaB = new Date(b.fechaCreacion || b.fecha);
            return fechaB - fechaA; // M√°s recientes primero
        });
        
        console.log(`üìã Mostrando ${registrosOrdenados.length} registros en la tabla`);
        
        registrosOrdenados.forEach((registro, index) => {
            const fila = tbody.insertRow();
            
            // Agregar efecto hover
            fila.style.transition = 'all 0.3s ease';
            fila.onmouseover = function() {
                this.style.background = '#f8f9fa';
                this.style.transform = 'translateX(5px)';
            };
            fila.onmouseout = function() {
                this.style.background = index % 2 === 0 ? '#ffffff' : '#f9f9f9';
                this.style.transform = 'translateX(0)';
            };
            
            // Color alternado para filas
            fila.style.background = index % 2 === 0 ? '#ffffff' : '#f9f9f9';
            
            // Celdas con datos
            fila.insertCell(0).innerText = registro.fecha;
            fila.insertCell(1).innerText = registro.rut;
            fila.insertCell(2).innerText = registro.nombre;
            fila.insertCell(3).innerText = registro.motivo;
            fila.insertCell(4).innerText = registro.submotivo;
            fila.insertCell(5).innerText = registro.observacion;
            
            // Celda de eliminar
            const celdaEliminar = fila.insertCell(6);
            celdaEliminar.style.textAlign = 'center';
            
            const btnEliminar = document.createElement('button');
            btnEliminar.innerText = "üóëÔ∏è";
            btnEliminar.title = "Eliminar este registro";
            btnEliminar.style.cssText = `
                background: #dc3545;
                color: white;
                border: none;
                padding: 5px 8px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 0.9em;
                transition: all 0.3s ease;
            `;
            
            btnEliminar.onmouseover = function() {
                this.style.background = '#c82333';
                this.style.transform = 'scale(1.1)';
            };
            
            btnEliminar.onmouseout = function() {
                this.style.background = '#dc3545';
                this.style.transform = 'scale(1)';
            };
            
            btnEliminar.onclick = function() {
                if (confirm('¬øEst√°s seguro de que quieres eliminar este registro?')) {
                    eliminarRegistro(registro.id);
                }
            };
            
            celdaEliminar.appendChild(btnEliminar);
        });
    }

    // Funci√≥n para eliminar un registro espec√≠fico
    function eliminarRegistro(id) {
        const registrosAnteriores = historialRegistros.length;
        historialRegistros = historialRegistros.filter(registro => registro.id !== id);
        guardarHistorialEnStorage();
        actualizarTablaHistorial();
        
        const registrosActuales = historialRegistros.length;
        console.log(`Registro eliminado. Anterior: ${registrosAnteriores}, Actual: ${registrosActuales}`);
        
        // Mensaje de confirmaci√≥n
        mostrarMensajeTemp('üóëÔ∏è Registro eliminado exitosamente', '#dc3545');
    }

    // Funci√≥n para mostrar mensajes temporales
    function mostrarMensajeTemp(texto, color = '#28a745') {
        const mensaje = document.createElement('div');
        mensaje.innerHTML = texto;
        mensaje.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${color};
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 9999;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            font-size: 0.9em;
        `;
        document.body.appendChild(mensaje);
        
        // Animaci√≥n de entrada
        setTimeout(() => {
            mensaje.style.transform = 'translateX(-10px)';
        }, 100);
        
        // Remover despu√©s de 3 segundos
        setTimeout(() => {
            if (mensaje.parentNode) {
                mensaje.style.opacity = '0';
                mensaje.style.transform = 'translateX(100px)';
                setTimeout(() => {
                    if (mensaje.parentNode) {
                        mensaje.parentNode.removeChild(mensaje);
                    }
                }, 300);
            }
        }, 3000);
    }

    // ============ EVENTOS DE BOTONES ============

    // Funci√≥n para el bot√≥n GRABAR
    function configurarBotonGrabar() {
        const btnGrabar = document.getElementById('grabar');
        if (btnGrabar) {
            btnGrabar.onclick = function() {
                console.log('üîÑ Bot√≥n GRABAR presionado');
                
                // Verificar que todos los elementos existan
                const elementos = {
                    fecha: document.getElementById('fecha'),
                    rut: document.getElementById('rut'),
                    nombre: document.getElementById('nombre'),
                    motivo: document.getElementById('motivo'),
                    submotivo: document.getElementById('submotivo'),
                    observacion: document.getElementById('observacion')
                };
                
                console.log('üîç Verificando elementos del formulario:', elementos);
                
                const fecha = elementos.fecha ? elementos.fecha.value : '';
                const rut = elementos.rut ? elementos.rut.value.trim() : '';
                const nombre = elementos.nombre ? elementos.nombre.value.trim() : '';
                const motivo = elementos.motivo ? elementos.motivo.value : '';
                const submotivo = elementos.submotivo ? elementos.submotivo.value : '';
                const observacion = elementos.observacion ? elementos.observacion.value.trim() : '';

                console.log('üìù Valores del formulario:', { fecha, rut, nombre, motivo, submotivo, observacion });

                // Validaciones
                if (!fecha) {
                    alert("‚ùå Por favor verifique que la fecha est√© establecida.");
                    return;
                }
                
                if (!rut) {
                    alert("‚ùå Por favor ingrese el RUT.");
                    if (elementos.rut) elementos.rut.focus();
                    return;
                }
                
                if (!nombre) {
                    alert("‚ùå Por favor ingrese el nombre.");
                    if (elementos.nombre) elementos.nombre.focus();
                    return;
                }
                
                if (!motivo || motivo === "ELIGE UNA OPCI√ìN") {
                    alert("‚ùå Por favor seleccione un motivo.");
                    if (elementos.motivo) elementos.motivo.focus();
                    return;
                }
                
                if (!submotivo || submotivo === "ELIGE UNA OPCI√ìN") {
                    alert("‚ùå Por favor seleccione un sub-motivo.");
                    if (elementos.submotivo) elementos.submotivo.focus();
                    return;
                }

                // Crear objeto registro con ID √∫nico y timestamp
                const nuevoRegistro = {
                    id: Date.now() + Math.random(), // ID √∫nico
                    fecha: fecha,
                    rut: rut,
                    nombre: nombre,
                    motivo: motivo,
                    submotivo: submotivo,
                    observacion: observacion,
                    fechaCreacion: new Date().toISOString() // Para ordenamiento
                };

                // Agregar al inicio del array para que aparezca en primera fila
                historialRegistros.unshift(nuevoRegistro);
                guardarHistorialEnStorage();
                actualizarTablaHistorial();

                // Limpiar campos del formulario
                if (elementos.rut) elementos.rut.value = "";
                if (elementos.nombre) elementos.nombre.value = "";
                if (elementos.motivo) elementos.motivo.selectedIndex = 0;
                if (elementos.submotivo) elementos.submotivo.selectedIndex = 0;
                if (elementos.observacion) elementos.observacion.value = "";

                // Mensaje de √©xito
                mostrarMensajeTemp('‚úÖ Registro guardado exitosamente', '#28a745');
                
                // Notificaci√≥n push del sistema
                if (typeof showNotification === 'function') {
                    showNotification(
                        'üíæ Registro Guardado',
                        `Nuevo registro para ${elementos.nombre?.value || 'N/A'} guardado exitosamente.`,
                        'success',
                        false,
                        [{text: 'üìä Ver Historial', onclick: 'scrollToHistorial()'}]
                    );
                }
                
                console.log('‚úÖ Nuevo registro agregado. Total:', historialRegistros.length);
                console.log('üìã Registro:', nuevoRegistro);
            };
            console.log('‚úÖ Evento del bot√≥n GRABAR configurado');
        } else {
            console.error('‚ùå Bot√≥n GRABAR no encontrado');
        }
    }

    // Funci√≥n para el bot√≥n EXPORTAR
    function configurarBotonExportar() {
        const btnExportar = document.getElementById('exportar');
        if (btnExportar) {
            btnExportar.onclick = function() {
                console.log('üîÑ Bot√≥n EXPORTAR presionado');
                
                if (historialRegistros.length === 0) {
                    alert('‚ùå No hay registros para exportar');
                    return;
                }
                
                let csv = [];
                
                // Encabezados
                csv.push(['Fecha', 'RUT', 'Nombre', 'Motivo', 'Sub-Motivo', 'Observaci√≥n'].join(','));
                
                // Datos - ordenados por fecha de creaci√≥n (m√°s recientes primero)
                const registrosOrdenados = [...historialRegistros].sort((a, b) => {
                    const fechaA = new Date(a.fechaCreacion || a.fecha);
                    const fechaB = new Date(b.fechaCreacion || b.fecha);
                    return fechaB - fechaA;
                });
                
                registrosOrdenados.forEach(registro => {
                    const fila = [
                        `"${registro.fecha}"`,
                        `"${registro.rut}"`,
                        `"${registro.nombre}"`,
                        `"${registro.motivo}"`,
                        `"${registro.submotivo}"`,
                        `"${registro.observacion.replace(/"/g, '""')}"` // Escapar comillas
                    ];
                    csv.push(fila.join(','));
                });
                
                const csvString = csv.join('\n');
                const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `historial_registros_${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                mostrarMensajeTemp('üì• Historial exportado exitosamente', '#17a2b8');
                console.log('‚úÖ Historial exportado exitosamente');
                
                // Notificaci√≥n push del sistema
                if (typeof showNotification === 'function') {
                    showNotification(
                        'üì• Exportaci√≥n Completa',
                        `Historial con ${historialRegistros.length} registros exportado exitosamente.`,
                        'success',
                        false,
                        [{text: 'üìÇ Abrir Carpeta', onclick: 'abrirCarpetaDescargas()'}]
                    );
                }
            };
            console.log('‚úÖ Evento del bot√≥n EXPORTAR configurado');
        } else {
            console.error('‚ùå Bot√≥n EXPORTAR no encontrado');
        }
    }

    // Funci√≥n para el bot√≥n BORRAR TODO
    // ...existing code...

    // Cerrar modal PDF
    function cerrarModalPdf() {
        document.getElementById('modalPdf').style.display = 'none';
        if (typeof ocultarFormularioEnlace === 'function') {
            ocultarFormularioEnlace();
        }
    }

    // ============ FUNCIONES DEL MODAL DE ANEXO ============
    
    // Funci√≥n para abrir modal de anexo
    function abrirModalAnexo() {
        console.log('üîÑ Abriendo modal de anexo');
        const modal = document.getElementById('modalAnexo');
        if (modal) {
            modal.style.display = 'flex';
            console.log('‚úÖ Modal de anexo abierto');
        } else {
            console.error('‚ùå Modal de anexo no encontrado');
            alert('‚ùå Error: Modal de anexo no encontrado');
        }
    }
    
    // Funci√≥n para cerrar modal de anexo
    function cerrarModalAnexo() {
        console.log('üîÑ Cerrando modal de anexo');
        const modal = document.getElementById('modalAnexo');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de anexo cerrado');
        }
    }
    
    // Configurar bot√≥n de anexo
    function configurarBotonAnexo() {
        const btnAnexo = document.getElementById('btnAnexo');
        if (btnAnexo) {
            btnAnexo.onclick = function() {
                console.log('üîÑ Bot√≥n ANEXO presionado');
                abrirModalAnexo();
            };
            console.log('‚úÖ Evento del bot√≥n ANEXO configurado');
        } else {
            console.error('‚ùå Bot√≥n ANEXO no encontrado');
        }
    }

    // ============ FUNCIONES DEL MODAL DE PRECIOS ============
    
    // Funci√≥n para abrir modal de precios
    function abrirModalPrecios() {
        console.log('üîÑ Abriendo modal de precios');
        const modal = document.getElementById('modalPrecios');
        if (modal) {
            modal.style.display = 'flex';
            console.log('‚úÖ Modal de precios abierto');
        } else {
            console.error('‚ùå Modal de precios no encontrado');
            alert('‚ùå Error: Modal de precios no encontrado');
        }
    }
    
    // Funci√≥n para cerrar modal de precios
    function cerrarModalPrecios() {
        console.log('üîÑ Cerrando modal de precios');
        const modal = document.getElementById('modalPrecios');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de precios cerrado');
        }
    }
    
    // Configurar bot√≥n de precios
    function configurarBotonPrecios() {
        const btnPrecios = document.getElementById('btnPrecios');
        if (btnPrecios) {
            btnPrecios.onclick = function() {
                console.log('üîÑ Bot√≥n PRECIOS presionado');
                abrirModalPrecios();
            };
            console.log('‚úÖ Evento del bot√≥n PRECIOS configurado');
        } else {
            console.error('‚ùå Bot√≥n PRECIOS no encontrado');
        }
    }
    
    // ============ FUNCIONES DEL MODAL DE CORREOS ============
    
    // Funci√≥n para abrir modal de correos
    function abrirModalCorreos() {
        console.log('üîÑ Abriendo modal de correos');
        const modal = document.getElementById('modalCorreos');
        if (modal) {
            modal.style.display = 'flex';
            console.log('‚úÖ Modal de correos abierto');
        } else {
            console.error('‚ùå Modal de correos no encontrado');
            alert('‚ùå Error: Modal de correos no encontrado');
        }
    }
    
    // Funci√≥n para cerrar modal de correos
    function cerrarModalCorreos() {
        console.log('üîÑ Cerrando modal de correos');
        const modal = document.getElementById('modalCorreos');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de correos cerrado');
        }
    }
    
    // Funci√≥n para copiar correo al portapapeles
    function copiarCorreo(correo) {
        if (navigator.clipboard && window.isSecureContext) {
            // M√©todo moderno para navegadores seguros
            navigator.clipboard.writeText(correo).then(function() {
                console.log('‚úÖ Correo copiado al portapapeles:', correo);
                mostrarMensajeTemp(`üìß Correo copiado: ${correo}`, '#28a745');
            }).catch(function(err) {
                console.error('‚ùå Error al copiar:', err);
                copiarCorreoFallback(correo);
            });
        } else {
            // M√©todo de respaldo para navegadores m√°s antiguos
            copiarCorreoFallback(correo);
        }
    }
    
    // Funci√≥n de respaldo para copiar al portapapeles
    function copiarCorreoFallback(correo) {
        const textArea = document.createElement('textarea');
        textArea.value = correo;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        textArea.style.top = '-999999px';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            console.log('‚úÖ Correo copiado al portapapeles (m√©todo de respaldo):', correo);
            mostrarMensajeTemp(`üìß Correo copiado: ${correo}`, '#28a745');
        } catch (err) {
            console.error('‚ùå Error al copiar con m√©todo de respaldo:', err);
            // Como √∫ltimo recurso, mostrar el correo en un prompt para que el usuario lo copie manualmente
            prompt('Copia este correo manualmente:', correo);
        } finally {
            document.body.removeChild(textArea);
        }
    }
    
    // Configurar bot√≥n de correos
    function configurarBotonCorreos() {
        const btnCorreos = document.getElementById('btnCorreos');
        if (btnCorreos) {
            btnCorreos.onclick = function() {
                console.log('üîÑ Bot√≥n CORREOS presionado');
                abrirModalCorreos();
            };
            console.log('‚úÖ Evento del bot√≥n CORREOS configurado');
        } else {
            console.error('‚ùå Bot√≥n CORREOS no encontrado');
        }
    }
    
    // ============ FUNCIONES DEL MODAL DE ATENCI√ìN ============
    
    // Funci√≥n para configurar bot√≥n de atenci√≥n
    function configurarBotonAtencion() {
        const btnAtencion = document.getElementById('btnAtencion');
        if (btnAtencion) {
            btnAtencion.onclick = function() {
                console.log('üîÑ Bot√≥n ATENCI√ìN presionado');
                abrirModalAtencion();
            };
            console.log('‚úÖ Evento del bot√≥n ATENCI√ìN configurado');
        } else {
            console.error('‚ùå Bot√≥n ATENCI√ìN no encontrado');
        }
    }
    
    // Funci√≥n para guardar registro de atenci√≥n
    function guardarRegistroAtencion() {
        const fecha = document.getElementById('fechaAtencion').value;
        const usuario = document.getElementById('usuarioAtencion').value.trim();
        const tipo = document.getElementById('tipoAtencion').value;
        const titulo = document.getElementById('tituloAtencion').value.trim();
        const descripcion = document.getElementById('descripcionAtencion').value.trim();
        const prioridad = document.getElementById('prioridadAtencion').value;
        const estado = document.getElementById('estadoAtencion').value;
        
        // Validaciones
        if (!fecha) {
            alert('‚ùå La fecha es requerida');
            return;
        }
        if (!usuario) {
            alert('‚ùå El nombre del usuario es requerido');
            document.getElementById('usuarioAtencion').focus();
            return;
        }
        if (!tipo) {
            alert('‚ùå Debe seleccionar un tipo de registro');
            document.getElementById('tipoAtencion').focus();
            return;
        }
        if (!titulo) {
            alert('‚ùå El t√≠tulo es requerido');
            document.getElementById('tituloAtencion').focus();
            return;
        }
        if (!descripcion) {
            alert('‚ùå La descripci√≥n es requerida');
            document.getElementById('descripcionAtencion').focus();
            return;
        }
        
        // Crear nuevo registro
        const nuevoRegistro = {
            id: Date.now() + Math.random(),
            fecha: fecha,
            usuario: usuario,
            tipo: tipo,
            titulo: titulo,
            descripcion: descripcion,
            prioridad: prioridad,
            estado: estado,
            fechaCreacion: new Date().toISOString()
        };
        
        // Agregar al array
        registrosAtencion.unshift(nuevoRegistro);
        guardarRegistrosAtencion();
        actualizarTablaAtencion();
        limpiarFormularioAtencion();
        
        // Reproducir sonido de notificaci√≥n
        reproducirSonidoAtencion();
        
        // Mostrar pop-up prominente
        mostrarPopUpAtencion(nuevoRegistro);
        
        // Mensaje temporal adicional
        mostrarMensajeTemp('‚úÖ Registro de atenci√≥n guardado exitosamente', '#28a745');
        console.log('‚úÖ Nuevo registro de atenci√≥n guardado:', nuevoRegistro);
    }
    
    // Funci√≥n para limpiar formulario
    function limpiarFormularioAtencion() {
        document.getElementById('usuarioAtencion').value = '';
        document.getElementById('tipoAtencion').selectedIndex = 0;
        document.getElementById('tituloAtencion').value = '';
        document.getElementById('descripcionAtencion').value = '';
        document.getElementById('prioridadAtencion').selectedIndex = 1; // Media
        document.getElementById('estadoAtencion').selectedIndex = 0; // Pendiente
        
        // Actualizar fecha
        const ahora = new Date();
        const fechaLocal = new Date(ahora.getTime() - (ahora.getTimezoneOffset() * 60000));
        document.getElementById('fechaAtencion').value = fechaLocal.toISOString().slice(0, 16);
    }
    
    // Funci√≥n para reproducir sonido de atenci√≥n
    function reproducirSonidoAtencion() {
        try {
            // Crear un contexto de audio
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Crear una secuencia de tonos para la alerta
            const playTone = (frequency, duration, delay = 0) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                }, delay);
            };
            
            // Secuencia de tonos de alerta: dos tonos altos
            playTone(800, 0.2, 0);      // Primer tono
            playTone(1000, 0.2, 300);   // Segundo tono
            playTone(800, 0.3, 600);    // Tercer tono
            
            console.log('üîä Sonido de atenci√≥n reproducido');
        } catch (error) {
            console.log('‚ö†Ô∏è No se pudo reproducir el sonido:', error);
            // Fallback: usar beep del sistema si est√° disponible
            if (typeof window !== 'undefined' && window.speechSynthesis) {
                window.speechSynthesis.speak(new SpeechSynthesisUtterance(''));
            }
        }
    }
    
    // Funci√≥n para mostrar pop-up prominente de atenci√≥n
    function mostrarPopUpAtencion(registro) {
        // Crear overlay
        const overlay = document.createElement('div');
        overlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(220, 53, 69, 0.9);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-in;
        `;
        
        // Crear modal del pop-up
        const popup = document.createElement('div');
        popup.style.cssText = `
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            text-align: center;
            border: 3px solid #dc3545;
            animation: scaleIn 0.3s ease-out;
        `;
        
        // Icono y colores seg√∫n prioridad
        const iconosPrioridad = {
            'Cr√≠tica': 'üö®',
            'Alta': 'üî¥',
            'Media': 'üü°',
            'Baja': 'üü¢'
        };
        
        const coloresPrioridad = {
            'Cr√≠tica': '#dc3545',
            'Alta': '#fd7e14', 
            'Media': '#ffc107',
            'Baja': '#28a745'
        };
        
        const icono = iconosPrioridad[registro.prioridad] || '‚ö†Ô∏è';
        const color = coloresPrioridad[registro.prioridad] || '#dc3545';
        
        popup.innerHTML = `
            <div style="font-size: 4em; margin-bottom: 20px; animation: pulse 1s infinite;">${icono}</div>
            <h2 style="color: ${color}; margin-bottom: 20px; font-size: 1.8em;">¬°REGISTRO DE ATENCI√ìN GUARDADO!</h2>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: left;">
                <p style="margin: 5px 0;"><strong>üìã Tipo:</strong> ${registro.tipo}</p>
                <p style="margin: 5px 0;"><strong>üè∑Ô∏è T√≠tulo:</strong> ${registro.titulo}</p>
                <p style="margin: 5px 0;"><strong>üë§ Usuario:</strong> ${registro.usuario}</p>
                <p style="margin: 5px 0;"><strong>‚ö° Prioridad:</strong> <span style="color: ${color}; font-weight: bold;">${registro.prioridad}</span></p>
                <p style="margin: 5px 0;"><strong>üìÖ Fecha:</strong> ${new Date(registro.fecha).toLocaleString('es-CL')}</p>
            </div>
            <button id="cerrarPopupAtencion" style="
                background: ${color};
                color: white;
                border: none;
                padding: 15px 30px;
                border-radius: 8px;
                font-size: 1.1em;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
            ">‚úÖ ENTENDIDO</button>
        `;
        
        overlay.appendChild(popup);
        document.body.appendChild(overlay);
        
        // Agregar estilos de animaci√≥n
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes scaleIn {
                from { transform: scale(0.5); opacity: 0; }
                to { transform: scale(1); opacity: 1; }
            }
            @keyframes pulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.1); }
            }
        `;
        document.head.appendChild(style);
        
        // Evento para cerrar
        const btnCerrar = document.getElementById('cerrarPopupAtencion');
        const cerrarPopup = () => {
            overlay.style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => {
                document.body.removeChild(overlay);
                document.head.removeChild(style);
            }, 300);
        };
        
        btnCerrar.onclick = cerrarPopup;
        
        // Cerrar con Escape
        const handleEscape = (e) => {
            if (e.key === 'Escape') {
                cerrarPopup();
                document.removeEventListener('keydown', handleEscape);
            }
        };
        document.addEventListener('keydown', handleEscape);
        
        // Auto-cerrar despu√©s de 10 segundos si es prioridad baja
        if (registro.prioridad === 'Baja') {
            setTimeout(cerrarPopup, 10000);
        }
        
        console.log('üö® Pop-up de atenci√≥n mostrado para:', registro.titulo);
    }
    
    // Funci√≥n para cargar registros desde localStorage
    function cargarRegistrosAtencion() {
        try {
            const datos = localStorage.getItem('registrosAtencionAchs');
            if (datos && datos !== 'null' && datos !== 'undefined') {
                registrosAtencion = JSON.parse(datos);
                console.log('‚úÖ Registros de atenci√≥n cargados:', registrosAtencion.length);
                actualizarTablaAtencion();
                return true;
            }
            registrosAtencion = [];
            return false;
        } catch (e) {
            console.error('‚ùå Error al cargar registros de atenci√≥n:', e);
            registrosAtencion = [];
            return false;
        }
    }
    
    // Funci√≥n para guardar registros en localStorage
    function guardarRegistrosAtencion() {
        try {
            localStorage.setItem('registrosAtencionAchs', JSON.stringify(registrosAtencion));
            console.log('‚úÖ Registros de atenci√≥n guardados:', registrosAtencion.length);
        } catch (e) {
            console.error('‚ùå Error al guardar registros de atenci√≥n:', e);
            alert('Error al guardar los registros. El almacenamiento puede estar lleno.');
        }
    }
    
    // Funci√≥n para actualizar tabla de atenci√≥n
    function actualizarTablaAtencion() {
        const tabla = document.getElementById('tablaAtencion');
        if (!tabla) return;
        
        const tbody = tabla.getElementsByTagName('tbody')[0];
        if (!tbody) return;
        
        tbody.innerHTML = '';
        
        if (registrosAtencion.length === 0) {
            const fila = tbody.insertRow();
            const celda = fila.insertCell(0);
            celda.colSpan = 7;
            celda.style.textAlign = 'center';
            celda.style.color = '#888';
            celda.style.padding = '20px';
            celda.innerHTML = 'No hay registros de atenci√≥n';
            return;
        }
        
        // Ordenar por fecha de creaci√≥n (m√°s recientes primero)
        const registrosOrdenados = [...registrosAtencion].sort((a, b) => 
            new Date(b.fechaCreacion) - new Date(a.fechaCreacion)
        );
        
        registrosOrdenados.forEach((registro, index) => {
            const fila = tbody.insertRow();
            fila.style.background = index % 2 === 0 ? '#ffffff' : '#f9f9f9';
            
            // Fecha
            const fechaFormateada = new Date(registro.fecha).toLocaleString('es-CL');
            fila.insertCell(0).innerHTML = fechaFormateada;
            
            // Usuario
            fila.insertCell(1).innerHTML = registro.usuario;
            
            // Tipo
            const tipoIconos = {
                'Incidencia': 'üö®',
                'Cambio de Procedimiento': 'üîÑ',
                'Mejora': 'üí°',
                'Observaci√≥n': 'üëÅÔ∏è',
                'Capacitaci√≥n': 'üìö',
                'Otro': 'üìå'
            };
            fila.insertCell(2).innerHTML = (tipoIconos[registro.tipo] || 'üìå') + ' ' + registro.tipo;
            
            // T√≠tulo (con tooltip para descripci√≥n)
            const celdaTitulo = fila.insertCell(3);
            celdaTitulo.innerHTML = registro.titulo;
            celdaTitulo.title = registro.descripcion;
            celdaTitulo.style.cursor = 'help';
            
            // Prioridad
            const prioridadColores = {
                'Baja': '#28a745',
                'Media': '#ffc107',
                'Alta': '#fd7e14',
                'Cr√≠tica': '#dc3545'
            };
            const celdaPrioridad = fila.insertCell(4);
            celdaPrioridad.innerHTML = registro.prioridad;
            celdaPrioridad.style.color = prioridadColores[registro.prioridad] || '#666';
            celdaPrioridad.style.fontWeight = 'bold';
            celdaPrioridad.style.textAlign = 'center';
            
            // Estado
            const estadoColores = {
                'Pendiente': '#ffc107',
                'En Proceso': '#17a2b8',
                'Resuelto': '#28a745',
                'Cancelado': '#dc3545'
            };
            const celdaEstado = fila.insertCell(5);
            celdaEstado.innerHTML = registro.estado;
            celdaEstado.style.color = estadoColores[registro.estado] || '#666';
            celdaEstado.style.fontWeight = 'bold';
            celdaEstado.style.textAlign = 'center';
            
            // Bot√≥n eliminar
            const celdaEliminar = fila.insertCell(6);
            celdaEliminar.style.textAlign = 'center';
            const btnEliminar = document.createElement('button');
            btnEliminar.innerHTML = 'üóëÔ∏è';
            btnEliminar.style.cssText = 'background:#dc3545; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; font-size:0.8em;';
            btnEliminar.onclick = function() {
                if (confirm('¬øEst√°s seguro de eliminar este registro?')) {
                    eliminarRegistroAtencion(registro.id);
                }
            };
            celdaEliminar.appendChild(btnEliminar);
        });
    }
    
    // Funci√≥n para eliminar registro de atenci√≥n
    function eliminarRegistroAtencion(id) {
        registrosAtencion = registrosAtencion.filter(r => r.id !== id);
        guardarRegistrosAtencion();
        actualizarTablaAtencion();
        mostrarMensajeTemp('üóëÔ∏è Registro eliminado exitosamente', '#dc3545');
    }
    
    // Funci√≥n para exportar registros de atenci√≥n
    function exportarRegistrosAtencion() {
        if (registrosAtencion.length === 0) {
            alert('‚ùå No hay registros para exportar');
            return;
        }
        
        let csv = [];
        csv.push(['Fecha', 'Usuario', 'Tipo', 'T√≠tulo', 'Descripci√≥n', 'Prioridad', 'Estado'].join(','));
        
        const registrosOrdenados = [...registrosAtencion].sort((a, b) => 
            new Date(b.fechaCreacion) - new Date(a.fechaCreacion)
        );
        
        registrosOrdenados.forEach(registro => {
            const fila = [
                `"${new Date(registro.fecha).toLocaleString('es-CL')}"`,
                `"${registro.usuario}"`,
                `"${registro.tipo}"`,
                `"${registro.titulo}"`,
                `"${registro.descripcion.replace(/"/g, '""')}"`,
                `"${registro.prioridad}"`,
                `"${registro.estado}"`
            ];
            csv.push(fila.join(','));
        });
        
        const csvString = csv.join('\n');
        const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `registros_atencion_${new Date().toISOString().split('T')[0]}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
        
        mostrarMensajeTemp('üì• Registros de atenci√≥n exportados exitosamente', '#17a2b8');
        
        // Notificaci√≥n push del sistema
        if (typeof showNotification === 'function') {
            showNotification(
                'üìä Datos de Atenci√≥n Exportados',
                `${registrosAtencion.length} registros de atenci√≥n exportados exitosamente.`,
                'success'
            );
        }
    }
    
    // ============ FUNCIONES DEL SISTEMA DE ALERTAS ============
    
    // Funci√≥n para abrir modal de alertas
    function abrirModalAlerta() {
        console.log('üîÑ Abriendo modal de alertas');
        const modal = document.getElementById('modalAlerta');
        if (modal) {
            modal.style.display = 'flex';
            // Establecer fecha m√≠nima como ahora
            const ahora = new Date();
            const fechaLocal = new Date(ahora.getTime() - (ahora.getTimezoneOffset() * 60000));
            document.getElementById('fechaAlerta').min = fechaLocal.toISOString().slice(0, 16);
            cargarAlertas();
            console.log('‚úÖ Modal de alertas abierto');
        } else {
            console.error('‚ùå Modal de alertas no encontrado');
        }
    }
    
    function cerrarModalAlerta() {
        console.log('üîÑ Cerrando modal de alertas');
        const modal = document.getElementById('modalAlerta');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de alertas cerrado');
        }
    }
    
    // Funci√≥n para configurar bot√≥n de alertas
    function configurarBotonAlerta() {
        const btnAlerta = document.getElementById('btnAlerta');
        if (btnAlerta) {
            btnAlerta.onclick = function() {
                console.log('üîÑ Bot√≥n ALERTA presionado');
                abrirModalAlerta();
            };
            console.log('‚úÖ Evento del bot√≥n ALERTA configurado');
        } else {
            console.error('‚ùå Bot√≥n ALERTA no encontrado');
        }
    }
    
    // Funci√≥n para guardar nueva alerta
    function guardarAlerta() {
        const fecha = document.getElementById('fechaAlerta').value;
        const titulo = document.getElementById('tituloAlerta').value.trim();
        const descripcion = document.getElementById('descripcionAlerta').value.trim();
        const prioridad = document.getElementById('prioridadAlerta').value;
        const tipo = document.getElementById('tipoAlerta').value;
        const repetir = document.getElementById('repetirAlerta').value;
        
        // Validaciones
        if (!fecha) {
            alert('‚ùå Debe seleccionar fecha y hora para la alerta');
            document.getElementById('fechaAlerta').focus();
            return;
        }
        
        const fechaAlerta = new Date(fecha);
        const ahora = new Date();
        
        if (fechaAlerta <= ahora) {
            alert('‚ùå La fecha debe ser futura');
            document.getElementById('fechaAlerta').focus();
            return;
        }
        
        if (!titulo) {
            alert('‚ùå El t√≠tulo es requerido');
            document.getElementById('tituloAlerta').focus();
            return;
        }
        
        if (!descripcion) {
            alert('‚ùå La descripci√≥n es requerida');
            document.getElementById('descripcionAlerta').focus();
            return;
        }
        
        // Crear nueva alerta
        const nuevaAlerta = {
            id: Date.now() + Math.random(),
            fecha: fecha,
            titulo: titulo,
            descripcion: descripcion,
            prioridad: prioridad,
            tipo: tipo,
            repetir: repetir,
            activa: true,
            fechaCreacion: new Date().toISOString()
        };
        
        // Agregar al array
        alertasProgramadas.push(nuevaAlerta);
        guardarAlertas();
        actualizarTablaAlertas();
        programarAlerta(nuevaAlerta);
        limpiarFormularioAlerta();
        
        // Reproducir sonido de confirmaci√≥n
        reproducirSonidoConfirmacion();
        
        mostrarMensajeTemp('‚è∞ Alerta programada exitosamente', '#ffc107');
        console.log('‚úÖ Nueva alerta programada:', nuevaAlerta);
    }
    
    // Funci√≥n para limpiar formulario de alerta
    function limpiarFormularioAlerta() {
        document.getElementById('fechaAlerta').value = '';
        document.getElementById('tituloAlerta').value = '';
        document.getElementById('descripcionAlerta').value = '';
        document.getElementById('prioridadAlerta').selectedIndex = 1; // Media
        document.getElementById('tipoAlerta').selectedIndex = 0; // Tarea
        document.getElementById('repetirAlerta').selectedIndex = 0; // No repetir
    }
    
    // Funci√≥n para programar alerta en el navegador
    function programarAlerta(alerta) {
        const fechaAlerta = new Date(alerta.fecha);
        const ahora = new Date();
        const tiempoEspera = fechaAlerta.getTime() - ahora.getTime();
        
        if (tiempoEspera > 0) {
            const timeoutId = setTimeout(() => {
                mostrarAlertaEmergente(alerta);
            }, tiempoEspera);
            
            // Guardar el ID del timeout para poder cancelarlo
            intervalosAlerta.push({
                id: alerta.id,
                timeoutId: timeoutId
            });
            
            console.log(`‚è∞ Alerta programada para: ${fechaAlerta.toLocaleString()}`);
        }
    }
    
    // Funci√≥n para mostrar alerta emergente con sonido
    function mostrarAlertaEmergente(alerta) {
        // Reproducir sonido de alerta
        reproducirSonidoAlertaUrgente();
        
        // Crear overlay
        const overlay = document.createElement('div');
        overlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(255, 193, 7, 0.95);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: alertaBlink 1s infinite;
        `;
        
        // Crear modal de alerta
        const popup = document.createElement('div');
        popup.style.cssText = `
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            text-align: center;
            border: 4px solid #ffc107;
            animation: alertaShake 0.5s ease-in-out infinite;
        `;
        
        // Icono y colores seg√∫n prioridad
        const iconosPrioridad = {
            'Cr√≠tica': 'üö®',
            'Alta': 'üî¥',
            'Media': 'üü°',
            'Baja': 'üü¢'
        };
        
        const coloresPrioridad = {
            'Cr√≠tica': '#dc3545',
            'Alta': '#fd7e14', 
            'Media': '#ffc107',
            'Baja': '#28a745'
        };
        
        const icono = iconosPrioridad[alerta.prioridad] || '‚è∞';
        const color = coloresPrioridad[alerta.prioridad] || '#ffc107';
        
        const tipoIconos = {
            'Tarea': 'üìã',
            'Reuni√≥n': 'üë•',
            'Llamada': 'üìû',
            'Revisi√≥n': 'üîç',
            'Entrega': 'üì§',
            'Otro': 'üìå'
        };
        
        popup.innerHTML = `
            <div style="font-size: 5em; margin-bottom: 20px; animation: pulse 1s infinite;">${icono}</div>
            <h1 style="color: ${color}; margin-bottom: 20px; font-size: 2.2em; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">¬°RECORDATORIO PROGRAMADO!</h1>
            <div style="background: #f8f9fa; padding: 25px; border-radius: 12px; margin-bottom: 20px; text-align: left; border: 2px solid ${color};">
                <p style="margin: 8px 0; font-size: 1.1em;"><strong>${tipoIconos[alerta.tipo] || 'üìå'} Tipo:</strong> ${alerta.tipo}</p>
                <p style="margin: 8px 0; font-size: 1.3em; color: ${color}; font-weight: bold;"><strong>üè∑Ô∏è Tarea:</strong> ${alerta.titulo}</p>
                <p style="margin: 8px 0; font-size: 1.1em;"><strong>üìù Descripci√≥n:</strong> ${alerta.descripcion}</p>
                <p style="margin: 8px 0; font-size: 1.1em;"><strong>‚ö° Prioridad:</strong> <span style="color: ${color}; font-weight: bold;">${alerta.prioridad}</span></p>
                <p style="margin: 8px 0; font-size: 1em;"><strong>üìÖ Programado para:</strong> ${new Date(alerta.fecha).toLocaleString('es-CL')}</p>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button id="completarAlerta" style="
                    background: #28a745;
                    color: white;
                    border: none;
                    padding: 15px 25px;
                    border-radius: 8px;
                    font-size: 1.1em;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">‚úÖ COMPLETADO</button>
                <button id="posponerAlerta" style="
                    background: #17a2b8;
                    color: white;
                    border: none;
                    padding: 15px 25px;
                    border-radius: 8px;
                    font-size: 1.1em;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">‚è∞ POSPONER 10 MIN</button>
                <button id="cerrarAlertaEmergente" style="
                    background: ${color};
                    color: white;
                    border: none;
                    padding: 15px 25px;
                    border-radius: 8px;
                    font-size: 1.1em;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">üëÅÔ∏è ENTENDIDO</button>
            </div>
        `;
        
        overlay.appendChild(popup);
        document.body.appendChild(overlay);
        
        // Agregar estilos de animaci√≥n
        const style = document.createElement('style');
        style.textContent = `
            @keyframes alertaBlink {
                0%, 50% { background: rgba(255, 193, 7, 0.95); }
                51%, 100% { background: rgba(255, 193, 7, 0.7); }
            }
            @keyframes alertaShake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
        
        // Eventos de botones
        const cerrarAlerta = () => {
            overlay.style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => {
                document.body.removeChild(overlay);
                document.head.removeChild(style);
            }, 300);
        };
        
        document.getElementById('completarAlerta').onclick = () => {
            marcarAlertaCompletada(alerta.id);
            cerrarAlerta();
        };
        
        document.getElementById('posponerAlerta').onclick = () => {
            posponerAlerta(alerta, 10);
            cerrarAlerta();
        };
        
        document.getElementById('cerrarAlertaEmergente').onclick = cerrarAlerta;
        
        // Cerrar con Escape
        const handleEscape = (e) => {
            if (e.key === 'Escape') {
                cerrarAlerta();
                document.removeEventListener('keydown', handleEscape);
            }
        };
        document.addEventListener('keydown', handleEscape);
        
        console.log('üö® Alerta emergente mostrada:', alerta.titulo);
    }
    
    // Funci√≥n para reproducir sonido de alerta urgente
    function reproducirSonidoAlertaUrgente() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            const playTone = (frequency, duration, delay = 0) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.type = 'square';
                    
                    gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                }, delay);
            };
            
            // Secuencia de sonidos urgentes: sirena
            for (let i = 0; i < 6; i++) {
                playTone(800, 0.3, i * 350);
                playTone(1200, 0.3, i * 350 + 150);
            }
            
            console.log('üîä Sonido de alerta urgente reproducido');
        } catch (error) {
            console.log('‚ö†Ô∏è No se pudo reproducir el sonido de alerta:', error);
        }
    }
    
    // Funci√≥n para reproducir sonido de confirmaci√≥n
    function reproducirSonidoConfirmacion() {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            const playTone = (frequency, duration, delay = 0) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                }, delay);
            };
            
            // Sonido de confirmaci√≥n: tonos ascendentes
            playTone(523, 0.2, 0);    // Do
            playTone(659, 0.2, 200);  // Mi
            playTone(784, 0.3, 400);  // Sol
            
        } catch (error) {
            console.log('‚ö†Ô∏è No se pudo reproducir el sonido de confirmaci√≥n:', error);
        }
    }
    
    // Funciones para gesti√≥n de enlaces PDF
    function mostrarFormularioEnlace() {
        document.getElementById('formularioEnlace').style.display = 'block';
        document.getElementById('nombreEnlace').focus();
    }

    function ocultarFormularioEnlace() {
        document.getElementById('formularioEnlace').style.display = 'none';
        document.getElementById('nombreEnlace').value = '';
        document.getElementById('urlEnlace').value = '';
    }

    function agregarEnlace() {
        const nombre = document.getElementById('nombreEnlace').value.trim();
        const url = document.getElementById('urlEnlace').value.trim();
        
        if (!nombre) {
            alert('‚ùå Por favor ingrese un nombre para el enlace');
            return;
        }
        
        if (!url) {
            alert('‚ùå Por favor ingrese la URL del PDF');
            return;
        }
        
        // Validar que sea una URL v√°lida
        try {
            new URL(url);
        } catch (e) {
            alert('‚ùå Por favor ingrese una URL v√°lida');
            return;
        }
        
        // Crear objeto enlace
        const enlace = {
            id: Date.now() + Math.random(),
            nombre: nombre,
            url: url,
            tipo: 'enlace',
            fechaCreacion: new Date().toLocaleDateString()
        };
        
        // Agregar a la lista
        documentosGuardados.push(enlace);
        guardarEnLocalStorage();
        actualizarListaDocumentos();
        
        // Limpiar formulario y ocultarlo
        ocultarFormularioEnlace();
        
        alert(`‚úÖ Enlace "${nombre}" agregado exitosamente`);
        console.log('Enlace agregado:', enlace);
    }

    function actualizarListaDocumentos() {
        console.log('üîÑ Ejecutando actualizarListaDocumentos...');
        const lista = document.getElementById('listaDocumentos');
        if (!lista) {
            console.warn('‚ö†Ô∏è Elemento listaDocumentos no encontrado');
            return;
        }
        
        lista.innerHTML = '';
        
        if (documentosGuardados.length === 0) {
            lista.innerHTML = '<p style="color:#888; font-size:0.9em; margin:10px 0;">No hay documentos guardados</p>';
            return;
        }
        
        console.log(`üìã Mostrando ${documentosGuardados.length} documentos`);
        
        documentosGuardados.forEach((doc, index) => {
            const item = document.createElement('div');
            const esEnlace = doc.tipo === 'enlace';
            
            item.style.cssText = 'border:1px solid #ddd; border-radius:4px; padding:8px; margin-bottom:8px; background:#f9f9f9; transition: all 0.3s ease; position:relative;';
            
            const icono = esEnlace ? 'üîó' : 'üìÑ';
            const tipo = esEnlace ? 'Enlace' : 'Archivo';
            
            item.innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                    <div style="flex:1; cursor:pointer;" onclick="${esEnlace ? `abrirEnlace('${doc.url}')` : `mostrarDocumento(documentosGuardados[${index}])`}">
                        <div style="font-weight:bold; color:#002147; margin-bottom:3px;">${icono} ${doc.nombre}</div>
                        <div style="font-size:0.8em; color:#666;">${tipo} ‚Ä¢ ${doc.fechaCreacion}</div>
                    </div>
                    <button onclick="eliminarDocumento(${index})" style="background:#dc3545; color:white; border:none; border-radius:50%; width:24px; height:24px; cursor:pointer; font-size:0.8em; font-weight:bold; transition:all 0.3s ease; margin-left:8px; display:flex; align-items:center; justify-content:center;" 
                            onmouseover="this.style.background='#c82333'; this.style.transform='scale(1.1)'" 
                            onmouseout="this.style.background='#dc3545'; this.style.transform='scale(1)'"
                            title="Eliminar documento">
                        √ó
                    </button>
                </div>
            `;
            
            // Efecto hover para el contenedor completo
            item.onmouseover = function() {
                this.style.background = '#e3f2fd';
                this.style.transform = 'translateX(3px)';
                this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
            };
            
            item.onmouseout = function() {
                this.style.background = '#f9f9f9';
                this.style.transform = 'translateX(0)';
                this.style.boxShadow = 'none';
            };
            
            lista.appendChild(item);
        });
    }

    function eliminarDocumento(index) {
        if (index < 0 || index >= documentosGuardados.length) {
            console.error('‚ùå √çndice inv√°lido para eliminar documento:', index);
            return;
        }
        
        const documento = documentosGuardados[index];
        
        // Confirmaci√≥n antes de eliminar
        if (confirm(`¬øEst√° seguro de que desea eliminar el documento "${documento.nombre}"?`)) {
            console.log(`üóëÔ∏è Eliminando documento: ${documento.nombre}`);
            
            // Eliminar del array
            documentosGuardados.splice(index, 1);
            
            // Actualizar localStorage
            guardarEnLocalStorage();
            
            // Actualizar la visualizaci√≥n
            actualizarListaDocumentos();
            
            // Mostrar mensaje de confirmaci√≥n
            alert('‚úÖ Documento eliminado exitosamente');
        }
    }

    function abrirEnlace(url) {
        window.open(url, '_blank');
    }

    function guardarEnLocalStorage() {
        try {
            const datos = JSON.stringify(documentosGuardados);
            localStorage.setItem('documentosAchs', datos);
            console.log('‚úÖ Guardado en localStorage exitoso. Total:', documentosGuardados.length);
        } catch (e) {
            console.error('‚ùå Error al guardar en localStorage:', e);
            alert('Error al guardar los documentos. El almacenamiento puede estar lleno.');
        }
    }

    // ===== FUNCIONES FALTANTES SISTEMA DE ALERTAS =====
    
    // Funci√≥n para cargar alertas desde localStorage
    function cargarAlertas() {
        try {
            console.log('üîÑ Cargando alertas desde localStorage...');
            const datos = localStorage.getItem('alertasProgramadasAchs');
            
            if (datos && datos !== 'null' && datos !== 'undefined') {
                alertasProgramadas = JSON.parse(datos);
                actualizarTablaAlertas();
                
                // Reprogramar alertas pendientes
                alertasProgramadas.forEach(alerta => {
                    if (alerta.activa) {
                        const fechaAlerta = new Date(alerta.fecha);
                        const ahora = new Date();
                        if (fechaAlerta > ahora) {
                            programarAlerta(alerta);
                        }
                    }
                });
                
                console.log(`‚úÖ Cargadas ${alertasProgramadas.length} alertas programadas`);
            } else {
                console.log('üìù No hay alertas guardadas');
                alertasProgramadas = [];
                actualizarTablaAlertas();
            }
        } catch (error) {
            console.error('‚ùå Error al cargar alertas:', error);
            alertasProgramadas = [];
            actualizarTablaAlertas();
        }
    }
    
    // Funci√≥n para guardar alertas en localStorage
    function guardarAlertas() {
        try {
            localStorage.setItem('alertasProgramadasAchs', JSON.stringify(alertasProgramadas));
            console.log(`üíæ Alertas guardadas: ${alertasProgramadas.length} elementos`);
        } catch (error) {
            console.error('‚ùå Error al guardar alertas:', error);
            alert('Error al guardar las alertas. El almacenamiento puede estar lleno.');
        }
    }
    
    // Funci√≥n para actualizar tabla de alertas
    function actualizarTablaAlertas() {
        const tabla = document.getElementById('tablaAlertas');
        if (!tabla) {
            console.warn('‚ö†Ô∏è Tabla de alertas no encontrada');
            return;
        }
        
        const tbody = tabla.querySelector('tbody') || tabla;
        tbody.innerHTML = '';
        
        if (alertasProgramadas.length === 0) {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td colspan="6" style="text-align:center; color:#6c757d; padding:20px; font-style:italic;">
                    üìÖ No hay alertas programadas
                </td>
            `;
            tbody.appendChild(tr);
            return;
        }
        
        // Ordenar alertas por fecha
        const alertasOrdenadas = [...alertasProgramadas].sort((a, b) => new Date(a.fecha) - new Date(b.fecha));
        
        alertasOrdenadas.forEach((alerta, index) => {
            const tr = document.createElement('tr');
            const fecha = new Date(alerta.fecha);
            const fechaFormateada = fecha.toLocaleDateString('es-ES') + ' ' + fecha.toLocaleTimeString('es-ES', {hour: '2-digit', minute: '2-digit'});
            
            // Determinar estado y color
            const ahora = new Date();
            let estado, colorEstado;
            if (!alerta.activa) {
                estado = 'Completada';
                colorEstado = '#28a745';
            } else if (fecha < ahora) {
                estado = 'Vencida';
                colorEstado = '#dc3545';
            } else {
                estado = 'Pendiente';
                colorEstado = '#007bff';
            }
            
            // Iconos por prioridad
            const iconosPrioridad = {
                'Cr√≠tica': 'üö®',
                'Alta': 'üî¥',
                'Media': 'üü°',
                'Baja': 'üü¢'
            };
            
            tr.innerHTML = `
                <td style="padding:8px; border-bottom:1px solid #ddd;">
                    ${iconosPrioridad[alerta.prioridad] || '‚ö™'} ${alerta.prioridad}
                </td>
                <td style="padding:8px; border-bottom:1px solid #ddd;">
                    <strong>${alerta.titulo}</strong><br>
                    <small style="color:#666;">${alerta.descripcion}</small>
                </td>
                <td style="padding:8px; border-bottom:1px solid #ddd; font-size:0.9em;">
                    ${fechaFormateada}
                </td>
                <td style="padding:8px; border-bottom:1px solid #ddd;">
                    <span style="background:${colorEstado}; color:white; padding:2px 6px; border-radius:3px; font-size:0.8em;">
                        ${estado}
                    </span>
                </td>
                <td style="padding:8px; border-bottom:1px solid #ddd; font-size:0.8em;">
                    ${alerta.tipo}
                </td>
                <td style="padding:8px; border-bottom:1px solid #ddd; text-align:center;">
                    <button onclick="marcarAlertaCompletada('${alerta.id}')" 
                            style="background:#28a745; color:white; border:none; padding:4px 8px; border-radius:3px; cursor:pointer; font-size:0.8em; margin-right:4px;"
                            title="Marcar como completada">
                        ‚úì
                    </button>
                    <button onclick="eliminarAlerta('${alerta.id}')" 
                            style="background:#dc3545; color:white; border:none; padding:4px 8px; border-radius:3px; cursor:pointer; font-size:0.8em;"
                            title="Eliminar alerta">
                        ‚úó
                    </button>
                </td>
            `;
            
            tbody.appendChild(tr);
        });
        
        console.log(`üìä Tabla de alertas actualizada con ${alertasProgramadas.length} elementos`);
    }
    
    // Funci√≥n para marcar alerta como completada
    function marcarAlertaCompletada(id) {
        const alerta = alertasProgramadas.find(a => a.id == id);
        if (alerta) {
            alerta.activa = false;
            guardarAlertas();
            actualizarTablaAlertas();
            mostrarMensajeTemp('‚úÖ Alerta marcada como completada', '#28a745');
            console.log('‚úÖ Alerta completada:', alerta.titulo);
        }
    }
    
    // Funci√≥n para eliminar alerta
    function eliminarAlerta(id) {
        const alerta = alertasProgramadas.find(a => a.id == id);
        if (alerta && confirm(`¬øEliminar la alerta "${alerta.titulo}"?`)) {
            alertasProgramadas = alertasProgramadas.filter(a => a.id != id);
            guardarAlertas();
            actualizarTablaAlertas();
            mostrarMensajeTemp('üóëÔ∏è Alerta eliminada', '#dc3545');
            console.log('üóëÔ∏è Alerta eliminada:', alerta.titulo);
        }
    }
    
    // Funci√≥n para verificar alertas vencidas
    function verificarAlertas() {
        const ahora = new Date();
        const alertasVencidas = alertasProgramadas.filter(a => a.activa && new Date(a.fecha) < ahora);
        
        if (alertasVencidas.length === 0) {
            mostrarMensajeTemp('‚úÖ No hay alertas vencidas', '#28a745');
        } else {
            mostrarMensajeTemp(`‚ö†Ô∏è ${alertasVencidas.length} alerta(s) vencida(s)`, '#ffc107');
            alertasVencidas.forEach(alerta => {
                console.warn(`‚ö†Ô∏è Alerta vencida: ${alerta.titulo} (${alerta.fecha})`);
            });
        }
        
        actualizarTablaAlertas();
    }
    
    // Funci√≥n para exportar alertas
    function exportarAlertas() {
        if (alertasProgramadas.length === 0) {
            mostrarMensajeTemp('‚ùå No hay alertas para exportar', '#dc3545');
            return;
        }
        
        let contenido = `REPORTE DE ALERTAS PROGRAMADAS - ACHS
=====================================
Fecha de exportaci√≥n: ${new Date().toLocaleString()}
Total de alertas: ${alertasProgramadas.length}

`;
        
        alertasProgramadas.forEach((alerta, index) => {
            const fecha = new Date(alerta.fecha);
            const estado = alerta.activa ? (fecha < new Date() ? 'VENCIDA' : 'PENDIENTE') : 'COMPLETADA';
            
            contenido += `${index + 1}. ${alerta.titulo}
   Fecha: ${fecha.toLocaleString()}
   Prioridad: ${alerta.prioridad}
   Tipo: ${alerta.tipo}
   Estado: ${estado}
   Descripci√≥n: ${alerta.descripcion}
   
`;
        });
        
        const blob = new Blob([contenido], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `alertas_achs_${new Date().toISOString().split('T')[0]}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        mostrarMensajeTemp('üìÑ Alertas exportadas correctamente', '#28a745');
        console.log('üìÑ Alertas exportadas exitosamente');
    }
    
    // ===== FIN FUNCIONES FALTANTES SISTEMA DE ALERTAS =====

    function cargarDocumentosGuardados() {
        try {
            console.log('üîÑ Cargando documentos desde localStorage...');
            const datos = localStorage.getItem('documentosAchs');
            
            if (datos && datos !== 'null' && datos !== 'undefined') {
                documentosGuardados = JSON.parse(datos);
                console.log('‚úÖ Documentos cargados desde localStorage. Total:', documentosGuardados.length);
                return true;
            }
            
            console.log('‚ÑπÔ∏è No hay documentos guardados o datos inv√°lidos');
            documentosGuardados = [];
            
            // Agregar enlace de ejemplo si no hay documentos
            if (documentosGuardados.length === 0) {
                const enlaceEjemplo = {
                    id: Date.now(),
                    nombre: 'Ejemplo - Google Drive',
                    url: 'https://drive.google.com/file/d/ejemplo',
                    tipo: 'enlace',
                    fechaCreacion: new Date().toLocaleDateString()
                };
                documentosGuardados.push(enlaceEjemplo);
                guardarEnLocalStorage();
            }
            
            return false;
            
        } catch (e) {
            console.error('‚ùå Error al cargar desde localStorage:', e);
            documentosGuardados = [];
            return false;
        }
    }

    // Inicializaci√≥n al cargar la p√°gina
    window.addEventListener('DOMContentLoaded', function() {
        console.log('üîÑ P√°gina cargada, inicializando...');
        
        // Establecer fecha actual
        const fechaElement = document.getElementById('fecha');
        if (fechaElement) {
            fechaElement.valueAsDate = new Date();
            console.log('‚úÖ Fecha establecida');
        }
        
        // Configurar cierre de modales al hacer clic fuera de ellos
        window.onclick = function(event) {
            const modalPdf = document.getElementById('modalPdf');
            const modalPrecios = document.getElementById('modalPrecios');
            const modalAnexo = document.getElementById('modalAnexo');
            const modalCorreos = document.getElementById('modalCorreos');
            const modalAtencion = document.getElementById('modalAtencion');
            const modalReclamo = document.getElementById('modalReclamo');
            
            // Cerrar modal PDF si se hace clic fuera
            if (modalPdf && event.target === modalPdf) {
                cerrarModalPdf();
            }
            
            // Cerrar modal de precios si se hace clic fuera
            if (modalPrecios && event.target === modalPrecios) {
                cerrarModalPrecios();
            }
            
            // Cerrar modal de anexo si se hace clic fuera
            if (modalAnexo && event.target === modalAnexo) {
                cerrarModalAnexo();
            }
            
            // Cerrar modal de correos si se hace clic fuera
            if (modalCorreos && event.target === modalCorreos) {
                cerrarModalCorreos();
            }
            
            // Cerrar modal de atenci√≥n si se hace clic fuera
            if (modalAtencion && event.target === modalAtencion) {
                cerrarModalAtencion();
            }
            
            // Cerrar modal de reclamos si se hace clic fuera
            if (modalReclamo && event.target === modalReclamo) {
                cerrarModalReclamo();
            }
        };
        console.log('‚úÖ Configurado cierre de modales al hacer clic fuera');
        
        // Cargar datos guardados
        cargarDocumentosGuardados();
        cargarHistorialGuardado(); // CARGAR HISTORIAL
        cargarRegistrosAtencion(); // CARGAR REGISTROS DE ATENCI√ìN
        cargarReclamosGuardados(); // CARGAR RECLAMOS GUARDADOS
        cargarAlertas(); // CARGAR ALERTAS
        cargarTareasPendientes(); // CARGAR TAREAS PENDIENTES
        cargarEmailsGuardados(); // CARGAR EMAILS
        
        // Configurar eventos de botones
        configurarBotonGrabar();
        configurarBotonExportar();
    // ...existing code...
        configurarBotonAnexo(); // CONFIGURAR BOT√ìN ANEXO
        configurarBotonPrecios(); // CONFIGURAR BOT√ìN PRECIOS
        configurarBotonCorreos(); // CONFIGURAR BOT√ìN CORREOS
        configurarBotonReclamo(); // CONFIGURAR BOT√ìN RECLAMO
        inicializarFormularioReclamo(); // INICIALIZAR SISTEMA DE RECLAMOS
        configurarBotonAtencion(); // CONFIGURAR BOT√ìN ATENCI√ìN
        configurarBotonPendiente(); // CONFIGURAR BOT√ìN PENDIENTE
        configurarBotonPlanillaRespuestas(); // CONFIGURAR BOT√ìN PLANILLA DE RESPUESTAS
        
        console.log('‚úÖ Inicializaci√≥n completa');
    });

    // Mostrar/ocultar men√∫ de acceso directo
    document.addEventListener('DOMContentLoaded', function() {
        // Inicializar sistema de notificaciones push
        initNotificationSystem();
        
        const btnAccesoDirecto = document.getElementById('btnAccesoDirecto');
        const accesoLinks = document.getElementById('accesoLinks');
        
        if (btnAccesoDirecto && accesoLinks) {
            btnAccesoDirecto.onclick = function(e) {
                e.stopPropagation();
                const isVisible = accesoLinks.style.display === "block";
                accesoLinks.style.display = isVisible ? "none" : "block";
            };
            
            // Ocultar men√∫ al hacer clic fuera
            document.addEventListener('click', function(e) {
                if (accesoLinks.style.display === "block") {
                    accesoLinks.style.display = "none";
                }
            });
            
            // Evitar que el men√∫ se cierre al hacer clic en √©l
            accesoLinks.onclick = function(e) {
                e.stopPropagation();
            };
        }
        
        // Inicializar calendario y reloj
        console.log('üîÑ Inicializando calendario y reloj...');
        configurarEventosCalendario();
        actualizarReloj();
        
        // Actualizar reloj cada segundo
        setInterval(actualizarReloj, 1000);
        console.log('‚úÖ Reloj iniciado - actualiz√°ndose cada segundo');
        
        // Configurar fecha actual en el formulario
        const fechaInput = document.getElementById('fecha');
        if (fechaInput) {
            const hoy = new Date();
            const fechaFormateada = hoy.toISOString().split('T')[0];
            fechaInput.value = fechaFormateada;
            console.log('‚úÖ Fecha del formulario configurada:', fechaFormateada);
        }
    });

    console.log('‚úÖ Script cargado completamente');

    // Respaldo de inicializaci√≥n con window.onload
    window.addEventListener('load', function() {
        console.log('üîÑ window.onload ejecutado - verificando inicializaci√≥n...');
        
        // Verificar si los botones est√°n configurados
        const btnGrabar = document.getElementById('grabar');
        const btnExportar = document.getElementById('exportar');
        const btnPrecios = document.getElementById('btnPrecios');
        const btnAnexo = document.getElementById('btnAnexo');
        const btnCorreos = document.getElementById('btnCorreos');
        
        if (btnGrabar && !btnGrabar.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n GRABAR desde window.onload');
            configurarBotonGrabar();
        }
        
        if (btnExportar && !btnExportar.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n EXPORTAR desde window.onload');
            configurarBotonExportar();
        }
        
        const btnBorrarTodo = document.getElementById('borrarTodo');
        // ...existing code...
        
        if (btnPrecios && !btnPrecios.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n PRECIOS desde window.onload');
            configurarBotonPrecios();
        }
        
        if (btnAnexo && !btnAnexo.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n ANEXO desde window.onload');
            configurarBotonAnexo();
        }
        
        if (btnCorreos && !btnCorreos.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n CORREOS desde window.onload');
            configurarBotonCorreos();
        }
        
        const btnAtencion = document.getElementById('btnAtencion');
        if (btnAtencion && !btnAtencion.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n ATENCI√ìN desde window.onload');
            configurarBotonAtencion();
        }
        
        const btnPendiente = document.getElementById('btnPendiente');
        if (btnPendiente && !btnPendiente.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n PENDIENTE desde window.onload');
            configurarBotonPendiente();
        }
        
        const btnReclamo = document.getElementById('btnReclamo');
        if (btnReclamo && !btnReclamo.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n RECLAMO desde window.onload');
            configurarBotonReclamo();
        }
        
        if (btnCorreos && !btnCorreos.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n CORREOS desde window.onload');
            configurarBotonCorreos();
        }
        
        const btnPlanillaRespuestas = document.getElementById('btnPlanillaRespuestas');
        if (btnPlanillaRespuestas && !btnPlanillaRespuestas.onclick) {
            console.log('‚ö†Ô∏è Configurando bot√≥n PLANILLA DE RESPUESTAS desde window.onload');
            configurarBotonPlanillaRespuestas();
        }
        
        // Cargar historial si no se ha cargado
        if (historialRegistros.length === 0) {
            console.log('‚ö†Ô∏è Cargando historial desde window.onload');
            cargarHistorialGuardado();
        }
    });

    // ============ FUNCIONES DEL SISTEMA DE PENDIENTES ============
    
    // Funci√≥n para configurar bot√≥n de pendientes
    function configurarBotonPendiente() {
        const btnPendiente = document.getElementById('btnPendiente');
        if (btnPendiente) {
            btnPendiente.onclick = function() {
                console.log('üîÑ Bot√≥n PENDIENTE presionado');
                abrirModalPendiente();
            };
            console.log('‚úÖ Evento del bot√≥n PENDIENTE configurado');
        } else {
            console.error('‚ùå Bot√≥n PENDIENTE no encontrado');
        }
    }
    
    // Funci√≥n para abrir modal de pendientes
    function abrirModalPendiente() {
        console.log('üîÑ Abriendo modal de pendientes');
        const modal = document.getElementById('modalPendiente');
        if (modal) {
            modal.style.display = 'flex';
            // Establecer fecha de registro autom√°tica (hoy)
            const hoy = new Date();
            const fechaLocal = hoy.toISOString().split('T')[0];
            document.getElementById('fechaRegistroPendiente').value = fechaLocal;
            
            // Establecer fecha m√≠nima para recordatorio (ahora)
            const ahora = new Date();
            const fechaHoraLocal = new Date(ahora.getTime() - (ahora.getTimezoneOffset() * 60000));
            document.getElementById('fechaRecordatorioPendiente').min = fechaHoraLocal.toISOString().slice(0, 16);
            
            cargarTareasPendientes();
            console.log('‚úÖ Modal de pendientes abierto');
        } else {
            console.error('‚ùå Modal de pendientes no encontrado');
        }
    }
    
    function cerrarModalPendiente() {
        console.log('üîÑ Cerrando modal de pendientes');
        const modal = document.getElementById('modalPendiente');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de pendientes cerrado');
        }
    }
    
    // Funci√≥n para guardar nueva tarea pendiente
    function guardarPendiente() {
        const fechaRegistro = document.getElementById('fechaRegistroPendiente').value;
        const fechaRecordatorio = document.getElementById('fechaRecordatorioPendiente').value;
        const titulo = document.getElementById('tituloPendiente').value.trim();
        const observaciones = document.getElementById('observacionesPendiente').value.trim();
        const prioridad = document.getElementById('prioridadPendiente').value;
        const categoria = document.getElementById('categoriaPendiente').value;
        
        // Validaciones
        if (!fechaRecordatorio) {
            alert('‚ùå Debe seleccionar fecha y hora para el recordatorio');
            document.getElementById('fechaRecordatorioPendiente').focus();
            return;
        }
        
        const fechaRecordatorioDate = new Date(fechaRecordatorio);
        const ahora = new Date();
        
        if (fechaRecordatorioDate <= ahora) {
            alert('‚ùå La fecha de recordatorio debe ser futura');
            document.getElementById('fechaRecordatorioPendiente').focus();
            return;
        }
        
        if (!titulo) {
            alert('‚ùå El t√≠tulo es requerido');
            document.getElementById('tituloPendiente').focus();
            return;
        }
        
        if (!observaciones) {
            alert('‚ùå Las observaciones son requeridas');
            document.getElementById('observacionesPendiente').focus();
            return;
        }
        
        // Crear nueva tarea pendiente
        const nuevaPendiente = {
            id: Date.now().toString() + Math.floor(Math.random() * 1000).toString(), // ID √∫nico como string
            fechaRegistro: fechaRegistro,
            fechaRecordatorio: fechaRecordatorio,
            titulo: titulo,
            observaciones: observaciones,
            prioridad: prioridad,
            categoria: categoria,
            estado: 'Pendiente',
            fechaCreacion: new Date().toISOString()
        };
        
        // Agregar al array
        tareasPendientes.push(nuevaPendiente);
        guardarTareasPendientes();
        actualizarTablaPendientes();
        programarRecordatorio(nuevaPendiente);
        limpiarFormularioPendiente();
        
        // Reproducir sonido de confirmaci√≥n
        reproducirSonidoConfirmacion();
        
        mostrarMensajeTemp('üìù Tarea pendiente registrada y recordatorio programado', '#007bff');
        console.log('‚úÖ Nueva tarea pendiente registrada:', nuevaPendiente);
    }
    
    // Funci√≥n para limpiar formulario de pendientes
    function limpiarFormularioPendiente() {
        document.getElementById('tituloPendiente').value = '';
        document.getElementById('observacionesPendiente').value = '';
        document.getElementById('fechaRecordatorioPendiente').value = '';
        document.getElementById('prioridadPendiente').selectedIndex = 1; // Media
        document.getElementById('categoriaPendiente').selectedIndex = 0; // Administraci√≥n
        
        // Establecer fecha de registro autom√°tica (hoy)
        const hoy = new Date();
        const fechaLocal = hoy.toISOString().split('T')[0];
        document.getElementById('fechaRegistroPendiente').value = fechaLocal;
    }
    
    // Funci√≥n para programar recordatorio
    function programarRecordatorio(tarea) {
        const fechaRecordatorio = new Date(tarea.fechaRecordatorio);
        const ahora = new Date();
        const tiempoEspera = fechaRecordatorio.getTime() - ahora.getTime();
        
        if (tiempoEspera > 0) {
            const timeoutId = setTimeout(() => {
                mostrarRecordatorioEmergente(tarea);
            }, tiempoEspera);
            
            // Guardar el ID del timeout para poder cancelarlo
            intervalosRecordatorio.push({
                id: tarea.id,
                timeoutId: timeoutId
            });
            
            console.log(`‚è∞ Recordatorio programado para: ${fechaRecordatorio.toLocaleString()}`);
        }
    }
    
    // Funci√≥n para mostrar recordatorio emergente con sonido
    function mostrarRecordatorioEmergente(tarea) {
        // Reproducir sonido de alerta
        reproducirSonidoAlertaUrgente();
        
        // Crear overlay
        const overlay = document.createElement('div');
        overlay.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 123, 255, 0.95);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: recordatorioBlink 1s infinite;
        `;
        
        // Crear modal de recordatorio
        const popup = document.createElement('div');
        popup.style.cssText = `
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            text-align: center;
            border: 4px solid #007bff;
            animation: recordatorioShake 0.5s ease-in-out infinite;
        `;
        
        // Icono y colores seg√∫n prioridad
        const iconosPrioridad = {
            'Cr√≠tica': 'üö®',
            'Alta': 'üî¥',
            'Media': 'üü°',
            'Baja': 'üü¢'
        };
        
        const coloresPrioridad = {
            'Cr√≠tica': '#dc3545',
            'Alta': '#fd7e14', 
            'Media': '#ffc107',
            'Baja': '#28a745'
        };
        
        const icono = iconosPrioridad[tarea.prioridad] || 'üìù';
        const color = coloresPrioridad[tarea.prioridad] || '#007bff';
        
        const categoriaIconos = {
            'Administraci√≥n': 'üìä',
            'Cliente': 'üë•',
            'Documentos': 'üìÑ',
            'Seguimiento': 'üîç',
            'Urgente': '‚ö°',
            'Otro': 'üìå'
        };
        
        popup.innerHTML = `
            <div style="font-size: 5em; margin-bottom: 20px; animation: pulse 1s infinite;">üìù</div>
            <h1 style="color: #007bff; margin-bottom: 20px; font-size: 2.2em; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">¬°RECORDATORIO DE TAREA PENDIENTE!</h1>
            <div style="background: #f8f9fa; padding: 25px; border-radius: 12px; margin-bottom: 20px; text-align: left; border: 2px solid ${color};">
                <p style="margin: 8px 0; font-size: 1.1em;"><strong>${categoriaIconos[tarea.categoria] || 'üìå'} Categor√≠a:</strong> ${tarea.categoria}</p>
                <p style="margin: 8px 0; font-size: 1.3em; color: ${color}; font-weight: bold;"><strong>üè∑Ô∏è Tarea:</strong> ${tarea.titulo}</p>
                <p style="margin: 8px 0; font-size: 1.1em;"><strong>üìù Observaciones:</strong> ${tarea.observaciones}</p>
                <p style="margin: 8px 0; font-size: 1.1em;"><strong>‚ö° Prioridad:</strong> <span style="color: ${color}; font-weight: bold;">${icono} ${tarea.prioridad}</span></p>
                <p style="margin: 8px 0; font-size: 1em;"><strong>üìÖ Registrado:</strong> ${new Date(tarea.fechaRegistro).toLocaleDateString('es-CL')}</p>
                <p style="margin: 8px 0; font-size: 1em;"><strong>‚è∞ Recordatorio para:</strong> ${new Date(tarea.fechaRecordatorio).toLocaleString('es-CL')}</p>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button id="completarTarea" style="
                    background: #28a745;
                    color: white;
                    border: none;
                    padding: 15px 25px;
                    border-radius: 8px;
                    font-size: 1.1em;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">‚úÖ COMPLETADA</button>
                <button id="posponerTarea" style="
                    background: #17a2b8;
                    color: white;
                    border: none;
                    padding: 15px 25px;
                    border-radius: 8px;
                    font-size: 1.1em;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">‚è∞ POSPONER 30 MIN</button>
                <button id="cerrarRecordatorio" style="
                    background: #007bff;
                    color: white;
                    border: none;
                    padding: 15px 25px;
                    border-radius: 8px;
                    font-size: 1.1em;
                    font-weight: bold;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">üëÅÔ∏è ENTENDIDO</button>
            </div>
        `;
        
        overlay.appendChild(popup);
        document.body.appendChild(overlay);
        
        // Agregar estilos de animaci√≥n
        const style = document.createElement('style');
        style.textContent = `
            @keyframes recordatorioBlink {
                0%, 50% { background: rgba(0, 123, 255, 0.95); }
                51%, 100% { background: rgba(0, 123, 255, 0.7); }
            }
            @keyframes recordatorioShake {
                0%, 100% { transform: translateX(0px); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
        
        // Configurar botones del pop-up
        document.getElementById('completarTarea').onclick = function() {
            marcarTareaCompletada(tarea.id);
            document.body.removeChild(overlay);
            document.head.removeChild(style);
            mostrarMensajeTemp('‚úÖ Tarea marcada como completada', '#28a745');
        };
        
        document.getElementById('posponerTarea').onclick = function() {
            posponerTarea(tarea, 30); // 30 minutos
            document.body.removeChild(overlay);
            document.head.removeChild(style);
            mostrarMensajeTemp('‚è∞ Tarea pospuesta 30 minutos', '#17a2b8');
        };
        
        document.getElementById('cerrarRecordatorio').onclick = function() {
            document.body.removeChild(overlay);
            document.head.removeChild(style);
        };
        
        console.log('üîî Recordatorio de tarea mostrado:', tarea);
    }
    
    // Funci√≥n para marcar tarea como completada
    function marcarTareaCompletada(tareaId) {
        const tarea = tareasPendientes.find(t => t.id === tareaId);
        if (tarea) {
            tarea.estado = 'Completada';
            tarea.fechaCompletada = new Date().toISOString();
            guardarTareasPendientes();
            actualizarTablaPendientes();
            console.log('‚úÖ Tarea marcada como completada:', tarea);
        }
    }
    
    // Funci√≥n para posponer tarea
    function posponerTarea(tarea, minutos) {
        const nuevaFecha = new Date(tarea.fechaRecordatorio);
        nuevaFecha.setMinutes(nuevaFecha.getMinutes() + minutos);
        
        tarea.fechaRecordatorio = nuevaFecha.toISOString().slice(0, 16);
        guardarTareasPendientes();
        actualizarTablaPendientes();
        
        // Reprogramar recordatorio
        programarRecordatorio(tarea);
        
        console.log(`‚è∞ Tarea pospuesta ${minutos} minutos. Nueva fecha:`, nuevaFecha.toLocaleString());
    }
    
    // Funci√≥n para cargar tareas desde localStorage
    function cargarTareasPendientes() {
        try {
            const datos = localStorage.getItem('tareasPendientesAchs');
            if (datos && datos !== 'null') {
                tareasPendientes = JSON.parse(datos);
                actualizarTablaPendientes();
                // Reprogramar recordatorios para tareas pendientes
                tareasPendientes.forEach(tarea => {
                    if (tarea.estado === 'Pendiente') {
                        programarRecordatorio(tarea);
                    }
                });
                console.log('‚úÖ Tareas pendientes cargadas:', tareasPendientes.length);
            }
        } catch (error) {
            console.error('‚ùå Error al cargar tareas pendientes:', error);
            tareasPendientes = [];
        }
    }
    
    // Funci√≥n para guardar tareas en localStorage
    function guardarTareasPendientes() {
        try {
            localStorage.setItem('tareasPendientesAchs', JSON.stringify(tareasPendientes));
            console.log('üíæ Tareas pendientes guardadas en localStorage');
        } catch (error) {
            console.error('‚ùå Error al guardar tareas pendientes:', error);
        }
    }
    
    // Funci√≥n para actualizar tabla de pendientes
    function actualizarTablaPendientes() {
        console.log('üîÑ Actualizando tabla de pendientes...');
        const tbody = document.querySelector('#tablaPendientes tbody');
        
        if (!tbody) {
            console.error('‚ùå No se encontr√≥ el tbody de la tabla pendientes');
            return;
        }
        
        console.log('üìã N√∫mero de tareas pendientes:', tareasPendientes.length);
        
        tbody.innerHTML = '';
        
        if (tareasPendientes.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px; color:#666;">No hay tareas pendientes registradas</td></tr>';
            console.log('üìù Tabla vac√≠a - no hay tareas pendientes');
            return;
        }
        
        tareasPendientes.forEach((tarea, index) => {
            console.log(`üîÑ Procesando tarea ${index + 1}:`, tarea.titulo, 'ID:', tarea.id);
            
            const coloresPrioridad = {
                'Cr√≠tica': '#dc3545',
                'Alta': '#fd7e14',
                'Media': '#ffc107',
                'Baja': '#28a745'
            };
            
            const colorEstado = tarea.estado === 'Completada' ? '#28a745' : '#007bff';
            
            const row = tbody.insertRow();
            
            // Crear celdas individualmente para mejor control
            const cellFechaRegistro = row.insertCell(0);
            cellFechaRegistro.style.cssText = 'border:1px solid #ddd; padding:8px;';
            cellFechaRegistro.textContent = new Date(tarea.fechaRegistro).toLocaleDateString('es-CL');
            
            const cellFechaRecordatorio = row.insertCell(1);
            cellFechaRecordatorio.style.cssText = 'border:1px solid #ddd; padding:8px;';
            cellFechaRecordatorio.textContent = new Date(tarea.fechaRecordatorio).toLocaleString('es-CL');
            
            const cellTitulo = row.insertCell(2);
            cellTitulo.style.cssText = 'border:1px solid #ddd; padding:8px; font-weight:bold;';
            cellTitulo.textContent = tarea.titulo;
            
            const cellCategoria = row.insertCell(3);
            cellCategoria.style.cssText = 'border:1px solid #ddd; padding:8px;';
            cellCategoria.textContent = tarea.categoria;
            
            const cellPrioridad = row.insertCell(4);
            cellPrioridad.style.cssText = `border:1px solid #ddd; padding:8px; text-align:center; color:${coloresPrioridad[tarea.prioridad]}; font-weight:bold;`;
            cellPrioridad.textContent = tarea.prioridad;
            
            const cellEstado = row.insertCell(5);
            cellEstado.style.cssText = `border:1px solid #ddd; padding:8px; text-align:center; color:${colorEstado}; font-weight:bold;`;
            cellEstado.textContent = tarea.estado;
            
            const cellAcciones = row.insertCell(6);
            cellAcciones.style.cssText = 'border:1px solid #ddd; padding:8px; text-align:center;';
            
            const btnEliminar = document.createElement('button');
            btnEliminar.style.cssText = 'background:#dc3545; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer;';
            btnEliminar.title = 'Eliminar tarea';
            btnEliminar.textContent = 'üóëÔ∏è';
            btnEliminar.onclick = function() {
                eliminarTareaPendiente(tarea.id);
            };
            
            cellAcciones.appendChild(btnEliminar);
            
            console.log(`‚úÖ Tarea agregada a tabla - ID: ${tarea.id}, T√≠tulo: ${tarea.titulo}`);
        });
        
        console.log('‚úÖ Tabla de pendientes actualizada con', tareasPendientes.length, 'tareas');
    }
    
    // Funci√≥n para eliminar tarea pendiente
    function eliminarTareaPendiente(tareaId) {
        console.log('üóëÔ∏è Intentando eliminar tarea pendiente:', tareaId);
        console.log('üìã Tareas pendientes antes de eliminar:', tareasPendientes.length);
        console.log('üìã Lista completa de IDs:', tareasPendientes.map(t => t.id));
        
        // Verificar que el tareaId no sea undefined o null
        if (!tareaId) {
            console.error('‚ùå ID de tarea no v√°lido:', tareaId);
            mostrarMensajeTemp('‚ùå Error: ID de tarea no v√°lido', '#dc3545');
            return;
        }
        
        // Convertir a string para comparaci√≥n consistente
        const tareaIdStr = String(tareaId);
        
        if (confirm('¬øEst√° seguro de que desea eliminar esta tarea pendiente?')) {
            // Buscar la tarea antes de eliminar
            const tareaAEliminar = tareasPendientes.find(t => String(t.id) === tareaIdStr);
            console.log('üîç Tarea encontrada:', tareaAEliminar);
            
            if (!tareaAEliminar) {
                console.error('‚ùå No se encontr√≥ la tarea con ID:', tareaIdStr);
                console.log('üîç IDs disponibles:', tareasPendientes.map(t => String(t.id)));
                mostrarMensajeTemp('‚ùå Error: Tarea no encontrada', '#dc3545');
                return;
            }
            
            // Cancelar recordatorio si existe
            const intervalo = intervalosRecordatorio.find(i => String(i.id) === tareaIdStr);
            if (intervalo) {
                clearTimeout(intervalo.timeoutId);
                intervalosRecordatorio = intervalosRecordatorio.filter(i => String(i.id) !== tareaIdStr);
                console.log('‚è∞ Recordatorio cancelado para tarea:', tareaIdStr);
            }
            
            // Eliminar la tarea del array
            const lengthAntes = tareasPendientes.length;
            tareasPendientes = tareasPendientes.filter(t => String(t.id) !== tareaIdStr);
            const lengthDespues = tareasPendientes.length;
            
            console.log(`üìä Tareas antes: ${lengthAntes}, despu√©s: ${lengthDespues}`);
            
            if (lengthAntes === lengthDespues) {
                console.error('‚ùå No se elimin√≥ ninguna tarea');
                console.log('üîç ID buscado:', tareaIdStr);
                console.log('üîç IDs en array:', tareasPendientes.map(t => String(t.id)));
                mostrarMensajeTemp('‚ùå Error al eliminar la tarea', '#dc3545');
                return;
            }
            
            // Guardar en localStorage
            try {
                guardarTareasPendientes();
                console.log('üíæ Tareas guardadas en localStorage');
            } catch (error) {
                console.error('‚ùå Error al guardar:', error);
            }
            
            // Actualizar la tabla
            try {
                actualizarTablaPendientes();
                console.log('üîÑ Tabla actualizada');
            } catch (error) {
                console.error('‚ùå Error al actualizar tabla:', error);
            }
            
            // Mostrar mensaje de √©xito
            mostrarMensajeTemp('üóëÔ∏è Tarea pendiente eliminada', '#dc3545');
            
            // Notificaci√≥n push si est√° disponible
            if (typeof showNotification === 'function') {
                showNotification('üóëÔ∏è Tarea Eliminada', `La tarea "${tareaAEliminar.titulo}" ha sido eliminada.`, 'info');
            }
            
            console.log('‚úÖ Tarea pendiente eliminada exitosamente:', tareaIdStr);
        } else {
            console.log('üö´ Eliminaci√≥n cancelada por el usuario');
        }
    }
    
    // Funci√≥n para verificar recordatorios pendientes
    function verificarRecordatoriosPendientes() {
        const ahora = new Date();
        const recordatoriosPendientes = tareasPendientes.filter(tarea => {
            const fechaRecordatorio = new Date(tarea.fechaRecordatorio);
            return tarea.estado === 'Pendiente' && fechaRecordatorio > ahora;
        });
        
        let mensaje = `üìä Recordatorios pendientes: ${recordatoriosPendientes.length}\n\n`;
        
        if (recordatoriosPendientes.length > 0) {
            recordatoriosPendientes.slice(0, 5).forEach((tarea, index) => {
                const fechaRecordatorio = new Date(tarea.fechaRecordatorio);
                const tiempoRestante = fechaRecordatorio.getTime() - ahora.getTime();
                const horasRestantes = Math.floor(tiempoRestante / (1000 * 60 * 60));
                const minutosRestantes = Math.floor((tiempoRestante % (1000 * 60 * 60)) / (1000 * 60));
                
                mensaje += `${index + 1}. ${tarea.titulo}\n`;
                mensaje += `   üìÖ ${fechaRecordatorio.toLocaleString('es-CL')}\n`;
                mensaje += `   ‚è∞ Faltan: ${horasRestantes}h ${minutosRestantes}m\n\n`;
            });
            
            if (recordatoriosPendientes.length > 5) {
                mensaje += `... y ${recordatoriosPendientes.length - 5} m√°s`;
            }
        } else {
            mensaje += 'No hay recordatorios pendientes programados.';
        }
        
        alert(mensaje);
    }
    
    // Funci√≥n para exportar pendientes a Excel
    function exportarPendientes() {
        if (tareasPendientes.length === 0) {
            alert('‚ùå No hay tareas pendientes para exportar');
            return;
        }
        
        try {
            // Crear datos para exportar
            const datosExportar = tareasPendientes.map(tarea => ({
                'Fecha Registro': new Date(tarea.fechaRegistro).toLocaleDateString('es-CL'),
                'Fecha Recordatorio': new Date(tarea.fechaRecordatorio).toLocaleString('es-CL'),
                'T√≠tulo': tarea.titulo,
                'Observaciones': tarea.observaciones,
                'Categor√≠a': tarea.categoria,
                'Prioridad': tarea.prioridad,
                'Estado': tarea.estado,
                'Fecha Completada': tarea.fechaCompletada ? new Date(tarea.fechaCompletada).toLocaleString('es-CL') : 'N/A'
            }));
            
            // Convertir a CSV
            const headers = Object.keys(datosExportar[0]);
            const csvContent = [
                headers.join(','),
                ...datosExportar.map(row => headers.map(header => `"${row[header]}"`).join(','))
            ].join('\n');
            
            // Crear y descargar archivo
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `tareas_pendientes_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            mostrarMensajeTemp('üì• Tareas pendientes exportadas exitosamente', '#28a745');
            console.log('üì• Tareas pendientes exportadas:', tareasPendientes.length);
        } catch (error) {
            console.error('‚ùå Error al exportar tareas pendientes:', error);
            alert('‚ùå Error al exportar las tareas pendientes');
        }
    }

    // ============ FUNCIONES DEL SISTEMA DE PLANILLA DE RESPUESTAS ============
    
    // Funci√≥n para configurar bot√≥n de planilla de respuestas
    function configurarBotonPlanillaRespuestas() {
        const btnPlanillaRespuestas = document.getElementById('btnPlanillaRespuestas');
        if (btnPlanillaRespuestas) {
            btnPlanillaRespuestas.onclick = function() {
                console.log('üîÑ Bot√≥n PLANILLA DE RESPUESTAS presionado');
                abrirModalPlanillaRespuestas();
            };
            console.log('‚úÖ Evento del bot√≥n PLANILLA DE RESPUESTAS configurado');
        } else {
            console.error('‚ùå Bot√≥n PLANILLA DE RESPUESTAS no encontrado');
        }
    }
    
    // Funci√≥n para abrir modal de planilla de respuestas
    function abrirModalPlanillaRespuestas() {
        console.log('üîÑ Abriendo modal de planilla de respuestas');
        const modal = document.getElementById('modalPlanillaRespuestas');
        if (modal) {
            modal.style.display = 'flex';
            inicializarBusquedaRespuestas();
            console.log('‚úÖ Modal de planilla de respuestas abierto');
        } else {
            console.error('‚ùå Modal de planilla de respuestas no encontrado');
        }
    }
    
    function cerrarModalPlanillaRespuestas() {
        console.log('üîÑ Cerrando modal de planilla de respuestas');
        const modal = document.getElementById('modalPlanillaRespuestas');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de planilla de respuestas cerrado');
        }
    }
    
    // Funci√≥n para copiar respuesta al portapapeles
    function copiarRespuesta(elemento) {
        const textoRespuesta = elemento.querySelector('.texto-respuesta').textContent;
        
        // Copiar al portapapeles
        navigator.clipboard.writeText(textoRespuesta).then(function() {
            // Mostrar feedback visual
            elemento.style.backgroundColor = '#d4edda';
            elemento.style.border = '2px solid #28a745';
            
            // Agregar icono de copiado temporalmente
            const iconoOriginal = elemento.innerHTML;
            elemento.innerHTML = `‚úÖ COPIADO: ${textoRespuesta}`;
            
            // Restaurar despu√©s de 2 segundos
            setTimeout(() => {
                elemento.innerHTML = iconoOriginal;
                elemento.style.backgroundColor = 'white';
                elemento.style.border = '1px solid #ddd';
            }, 2000);
            
            // Reproducir sonido de confirmaci√≥n
            reproducirSonidoConfirmacion();
            
            mostrarMensajeTemp('üìã Respuesta copiada al portapapeles', '#28a745');
            console.log('‚úÖ Respuesta copiada:', textoRespuesta);
        }).catch(function(err) {
            console.error('‚ùå Error al copiar al portapapeles:', err);
            
            // Fallback: seleccionar texto
            const range = document.createRange();
            range.selectNode(elemento.querySelector('.texto-respuesta'));
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            
            mostrarMensajeTemp('üìã Texto seleccionado. Use Ctrl+C para copiar', '#ffc107');
        });
    }
    
    // Funci√≥n para alternar categor√≠as (expandir/colapsar)
    function toggleCategoria(categoria) {
        const content = document.getElementById(`content-${categoria}`);
        const toggle = document.getElementById(`toggle-${categoria}`);
        
        if (content && toggle) {
            if (content.style.display === 'none') {
                content.style.display = 'block';
                toggle.textContent = '‚ñº';
            } else {
                content.style.display = 'none';
                toggle.textContent = '‚ñ∂';
            }
        }
    }
    
    // Funci√≥n para inicializar b√∫squeda de respuestas
    function inicializarBusquedaRespuestas() {
        const buscarInput = document.getElementById('buscarRespuesta');
        const filtroCategoria = document.getElementById('filtroCategoria');
        
        if (buscarInput) {
            buscarInput.addEventListener('input', filtrarRespuestas);
        }
        
        if (filtroCategoria) {
            filtroCategoria.addEventListener('change', filtrarRespuestas);
        }
        
        // Expandir todas las categor√≠as por defecto
        const categorias = ['acuso-recibo', 'bloqueos', 'cambios-cita', 'opciones-completas', 'finalizacion', 'contacto-paciente'];
        categorias.forEach(categoria => {
            const content = document.getElementById(`content-${categoria}`);
            const toggle = document.getElementById(`toggle-${categoria}`);
            if (content && toggle) {
                content.style.display = 'block';
                toggle.textContent = '‚ñº';
            }
        });
    }
    
    // Funci√≥n para filtrar respuestas
    function filtrarRespuestas() {
        const busqueda = document.getElementById('buscarRespuesta').value.toLowerCase();
        const categoriaSeleccionada = document.getElementById('filtroCategoria').value;
        
        const todasLasCategorias = document.querySelectorAll('.categoria-respuestas');
        let respuestasVisibles = 0;
        let categoriasVisibles = 0;
        
        todasLasCategorias.forEach(categoria => {
            const categoriaNombre = categoria.getAttribute('data-categoria');
            let mostrarCategoria = false;
            
            // Filtrar por categor√≠a
            if (categoriaSeleccionada === 'todas' || categoriaSeleccionada === categoriaNombre) {
                const respuestas = categoria.querySelectorAll('.respuesta-item');
                
                respuestas.forEach(respuesta => {
                    const textoRespuesta = respuesta.querySelector('.texto-respuesta').textContent.toLowerCase();
                    
                    if (!busqueda || textoRespuesta.includes(busqueda)) {
                        respuesta.style.display = 'block';
                        mostrarCategoria = true;
                        respuestasVisibles++;
                    } else {
                        respuesta.style.display = 'none';
                    }
                });
                
                if (mostrarCategoria) {
                    categoria.style.display = 'block';
                    categoriasVisibles++;
                } else {
                    categoria.style.display = 'none';
                }
            } else {
                categoria.style.display = 'none';
            }
        });
        
        // Actualizar estad√≠sticas
        const estadisticas = document.getElementById('estadisticasRespuestas');
        if (estadisticas) {
            estadisticas.innerHTML = `üìä Respuestas encontradas: <strong>${respuestasVisibles}</strong> | üìÇ Categor√≠as visibles: <strong>${categoriasVisibles}</strong>`;
        }
        
        // Mostrar mensaje si no hay resultados
        if (respuestasVisibles === 0) {
            mostrarMensajeNoResultados();
        } else {
            ocultarMensajeNoResultados();
        }
    }
    
    // Funci√≥n para mostrar mensaje de no resultados
    function mostrarMensajeNoResultados() {
        let mensajeExistente = document.getElementById('mensajeNoResultados');
        if (!mensajeExistente) {
            const contenedor = document.getElementById('contenedorRespuestas');
            const mensaje = document.createElement('div');
            mensaje.id = 'mensajeNoResultados';
            mensaje.style.cssText = `
                text-align: center;
                padding: 40px;
                color: #666;
                font-size: 1.1em;
                background: #f8f9fa;
                border-radius: 12px;
                border: 2px dashed #ddd;
                margin: 20px 0;
            `;
            mensaje.innerHTML = `
                <div style="font-size: 3em; margin-bottom: 15px;">üîç</div>
                <h3 style="color: #666; margin-bottom: 10px;">No se encontraron resultados</h3>
                <p style="margin: 0;">Intenta con otros t√©rminos de b√∫squeda o selecciona una categor√≠a diferente.</p>
            `;
            contenedor.appendChild(mensaje);
        }
    }
    
    // Funci√≥n para ocultar mensaje de no resultados
    function ocultarMensajeNoResultados() {
        const mensaje = document.getElementById('mensajeNoResultados');
        if (mensaje) {
            mensaje.remove();
        }
    }
    
    // Funci√≥n para limpiar b√∫squeda
    function limpiarBusqueda() {
        const buscarInput = document.getElementById('buscarRespuesta');
        const filtroCategoria = document.getElementById('filtroCategoria');
        
        if (buscarInput) {
            buscarInput.value = '';
        }
        
        if (filtroCategoria) {
            filtroCategoria.selectedIndex = 0;
        }
        
        // Mostrar todas las respuestas
        const todasLasRespuestas = document.querySelectorAll('.respuesta-item');
        const todasLasCategorias = document.querySelectorAll('.categoria-respuestas');
        
        todasLasRespuestas.forEach(respuesta => {
            respuesta.style.display = 'block';
        });
        
        todasLasCategorias.forEach(categoria => {
            categoria.style.display = 'block';
        });
        
        // Restaurar estad√≠sticas
        const estadisticas = document.getElementById('estadisticasRespuestas');
        if (estadisticas) {
            estadisticas.innerHTML = 'üìä Total de respuestas: <strong>30</strong> | üìÇ Categor√≠as: <strong>6</strong>';
        }
        
        // Ocultar mensaje de no resultados si existe
        ocultarMensajeNoResultados();
        
        mostrarMensajeTemp('üßπ Filtros limpiados', '#6c757d');
    }
    
    // Funci√≥n para integrar con el sistema de emails (si est√° abierto)
    function integrarConEmails(texto) {
        const modalEmails = document.getElementById('modalEmails');
        const modalRedactar = document.getElementById('modalRedactarEmail');
        const contenidoEmail = document.getElementById('contenidoEmail');
        
        if (modalEmails && modalEmails.style.display === 'flex') {
            // Si el modal de emails est√° abierto, abrir redacci√≥n
            if (modalRedactar && contenidoEmail) {
                modalRedactar.style.display = 'flex';
                contenidoEmail.value = texto;
                mostrarMensajeTemp('üìß Texto insertado en el email', '#007bff');
            }
        }
    }
    
    // ========== FUNCIONES PARA SCRIPT EP (ENFERMEDADES PROFESIONALES) ==========
    
    function abrirModalScriptEP() {
        console.log('üîÑ Abriendo modal Script EP');
        const modal = document.getElementById('modalScriptEP');
        if (modal) {
            modal.style.display = 'flex';
            console.log('‚úÖ Modal Script EP abierto correctamente');
            
            // Reproducir sonido de alerta para llamar la atenci√≥n
            reproducirSonidoConfirmacion();
            
            // Mostrar mensaje temporal
            mostrarMensajeTemp('üè• Script EP cargado - Protocolo de Enfermedades Profesionales', '#dc3545');
        } else {
            console.error('‚ùå Modal Script EP no encontrado');
            alert('‚ùå Error: Modal Script EP no encontrado');
        }
    }
    
    function cerrarModalScriptEP() {
        console.log('üîÑ Cerrando modal Script EP');
        const modal = document.getElementById('modalScriptEP');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal Script EP cerrado');
        }
    }
    
    function copiarScript() {
        // Obtener todo el contenido del script actualizado
        const contenidoScript = `
SCRIPT EP - PROTOCOLO DE ATENCI√ìN PARA ENFERMEDADES PROFESIONALES

üè• CLASIFICACI√ìN DE LA ENFERMEDAD
"¬øMe podr√≠a indicar por favor si su posible enfermedad profesional corresponde a la categor√≠a de Salud Mental o es Musculo esquel√©tico (como por ejemplo dolor de hombro, codo, mu√±eca)?"

"¬øHab√≠a asistido anteriormente a alguna agencia de ACHS por esta misma enfermedad?"

"¬øEn qu√© regi√≥n se encuentra ubicado usted?"

‚úÖ VALIDACI√ìN DE DATOS PERSONALES
"Perfecto. A continuaci√≥n, pasar√© a validar sus datos personales:"
"¬øSu n√∫mero de tel√©fono es <XXXXXXXXX>?"
"correo: xxxxx"

üìã PROCESO DE ENFERMEDADES PROFESIONALES
"Quiero comentarle acerca del proceso de enfermedades profesionales."

Primero, ser√° atendido por un M√âDICO GENERAL y recibir√° las indicaciones para su tratamiento. En paralelo, un COMIT√â INICIAR√Å UN ESTUDIO por su patolog√≠a que tomar√° alrededor de 30 D√çAS APROXIMADAMENTE.

Esta investigaci√≥n se realizar√° para identificar si su patolog√≠a es de ORIGEN LABORAL, es decir, ocasionada por el trabajo o de ORIGEN COM√öN, enfermedad producto de situaciones externas a lo laboral.

"¬øSe entiende?"

üí∞ COBERTURA SEG√öN ORIGEN
‚úÖ Si su enfermedad es de ORIGEN LABORAL, sus atenciones y tratamiento estar√°n cubiertas por el seguro de la ley.

‚ùå Si su patolog√≠a es definida de ORIGEN COM√öN, los gastos asociados a su atenci√≥n y tratamiento ser√°n derivados a su previsi√≥n de salud (ISAPRE o FONASA).

"¬øDesea tomar la cita?"

  MODALIDAD DE ATENCI√ìN
"Para su tipo de atenci√≥n, la modalidad es a trav√©s de TELEMEDICINA."
"¬øConoce esta modalidad? ¬øSe ha atendido previamente por telemedicina?"

‚ö†Ô∏è INSTRUCCIONES IMPORTANTES
üìû LLAMADA TELEF√ìNICA OBLIGATORIA:
Ese d√≠a tambi√©n lo llamar√°n a su celular para hacer su admisi√≥n de manera telef√≥nica 20 MIN ANTES APROXIMADAMENTE. Por favor est√© atento a su tel√©fono el d√≠a de su ingreso y tenga su C√âDULA DE IDENTIDAD A MANO.

üö® ESTA LLAMADA ES OBLIGATORIA üö®
Si no contestan el llamado y se conectan NO SER√ÅN ATENDIDOS

En su atenci√≥n con el m√©dico, deber√° indicar DOS TESTIGOS DE LA EMPRESA para su caso, nombre y n√∫mero de tel√©fono. A ellos se les realizar√°n entrevistas de car√°cter confidencial. Si los testigos no est√°n ese d√≠a o no quisieran declarar, se deber√° tomar el testimonio a otros testigos que est√©n presentes ese d√≠a.

üì± Le informo que recibir√° un MENSAJE V√çA WHATSAPP con un video explicativo del proceso de evaluaci√≥n.

  AGENDAMIENTO
Quiero comentarle que su agendamiento para ingreso de enfermedad profesional de SALUD MENTAL, tanto para la CONSULTA M√âDICA como para la CITA CON EL PSIC√ìLOGO, ser√° gestionado y le llegar√° la informaci√≥n con detalles del d√≠a y hora de atenci√≥n dentro de las pr√≥ximas 24 HORAS H√ÅBILES a su correo electr√≥nico <xxxx@xxx.xx>.

"¬øTiene alguna preferencia AM (8 AM ‚Äì 13 PM) o PM (13 PM ‚Äì 18 PM) de su citaci√≥n?"
Intentaremos agendarlo en el bloque que nos indique seg√∫n disponibilidad.
Paciente: AM/PM/No tiene preferencia

Le recomiendo que revise su BANDEJA DE ENTRADA de su correo electr√≥nico en 24 horas h√°biles, y tambi√©n la carpeta de "SPAM" O "CORREO NO DESEADO", ya que los correos autom√°ticos pueden llegar all√≠. Este correo deber√≠a llegar en la ma√±ana del siguiente d√≠a h√°bil.

üìÑ LICENCIAS Y DOCUMENTACI√ìN
"¬øCuenta con licencias rechazadas o alg√∫n antecedente de su patolog√≠a?"

üìß Env√≠o de licencias rechazadas:
Deber√° enviar la licencia m√©dica rechazada y la resoluci√≥n del motivo de rechazo a la casilla SDTELEMEDICINA@ACHS.CL. Con su nombre y apellido en el asunto del correo.

üìé Medios de prueba:
MEDIOSDEPRUEBA@ACHS.CL

‚ö†Ô∏è Debe llevar el d√≠a de su atenci√≥n CUALQUIER ANTECEDENTE QUE APORTE A SU PATOLOG√çA.
        `;
        
        // Copiar al portapapeles
        navigator.clipboard.writeText(contenidoScript.trim()).then(function() {
            mostrarMensajeTemp('üìã Script EP actualizado copiado al portapapeles', '#28a745');
            console.log('‚úÖ Script EP actualizado copiado al portapapeles');
            
            // Reproducir sonido de confirmaci√≥n
            reproducirSonidoConfirmacion();
        }).catch(function(err) {
            console.error('‚ùå Error al copiar script EP:', err);
            mostrarMensajeTemp('‚ùå Error al copiar. Use Ctrl+A y Ctrl+C manualmente', '#dc3545');
        });
    }
    
    function imprimirScript() {
        // Crear ventana de impresi√≥n con el script formateado actualizado
        const ventanaImpresion = window.open('', '_blank', 'width=800,height=600');
        
        const contenidoImpresion = `
<!DOCTYPE html>
<html>
<head>
    <title>Script EP - Enfermedades Profesionales</title>
    <style>
        :root { --font-sans: 'Helvetica Rounded', 'Arial Rounded MT Bold', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif; }
        body { 
            font-family: var(--font-sans); 
            margin: 24px; 
            line-height: 1.55; 
            font-size: 0.95rem;
        }
        .header {
            background: #dc3545;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .seccion {
            margin-bottom: 25px;
            padding: 15px;
            border-left: 4px solid #007bff;
            background: #f8f9fa;
        }
        /* Estilos migrados a assets/css/styles.css (bloque SCRIPT EP) - 2025-11-10 */
    </style>
</head>
<body>
    <div class="header">
        <h1>üè• SCRIPT EP</h1>
        <p>Protocolo de Atenci√≥n para Enfermedades Profesionales - ACTUALIZADO</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">üè• CLASIFICACI√ìN DE LA ENFERMEDAD</div>
        <p class="pregunta">"¬øMe podr√≠a indicar por favor si su posible enfermedad profesional corresponde a la categor√≠a de Salud Mental o es Musculo esquel√©tico (como por ejemplo dolor de hombro, codo, mu√±eca)?"</p>
        <p class="pregunta">"¬øHab√≠a asistido anteriormente a alguna agencia de ACHS por esta misma enfermedad?"</p>
        <p class="pregunta">"¬øEn qu√© regi√≥n se encuentra ubicado usted?"</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">‚úÖ VALIDACI√ìN DE DATOS PERSONALES</div>
        <p><strong>"Perfecto. A continuaci√≥n, pasar√© a validar sus datos personales:"</strong></p>
        <p class="pregunta">"¬øSu n√∫mero de tel√©fono es <span class="destacado">&lt;XXXXXXXXX&gt;</span>?"</p>
        <p class="pregunta">"correo: <span class="destacado">xxxxx</span>"</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">üìã PROCESO DE ENFERMEDADES PROFESIONALES</div>
        <p><strong>"Quiero comentarle acerca del proceso de enfermedades profesionales."</strong></p>
        <p>Primero, ser√° atendido por un <span class="destacado">m√©dico general</span> y recibir√° las indicaciones para su tratamiento. En paralelo, un <span class="destacado">comit√© iniciar√° un estudio</span> por su patolog√≠a que tomar√° alrededor de <span class="destacado">30 d√≠as aproximadamente</span>.</p>
        <p>Esta investigaci√≥n se realizar√° para identificar si su patolog√≠a es de <span class="destacado">origen laboral</span>, es decir, ocasionada por el trabajo o de <span class="destacado">origen com√∫n</span>, enfermedad producto de situaciones externas a lo laboral.</p>
        <p class="pregunta">"¬øSe entiende?"</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">üí∞ COBERTURA SEG√öN ORIGEN</div>
        <div style="background:#c8e6c9; border:1px solid #4caf50; padding:10px; border-radius:5px; color:#2e7d32; margin:10px 0;">
            <strong>‚úÖ Si su enfermedad es de <span class="destacado">ORIGEN LABORAL</span>, sus atenciones y tratamiento estar√°n cubiertas por el seguro de la ley.</strong>
        </div>
        <div style="background:#ffcdd2; border:1px solid #f44336; padding:10px; border-radius:5px; color:#c62828; margin:10px 0;">
            <strong>‚ùå Si su patolog√≠a es definida de <span class="destacado">ORIGEN COM√öN</span>, los gastos asociados a su atenci√≥n y tratamiento ser√°n derivados a su previsi√≥n de salud (ISAPRE o FONASA).</strong>
        </div>
        <p class="pregunta">"¬øDesea tomar la cita?"</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">  MODALIDAD DE ATENCI√ìN</div>
        <p><strong>"Para su tipo de atenci√≥n, la modalidad es a trav√©s de <span class="destacado">telemedicina</span>."</strong></p>
        <p class="pregunta">"¬øConoce esta modalidad? ¬øSe ha atendido previamente por telemedicina?"</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">‚ö†Ô∏è INSTRUCCIONES IMPORTANTES</div>
        <div class="importante">
            <strong>  LLAMADA TELEF√ìNICA OBLIGATORIA:</strong><br>
            Ese d√≠a tambi√©n lo llamar√°n a su celular para hacer su admisi√≥n de manera telef√≥nica <span class="destacado">20 min antes aproximadamente</span>. Por favor est√© atento a su tel√©fono el d√≠a de su ingreso y tenga su <span class="destacado">c√©dula de identidad a mano</span>.
        </div>
        
        <div class="alerta-critica">
            üö® ESTA LLAMADA ES OBLIGATORIA üö®<br>
            Si no contestan el llamado y se conectan NO SER√ÅN ATENDIDOS
        </div>
        
        <p>En su atenci√≥n con el m√©dico, deber√° indicar <span class="destacado">dos testigos de la empresa</span> para su caso, nombre y n√∫mero de tel√©fono. A ellos se les realizar√°n entrevistas de car√°cter confidencial. Si los testigos no est√°n ese d√≠a o no quisieran declarar, se deber√° tomar el testimonio a otros testigos que est√©n presentes ese d√≠a.</p>
        
        <p>üì± Le informo que recibir√° un <span class="destacado">mensaje v√≠a WhatsApp</span> con un video explicativo del proceso de evaluaci√≥n.</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">  AGENDAMIENTO</div>
        <p>Quiero comentarle que su agendamiento para ingreso de enfermedad profesional de <span class="destacado">salud mental</span>, tanto para la <span class="destacado">consulta m√©dica</span> como para la <span class="destacado">cita con el psic√≥logo</span>, ser√° gestionado y le llegar√° la informaci√≥n con detalles del d√≠a y hora de atenci√≥n dentro de las pr√≥ximas <span class="destacado">24 horas h√°biles</span> a su correo electr√≥nico &lt;xxxx@xxx.xx&gt;.</p>
        
        <p class="pregunta">"¬øTiene alguna preferencia AM (8 AM ‚Äì 13 PM) o PM (13 PM ‚Äì 18 PM) de su citaci√≥n?"</p>
        <p>Intentaremos agendarlo en el bloque que nos indique seg√∫n disponibilidad.</p>
        <p><em>Paciente: AM/PM/No tiene preferencia</em></p>
        
        <p>Le recomiendo que revise su <span class="destacado">bandeja de entrada</span> de su correo electr√≥nico en 24 horas h√°biles, y tambi√©n la carpeta de <span class="destacado">"Spam" o "Correo no deseado"</span>, ya que los correos autom√°ticos pueden llegar all√≠. Este correo deber√≠a llegar en la ma√±ana del siguiente d√≠a h√°bil.</p>
    </div>
    
    <div class="seccion">
        <div class="titulo-seccion">üìÑ LICENCIAS Y DOCUMENTACI√ìN</div>
        <p class="pregunta">"¬øCuenta con licencias rechazadas o alg√∫n antecedente de su patolog√≠a?"</p>
        
        <div class="importante">
            <strong>üìß Env√≠o de licencias rechazadas:</strong><br>
            Deber√° enviar la licencia m√©dica rechazada y la resoluci√≥n del motivo de rechazo a la casilla <span class="destacado">SDTELEMEDICINA@ACHS.CL</span>. Con su nombre y apellido en el asunto del correo.
        </div>
        
        <div class="contacto">
            <strong>üìé Medios de prueba:</strong><br>
            <span class="destacado">MEDIOSDEPRUEBA@ACHS.CL</span>
        </div>
        
        <div class="importante" style="margin-top:15px;">
            <strong>‚ö†Ô∏è Debe llevar el d√≠a de su atenci√≥n <span class="destacado">cualquier antecedente que aporte a su patolog√≠a</span>.</strong>
        </div>
    </div>
    
    <div style="text-align:center; margin-top:30px; color:#666; font-size:0.9em;">
        <p>Documento generado desde ACHS Ejecutivo Centralizado</p>
        <p>Fecha: ${new Date().toLocaleDateString('es-CL')}</p>
    </div>
</body>
</html>
        `;
        
        ventanaImpresion.document.write(contenidoImpresion);
        ventanaImpresion.document.close();
        
        // Esperar a que se cargue y luego imprimir
        ventanaImpresion.onload = function() {
            ventanaImpresion.print();
        };
        
        mostrarMensajeTemp('üñ®Ô∏è Abriendo ventana de impresi√≥n actualizada...', '#007bff');
        console.log('‚úÖ Ventana de impresi√≥n actualizada abierta para Script EP');
    }

    // ========== FUNCIONES PARA SCRIPT SNL 2.0 (Contact Center ACHS Salud) ==========
    
    // Funci√≥n para mostrar/ocultar el submen√∫ SNL 2.0
    function toggleSubmenuSNL2() {
            const submenu = document.getElementById('submenuSNL2');
            const overlay = document.getElementById('overlaySubmenuSNL2');
            if (submenu && overlay) {
                const isVisible = submenu.style.display === 'block';
                if (isVisible) {
                    submenu.style.display = 'none';
                    submenu.classList.remove('show');
                    overlay.style.display = 'none';
                } else {
                    submenu.style.display = 'block';
                    submenu.classList.add('show');
                    overlay.style.display = 'block';
                }
            }
        }

        // Funci√≥n para cerrar el submen√∫ SNL 2.0
        function cerrarSubmenuSNL2() {
            const submenu = document.getElementById('submenuSNL2');
            const overlay = document.getElementById('overlaySubmenuSNL2');
            if (submenu) {
                submenu.style.display = 'none';
                submenu.classList.remove('show');
            }
            if (overlay) {
                overlay.style.display = 'none';
            }
        }

        // Cerrar el submen√∫ al hacer clic fuera
        document.addEventListener('click', function(e) {
            const btnSNL2 = document.getElementById('btnFloranteSNL2');
            const submenu = document.getElementById('submenuSNL2');
            if (btnSNL2 && submenu && !btnSNL2.contains(e.target) && !submenu.contains(e.target)) {
                cerrarSubmenuSNL2();
            }
        });
        
        function abrirModalScriptSNL2(tipo) {
            console.log('üîÑ Abriendo modal Script SNL 2.0 -', tipo);
            
            // Cerrar el submen√∫ y el overlay
            cerrarSubmenuSNL2();
            
            const modal = document.getElementById('modalScriptSNL2');
            if (modal) {
                // Actualizar el contenido del modal seg√∫n el tipo seleccionado
                actualizarContenidoSNL2(tipo);
                
                modal.style.display = 'flex';
                console.log('‚úÖ Modal Script SNL 2.0 abierto correctamente');
                
                // Reproducir sonido de confirmaci√≥n
                reproducirSonidoConfirmacion();
                
                // Mostrar mensaje temporal
                mostrarMensajeTemp('üìû Script SNL 2.0 cargado - ' + obtenerTituloSNL2(tipo), '#00d2ff');
            } else {
                console.error('‚ùå Modal Script SNL 2.0 no encontrado');
                alert('‚ùå Error: No se pudo abrir el modal Script SNL 2.0');
            }
        }
        
        function cerrarModalScriptSNL2() {
            console.log('üîÑ Cerrando modal Script SNL 2.0');
            const modal = document.getElementById('modalScriptSNL2');
            if (modal) {
                modal.style.display = 'none';
                console.log('‚úÖ Modal Script SNL 2.0 cerrado correctamente');
            } else {
                console.error('‚ùå Modal Script SNL 2.0 no encontrado');
            }
        }
        
        function obtenerTituloSNL2(tipo) {
            switch(tipo) {
                case 'intro':
                    return 'Intro Contact Center ACHS Salud';
                case 'menu':
                    return 'Men√∫ Principal y Submen√∫s';
                case 'procedimiento':
                    return 'Procedimiento de Agendamiento';
                case 'saludmental':
                    return 'Agendamiento Salud Mental';
                case 'traumatologia':
                    return 'Agendamiento Traumatolog√≠a';
                case 'kinesiologia':
                    return 'Agendamiento Kinesiolog√≠a';
                case 'medicinageneral':
                    return 'Agendamiento Medicina General';
                case 'medicinacuidado':
                    return 'Agendamiento Medicina del Cuidado';
                case 'dermatologia':
                    return 'Agendamiento Dermatolog√≠a';
                case 'despedida':
                    return 'Despedida';
                default:
                    return 'Contact Center ACHS Salud';
            }
        }
        
        function actualizarContenidoSNL2(tipo) {
            const modalContent = document.getElementById('modalScriptSNL2Content');
            if (!modalContent) {
                console.error('‚ùå No se encontr√≥ el contenedor del modal SNL 2.0');
                return;
            }
            
            let contenidoHTML = '';
            
            switch(tipo) {
                case 'intro':
                    contenidoHTML = generarContenidoIntro();
                    break;
                case 'menu':
                    contenidoHTML = generarContenidoMenu();
                    break;
                case 'procedimiento':
                    contenidoHTML = generarContenidoProcedimiento();
                    break;
                case 'saludmental':
                    contenidoHTML = generarContenidoSaludMentalSNL2();
                    break;
                case 'traumatologia':
                    contenidoHTML = generarContenidoTraumatologiaSNL2();
                    break;
                case 'kinesiologia':
                    contenidoHTML = generarContenidoKinesiologiaSNL2();
                    break;
                case 'medicinageneral':
                    contenidoHTML = generarContenidoMedicinaGeneralSNL2();
                    break;
                case 'medicinacuidado':
                    contenidoHTML = generarContenidoMedicinaCuidado();
                    break;
                case 'dermatologia':
                    contenidoHTML = generarContenidoDermatologiaSNL2();
                    break;
                case 'despedida':
                    contenidoHTML = generarContenidoDespedida();
                    break;
                default:
                    contenidoHTML = generarContenidoIntro();
            }
            
            modalContent.innerHTML = contenidoHTML;
            console.log('‚úÖ Contenido SNL 2.0 actualizado para:', tipo);
        }

        // Funciones para generar contenido espec√≠fico
        function generarContenidoIntro() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff; margin-bottom:20px;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üé§ Intro Contact Center ACHS Salud</h2>
                    <div style="background:white; padding:18px; border-radius:10px; margin-bottom:16px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">Primer mensaje:</h3>
                        <p style="font-size:1.1em; line-height:1.8; color:#222;">
                            <strong>Hola te damos la bienvenida a ACHS Salud</strong><br>
                            Reserva tu hora en <strong style="color:#00d2ff;">achssalud.cl</strong>
                        </p>
                    </div>
                </div>
            `;
        }

        function generarContenidoMenu() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff; margin-bottom:20px;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üìã Men√∫ Principal y Submen√∫s</h2>
                    
                    <div style="background:white; padding:18px; border-radius:10px; margin-bottom:16px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">Men√∫ Principal:</h3>
                        <ul style="list-style:none; padding:0; font-size:1.05em; line-height:2;">
                            <li>‚úÖ Para <strong>Reserva de hora</strong>, marca <strong style="color:#00d2ff;">1</strong></li>
                            <li>‚ùå Para <strong>Anular una hora</strong>, marca <strong style="color:#00d2ff;">2</strong></li>
                            <li>üí¨ Para <strong>otras consultas</strong>, marca <strong style="color:#00d2ff;">3</strong></li>
                        </ul>
                    </div>

                    <div style="background:#fff5e6; padding:18px; border-radius:10px; border:2px solid #ffd166;">
                        <h3 style="color:#e67e22; margin-bottom:12px;">Sub men√∫ 1 (Reserva de hora):</h3>
                        <ul style="list-style:none; padding:0; font-size:1.05em; line-height:2;">
                            <li>ü¶¥ Para consulta de <strong>Traumatolog√≠a</strong> con un m√©dico general, marca <strong style="color:#e67e22;">1</strong></li>
                            <li>üß¥ Para consulta de <strong>Dermatolog√≠a</strong> con un m√©dico general, marca <strong style="color:#e67e22;">2</strong></li>
                            <li>ü©∫ Para consulta de <strong>Medicina General</strong>, marca <strong style="color:#e67e22;">3</strong></li>
                            <li>üèÉ Para consulta de <strong>Kinesiolog√≠a</strong>, marca <strong style="color:#e67e22;">4</strong></li>
                            <li>üß† Para servicio de <strong>Salud Mental</strong> con un psic√≥logo, marca <strong style="color:#e67e22;">5</strong></li>
                            <li>üì∏ En caso de necesitar servicio de <strong>Rayos</strong>, te informamos que la atenci√≥n se realiza por orden de llegada, sin agendamiento previo. Si quieres saber en qu√© centros se ofrece este servicio, Marca <strong style="color:#e67e22;">6</strong>.</li>
                            <li>üîÑ Para volver al men√∫ principal, marca <strong style="color:#e67e22;">9</strong></li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function generarContenidoProcedimiento() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üìù Procedimiento agendamiento de atenciones de Salud No Laboral</h2>
                    
                    <div style="background:#fffbe6; padding:16px; border-radius:10px; margin-bottom:16px; border:1px solid #ffd166;">
                        <p style="font-size:1.05em; color:#333; line-height:1.7;">
                            El siguiente script corresponde a la realizaci√≥n del <strong style="color:#e67e22;">agendamiento de pacientes</strong> de los servicios de <strong>Salud Mental</strong>, <strong>Traumatolog√≠a</strong>, <strong>Medicina General</strong>, <strong>Dermatolog√≠a</strong> y <strong>Kinesiolog√≠a</strong> (primera atenci√≥n), medicina del cuidado ACHS con la siguiente estructura de llamado: <strong>datos e informaci√≥n del paciente</strong>, <strong>agendamiento</strong> (presencial o telemedicina) y <strong>cierre final</strong> al paciente.
                        </p>
                        <p style="color:#e74c3c; font-weight:bold; margin-top:10px;">
                            ‚ö†Ô∏è El procedimiento es para realizar agendamientos de atenciones de Salud Com√∫n. No aplica para agendar Rayos X.
                        </p>
                    </div>

                    <div style="background:white; padding:18px; border-radius:10px; margin-bottom:16px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">üë§ Datos e informaci√≥n del paciente</h3>
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:1.9; color:#333;">
                            <p><strong>Ejecutivo:</strong> Achs Salud, buenos &lt;d√≠as/tardes&gt;, mi nombre es &lt;nombre y apellido agente&gt; ¬øCon qui√©n tengo el gusto?</p>
                            <p><strong>Paciente:</strong> Hablas con &lt;nombre y apellido paciente&gt;</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; ¬øEn qu√© le puedo ayudar?</p>
                            <p><strong>Paciente:</strong> Necesito una cita para el Servicio de Salud Mental/Traumatolog√≠a/Kinesiolog√≠a/Medicina General/Dermatolog√≠a de Salud Com√∫n.</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; Entiendo. ¬øSe ha atendido previamente por este servicio?</p>
                            <p><strong>Paciente:</strong> Si/No <span style="color:#e67e22;">[Tener consideraci√≥n para el agendamiento]</span></p>
                            <p><strong>Ejecutivo:</strong> <span style="color:#e74c3c; font-weight:bold;">Recuerde que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</span><br>
                            ¬øCumple con los requisitos para agendar?</p>
                            <p><strong>Paciente:</strong> Si/No <span style="color:#e74c3c;">[En caso de no cumplir los requisitos, no agendar]</span></p>
                            <p><strong>Ejecutivo:</strong> Entiendo. ¬øPodr√≠a indicarme su RUT?</p>
                            <p><strong>Paciente:</strong> &lt;XX.XXX.XXX-X&gt;</p>
                            <p><strong>Ejecutivo:</strong> Gracias.</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generarContenidoSaludMentalSNL2() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üß† Agendamiento Salud Mental con Psic√≥logo</h2>
                    
                    <div style="background:#f0e6ff; padding:16px; border-radius:10px; margin-bottom:16px; border:1px solid #9b59b6;">
                        <h3 style="color:#8e44ad;">Si el paciente es nuevo y no conoce la modalidad:</h3>
                        <p style="line-height:1.8; color:#333;">
                            <strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; recuerde que este servicio <strong style="color:#e74c3c;">no es para patolog√≠as relacionadas al trabajo</strong> y es de <strong>modalidad online</strong>. El psic√≥logo evaluar√° el caso del paciente y determinar√° en la primera cita si nuestro modelo de atenci√≥n se adec√∫a a sus necesidades.
                        </p>
                        <p style="line-height:1.8; color:#333;">
                            Puede realizar el agendamiento a trav√©s de la p√°gina web <strong style="color:#00d2ff;">www.achssalud.cl/saludmental</strong>, para hacer la reserva online de su cita. Una vez realizada la reserva, deber√° pagar su cita dentro de los pr√≥ximos <strong style="color:#e67e22;">15 minutos</strong> o su cita ser√° anulada autom√°ticamente por no pago.
                        </p>
                    </div>

                    <div style="background:white; padding:18px; border-radius:10px; margin-bottom:16px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">En caso de que el paciente quiera ser agendado por el ejecutivo:</h3>
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:1.9; color:#333;">
                            <p><strong>Ejecutivo:</strong> <span style="color:#e74c3c; font-weight:bold;">Recuerde que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</span><br>
                            ¬øCumple con los requisitos para agendar?</p>
                            <p><strong>Paciente:</strong> Si/No <span style="color:#e74c3c;">[En caso de no cumplir los requisitos, no agendar]</span></p>
                            <p><strong>Ejecutivo:</strong> Hay disponibilidad en los siguientes horarios &lt;indicar horarios disponibles&gt;</p>
                            <p><strong>Paciente:</strong> &lt;Ag√©ndeme a las XX:XX horas por favor&gt;</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; su cita qued√≥ agendada para el d√≠a <strong>&lt;XX-XX-XXXX&gt;</strong> a las <strong>&lt;XX:XX horas&gt;</strong> con el/la psic√≥logo/a <strong>&lt;nombre y apellido de profesional&gt;</strong>. Le deber√≠a haber llegado un correo con el link para realizar el pago de la cita. Recuerde que para que su cita sea confirmada debe realizar el pago dentro de los pr√≥ximos <strong style="color:#e67e22;">15 minutos</strong>. Una vez realizado el pago y confirmada su cita recibir√° en su correo el link de conexi√≥n. Le recuerdo que debe ingresar al menos <strong>5 minutos antes</strong> de su cita para verificar que todo funcione correctamente.</p>
                            <p style="background:#fffbe6; padding:10px; border-radius:6px; margin-top:10px;">
                                üìù <strong>Importante:</strong> Como es paciente nuevo, en el correo "confirmaci√≥n de cita" le ser√° enviado un cuestionario para que lo responda antes de su primera sesi√≥n.
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Continuar√° en el siguiente bloque...
    
        function generarContenidoTraumatologiaSNL2() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">ü¶¥ Agendamiento Traumatolog√≠a con M√©dico General</h2>
                    
                    <div style="background:#fffbe6; padding:16px; border-radius:10px; margin-bottom:16px; border:1px solid #e67e22;">
                        <h3 style="color:#e67e22;">Si es paciente nuevo:</h3>
                        <p style="line-height:1.8; color:#333;">
                            <strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; recuerde que:
                        </p>
                        <ul style="line-height:1.9; color:#333;">
                            <li>Este servicio <strong style="color:#e74c3c;">no es para patolog√≠as relacionadas al trabajo</strong></li>
                            <li>La primera atenci√≥n es <strong>presencial con m√©dico general</strong>, el cual puede solicitar ex√°menes y/o apoyo de un traumat√≥logo central.</li>
                            <li><strong style="color:#e74c3c;">No realizamos cirug√≠as ni procedimientos como curaciones en el centro.</strong></li>
                            <li>El servicio tiene foco en identificar el diagn√≥stico, entregar recetas para medicamentos y otras indicaciones m√©dicas como terapia f√≠sica, seg√∫n corresponda</li>
                            <li>Puede realizar el agendamiento a trav√©s de la p√°gina web <strong style="color:#00d2ff;">www.achssalud.cl/traumatologia</strong> para hacer la reserva online de su cita</li>
                        </ul>
                    </div>

                    <div style="background:white; padding:18px; border-radius:10px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">En caso de que el paciente quiera ser agendado por el ejecutivo:</h3>
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:1.9; color:#333;">
                            <p><strong>Ejecutivo:</strong> <span style="color:#e74c3c; font-weight:bold;">Recuerde que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</span><br>
                            ¬øCumple con los requisitos para agendar?</p>
                            <p><strong>Paciente:</strong> Si/No <span style="color:#e74c3c;">[En caso de no cumplir los requisitos, no agendar]</span></p>
                            <p><strong>Ejecutivo:</strong> ¬øEn qu√© centro desea agendar o de qu√© comuna es para buscarle la m√°s cercana?</p>
                            <p><strong>Paciente:</strong> &lt;XXXXX regi√≥n/comuna&gt;</p>
                            <p><strong>Ejecutivo:</strong> Hay disponibilidad en los siguientes horarios &lt;indicar horarios disponibles seg√∫n centro Achs m√°s cercano&gt;</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; su cita de Traumatolog√≠a con m√©dico general qued√≥ agendada para el d√≠a <strong>&lt;XX-XX-XXXX&gt;</strong> a las <strong>&lt;XX:XX horas&gt;</strong>, en el Centro de Salud Achs <strong>&lt;XXXXXX, ubicada en la calle XXXXXX&gt;</strong>. Debe presentarse <strong>20 minutos antes</strong> con su carnet de identidad o pasaporte para realizar el pago y la admisi√≥n de la cita.</p>
                            <p style="color:#e74c3c; font-weight:bold;">Recuerde que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</p>
                            <div style="background:#e6f7ff; padding:12px; border-radius:8px; margin-top:12px;">
                                <p><strong style="color:#0077be;">Agregar informaci√≥n seg√∫n previsi√≥n:</strong></p>
                                <p><strong>‚Ä¢ Fonasa:</strong> Para la atenci√≥n existen dos formas de pago: llegar con el bono que puede comprar en la p√°gina web de Fonasa <strong>www.fonasa.cl</strong> o comprar bono directo en el centro que se va a atender.</p>
                                <p><strong>‚Ä¢ Isapre:</strong> Tenemos convenio con Banm√©dica, Vida Tres y Colmena, en caso de que tu Isapre no est√© en convenio deber√°s cancelar el valor particular y con la boleta reembolsar en su Isapre.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generarContenidoKinesiologiaSNL2() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üèÉ Agendamiento Kinesiolog√≠a</h2>
                    
                    <div style="background:#fffbe6; padding:16px; border-radius:10px; margin-bottom:16px; border:1px solid #e67e22;">
                        <h3 style="color:#e67e22;">Si es paciente nuevo:</h3>
                        <p style="line-height:1.8; color:#333;">
                            <strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; recuerde que:
                        </p>
                        <ul style="line-height:1.9; color:#333;">
                            <li>Este servicio <strong style="color:#e74c3c;">no es para patolog√≠as relacionadas al trabajo</strong></li>
                            <li>La primera atenci√≥n es una <strong>evaluaci√≥n kinesiol√≥gica</strong>, donde se le informar√° cu√°ntas sesiones tendr√° a la semana. En el centro se le agendar√° las sesiones faltantes para completar su tratamiento.</li>
                            <li><strong style="color:#e74c3c;">Solo se puede agendar con Orden M√©dica</strong>, recuerde llevarla el d√≠a de su atenci√≥n.</li>
                            <li>Paciente debe ser <strong>autovalente</strong>.</li>
                            <li>Disponible para <strong>mayores de 18 a√±os</strong></li>
                            <li>Se ven <strong>lesiones m√∫sculo-esquel√©ticas de origen com√∫n</strong>.</li>
                        </ul>
                    </div>

                    <div style="background:white; padding:18px; border-radius:10px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">En caso de que el paciente quiera ser agendado por el ejecutivo y cuente con Orden M√©dica:</h3>
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:1.9; color:#333;">
                            <p><strong>Ejecutivo:</strong> <span style="color:#e74c3c; font-weight:bold;">Te informamos que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</span><br>
                            ¬øCumple con los requisitos para agendar?</p>
                            <p><strong>Paciente:</strong> Si/No <span style="color:#e74c3c;">[En caso de no cumplir los requisitos, no agendar]</span></p>
                            <p><strong>Ejecutivo:</strong> ¬øSu dolencia est√° relacionada con qu√© parte del cuerpo?, ¬øcu√°l es su diagn√≥stico?</p>
                            <p><strong>Paciente:</strong> &lt;Indica lugar del cuerpo y diagn√≥stico&gt;</p>
                            <p style="background:#fff3cd; padding:10px; border-radius:6px; border:1px solid #ffc107;">
                                üìù <strong>Nota:</strong> Revisar listado. Si se encuentra, proceder a agendar cita. En caso contrario, anotar diagn√≥stico y no agendar.
                            </p>
                            <p><strong>Ejecutivo:</strong> ¬øEn qu√© centro desea agendar o de qu√© comuna es para buscarle la m√°s cercana?</p>
                            <p><strong>Paciente:</strong> &lt;XXXXX centro/comuna&gt;</p>
                            <p style="background:#e3f2fd; padding:10px; border-radius:6px; border:1px solid #2196f3;">
                                üíª <strong>Sistema SAP:</strong> Ingresar a SAP a la transacci√≥n NWP1, Activar Variante de la sede, y buscar disponibilidad en los cupos de Salud Integral
                            </p>
                            <p><strong>Ejecutivo:</strong> Hay disponibilidad en los siguientes horarios &lt;indicar horarios disponibles seg√∫n centro Achs m√°s cercano. Se debe entregar hora cerrada HH:00&gt;</p>
                            <p><strong>Paciente:</strong> &lt;Ag√©ndeme a las HH:00 horas por favor&gt;</p>
                            <p style="background:#fff3cd; padding:10px; border-radius:6px; border:1px solid #ffc107; margin-top:10px;">
                                üìã <strong>Proceso en SAP:</strong><br>
                                1. Colocarse sobre el cupo y hacer doble click<br>
                                2. Ingresar Rut del paciente anteponiendo RU<br>
                                3. Tipo de episodio: VSC salud com√∫n<br>
                                4. Clase de consulta: Apoyo tratamiento<br>
                                5. Pinchar Binoculares, seleccionar al paciente<br>
                                6. Guardar en el disquet<br>
                                <em>Si tiene dudas del proceso, puede consultarlo con Nataly Ram√≠rez: nvramirezj@achs.cl</em>
                            </p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; su cita de Kinesiolog√≠a qued√≥ agendada para el d√≠a <strong>&lt;XX-XX-XXXX&gt;</strong> a las <strong>&lt;HH:00 horas&gt;</strong>, en el Centro de Salud Achs <strong>&lt;XXXXXX, ubicada en la calle XXXXXX&gt;</strong>. Debe presentarse <strong>30 minutos antes</strong> con su <strong style="color:#e74c3c;">Orden M√©dica</strong> y su carnet de identidad o pasaporte para realizar el pago y la admisi√≥n de la cita.</p>
                            <p style="color:#e74c3c; font-weight:bold;">Recuerde que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</p>
                            <div style="background:#e6f7ff; padding:12px; border-radius:8px; margin-top:12px;">
                                <p><strong style="color:#0077be;">Agregar informaci√≥n seg√∫n previsi√≥n:</strong></p>
                                <p><strong>‚Ä¢ Fonasa:</strong> Para la atenci√≥n existen dos formas de pago: Comprar bono directo en el centro que se va a atender o puede llegar con el bono comprado en la p√°gina web de Fonasa <strong>www.fonasa.cl</strong>. Para una atenci√≥n m√°s r√°pida le recomendamos asistir con el bono comprado.</p>
                                <p><strong>‚Ä¢ Isapre:</strong> Tenemos convenio con Banm√©dica, Vida Tres y Colmena, en caso de que tu Isapre no est√© en convenio deber√°s cancelar el valor particular y con la boleta reembolsar en su Isapre.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generarContenidoMedicinaGeneralSNL2() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">ü©∫ Agendamiento Medicina General</h2>
                    
                    <div style="background:#fffbe6; padding:16px; border-radius:10px; margin-bottom:16px; border:1px solid #e67e22;">
                        <h3 style="color:#e67e22;">Si es paciente nuevo:</h3>
                        <p style="line-height:1.8; color:#333;">
                            <strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; recuerde que:
                        </p>
                        <ul style="line-height:1.9; color:#333;">
                            <li>Este servicio <strong style="color:#e74c3c;">no es para patolog√≠as relacionadas al trabajo</strong></li>
                            <li>La atenci√≥n es <strong>presencial con m√©dico general</strong>, el cual puede solicitar ex√°menes y/o derivarlo a especialista para su tratamiento</li>
                            <li>Puede realizar el agendamiento a trav√©s de la p√°gina web <strong style="color:#00d2ff;">www.achssalud.cl/medicinageneral</strong> para hacer la reserva online de su cita</li>
                        </ul>
                    </div>

                    <div style="background:white; padding:18px; border-radius:10px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">En caso de que el paciente quiera ser agendado por el ejecutivo:</h3>
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:1.9; color:#333;">
                            <p><strong>Ejecutivo:</strong> ¬øEn qu√© centro desea agendar o de qu√© comuna es para buscarle la m√°s cercana?</p>
                            <p><strong>Paciente:</strong> &lt;XXXXX regi√≥n/comuna&gt;</p>
                            <p><strong>Ejecutivo:</strong> Hay disponibilidad en los siguientes horarios &lt;indicar horarios disponibles seg√∫n centro Achs m√°s cercano&gt;</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; su cita de Medicina General qued√≥ agendada para el d√≠a <strong>&lt;XX-XX-XXXX&gt;</strong> a las <strong>&lt;XX:XX horas&gt;</strong>, en el Centro de Salud Achs <strong>&lt;XXXXXX, ubicada en la calle XXXXXX&gt;</strong>. Debe presentarse <strong>20 minutos antes</strong> con su carnet de identidad o pasaporte para realizar el pago y la admisi√≥n de la cita.</p>
                            <div style="background:#e6f7ff; padding:12px; border-radius:8px; margin-top:12px;">
                                <p><strong style="color:#0077be;">Agregar informaci√≥n seg√∫n previsi√≥n:</strong></p>
                                <p><strong>‚Ä¢ Fonasa:</strong> Para la atenci√≥n existen dos formas de pago: Comprar bono directo en el centro que se va a atender o puede llegar con el bono comprado en la p√°gina web de Fonasa <strong>www.fonasa.cl</strong>.</p>
                                <p><strong>‚Ä¢ Isapre:</strong> Tenemos convenio con Banm√©dica, Vida Tres y Colmena, en caso de que tu Isapre no est√© en convenio deber√°s cancelar el valor particular y con la boleta reembolsar en su Isapre.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generarContenidoMedicinaCuidado() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üíö Agendamiento Medicina General del Cuidado</h2>
                    
                    <div style="background:#fffbe6; padding:16px; border-radius:10px; margin-bottom:16px; border:1px solid #e67e22;">
                        <h3 style="color:#e67e22;">Si es paciente nuevo:</h3>
                        <p style="line-height:1.8; color:#333;">
                            <strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; recuerde que:
                        </p>
                        <ul style="line-height:1.9; color:#333;">
                            <li>Este servicio <strong style="color:#e74c3c;">no es para patolog√≠as relacionadas al trabajo</strong></li>
                            <li>La atenci√≥n es <strong>presencial con m√©dico general</strong>, el cual puede revisar ex√°menes y/o derivarlo a especialista para su tratamiento.</li>
                            <li>Puede realizar el agendamiento a trav√©s de la p√°gina web <strong style="color:#00d2ff;">www.achssalud.cl/medicinadelcuidado</strong> para hacer la obtenci√≥n de la orden m√©dica y la reserva online de su cita.</li>
                            <li style="background:#fff3cd; padding:8px; border-radius:6px; margin-top:8px;">En caso de que el paciente haya adquirido la orden de ex√°menes con nosotros (<strong>$2.490</strong>), se le aplicar√° un <strong>pre-abono</strong> al pago de la atenci√≥n m√©dica, descontando hasta <strong style="color:#27ae60;">$2.000</strong> del monto total a pagar de la consulta.</li>
                            <li>El prepago se considerar√° de manera autom√°tica, s√≥lo para pacientes Fonasa e Isapre convenidas (en caso contrario el paciente deber√° pagar el valor completo de la consulta, aunque haya comprado √≥rdenes de ex√°menes con nosotros).</li>
                            <li>Prepago se aplica con IMED de forma autom√°tica al momento de colocar la huella digital del paciente.</li>
                            <li>Se les solicita a los pacientes que lleven los <strong>resultados de los ex√°menes impresos</strong></li>
                            <li style="background:#ffe4e4; padding:8px; border-radius:6px; margin-top:8px;">‚è∞ El prepago de la consulta tiene una vigencia de <strong style="color:#e74c3c;">6 meses</strong> a partir de la emisi√≥n de la orden m√©dica.</li>
                        </ul>
                    </div>

                    <div style="background:white; padding:18px; border-radius:10px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">En caso de que el paciente quiera ser agendado por el ejecutivo la lectura de los ex√°menes preventivos:</h3>
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:1.9; color:#333;">
                            <p><strong>Ejecutivo:</strong> ¬øEn qu√© centro desea agendar o de qu√© comuna es para buscarle la m√°s cercana?</p>
                            <p><strong>Paciente:</strong> &lt;XXXXX regi√≥n/comuna&gt;</p>
                            <p><strong>Ejecutivo:</strong> Hay disponibilidad en los siguientes horarios &lt;indicar horarios disponibles seg√∫n centro Achs m√°s cercano&gt;</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; su cita de Medicina General del cuidado qued√≥ agendada para el d√≠a <strong>&lt;XX-XX-XXXX&gt;</strong> a las <strong>&lt;XX:XX horas&gt;</strong>, en el Centro de Salud Achs <strong>&lt;XXXXXX, ubicada en la calle XXXXXX&gt;</strong>. Debe presentarse <strong>20 minutos antes</strong> con su carnet de identidad o pasaporte para realizar el pago y la admisi√≥n de la cita.</p>
                            <div style="background:#e6f7ff; padding:12px; border-radius:8px; margin-top:12px;">
                                <p><strong style="color:#0077be;">Agregar informaci√≥n seg√∫n previsi√≥n:</strong></p>
                                <p><strong>‚Ä¢ FONASA ‚Äì ISAPRE:</strong> En caso de que el paciente haya adquirido la orden de ex√°menes con nosotros Achs salud ($2.490), se le aplicar√° un pre-abono al pago de la atenci√≥n m√©dica, descontando hasta <strong style="color:#27ae60;">$2.000</strong> del monto total a pagar de la consulta. El prepago se considerar√° de manera autom√°tica, s√≥lo para pacientes Fonasa e Isapre convenidas (en caso contrario el paciente deber√° pagar el valor completo de la consulta, aunque haya comprado √≥rdenes de ex√°menes con nosotros).</p>
                                <p><strong>‚Ä¢ Prepago:</strong> Se aplica con IMED de forma autom√°tica al momento de colocar la huella digital del paciente.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generarContenidoDermatologiaSNL2() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üß¥ Agendamiento Dermatolog√≠a con M√©dico General</h2>
                    
                    <div style="background:#fffbe6; padding:16px; border-radius:10px; margin-bottom:16px; border:1px solid #e67e22;">
                        <h3 style="color:#e67e22;">Si es paciente nuevo:</h3>
                        <p style="line-height:1.8; color:#333;">
                            <strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; recuerde que:
                        </p>
                        <ul style="line-height:1.9; color:#333;">
                            <li>Este servicio <strong style="color:#e74c3c;">no es para patolog√≠as relacionadas al trabajo</strong></li>
                            <li>La primera atenci√≥n es <strong>presencial con m√©dico general</strong>, el cual puede solicitar ex√°menes y/o apoyo de un dermat√≥logo.</li>
                            <li><strong style="color:#e74c3c;">No realizamos cirug√≠as ni procedimientos como curaciones en el centro.</strong></li>
                            <li>El servicio tiene foco en identificar el diagn√≥stico y entregar recetas para medicamentos/cremas</li>
                            <li>Puede realizar el agendamiento a trav√©s de la p√°gina web <strong style="color:#00d2ff;">www.achssalud.cl/dermatologia</strong> para hacer la reserva online de su cita</li>
                        </ul>
                    </div>

                    <div style="background:white; padding:18px; border-radius:10px;">
                        <h3 style="color:#3a7bd5; margin-bottom:12px;">En caso de que el paciente quiera ser agendado por el ejecutivo:</h3>
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:1.9; color:#333;">
                            <p><strong>Ejecutivo:</strong> <span style="color:#e74c3c; font-weight:bold;">Recuerde que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</span><br>
                            ¬øCumple con los requisitos para agendar?</p>
                            <p><strong>Paciente:</strong> Si/No <span style="color:#e74c3c;">[En caso de no cumplir los requisitos, no agendar]</span></p>
                            <p><strong>Ejecutivo:</strong> ¬øEn qu√© centro desea agendar o de qu√© comuna es para buscarle la m√°s cercana?</p>
                            <p><strong>Paciente:</strong> &lt;XXXXX regi√≥n/comuna&gt;</p>
                            <p><strong>Ejecutivo:</strong> Hay disponibilidad en los siguientes horarios &lt;indicar horarios disponibles seg√∫n centro Achs m√°s cercano&gt;</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; su cita de Dermatolog√≠a con m√©dico general qued√≥ agendada para el d√≠a <strong>&lt;XX-XX-XXXX&gt;</strong> a las <strong>&lt;XX:XX horas&gt;</strong>, en el Centro de Salud Achs <strong>&lt;XXXXXX, ubicada en la calle XXXXXX&gt;</strong>. Debe presentarse <strong>20 minutos antes</strong> con su carnet de identidad o pasaporte para realizar el pago y la admisi√≥n de la cita.</p>
                            <p style="color:#e74c3c; font-weight:bold;">Recuerde que, por normativa de la Superintendencia de Seguridad Social, no podemos atender patolog√≠as que ya fueron consultadas por motivos laborales.</p>
                            <div style="background:#e6f7ff; padding:12px; border-radius:8px; margin-top:12px;">
                                <p><strong style="color:#0077be;">Agregar informaci√≥n seg√∫n previsi√≥n:</strong></p>
                                <p><strong>‚Ä¢ Fonasa:</strong> Para la atenci√≥n existen dos formas de pago: llegar con el bono que puede comprar en la p√°gina web de Fonasa <strong>www.fonasa.cl</strong> o comprar bono directo en el centro que se va a atender.</p>
                                <p><strong>‚Ä¢ Isapre:</strong> Tenemos convenio con Banm√©dica, Vida Tres y Colmena, en caso de que tu Isapre no est√© en convenio deber√°s cancelar el valor particular y con la boleta reembolsar en su Isapre.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generarContenidoDespedida() {
            return `
                <div style="background:#e0f7ff; padding:24px; border-radius:14px; border-left:5px solid #00d2ff;">
                    <h2 style="color:#006494; font-size:1.6em; margin-bottom:16px;">üëã Despedida</h2>
                    
                    <div style="background:white; padding:18px; border-radius:10px;">
                        <div style="background:#f8f9fa; padding:14px; border-radius:8px; line-height:2; color:#333; font-size:1.1em;">
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt;, ¬øalgo m√°s en lo que lo pueda ayudar?</p>
                            <p><strong>Paciente:</strong> No, gracias.</p>
                            <p><strong>Ejecutivo:</strong> &lt;nombre y apellido paciente&gt; Gracias por llamar a ACHS Salud. Por favor mant√©ngase en l√≠nea para evaluar mi atenci√≥n, muchas gracias.</p>
                        </div>
                        <div style="background:#d4edda; padding:12px; border-radius:8px; margin-top:16px; border:1px solid #28a745;">
                            <p style="color:#155724; margin:0; font-weight:600;">
                                ‚úÖ Es importante mantener siempre un tono amable, profesional y emp√°tico durante toda la llamada.
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function copiarScriptSNL2() {
            const modal = document.getElementById('modalScriptSNL2Content');
            if (!modal) return;
            
            const textoParaCopiar = modal.innerText || modal.textContent;
            
            navigator.clipboard.writeText(textoParaCopiar).then(() => {
                mostrarMensajeTemp('üìã Contenido copiado al portapapeles', '#27ae60');
            }).catch(err => {
                console.error('Error al copiar:', err);
                mostrarMensajeTemp('‚ùå Error al copiar el contenido', '#e74c3c');
            });
        }

        function imprimirScriptSNL2() {
            const contenidoModal = document.getElementById('modalScriptSNL2Content');
            if (!contenidoModal) {
                alert('No hay contenido para imprimir');
                return;
            }

            const ventanaImpresion = window.open('', '_blank');
            const contenidoImpresion = `
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SCRIPT SNL 2.0 - Contact Center ACHS Salud</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 40px;
            color: #2c3e50;
            background: #f8f9fa;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #00d2ff, #3a7bd5);
            color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 210, 255, 0.3);
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #00d2ff;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 { font-size: 2.2em; margin: 0; }
        h2 { color: #006494; font-size: 1.5em; margin-bottom: 10px; }
        h3 { color: #3a7bd5; font-size: 1.2em; margin: 12px 0 8px 0; }
        p { margin: 8px 0; }
        strong { color: #006494; }
        ul { margin: 10px 0 10px 20px; }
        li { margin: 6px 0; }
        .important { background: #fff3cd; padding: 10px; border-radius: 5px; border: 1px solid #ffc107; margin: 10px 0; }
        .note { background: #d1ecf1; padding: 10px; border-radius: 5px; border: 1px solid #17a2b8; margin: 10px 0; }
        .footer { text-align: center; margin-top: 40px; color: #6c757d; font-size: 0.9em; }
        @media print {
            body { margin: 20px; }
            .header { background: #00d2ff; }
            .section { page-break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìû SCRIPT SNL 2.0</h1>
        <p style="font-size: 1.2em; margin: 5px 0 0 0;">Contact Center ACHS Salud</p>
    </div>
    
    ${contenidoModal.innerHTML}
    
    <div class="footer">
        <p>Documento generado autom√°ticamente - ACHS ${new Date().toLocaleDateString()}</p>
        <p>Contact Center ACHS Salud</p>
    </div>
</body>
</html>
            `;
            
            ventanaImpresion.document.write(contenidoImpresion);
            ventanaImpresion.document.close();
            
            ventanaImpresion.onload = function() {
                setTimeout(() => {
                    ventanaImpresion.print();
                }, 500);
            };
            
            mostrarMensajeTemp('üñ®Ô∏è Abriendo ventana de impresi√≥n para Script SNL 2.0...', '#00d2ff');
            console.log('‚úÖ Ventana de impresi√≥n abierta para Script SNL 2.0');
        }
    
        // ===== FUNCIONES PARA SCRIPT LE - LISTA DE ESPERA =====
        
        function abrirModalScriptLE() {
            console.log('üîÑ Abriendo modal Script LE');
            const modal = document.getElementById('modalScriptLE');
            if (modal) {
                modal.style.display = 'flex';
                console.log('‚úÖ Modal Script LE abierto correctamente');
                
                // Reproducir sonido de confirmaci√≥n
                reproducirSonidoConfirmacion();
                
                // Mostrar mensaje temporal
                mostrarMensajeTemp('üè• Script LE cargado - Protocolo Lista de Espera FONASA', '#9b59b6');
            } else {
                console.error('‚ùå Modal Script LE no encontrado');
                alert('‚ùå Error: No se pudo abrir el modal Script LE');
            }
        }
        
        function cerrarModalScriptLE() {
            console.log('üîÑ Cerrando modal Script LE');
            const modal = document.getElementById('modalScriptLE');
            if (modal) {
                modal.style.display = 'none';
                console.log('‚úÖ Modal Script LE cerrado correctamente');
            } else {
                console.error('‚ùå Modal Script LE no encontrado');
            }
        }
        
        function copiarScriptLE() {
            // Obtener todo el contenido del script LE
            const contenidoScript = `
    SCRIPT LE - PROTOCOLO LISTA DE ESPERA FONASA
    Hospital del Trabajador ACHS Salud
    
    üè• SCRIPT LISTA DE ESPERA (LE)
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üìû 1. NOTIFICACI√ìN:
    
    Hola, ¬øhablo con [Nombre del Paciente]? Soy [Tu Nombre] y te llamo del Hospital del Trabajador Achs Salud. ¬øC√≥mo est√°s hoy?
    
    Te llamo para informarte que Fonasa/Tu hospital nos deriv√≥ tu caso para resolver tu problema de salud [Problema de salud].
    
    ‚ö†Ô∏è IMPORTANTE: Hay que recalcar que Fonasa solo nos deriv√≥ el caso para la resoluci√≥n de ese problema de salud
    
    üìù NOTA: Si no es el paciente, reforzar que se llama por una cirug√≠a pendiente de LE y pedir n√∫meros de paciente o que indiquen horario de llamado
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üè• 2. PROCESO Y PARTICIPACI√ìN:
    
    Todo el proceso se realiza en el Centro M√©dico del Hospital del Trabajador. Este incluye:
    ‚Ä¢ Ex√°menes de laboratorio
    ‚Ä¢ Imagen  
    ‚Ä¢ Consulta para confirmar tu diagn√≥stico
    ‚Ä¢ Posteriormente la cirug√≠a en caso de que no existan contraindicaciones
    
    üí∞ Los ex√°menes, consultas y cirug√≠a no tienen ning√∫n costo para el paciente y solamente corren por su cuenta los costos de traslado (incluso si son de regi√≥n)
    
    ¬øDeseas atenderte con nosotros?
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üìã 3. INFORMACI√ìN DE CONTACTO DEL PACIENTE (solo en caso de que paciente acepte operarse):
    
    Para poder seguir adelante, necesito reunir informaci√≥n relevante sobre ti, ¬øte puedo hacer algunas preguntas?
    
    ‚Ä¢ ¬øPodr√≠as darme tu n√∫mero de tel√©fono principal y un segundo n√∫mero si tienes?
    ‚Ä¢ ¬øCu√°l es tu correo electr√≥nico?
    ‚Ä¢ ¬øCu√°l es tu fecha de nacimiento?
    ‚Ä¢ ¬øCu√°l es tu direcci√≥n y comuna?
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    ü©∫ 4. INFORMACI√ìN M√âDICA (solo en caso de que paciente acepte operarse):
    
    Ahora te har√© algunas preguntas sobre tu problema de salud:
    
    ‚Ä¢ ¬øLa condici√≥n afecta un lado en particular? Si es as√≠, ¬øcu√°l?
    ‚Ä¢ ¬øHas tenido alguna operaci√≥n previa por este diagn√≥stico?
    ‚Ä¢ ¬øHace cu√°nto tiempo est√°s esperando esta cirug√≠a?
    ‚Ä¢ ¬øEst√°s o crees estar embarazada? [Solo si aplica]
    ‚Ä¢ ¬øHas tenido alg√∫n infarto?
    ‚Ä¢ ¬øEst√°s dializado?
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    ‚ùå 5. INFORMACI√ìN RECHAZO (solo en caso de que paciente rechace):
    
    Dependiendo del motivo de rechazo:
    
    ‚Ä¢ Si ya se oper√≥: ¬øCu√°ndo y d√≥nde se oper√≥? [No es necesaria fecha exacta]
    ‚Ä¢ Si paciente falleci√≥: ¬øCu√°ndo falleci√≥?
    ‚Ä¢ Si no desea operarse con nosotros es por:
      ‚óã Lejan√≠a (Distancia/Traslado)
      ‚óã Salud
      ‚óã No lo necesita (No quiere ‚Äì No necesita)
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üëã 6. DESPEDIDA E INFORMACI√ìN PARA EL PACIENTE:
    
    Te recuerdo que todas tus atenciones ser√°n en el Centro M√©dico del Hospital del Trabajador ubicado en Vicu√±a Mackenna 210, Providencia (a pasos del metro Parque Bustamante). 
    
    Durante los pr√≥ximos d√≠as te contactar√°n para agendar tu consulta m√©dica y tus ex√°menes, por lo que te pido que est√©s muy atento a tu tel√©fono.
    
    Buenas tardes y muchas gracias por tu tiempo
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    ‚ùì PREGUNTAS FRECUENTES:
    
    üí∞ ¬øEsto tiene alg√∫n costo para m√≠?
    Las consultas, ex√°menes, cirug√≠a y recuperaci√≥n no tienen costo para el paciente. Sin embargo, cualquier costo relacionado a transporte (traslados en taxi, locomoci√≥n p√∫blica, ambulancia, uber, bus, avi√≥n, etc) corre por cuenta del paciente.
    ‚ö†Ô∏è RECALCAR ESTA INFORMACI√ìN PARA PACIENTES DE REGI√ìN/ZONAS ALEJADAS DEL HT
    
    ‚è∞ ¬øQu√© sucede si no puedo tomar la decisi√≥n ahora?
    Fonasa nos entrega plazos muy acotados para resolver los casos que nos deriva, por lo cual solamente podemos darle 24 horas para que tome la decisi√≥n
    
    üè• Ya estoy en un proceso para operarme en mi Hospital de Base, ¬øpuedo iniciar el proceso en el HT?
    Fonasa nos deriv√≥ su caso para ser operado por nosotros, sin importar lo que est√© sucediendo en su Hospital de base. Usted puede mantenerse en ambos procesos, sin embargo, si durante el proceso decide mantenerse en su Hospital de base, debe comunicarnos su decisi√≥n para informar a Fonasa
    
    üìã ¬øTodas mis atenciones pasan a ser en el Hospital del Trabajador?
    No, Fonasa solamente nos deriva su caso para la confirmaci√≥n del diagn√≥stico y la resoluci√≥n quir√∫rgica de su problema de salud, por lo que cualquier problema de salud no asociado al diagn√≥stico por el que fue derivado debe ser resuelto en su Hospital de base
    
    ü©∫ ¬øQu√© pasa con el resto de mis atenciones en mi Hospital de base?
    Usted mantendr√° todo el resto de sus atenciones en su Hospital de base. Fonasa solamente nos entrega las facultades para atenderla por el problema de salud que Fonasa deriv√≥
    
    üöÄ ¬øCu√°ndo iniciar√≠a el proceso?
    El proceso comienza inmediatamente despu√©s de la creaci√≥n de la ficha [Preguntas que se le har√°n a continuaci√≥n]. Durante la misma semana lo contactar√°n desde el equipo de agendamiento para agendar sus ex√°menes y consulta de evaluaci√≥n, por lo que debe estar muy atento al tel√©fono
    
    üìÖ ¬øCu√°ndo tengo mi consulta?
    Durante la misma semana lo contactar√°n desde el equipo de agendamiento para confirmar sus ex√°menes y consulta de evaluaci√≥n, por lo que debe estar muy atento al tel√©fono
    
    ‚öïÔ∏è ¬øCu√°ndo tengo mi cirug√≠a?
    Para poder llegar a la cirug√≠a se debe seguir todo el proceso, el cual contempla: ex√°menes de laboratorio, im√°genes y consultas m√©dicas, en los cuales se corroborar√° el diagn√≥stico. Posteriormente el equipo m√©dico definir√° la fecha de su cirug√≠a, la cual debe tener lugar antes de un mes aproximadamente desde la derivaci√≥n
    
    üß™ Yo ya tengo mis ex√°menes, ¬ødebo tomarme mis ex√°menes igual?
    Si cuenta con ex√°menes que fueron tomados en menos de 3 meses hacia el pasado, puede traerlos para complementar informaci√≥n en consulta, pero de todas formas tomaremos nuevamente todos los ex√°menes
    
    üìã Si ya tengo todos mis pases en mi Hospital de base, ¬øpuedo operarme al tiro?
    No, pese a que usted ya cuenta con pases de su Hospital de base, nuestros m√©dicos deben corroborar su diagn√≥stico para poder operarse con nosotros. De todas formas, debe traer toda la documentaci√≥n que le hayan entregado en su Hospital de base (ex√°menes, pases, etc)
    
    ‚è±Ô∏è ¬øCu√°nto demora el proceso?
    El proceso depende de cada paciente y su condici√≥n de salud. En caso de que usted sea un paciente sano y se confirme su diagn√≥stico, entonces programaremos su cirug√≠a cuanto antes. En caso de que su problema de salud sea m√°s complejo, entonces los tiempos pueden aumentar.
    
    üìÖ ¬øLas consultas y ex√°menes son el mismo d√≠a?
    No siempre es posible agendar todas las atenciones para el mismo d√≠a debido a que depende de la disponibilidad de horas de imagenolog√≠a y de consultas. En caso de que tenga alguna limitaci√≥n de horarios, puedo dejar una nota con su disponibilidad
    
    üìç ¬øD√≥nde est√°n ubicados?
    Nuestro centro m√©dico est√° ubicado en Vicu√±a Mackenna 210, metro parque Bustamante.
    
    üè¢ ¬øMe puedo atender en una de las sedes?
    La licitaci√≥n solo contempla atenciones en sede central ubicada en Vicu√±a Mackenna 210.
    
    üèÉ‚Äç‚ôÇÔ∏è ¬øPuedo hacer la kinesiolog√≠a en otro lado?
    La licitaci√≥n solo contempla atenciones ambulatorias en sede central ubicada en Vicu√±a Mackenna 210.
    
    üîç ¬øPor qu√© tienen que confirmar mi diagn√≥stico?
    La confirmaci√≥n de diagn√≥stico es esencial para entregar un tratamiento acorde a cada paciente y tener certeza de la patolog√≠a por la que fue derivado y explicar a paciente el procedimiento y plan de acci√≥n.
    
    üìù ¬øPor qu√© necesitan mi informaci√≥n?
    Fonasa no nos entrega toda la informaci√≥n que necesitamos para crear su ficha y sin esta no podemos atenderlo, por lo que necesitamos que nos la entregue. Esta informaci√≥n solo ser√° utilizada para crear la ficha y tener la mayor cantidad de opciones para contactarlo
    
    üè† ¬øPara qu√© necesitan mi direcci√≥n?
    Su direcci√≥n es parte de la informaci√≥n solicitada al momento de la creaci√≥n de su ficha cl√≠nica
    
    üîí ¬øD√≥nde puedo revisar que esto no es una estafa?
    Puede revisar nuestra p√°gina Web (https://www.hospitaldeltrabajador.cl/ o https://www.hospitaldeltrabajador.cl/detalle-noticia/2024/hospital-del-trabajador-achs-salud-es-uno-de-los-prestadores-que-resolvera-parte-de-las-cirugias-de-lista-de-espera-fonasa-durante-los-proximos-3-anos), revisar en YouTube un reportaje realizado cuando iniciamos este proceso el a√±o pasado con nuestra primera paciente e incluso preguntar a Fonasa o su hospital de base por la derivaci√≥n.
    
    ü©∫ ¬øQu√© pasa si tengo muchos problemas de salud?
    Usted ser√° evaluado por uno de nuestros m√©dicos para determinar si estos problemas de salud ser√°n un problema para realizar la cirug√≠a
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    Documento generado autom√°ticamente - ACHS ${new Date().toLocaleDateString()}
            `;
            
            // Copiar al portapapeles
            navigator.clipboard.writeText(contenidoScript.trim()).then(function() {
                mostrarMensajeTemp('üìã Script LE copiado al portapapeles', '#9b59b6');
                console.log('‚úÖ Script LE copiado al portapapeles');
                
                // Reproducir sonido de confirmaci√≥n
                reproducirSonidoConfirmacion();
            }).catch(function(err) {
                console.error('‚ùå Error al copiar script LE:', err);
                mostrarMensajeTemp('‚ùå Error al copiar. Use Ctrl+A y Ctrl+C manualmente', '#dc3545');
            });
        }
        
        function imprimirScriptLE() {
            // Crear ventana de impresi√≥n con el script LE formateado
            const ventanaImpresion = window.open('', '_blank', 'width=800,height=600');
            
            const contenidoImpresion = `
    <!DOCTYPE html>
    <html>
    <head>
        <title>Script LE - Lista de Espera FONASA</title>
        <style>
            body { 
                font-family: Arial, sans-serif; 
                line-height: 1.6; 
                margin: 40px; 
                color: #2c3e50; 
                background: #f8f9fa;
            }
            .header { 
                text-align: center; 
                margin-bottom: 30px; 
                padding: 20px; 
                background: linear-gradient(135deg, #9b59b6, #8e44ad); 
                color: white; 
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(155,89,182,0.3);
            }
            .seccion { 
                margin: 20px 0; 
                padding: 15px; 
                border-left: 4px solid #9b59b6; 
                background: #fff; 
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
            .titulo-seccion { 
                font-weight: bold; 
                font-size: 1.2em; 
                color: #8e44ad; 
                margin-bottom: 10px;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            .destacado { 
                background: #fff3cd; 
                padding: 2px 6px; 
                border-radius: 4px; 
                font-weight: bold;
                color: #856404;
            }
            .importante { 
                background: #f8d7da; 
                border: 1px solid #f5c6cb; 
                padding: 15px; 
                border-radius: 8px; 
                margin: 10px 0;
                color: #721c24;
            }
            .nota { 
                background: #d1ecf1; 
                border: 1px solid #bee5eb; 
                padding: 15px; 
                border-radius: 8px; 
                margin: 10px 0;
                color: #0c5460;
            }
            .footer { 
                margin-top: 40px; 
                text-align: center;
                color: #6c757d;
                font-size: 0.9em;
            }
            ul { margin: 10px 0; padding-left: 20px; }
            li { margin: 5px 0; }
            .pregunta { font-weight: bold; color: #2980b9; margin: 8px 0; }
            .faq { background: #e8f5e8; padding: 10px; border-radius: 5px; margin: 8px 0; }
            .faq-titulo { font-weight: bold; color: #155724; }
            hr { border: none; height: 2px; background: linear-gradient(90deg, #9b59b6, #8e44ad); margin: 30px 0; }
        </style>
    </head>
    <body>
        <div class="header">
            <h1>üè• SCRIPT LE</h1>
            <p>Protocolo Lista de Espera FONASA - Hospital del Trabajador ACHS Salud</p>
        </div>
        
        <div class="seccion">
            <div class="titulo-seccion">üìû 1. NOTIFICACI√ìN</div>
            <p class="pregunta">Hola, ¬øhablo con <span class="destacado">[Nombre del Paciente]</span>? Soy <span class="destacado">[Tu Nombre]</span> y te llamo del Hospital del Trabajador Achs Salud. ¬øC√≥mo est√°s hoy?</p>
            <p class="pregunta">Te llamo para informarte que Fonasa/Tu hospital nos deriv√≥ tu caso para resolver tu problema de salud <span class="destacado">[Problema de salud]</span>.</p>
            <div class="importante">
                <strong>‚ö†Ô∏è IMPORTANTE:</strong> Hay que recalcar que Fonasa solo nos deriv√≥ el caso para la resoluci√≥n de ese problema de salud
            </div>
            <div class="nota">
                <strong>üìù NOTA:</strong> Si no es el paciente, reforzar que se llama por una cirug√≠a pendiente de LE y pedir n√∫meros de paciente o que indiquen horario de llamado
            </div>
        </div>
    
        <hr>
        
        <div class="seccion">
            <div class="titulo-seccion">üè• 2. PROCESO Y PARTICIPACI√ìN</div>
            <p>Todo el proceso se realiza en el <strong>Centro M√©dico del Hospital del Trabajador</strong>. Este incluye:</p>
            <ul>
                <li>Ex√°menes de laboratorio</li>
                <li>Imagen</li>
                <li>Consulta para confirmar tu diagn√≥stico</li>
                <li>Posteriormente la cirug√≠a en caso de que no existan contraindicaciones</li>
            </ul>
            <div class="nota">
                <strong>üí∞ SIN COSTO:</strong> Los ex√°menes, consultas y cirug√≠a no tienen ning√∫n costo para el paciente y solamente corren por su cuenta los costos de traslado (incluso si son de regi√≥n)
            </div>
            <p class="pregunta">¬øDeseas atenderte con nosotros?</p>
        </div>
    
        <hr>
        
        <div class="seccion">
            <div class="titulo-seccion">üìã 3. INFORMACI√ìN DE CONTACTO DEL PACIENTE</div>
            <em>(solo en caso de que paciente acepte operarse)</em>
            <p class="pregunta">Para poder seguir adelante, necesito reunir informaci√≥n relevante sobre ti, ¬øte puedo hacer algunas preguntas?</p>
            <ul>
                <li>¬øPodr√≠as darme tu n√∫mero de tel√©fono principal y un segundo n√∫mero si tienes?</li>
                <li>¬øCu√°l es tu correo electr√≥nico?</li>
                <li>¬øCu√°l es tu fecha de nacimiento?</li>
                <li>¬øCu√°l es tu direcci√≥n y comuna?</li>
            </ul>
        </div>
    
        <hr>
        
        <div class="seccion">
            <div class="titulo-seccion">ü©∫ 4. INFORMACI√ìN M√âDICA</div>
            <em>(solo en caso de que paciente acepte operarse)</em>
            <p class="pregunta">Ahora te har√© algunas preguntas sobre tu problema de salud:</p>
            <ul>
                <li>¬øLa condici√≥n afecta un lado en particular? Si es as√≠, ¬øcu√°l?</li>
                <li>¬øHas tenido alguna operaci√≥n previa por este diagn√≥stico?</li>
                <li>¬øHace cu√°nto tiempo est√°s esperando esta cirug√≠a?</li>
                <li>¬øEst√°s o crees estar embarazada? <em>[Solo si aplica]</em></li>
                <li>¬øHas tenido alg√∫n infarto?</li>
                <li>¬øEst√°s dializado?</li>
            </ul>
        </div>
    
        <hr>
        
        <div class="seccion">
            <div class="titulo-seccion">‚ùå 5. INFORMACI√ìN RECHAZO</div>
            <em>(solo en caso de que paciente rechace y dependiendo del motivo de rechazo)</em>
            <ul>
                <li><strong>Si ya se oper√≥:</strong> ¬øCu√°ndo y d√≥nde se oper√≥? <em>[No es necesaria fecha exacta]</em></li>
                <li><strong>Si paciente falleci√≥:</strong> ¬øCu√°ndo falleci√≥?</li>
                <li><strong>Si no desea operarse con nosotros es por:</strong>
                    <ul>
                        <li>Lejan√≠a (Distancia/Traslado)</li>
                        <li>Salud</li>
                        <li>No lo necesita (No quiere ‚Äì No necesita)</li>
                    </ul>
                </li>
            </ul>
        </div>
    
        <hr>
        
        <div class="seccion">
            <div class="titulo-seccion">üëã 6. DESPEDIDA E INFORMACI√ìN</div>
            <p class="pregunta">Te recuerdo que todas tus atenciones ser√°n en el Centro M√©dico del Hospital del Trabajador ubicado en <span class="destacado">Vicu√±a Mackenna 210, Providencia</span> (a pasos del metro Parque Bustamante).</p>
            <p class="pregunta">Durante los pr√≥ximos d√≠as te contactar√°n para agendar tu consulta m√©dica y tus ex√°menes, por lo que <span class="destacado">te pido que est√©s muy atento a tu tel√©fono</span>.</p>
            <p class="pregunta"><strong>Buenas tardes y muchas gracias por tu tiempo</strong></p>
        </div>
    
        <hr>
        
        <div class="seccion">
            <div class="titulo-seccion">‚ùì PREGUNTAS FRECUENTES</div>
            
            <div class="faq">
                <div class="faq-titulo">üí∞ ¬øEsto tiene alg√∫n costo para m√≠?</div>
                <p>Las consultas, ex√°menes, cirug√≠a y recuperaci√≥n no tienen costo para el paciente. Sin embargo, cualquier costo relacionado a transporte (traslados en taxi, locomoci√≥n p√∫blica, ambulancia, uber, bus, avi√≥n, etc) corre por cuenta del paciente.</p>
                <div class="importante">‚ö†Ô∏è RECALCAR ESTA INFORMACI√ìN PARA PACIENTES DE REGI√ìN/ZONAS ALEJADAS DEL HT</div>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">‚è∞ ¬øQu√© sucede si no puedo tomar la decisi√≥n ahora?</div>
                <p>Fonasa nos entrega plazos muy acotados para resolver los casos que nos deriva, por lo cual solamente podemos darle 24 horas para que tome la decisi√≥n</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üè• Ya estoy en proceso en mi Hospital de Base, ¬øpuedo iniciar en el HT?</div>
                <p>Fonasa nos deriv√≥ su caso para ser operado por nosotros, sin importar lo que est√© sucediendo en su Hospital de base. Usted puede mantenerse en ambos procesos, sin embargo, si durante el proceso decide mantenerse en su Hospital de base, debe comunicarnos su decisi√≥n para informar a Fonasa</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üìã ¬øTodas mis atenciones pasan a ser en el Hospital del Trabajador?</div>
                <p>No, Fonasa solamente nos deriva su caso para la confirmaci√≥n del diagn√≥stico y la resoluci√≥n quir√∫rgica de su problema de salud, por lo que cualquier problema de salud no asociado al diagn√≥stico por el que fue derivado debe ser resuelto en su Hospital de base</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">ü©∫ ¬øQu√© pasa con el resto de mis atenciones en mi Hospital de base?</div>
                <p>Usted mantendr√° todo el resto de sus atenciones en su Hospital de base. Fonasa solamente nos entrega las facultades para atenderla por el problema de salud que Fonasa deriv√≥</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üöÄ ¬øCu√°ndo iniciar√≠a el proceso?</div>
                <p>El proceso comienza inmediatamente despu√©s de la creaci√≥n de la ficha [Preguntas que se le har√°n a continuaci√≥n]. Durante la misma semana lo contactar√°n desde el equipo de agendamiento para agendar sus ex√°menes y consulta de evaluaci√≥n, por lo que debe estar muy atento al tel√©fono</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üìÖ ¬øCu√°ndo tengo mi consulta?</div>
                <p>Durante la misma semana lo contactar√°n desde el equipo de agendamiento para confirmar sus ex√°menes y consulta de evaluaci√≥n, por lo que debe estar muy atento al tel√©fono</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">‚öïÔ∏è ¬øCu√°ndo tengo mi cirug√≠a?</div>
                <p>Para poder llegar a la cirug√≠a se debe seguir todo el proceso, el cual contempla: ex√°menes de laboratorio, im√°genes y consultas m√©dicas, en los cuales se corroborar√° el diagn√≥stico. Posteriormente el equipo m√©dico definir√° la fecha de su cirug√≠a, la cual debe tener lugar antes de un mes aproximadamente desde la derivaci√≥n</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üß™ Yo ya tengo mis ex√°menes, ¬ødebo tomarme mis ex√°menes igual?</div>
                <p>Si cuenta con ex√°menes que fueron tomados en menos de 3 meses hacia el pasado, puede traerlos para complementar informaci√≥n en consulta, pero de todas formas tomaremos nuevamente todos los ex√°menes</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üìã Si ya tengo todos mis pases en mi Hospital de base, ¬øpuedo operarme al tiro?</div>
                <p>No, pese a que usted ya cuenta con pases de su Hospital de base, nuestros m√©dicos deben corroborar su diagn√≥stico para poder operarse con nosotros. De todas formas, debe traer toda la documentaci√≥n que le hayan entregado en su Hospital de base (ex√°menes, pases, etc)</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">‚è±Ô∏è ¬øCu√°nto demora el proceso?</div>
                <p>El proceso depende de cada paciente y su condici√≥n de salud. En caso de que usted sea un paciente sano y se confirme su diagn√≥stico, entonces programaremos su cirug√≠a cuanto antes. En caso de que su problema de salud sea m√°s complejo, entonces los tiempos pueden aumentar.</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üìÖ ¬øLas consultas y ex√°menes son el mismo d√≠a?</div>
                <p>No siempre es posible agendar todas las atenciones para el mismo d√≠a debido a que depende de la disponibilidad de horas de imagenolog√≠a y de consultas. En caso de que tenga alguna limitaci√≥n de horarios, puedo dejar una nota con su disponibilidad</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üìç ¬øD√≥nde est√°n ubicados?</div>
                <p>Nuestro centro m√©dico est√° ubicado en Vicu√±a Mackenna 210, metro parque Bustamante.</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üè¢ ¬øMe puedo atender en una de las sedes?</div>
                <p>La licitaci√≥n solo contempla atenciones en sede central ubicada en Vicu√±a Mackenna 210.</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üèÉ‚Äç‚ôÇÔ∏è ¬øPuedo hacer la kinesiolog√≠a en otro lado?</div>
                <p>La licitaci√≥n solo contempla atenciones ambulatorias en sede central ubicada en Vicu√±a Mackenna 210.</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üîç ¬øPor qu√© tienen que confirmar mi diagn√≥stico?</div>
                <p>La confirmaci√≥n de diagn√≥stico es esencial para entregar un tratamiento acorde a cada paciente y tener certeza de la patolog√≠a por la que fue derivado y explicar a paciente el procedimiento y plan de acci√≥n.</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üìù ¬øPor qu√© necesitan mi informaci√≥n?</div>
                <p>Fonasa no nos entrega toda la informaci√≥n que necesitamos para crear su ficha y sin esta no podemos atenderlo, por lo que necesitamos que nos la entregue. Esta informaci√≥n solo ser√° utilizada para crear la ficha y tener la mayor cantidad de opciones para contactarlo</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üè† ¬øPara qu√© necesitan mi direcci√≥n?</div>
                <p>Su direcci√≥n es parte de la informaci√≥n solicitada al momento de la creaci√≥n de su ficha cl√≠nica</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">üîí ¬øD√≥nde puedo revisar que esto no es una estafa?</div>
                <p>Puede revisar nuestra p√°gina Web (hospitaldeltrabajador.cl), revisar en YouTube un reportaje realizado cuando iniciamos este proceso el a√±o pasado con nuestra primera paciente e incluso preguntar a Fonasa o su hospital de base por la derivaci√≥n.</p>
            </div>
            
            <div class="faq">
                <div class="faq-titulo">ü©∫ ¬øQu√© pasa si tengo muchos problemas de salud?</div>
                <p>Usted ser√° evaluado por uno de nuestros m√©dicos para determinar si estos problemas de salud ser√°n un problema para realizar la cirug√≠a</p>
            </div>
        </div>
        
        <div class="footer">
            <p>Documento generado autom√°ticamente - ACHS ${new Date().toLocaleDateString()}</p>
        </div>
    </body>
    </html>
            `;
            
            ventanaImpresion.document.write(contenidoImpresion);
            ventanaImpresion.document.close();
            
            // Esperar a que se cargue y luego imprimir
            ventanaImpresion.onload = function() {
                setTimeout(() => {
                    ventanaImpresion.print();
                }, 500);
            };
            
            mostrarMensajeTemp('üñ®Ô∏è Abriendo ventana de impresi√≥n para Script LE...', '#3498db');
            console.log('‚úÖ Ventana de impresi√≥n abierta para Script LE');
        }
    
        // ===== FUNCIONES PARA SCRIPT CIRUG√çA =====
        
        function abrirModalScriptCirugia() {
            console.log('üè• Abriendo modal Script Cirug√≠a...');
            
            const modal = document.getElementById('modalScriptCirugia');
            if (modal) {
                modal.style.display = 'flex';
                
                // Animaci√≥n de entrada
                setTimeout(() => {
                    modal.querySelector('div').style.transform = 'scale(1)';
                    modal.querySelector('div').style.opacity = '1';
                }, 10);
                
                mostrarMensajeTemp('üìã Script Cirug√≠a abierto correctamente', '#28a745');
                console.log('‚úÖ Modal Script Cirug√≠a abierto exitosamente');
            } else {
                console.error('‚ùå Error: No se encontr√≥ el modal Script Cirug√≠a');
                mostrarMensajeTemp('‚ùå Error al abrir Script Cirug√≠a', '#dc3545');
            }
        }
        
        function cerrarModalScriptCirugia() {
            console.log('üîí Cerrando modal Script Cirug√≠a...');
            
            const modal = document.getElementById('modalScriptCirugia');
            if (modal) {
                // Animaci√≥n de salida
                modal.querySelector('div').style.transform = 'scale(0.9)';
                modal.querySelector('div').style.opacity = '0';
                
                setTimeout(() => {
                    modal.style.display = 'none';
                }, 300);
                
                console.log('‚úÖ Modal Script Cirug√≠a cerrado exitosamente');
            }
        }
        
        function copiarScriptCirugia() {
            console.log('üìã Copiando Script Cirug√≠a al portapapeles...');
            
            // Contenido del script de cirug√≠a para copiar
            const contenidoScript = `
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    üè• SCRIPT CIRUG√çA - PROTOCOLO SEGUIMIENTO POST-PRESUPUESTO
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üë§ EJECUTIVO A: SALUDO INICIAL
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    
    Buenos d√≠as/Buenas tardes, mi nombre es <nombre y apellido agente> y lo llamo del Hospital del 
    trabajador Achs Salud ¬øhablo con <nombre y apellido paciente>?
    
    üìã Paciente: S√≠
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üìû EJECUTIVO B: INFORMACI√ìN PRINCIPAL
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    
    <nombre paciente> Le informo que, para efectos de auditor√≠a y seguridad, esta llamada podr√≠a ser 
    grabada. El motivo de mi llamada es porque, seg√∫n nuestros registros usted presupuest√≥ una cirug√≠a 
    de <Nombre cirug√≠a> el d√≠a <Fecha de presupuesto>, pero finalmente no se realiz√≥ su cirug√≠a con 
    nosotros. Desde el Hospital del Trabajador nos gustar√≠a entender cual fue el motivo por el cual no 
    se oper√≥ con nosotros ¬øtendr√° 2 minutos para hacerle unas preguntas?
    
    üìã Respuestas del Paciente:
    ‚Ä¢ No ‚Üí Proceder con despedida
    ‚Ä¢ S√≠ ‚Üí Continuar con el Script
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    ‚ùì EJECUTIVO C: PRIMERA PREGUNTA
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    
    1. ¬øLa cirug√≠a que presupuest√≥ se la realiz√≥ finalmente en otra cl√≠nica/hospital?
    
    üìã Respuestas:
    ‚Ä¢ S√≠ ‚Üí Proceder en Ejecutivo D
    ‚Ä¢ No ‚Üí Proceder en Ejecutivo E
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üè• EJECUTIVO D: SI SE OPER√ì EN OTRO LUGAR
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    
    2. ¬øEn que cl√≠nica/hospital se realiz√≥ la cirug√≠a?
    (Respuesta abierta)
    
    3. ¬øLa cirug√≠a se la realiz√≥ con un m√©dico distinto al que lo atendi√≥ en el Hospital del Trabajador?
    ‚Ä¢ S√≠
    ‚Ä¢ No
    
    4. ¬øNos podr√≠a comentar por qu√© eligi√≥ otro prestador?
    ‚Ä¢ Decid√≠ operarme en Hospital P√∫blico
    ‚Ä¢ Mi Isapre ten√≠a mejor cobertura con otro prestador
    ‚Ä¢ Precios m√°s econ√≥micos
    ‚Ä¢ No me gust√≥ el m√©dico que me atendi√≥ en el Hospital del Trabajador
    ‚Ä¢ Ubicaci√≥n m√°s conveniente
    ‚Ä¢ Tuve que esperar menos tiempo para conseguir fecha de cirug√≠a
    ‚Ä¢ Ten√≠an disponible Bono PAD
    
    ‚û°Ô∏è Seguir en Despedida
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    ‚ùå EJECUTIVO E: SI NO SE OPER√ì
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    
    2. ¬øPor qu√© motivo decidi√≥ no avanzar con su cirug√≠a?
    ‚Ä¢ Motivos econ√≥micos
    ‚Ä¢ Decid√≠ posponerla porque no era urgente
    ‚Ä¢ Estoy haciendo kinesiolog√≠a para poder agendar mi cirug√≠a
    ‚Ä¢ S√≠ me voy a operar
    
    ‚û°Ô∏è Seguir en Despedida
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    üëã DESPEDIDA
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    
    Ejecutivo: <nombre paciente>, ¬øtienes alguna duda o algo m√°s en lo que te pueda ayudar?
    
    Paciente: No, gracias.
    
    Ejecutivo: <nombre paciente> Muchas gracias por atenderme. En caso de cualquier duda o consulta 
    nos puedes llamar al 22 515 7777. Que tengas Un buen d√≠a/Una buena tarde
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    `;
            
            // Copiar al portapapeles
            navigator.clipboard.writeText(contenidoScript).then(() => {
                mostrarMensajeTemp('üìã Script Cirug√≠a copiado al portapapeles exitosamente', '#28a745');
                console.log('‚úÖ Script Cirug√≠a copiado al portapapeles');
            }).catch(err => {
                console.error('‚ùå Error al copiar Script Cirug√≠a:', err);
                mostrarMensajeTemp('‚ùå Error al copiar Script Cirug√≠a', '#dc3545');
            });
        }
        
        function imprimirScriptCirugia() {
            // Crear ventana de impresi√≥n con el script de cirug√≠a formateado
            const ventanaImpresion = window.open('', '_blank', 'width=800,height=600');
            
            const contenidoImpresion = `
    <!DOCTYPE html>
    <html>
    <head>
        <title>Script Cirug√≠a - Protocolo Seguimiento Post-Presupuesto</title>
        <style>
            body { 
                font-family: Arial, sans-serif; 
                line-height: 1.6; 
                margin: 40px; 
                color: #2c3e50; 
                background: #f8f9fa;
            }
            .header { 
                text-align: center; 
                color: #e74c3c; 
                border-bottom: 3px solid #e74c3c; 
                padding-bottom: 20px; 
                margin-bottom: 30px;
            }
            .seccion { 
                background: white; 
                margin: 20px 0; 
                padding: 20px; 
                border-radius: 10px; 
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                border-left: 5px solid #e74c3c;
            }
            .titulo-seccion { 
                color: #e74c3c; 
                font-weight: bold; 
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            .contenido { 
                background: #f8f9fa; 
                padding: 15px; 
                border-radius: 8px; 
                margin: 10px 0;
            }
            .opciones { 
                background: #fff3cd; 
                padding: 10px; 
                border-radius: 6px; 
                border-left: 3px solid #ffc107;
                margin: 10px 0;
            }
            .footer { 
                text-align: center; 
                margin-top: 40px; 
                color: #666; 
                font-size: 0.9em;
            }
            @page { margin: 2cm; }
        </style>
    </head>
    <body>
        <div class="header">
            <h1>üè• SCRIPT CIRUG√çA</h1>
            <h2>Protocolo Seguimiento Post-Presupuesto</h2>
            <p>Hospital del Trabajador ACHS Salud</p>
        </div>
        
        <div class="seccion">
            <div class="titulo-seccion">üë§ EJECUTIVO A: SALUDO INICIAL</div>
            <div class="contenido">
                <strong>Buenos d√≠as/Buenas tardes</strong>, mi nombre es <strong>&lt;nombre y apellido agente&gt;</strong> y lo llamo del Hospital del trabajador Achs Salud ¬øhablo con <strong>&lt;nombre y apellido paciente&gt;</strong>?
            </div>
            <div class="opciones">
                <strong>üìã Paciente responde:</strong> S√≠
            </div>
        </div>
        
        <div class="seccion">
            <div class="titulo-seccion">üìû EJECUTIVO B: INFORMACI√ìN PRINCIPAL</div>
            <div class="contenido">
                <strong>&lt;nombre paciente&gt;</strong> Le informo que, para efectos de auditor√≠a y seguridad, esta llamada podr√≠a ser grabada. El motivo de mi llamada es porque, seg√∫n nuestros registros usted presupuest√≥ una cirug√≠a de <strong>&lt;Nombre cirug√≠a&gt;</strong> el d√≠a <strong>&lt;Fecha de presupuesto&gt;</strong>, pero finalmente no se realiz√≥ su cirug√≠a con nosotros. Desde el Hospital del Trabajador nos gustar√≠a entender cual fue el motivo por el cual no se oper√≥ con nosotros ¬øtendr√° 2 minutos para hacerle unas preguntas?
            </div>
            <div class="opciones">
                <strong>üìã Respuestas del Paciente:</strong><br>
                ‚Ä¢ <strong>No</strong> ‚Üí Proceder con despedida<br>
                ‚Ä¢ <strong>S√≠</strong> ‚Üí Continuar con el Script
            </div>
        </div>
        
        <div class="seccion">
            <div class="titulo-seccion">‚ùì EJECUTIVO C: PRIMERA PREGUNTA</div>
            <div class="contenido">
                <strong>1.</strong> ¬øLa cirug√≠a que presupuest√≥ se la realiz√≥ finalmente en otra cl√≠nica/hospital?
            </div>
            <div class="opciones">
                <strong>üìã Respuestas:</strong><br>
                ‚Ä¢ <strong>S√≠</strong> ‚Üí Proceder en Ejecutivo D<br>
                ‚Ä¢ <strong>No</strong> ‚Üí Proceder en Ejecutivo E
            </div>
        </div>
        
        <div class="seccion">
            <div class="titulo-seccion">üè• EJECUTIVO D: SI SE OPER√ì EN OTRO LUGAR</div>
            <div class="contenido">
                <strong>2.</strong> ¬øEn que cl√≠nica/hospital se realiz√≥ la cirug√≠a?<br>
                <em>(Respuesta abierta)</em>
            </div>
            <div class="contenido">
                <strong>3.</strong> ¬øLa cirug√≠a se la realiz√≥ con un m√©dico distinto al que lo atendi√≥ en el Hospital del Trabajador?<br>
                ‚Ä¢ S√≠<br>
                ‚Ä¢ No
            </div>
            <div class="contenido">
                <strong>4.</strong> ¬øNos podr√≠a comentar por qu√© eligi√≥ otro prestador?<br>
                ‚Ä¢ Decid√≠ operarme en Hospital P√∫blico<br>
                ‚Ä¢ Mi Isapre ten√≠a mejor cobertura con otro prestador<br>
                ‚Ä¢ Precios m√°s econ√≥micos<br>
                ‚Ä¢ No me gust√≥ el m√©dico que me atendi√≥ en el Hospital del Trabajador<br>
                ‚Ä¢ Ubicaci√≥n m√°s conveniente<br>
                ‚Ä¢ Tuve que esperar menos tiempo para conseguir fecha de cirug√≠a<br>
                ‚Ä¢ Ten√≠an disponible Bono PAD
            </div>
            <div class="opciones">
                <strong>‚û°Ô∏è Seguir en Despedida</strong>
            </div>
        </div>
        
        <div class="seccion">
            <div class="titulo-seccion">‚ùå EJECUTIVO E: SI NO SE OPER√ì</div>
            <div class="contenido">
                <strong>2.</strong> ¬øPor qu√© motivo decidi√≥ no avanzar con su cirug√≠a?<br>
                ‚Ä¢ Motivos econ√≥micos<br>
                ‚Ä¢ Decid√≠ posponerla porque no era urgente<br>
                ‚Ä¢ Estoy haciendo kinesiolog√≠a para poder agendar mi cirug√≠a<br>
                ‚Ä¢ S√≠ me voy a operar
            </div>
            <div class="opciones">
                <strong>‚û°Ô∏è Seguir en Despedida</strong>
            </div>
        </div>
        
        <div class="seccion">
            <div class="titulo-seccion">üëã DESPEDIDA</div>
            <div class="contenido">
                <strong>Ejecutivo:</strong> <strong>&lt;nombre paciente&gt;</strong>, ¬øtienes alguna duda o algo m√°s en lo que te pueda ayudar?
            </div>
            <div class="opciones">
                <strong>Paciente:</strong> No, gracias.
            </div>
            <div class="contenido">
                <strong>Ejecutivo:</strong> <strong>&lt;nombre paciente&gt;</strong> Muchas gracias por atenderme. En caso de cualquier duda o consulta nos puedes llamar al <strong>22 515 7777</strong>. Que tengas <strong>Un buen d√≠a/Una buena tarde</strong>
            </div>
        </div>
        
        <div class="footer">
            <p>üìÑ Documento generado desde Sistema ACHS - Script Cirug√≠a</p>
            <p>üïí Fecha de impresi√≥n: ${new Date().toLocaleString('es-CL')}</p>
        </div>
    </body>
    </html>
            `;
            
            ventanaImpresion.document.write(contenidoImpresion);
            ventanaImpresion.document.close();
            
            // Esperar a que se cargue y luego imprimir
            ventanaImpresion.onload = function() {
                setTimeout(() => {
                    ventanaImpresion.print();
                }, 500);
            };
            
            mostrarMensajeTemp('üñ®Ô∏è Abriendo ventana de impresi√≥n para Script Cirug√≠a...', '#3498db');
            console.log('‚úÖ Ventana de impresi√≥n abierta para Script Cirug√≠a');
        }

    // Event listener para configuraci√≥n
    document.addEventListener('DOMContentLoaded', function() {
        // Cargar √∫ltimo n√∫mero de WhatsApp cuando se abra el modal de comunicaci√≥n
        setTimeout(() => {
            cargarUltimoNumeroWhatsApp();
        }, 1000);
        
        // Configurar event listener para la Base de Conocimientos
        const btnBaseConocimientos = document.getElementById('btnBaseConocimientos');
        if (btnBaseConocimientos) {
            btnBaseConocimientos.addEventListener('click', abrirModalBaseConocimientos);
            console.log('‚úÖ Event listener para Base de Conocimientos configurado');
        }
        
        // Inicializar la base de conocimientos
        inicializarBaseConocimientos();
    });

    // Cargar √∫ltimo n√∫mero de WhatsApp usado
    function cargarUltimoNumeroWhatsApp() {
        const ultimoNumero = localStorage.getItem('ultimoNumeroWhatsApp');
        if (ultimoNumero) {
            const inputNumero = document.getElementById('numeroWhatsApp');
            if (inputNumero) {
                inputNumero.value = ultimoNumero;
            }
        }
    }

    // Funci√≥n para abrir modal de comunicaci√≥n
    function abrirModalComunicacion() {
        const modal = document.getElementById('modalComunicacion');
        if (modal) {
            modal.style.display = 'flex';
            console.log('‚úÖ Modal de comunicaci√≥n abierto');
        }
    }

    // Funci√≥n para cerrar modal de comunicaci√≥n
    function cerrarModalComunicacion() {
        const modal = document.getElementById('modalComunicacion');
        if (modal) {
            modal.style.display = 'none';
            console.log('‚úÖ Modal de comunicaci√≥n cerrado');
        }
    }

    // Funci√≥n para enviar por WhatsApp
    function enviarPorWhatsApp(tipo = 'corto') {
        const contenido = tipo === 'corto' ? 
            document.getElementById('resumenCorto').value : 
            document.getElementById('resumenCompleto').value;
        
        if (!contenido.trim()) {
            mostrarMensajeTemp('‚ö†Ô∏è No hay contenido para enviar', '#ffc107');
            return;
        }

        // Codificar el mensaje para URL
        const mensajeCodificado = encodeURIComponent(contenido);
        
        // Abrir WhatsApp Web con el mensaje preformateado
        const urlWhatsApp = `https://web.whatsapp.com/send?text=${mensajeCodificado}`;
        
        window.open(urlWhatsApp, '_blank');
        
        mostrarMensajeTemp('üì± WhatsApp abierto con el reporte', '#25D366');
        console.log('‚úÖ Reporte enviado a WhatsApp');
        
        // Opcional: cerrar modal despu√©s de enviar
        setTimeout(() => {
            cerrarModalComunicacion();
        }, 2000);
    }

    // Funci√≥n para enviar por WhatsApp a n√∫mero espec√≠fico
    function enviarWhatsAppANumero() {
        const numero = document.getElementById('numeroWhatsApp').value.trim();
        const contenido = document.getElementById('resumenCompleto').value;
        
        if (!numero) {
            mostrarMensajeTemp('‚ö†Ô∏è Ingrese un n√∫mero de WhatsApp', '#ffc107');
            document.getElementById('numeroWhatsApp').focus();
            return;
        }
        
        if (!contenido.trim()) {
            mostrarMensajeTemp('‚ö†Ô∏è No hay contenido para enviar', '#ffc107');
            return;
        }

        // Limpiar el n√∫mero (quitar espacios, guiones, etc.)
        const numeroLimpio = numero.replace(/\D/g, '');
        
        if (numeroLimpio.length < 8) {
            mostrarMensajeTemp('‚ö†Ô∏è N√∫mero de WhatsApp inv√°lido', '#dc3545');
            return;
        }

        // Agregar c√≥digo de pa√≠s si no lo tiene
        const numeroCompleto = numeroLimpio.startsWith('56') ? numeroLimpio : '56' + numeroLimpio;
        
        const mensajeCodificado = encodeURIComponent(contenido);
        const urlWhatsApp = `https://web.whatsapp.com/send?phone=${numeroCompleto}&text=${mensajeCodificado}`;
        
        window.open(urlWhatsApp, '_blank');
        
        mostrarMensajeTemp(`üì± WhatsApp abierto para enviar a +${numeroCompleto}`, '#25D366');
        console.log(`‚úÖ Reporte enviado a WhatsApp: +${numeroCompleto}`);
        
        // Guardar n√∫mero para uso futuro
        localStorage.setItem('ultimoNumeroWhatsApp', numero);
        
        setTimeout(() => {
            cerrarModalComunicacion();
        }, 2000);
    }

    // Funci√≥n para enviar por Microsoft Teams
    function enviarPorTeams() {
        const contenido = document.getElementById('resumenCompleto').value;
        
        if (!contenido.trim()) {
            mostrarMensajeTemp('‚ö†Ô∏è No hay contenido para enviar', '#ffc107');
            return;
        }

        // Crear enlace de Teams con mensaje preformateado
        const mensajeCodificado = encodeURIComponent(contenido);
        
        // Intentar abrir Teams desktop app primero, luego web
        const urlTeamsDesktop = `msteams:/l/chat/0/0?message=${mensajeCodificado}`;
        const urlTeamsWeb = `https://teams.microsoft.com/l/chat/0/0?message=${mensajeCodificado}`;
        
        // Intentar abrir app de escritorio
        const ventanaTeams = window.open(urlTeamsDesktop, '_blank');
        
        // Si no se abre en 2 segundos, abrir versi√≥n web
        setTimeout(() => {
            if (!ventanaTeams || ventanaTeams.closed) {
                window.open(urlTeamsWeb, '_blank');
                mostrarMensajeTemp('üíº Teams Web abierto con el reporte', '#6264A7');
            } else {
                mostrarMensajeTemp('üíº Teams App abierto con el reporte', '#6264A7');
            }
        }, 2000);
        
        console.log('‚úÖ Reporte enviado a Microsoft Teams');
        
        setTimeout(() => {
            cerrarModalComunicacion();
        }, 2000);
    }

    // Funci√≥n para enviar por email
    function enviarPorEmail() {
        const contenido = document.getElementById('resumenCompleto').value;
        const asunto = `Reporte de Conversaci√≥n ACHS - ${new Date().toLocaleDateString()}`;
        
        if (!contenido.trim()) {
            mostrarMensajeTemp('‚ö†Ô∏è No hay contenido para enviar', '#ffc107');
            return;
        }

        // Crear enlace mailto
        const asuntoCodificado = encodeURIComponent(asunto);
        const cuerpoConFormato = contenido.replace(/\n/g, '%0D%0A');
        const cuerpoCodificado = encodeURIComponent(cuerpoConFormato);
        
        const urlEmail = `mailto:?subject=${asuntoCodificado}&body=${cuerpoCodificado}`;
        
        window.location.href = urlEmail;
        
        mostrarMensajeTemp('üìß Cliente de email abierto con el reporte', '#0078D4');
        console.log('‚úÖ Reporte enviado por email');
        
        setTimeout(() => {
            cerrarModalComunicacion();
        }, 2000);
    }

    // Funci√≥n para copiar al portapapeles
    function copiarReporte(tipo = 'completo') {
        const contenido = tipo === 'corto' ? 
            document.getElementById('resumenCorto').value : 
            document.getElementById('resumenCompleto').value;
        
        if (!contenido.trim()) {
            mostrarMensajeTemp('‚ö†Ô∏è No hay contenido para copiar', '#ffc107');
            return;
        }

        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(contenido).then(() => {
                mostrarMensajeTemp('üìã Reporte copiado al portapapeles', '#28a745');
            }).catch(() => {
                copiarAlPortapapelesFallback(contenido);
            });
        } else {
            copiarAlPortapapelesFallback(contenido);
        }
    }

    // Funci√≥n de respaldo para copiar al portapapeles
    function copiarAlPortapapelesFallback(texto) {
        const textArea = document.createElement('textarea');
        textArea.value = texto;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        textArea.style.top = '-999999px';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            mostrarMensajeTemp('üìã Reporte copiado al portapapeles', '#28a745');
        } catch (err) {
            prompt('Copia este texto manualmente:', texto);
        } finally {
            document.body.removeChild(textArea);
        }
    }

    // ============ FUNCIONES DE BASE DE CONOCIMIENTOS ============

    // Variables globales para la base de conocimientos
    let articulosWiki = [];
    let articuloActual = null;
    let modoEdicion = false;

    // Funci√≥n para inicializar la base de conocimientos
    function inicializarBaseConocimientos() {
        console.log('üìö Inicializando Base de Conocimientos');
        
        // Cargar art√≠culos desde localStorage
        cargarArticulosWiki();
        
        // Mostrar lista de art√≠culos
        mostrarListaArticulos();
        
        // Actualizar estad√≠sticas
        actualizarEstadisticasWiki();
        
        console.log('‚úÖ Base de Conocimientos inicializada');
    }

    // Funci√≥n para inicializar la base de conocimientos
    function inicializarBaseConocimientos() {
        cargarArticulosWiki();
        configurarEventosWiki();
        console.log('‚úÖ Base de Conocimientos inicializada');
    }

    // Cargar art√≠culos desde localStorage
    function cargarArticulosWiki() {
        const articulosGuardados = localStorage.getItem('articulosWiki');
        if (articulosGuardados) {
            articulosWiki = JSON.parse(articulosGuardados);
            console.log(`üìö Cargados ${articulosWiki.length} art√≠culos de la wiki`);
        } else {
            // Crear algunos art√≠culos de ejemplo
            articulosWiki = [
                {
                    id: Date.now() + 1,
                    titulo: 'Proceso de Atenci√≥n SNL',
                    categoria: 'SNL',
                    tipoDocumento: 'MANUAL',
                    contenido: `# Proceso de Atenci√≥n SNL (Salud No Laboral)

## Pasos a seguir:

1. **Verificar datos del paciente**
   - RUT v√°lido y activo
   - Nombre completo
   - Tel√©fono de contacto

2. **Consultar disponibilidad**
   - Revisar agenda m√©dica
   - Verificar especialidades disponibles
   - Confirmar horarios

3. **Coordinar cita**
   - Agendar en sistema
   - Enviar confirmaci√≥n
   - Registrar en historial

## Contactos importantes:
- **SNL:** 225157000
- **WhatsApp SNL:** 988514462`,
                    autor: 'Sistema',
                    fecha: new Date().toISOString(),
                    vistas: 15,
                    prioridad: 'importante',
                    tags: ['SNL', 'procedimiento', 'citas'],
                    comentarios: []
                },
                {
                    id: Date.now() + 2,
                    titulo: 'FAQ - Preguntas Frecuentes EP',
                    categoria: 'FAQ',
                    tipoDocumento: 'WORD',
                    contenido: `# Preguntas Frecuentes - Enfermedades Profesionales

## ¬øQu√© es una EP?
Una Enfermedad Profesional es aquella causada de manera directa por el ejercicio de la profesi√≥n o el trabajo que realice una persona.

## ¬øC√≥mo se reporta una EP?
1. Llenar formulario EP-SM
2. Adjuntar documentaci√≥n m√©dica
3. Enviar a trav√©s del sistema

## Tiempos de respuesta:
- **Evaluaci√≥n inicial:** 5 d√≠as h√°biles
- **Resoluci√≥n:** 15 d√≠as h√°biles
- **Notificaci√≥n:** 24 horas

## Contacto especializado:
- **Formulario EP:** [Enlace al formulario]
- **Consultas:** contacto.ep@achs.cl`,
                    autor: 'Sistema',
                    fecha: new Date(Date.now() - 86400000).toISOString(),
                    vistas: 32,
                    prioridad: 'normal',
                    tags: ['EP', 'FAQ', 'formulario'],
                    comentarios: []
                },
                {
                    id: Date.now() + 3,
                    titulo: 'Manual de Procedimientos PDF',
                    categoria: 'procedimientos',
                    tipoDocumento: 'PDF',
                    contenido: `# Manual de Procedimientos Administrativos

Este documento fue importado desde un archivo PDF oficial de ACHS.

## Contenido del Manual:

### 1. Procedimientos Generales
- Atenci√≥n al cliente
- Gesti√≥n de documentos
- Reportes administrativos

### 2. Procesos Espec√≠ficos
- Validaci√≥n de datos
- Seguimiento de casos
- Archivo y almacenamiento

### 3. Contactos de Soporte
- Mesa de ayuda: ext. 1234
- Supervisor: ext. 5678

*Documento originalmente en formato PDF, convertido a la Base de Conocimientos para facilitar el acceso y b√∫squeda.*`,
                    autor: 'Importado desde PDF',
                    fecha: new Date(Date.now() - 172800000).toISOString(),
                    vistas: 8,
                    prioridad: 'normal',
                    tags: ['PDF', 'manual', 'procedimientos'],
                    comentarios: []
                }
            ];
            guardarArticulosWiki();
        }
    }

    // Guardar art√≠culos en localStorage
    function guardarArticulosWiki() {
        localStorage.setItem('articulosWiki', JSON.stringify(articulosWiki));
        actualizarEstadisticasWiki();
    }

    // Configurar eventos de la wiki
    function configurarEventosWiki() {
        // B√∫squeda en tiempo real
        const inputBusqueda = document.getElementById('buscarArticulo');
        if (inputBusqueda) {
            inputBusqueda.addEventListener('input', buscarArticulosWiki);
        }

        // Filtros
        const selectCategoria = document.getElementById('filtroCategoria');
        const selectOrden = document.getElementById('ordenarPor');
        
        if (selectCategoria) {
            selectCategoria.addEventListener('change', filtrarArticulosWiki);
        }
        
        if (selectOrden) {
            selectOrden.addEventListener('change', filtrarArticulosWiki);
        }
    }

    // Abrir modal de base de conocimientos
    function abrirModalBaseConocimientos() {
        const modal = document.getElementById('modalBaseConocimientos');
        if (modal) {
            modal.style.display = 'flex';
            mostrarListaArticulos();
            mostrarVistaPorDefecto();
            actualizarEstadisticasWiki();
            console.log('üìö Modal de Base de Conocimientos abierto');
        }
    }

    // Cerrar modal
    function cerrarModalBaseConocimientos() {
        const modal = document.getElementById('modalBaseConocimientos');
        if (modal) {
            modal.style.display = 'none';
            console.log('üìö Modal de Base de Conocimientos cerrado');
        }
    }

    // Mostrar lista de art√≠culos
    function mostrarListaArticulos(articulos = null) {
        const listaContainer = document.getElementById('listaArticulos');
        if (!listaContainer) return;

        const articulosMostrar = articulos || articulosWiki;

        if (articulosMostrar.length === 0) {
            listaContainer.innerHTML = `
                <div style="text-align:center; color:#6c757d; padding:20px; font-style:italic;">
                    üìù No hay art√≠culos que coincidan<br>
                    <small>Intenta cambiar los filtros de b√∫squeda</small>
                </div>
            `;
            return;
        }

        const articulosHTML = articulosMostrar.map(articulo => {
            const fechaFormateada = new Date(articulo.fecha).toLocaleDateString();
            const iconoCategoria = obtenerIconoCategoria(articulo.categoria);
            const iconoPrioridad = articulo.prioridad === 'urgente' ? 'üî•' : 
                                 articulo.prioridad === 'importante' ? '‚≠ê' : 'üìÑ';
            const tipoIcono = articulo.tipoDocumento === 'WORD' ? 'üìù' :
                             articulo.tipoDocumento === 'PDF' ? 'üìã' :
                             articulo.tipoDocumento === 'JSON' ? 'üìÑ' : '‚úèÔ∏è';
            
            return `
                <div onclick="verArticulo('${articulo.id}')" style="background:white; border:1px solid #dee2e6; border-radius:8px; padding:12px; margin-bottom:10px; cursor:pointer; transition:all 0.3s ease;" 
                     onmouseover="this.style.borderColor='#17a2b8'; this.style.boxShadow='0 4px 8px rgba(23,162,184,0.2)'" 
                     onmouseout="this.style.borderColor='#dee2e6'; this.style.boxShadow='none'">
                    
                    <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:8px;">
                        <h6 style="margin:0; color:#17a2b8; font-size:0.9em; font-weight:bold; line-height:1.3;">
                            ${iconoPrioridad} ${articulo.titulo}
                        </h6>
                    </div>
                    
                    <div style="display:flex; justify-content:space-between; align-items:center; font-size:0.75em; color:#6c757d;">
                        <span style="background:#e7f3ff; color:#0056b3; padding:2px 6px; border-radius:10px;">
                            ${iconoCategoria} ${articulo.categoria}
                        </span>
                        <span style="background:#f8f9fa; color:#495057; padding:2px 6px; border-radius:10px;">
                            ${tipoIcono} ${articulo.tipoDocumento || 'MANUAL'}
                        </span>
                        <span>üëÄ ${articulo.vistas}</span>
                    </div>
                    
                    <div style="font-size:0.7em; color:#6c757d; margin-top:5px;">
                        üìÖ ${fechaFormateada}
                    </div>
                </div>
            `;
        }).join('');

        listaContainer.innerHTML = articulosHTML;
    }

    // Obtener icono por categor√≠a
    function obtenerIconoCategoria(categoria) {
        const iconos = {
            'SNL': 'üè•',
            'EP': '‚öïÔ∏è',
            'Procedimientos': 'üìã',
            'FAQ': '‚ùì',
            'Contactos': 'üìû',
            'Sistemas': 'üíª',
            'Normativas': 'üìú'
        };
        return iconos[categoria] || 'üìÑ';
    }

    // Formatear contenido con markdown simple
    function formatearContenido(contenido) {
        let html = contenido;
        
        // Headers
        html = html.replace(/^### (.*$)/gim, '<h5 style="color:#17a2b8; margin-top:20px; margin-bottom:10px;">$1</h5>');
        html = html.replace(/^## (.*$)/gim, '<h4 style="color:#17a2b8; margin-top:25px; margin-bottom:12px;">$1</h4>');
        html = html.replace(/^# (.*$)/gim, '<h3 style="color:#17a2b8; margin-top:30px; margin-bottom:15px;">$1</h3>');
        
        // Bold e italic
        html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
        
        // Enlaces
        html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" style="color:#17a2b8; text-decoration:none;">$1 üîó</a>');
        
        // Listas
        html = html.replace(/^\d+\.\s(.*)$/gim, '<li style="margin-bottom:5px;">$1</li>');
        html = html.replace(/^-\s(.*)$/gim, '<li style="margin-bottom:5px; list-style-type:disc;">$1</li>');
        
        // Envolver listas en ul/ol
        html = html.replace(/(<li[^>]*>.*<\/li>)/gs, (match) => {
            if (match.includes('list-style-type:disc')) {
                return `<ul style="margin:10px 0; padding-left:20px;">${match}</ul>`;
            } else {
                return `<ol style="margin:10px 0; padding-left:20px;">${match}</ol>`;
            }
        });
        
        // P√°rrafos
        html = html.split('\n\n').map(p => p.trim() ? `<p style="margin-bottom:15px; line-height:1.6;">${p}</p>` : '').join('');
        
        return html;
    }

    // Crear nuevo art√≠culo
    function crearNuevoArticulo() {
        articuloActual = null;
        modoEdicion = true;
        
        // Ocultar otros paneles
        document.getElementById('vistaPorDefecto').style.display = 'none';
        document.getElementById('visorArticulo').style.display = 'none';
        
        // Mostrar editor
        const editor = document.getElementById('editorArticulo');
        editor.style.display = 'flex';
        
        // Limpiar campos
        document.getElementById('tituloArticulo').value = '';
        document.getElementById('categoriaArticulo').value = '';
        document.getElementById('prioridadArticulo').value = 'normal';
        document.getElementById('tagsArticulo').value = '';
        document.getElementById('contenidoArticulo').value = '';
        
        // Ocultar bot√≥n eliminar
        document.getElementById('btnEliminarArticulo').style.display = 'none';
        
        console.log('üìù Creando nuevo art√≠culo');
    }

    // Editar art√≠culo actual
    function editarArticuloActual() {
        if (!articuloActual) return;
        
        modoEdicion = true;
        
        // Ocultar visor
        document.getElementById('visorArticulo').style.display = 'none';
        
        // Mostrar editor
        const editor = document.getElementById('editorArticulo');
        editor.style.display = 'flex';
        
        // Llenar campos
        document.getElementById('tituloArticulo').value = articuloActual.titulo;
        document.getElementById('categoriaArticulo').value = articuloActual.categoria;
        document.getElementById('prioridadArticulo').value = articuloActual.prioridad || 'normal';
        document.getElementById('tagsArticulo').value = articuloActual.tags ? articuloActual.tags.join(', ') : '';
        document.getElementById('contenidoArticulo').value = articuloActual.contenido;
        
        // Mostrar bot√≥n eliminar
        document.getElementById('btnEliminarArticulo').style.display = 'inline-block';
        
        console.log(`‚úèÔ∏è Editando art√≠culo: ${articuloActual.titulo}`);
    }

    // Guardar art√≠culo
    function guardarArticulo() {
        const titulo = document.getElementById('tituloArticulo').value.trim();
        const categoria = document.getElementById('categoriaArticulo').value;
        const prioridad = document.getElementById('prioridadArticulo').value;
        const tags = document.getElementById('tagsArticulo').value.split(',').map(t => t.trim()).filter(t => t);
        const contenido = document.getElementById('contenidoArticulo').value.trim();
        
        // Validaciones
        if (!titulo) {
            mostrarMensajeTemp('‚ö†Ô∏è El t√≠tulo es obligatorio', '#ffc107');
            return;
        }
        
        if (!categoria) {
            mostrarMensajeTemp('‚ö†Ô∏è Selecciona una categor√≠a', '#ffc107');
            return;
        }
        
        if (!contenido) {
            mostrarMensajeTemp('‚ö†Ô∏è El contenido no puede estar vac√≠o', '#ffc107');
            return;
        }
        
        // Crear o actualizar art√≠culo
        if (articuloActual) {
            // Actualizar existente
            articuloActual.titulo = titulo;
            articuloActual.categoria = categoria;
            articuloActual.prioridad = prioridad;
            articuloActual.tags = tags;
            articuloActual.contenido = contenido;
            articuloActual.fechaModificacion = new Date().toISOString();
        } else {
            // Crear nuevo
            const nuevoArticulo = {
                id: Date.now(),
                titulo: titulo,
                categoria: categoria,
                prioridad: prioridad,
                tags: tags,
                contenido: contenido,
                autor: 'Usuario',
                fecha: new Date().toISOString(),
                vistas: 0,
                comentarios: []
            };
            
            articulosWiki.unshift(nuevoArticulo);
            articuloActual = nuevoArticulo;
        }
        
        guardarArticulosWiki();
        mostrarListaArticulos();
        mostrarVisorArticulo(articuloActual);
        mostrarMensajeTemp('‚úÖ Art√≠culo guardado exitosamente', '#28a745');
        
        console.log(`üíæ Art√≠culo guardado: ${titulo}`);
    }

    // Cancelar edici√≥n
    function cancelarEdicion() {
        if (articuloActual) {
            mostrarVisorArticulo(articuloActual);
        } else {
            mostrarVistaPorDefecto();
        }
        modoEdicion = false;
    }

    // Eliminar art√≠culo
    function eliminarArticulo() {
        if (!articuloActual) return;
        
        if (confirm(`¬øEst√°s seguro de que quieres eliminar el art√≠culo "${articuloActual.titulo}"?`)) {
            const index = articulosWiki.findIndex(a => a.id === articuloActual.id);
            if (index !== -1) {
                articulosWiki.splice(index, 1);
                guardarArticulosWiki();
                mostrarListaArticulos();
                mostrarVistaPorDefecto();
                articuloActual = null;
                mostrarMensajeTemp('üóëÔ∏è Art√≠culo eliminado', '#dc3545');
                console.log('üóëÔ∏è Art√≠culo eliminado');
            }
        }
    }

    // Mostrar vista por defecto
    function mostrarVistaPorDefecto() {
        document.getElementById('visorArticulo').style.display = 'none';
        document.getElementById('editorArticulo').style.display = 'none';
        document.getElementById('vistaPorDefecto').style.display = 'block';
    }

    // Buscar art√≠culos
    function buscarArticulosWiki() {
        const termino = document.getElementById('buscarArticulo').value.toLowerCase();
        const categoria = document.getElementById('filtroCategoria').value;
        
        let articulosFiltrados = articulosWiki.filter(articulo => {
            const coincideTexto = articulo.titulo.toLowerCase().includes(termino) ||
                                articulo.contenido.toLowerCase().includes(termino) ||
                                (articulo.tags && articulo.tags.some(tag => tag.toLowerCase().includes(termino)));
            
            const coincideCategoria = !categoria || articulo.categoria === categoria;
            
            return coincideTexto && coincideCategoria;
        });
        
        // Aplicar orden
        const orden = document.getElementById('ordenarPor').value;
        articulosFiltrados = ordenarArticulos(articulosFiltrados, orden);
        
        mostrarListaArticulos(articulosFiltrados);
    }

    // Filtrar art√≠culos
    function filtrarArticulosWiki() {
        buscarArticulosWiki(); // Reutilizar la funci√≥n de b√∫squeda
    }

    // Ordenar art√≠culos
    function ordenarArticulos(articulos, criterio) {
        return articulos.sort((a, b) => {
            switch(criterio) {
                case 'fecha':
                    return new Date(b.fecha) - new Date(a.fecha);
                case 'titulo':
                    return a.titulo.localeCompare(b.titulo);
                case 'vistas':
                    return (b.vistas || 0) - (a.vistas || 0);
                case 'relevancia':
                    // Combinar vistas y prioridad
                    const scoreA = (a.vistas || 0) + (a.prioridad === 'urgente' ? 100 : a.prioridad === 'importante' ? 50 : 0);
                    const scoreB = (b.vistas || 0) + (b.prioridad === 'urgente' ? 100 : b.prioridad === 'importante' ? 50 : 0);
                    return scoreB - scoreA;
                default:
                    return 0;
            }
        });
    }

    // Actualizar estad√≠sticas
    function actualizarEstadisticasWiki() {
        const hoy = new Date().toDateString();
        const semanaAtras = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
        
        const totalArticulos = articulosWiki.length;
        const articulosHoy = articulosWiki.filter(a => new Date(a.fecha).toDateString() === hoy).length;
        const articulosSemana = articulosWiki.filter(a => new Date(a.fecha) >= semanaAtras).length;
        const totalVistas = articulosWiki.reduce((sum, a) => sum + (a.vistas || 0), 0);
        
        // Actualizar elementos
        const elementos = {
            'totalArticulos': totalArticulos,
            'articulosHoy': articulosHoy,
            'totalArticulosPanel': totalArticulos,
            'articulosSemana': articulosSemana,
            'totalVistas': totalVistas
        };
        
        Object.entries(elementos).forEach(([id, valor]) => {
            const elemento = document.getElementById(id);
            if (elemento) {
                elemento.textContent = valor;
            }
        });
        
        // Actualizar art√≠culos recientes y populares
        actualizarPanelesLaterales();
    }

    // Actualizar paneles laterales
    function actualizarPanelesLaterales() {
        // Art√≠culos recientes
        const recientes = [...articulosWiki]
            .sort((a, b) => new Date(b.fecha) - new Date(a.fecha))
            .slice(0, 5);
        
        const recientesContainer = document.getElementById('articulosRecientes');
        if (recientesContainer) {
            if (recientes.length === 0) {
                recientesContainer.innerHTML = '<div style="color:#6c757d; font-style:italic; text-align:center; padding:10px;">No hay art√≠culos recientes</div>';
            } else {
                recientesContainer.innerHTML = recientes.map(articulo => `
                    <div onclick="verArticulo('${articulo.id}')" style="background:white; border:1px solid #dee2e6; border-radius:6px; padding:8px; margin-bottom:8px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.borderColor='#17a2b8'" onmouseout="this.style.borderColor='#dee2e6'">
                        <div style="font-weight:bold; font-size:0.8em; color:#17a2b8; margin-bottom:4px;">${articulo.titulo}</div>
                        <div style="font-size:0.7em; color:#6c757d;">${new Date(articulo.fecha).toLocaleDateString()}</div>
                    </div>
                `).join('');
            }
        }
        
        // Art√≠culos populares
        const populares = [...articulosWiki]
            .sort((a, b) => (b.vistas || 0) - (a.vistas || 0))
            .slice(0, 5);
        
        const popularesContainer = document.getElementById('articulosPopulares');
        if (popularesContainer) {
            if (populares.length === 0 || populares.every(a => (a.vistas || 0) === 0)) {
                popularesContainer.innerHTML = '<div style="color:#6c757d; font-style:italic; text-align:center; padding:10px;">No hay datos a√∫n</div>';
            } else {
                popularesContainer.innerHTML = populares.map(articulo => `
                    <div onclick="verArticulo('${articulo.id}')" style="background:white; border:1px solid #dee2e6; border-radius:6px; padding:8px; margin-bottom:8px; cursor:pointer; transition:all 0.3s ease;" onmouseover="this.style.borderColor='#17a2b8'" onmouseout="this.style.borderColor='#dee2e6'">
                        <div style="font-weight:bold; font-size:0.8em; color:#17a2b8; margin-bottom:4px;">${articulo.titulo}</div>
                        <div style="font-size:0.7em; color:#6c757d;">üëÄ ${articulo.vistas || 0} vistas</div>
                    </div>
                `).join('');
            }
        }
    }

    // Buscar en wiki por categor√≠a
    function buscarEnWiki(categoria) {
        document.getElementById('filtroCategoria').value = categoria;
        document.getElementById('buscarArticulo').value = '';
        filtrarArticulosWiki();
    }

    // Mostrar comentarios
    function mostrarComentarios(articulo) {
        const container = document.getElementById('comentariosArticulo');
        if (!container) return;
        
        if (!articulo.comentarios || articulo.comentarios.length === 0) {
            container.innerHTML = '<div style="color:#6c757d; font-style:italic;">No hay comentarios a√∫n</div>';
            return;
        }
        
        container.innerHTML = articulo.comentarios.map(comentario => `
            <div style="background:#f8f9fa; border-left:4px solid #17a2b8; padding:10px; margin-bottom:8px; border-radius:4px;">
                <div style="font-size:0.8em; color:#6c757d; margin-bottom:5px;">
                    ${comentario.autor} - ${new Date(comentario.fecha).toLocaleDateString()}
                </div>
                <div>${comentario.texto}</div>
            </div>
        `).join('');
    }

    // Agregar comentario
    function agregarComentario() {
        if (!articuloActual) return;
        
        const input = document.getElementById('nuevoComentario');
        const texto = input.value.trim();
        
        if (!texto) {
            mostrarMensajeTemp('‚ö†Ô∏è Escribe un comentario', '#ffc107');
            return;
        }
        
        if (!articuloActual.comentarios) {
            articuloActual.comentarios = [];
        }
        
        articuloActual.comentarios.push({
            texto: texto,
            autor: 'Usuario',
            fecha: new Date().toISOString()
        });
        
        guardarArticulosWiki();
        mostrarComentarios(articuloActual);
        input.value = '';
        
        mostrarMensajeTemp('üí¨ Comentario agregado', '#28a745');
    }

    // Funciones de herramientas adicionales
    function mostrarCategorias() {
        const categorias = [...new Set(articulosWiki.map(a => a.categoria))];
        const mensaje = categorias.length > 0 ? 
            `Categor√≠as disponibles:\n${categorias.map(c => `‚Ä¢ ${obtenerIconoCategoria(c)} ${c}`).join('\n')}` :
            'No hay categor√≠as creadas a√∫n';
        alert(mensaje);
    }

    function exportarBaseConocimientos() {
        const datos = {
            articulos: articulosWiki,
            fechaExportacion: new Date().toISOString(),
            version: '1.0'
        };
        
        const blob = new Blob([JSON.stringify(datos, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `base-conocimientos-achs-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        
        mostrarMensajeTemp('üì• Base de conocimientos exportada', '#28a745');
    }

    function importarBaseConocimientos() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        input.onchange = function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const datos = JSON.parse(e.target.result);
                    if (datos.articulos && Array.isArray(datos.articulos)) {
                        if (confirm('¬øQuieres reemplazar todos los art√≠culos actuales? (Se recomienda hacer un backup primero)')) {
                            articulosWiki = datos.articulos;
                            guardarArticulosWiki();
                            mostrarListaArticulos();
                            mostrarMensajeTemp('üì§ Base de conocimientos importada', '#28a745');
                        }
                    } else {
                        throw new Error('Formato de archivo inv√°lido');
                    }
                } catch (error) {
                    mostrarMensajeTemp('‚ùå Error al importar: formato inv√°lido', '#dc3545');
                }
            };
            reader.readAsText(file);
        };
        input.click();
    }

    function estadisticasWiki() {
        const stats = {
            total: articulosWiki.length,
            categorias: [...new Set(articulosWiki.map(a => a.categoria))].length,
            vistasTotal: articulosWiki.reduce((sum, a) => sum + (a.vistas || 0), 0),
            comentariosTotal: articulosWiki.reduce((sum, a) => sum + (a.comentarios ? a.comentarios.length : 0), 0),
            articulo_mas_visto: articulosWiki.reduce((max, a) => (a.vistas || 0) > (max.vistas || 0) ? a : max, articulosWiki[0])
        };
        
        const mensaje = `üìä Estad√≠sticas de la Base de Conocimientos:

‚Ä¢ Total de art√≠culos: ${stats.total}
‚Ä¢ Categor√≠as diferentes: ${stats.categorias}
‚Ä¢ Vistas totales: ${stats.vistasTotal}
‚Ä¢ Comentarios totales: ${stats.comentariosTotal}
${stats.articulo_mas_visto ? `‚Ä¢ Art√≠culo m√°s visto: "${stats.articulo_mas_visto.titulo}" (${stats.articulo_mas_visto.vistas || 0} vistas)` : ''}`;
        
        alert(mensaje);
    }

    // Funciones de formato para el editor
    function formatearTexto(tipo) {
        const textarea = document.getElementById('contenidoArticulo');
        const inicio = textarea.selectionStart;
        const fin = textarea.selectionEnd;
        const textoSeleccionado = textarea.value.substring(inicio, fin);
        
        let textoFormateado = '';
        switch(tipo) {
            case 'bold':
                textoFormateado = `**${textoSeleccionado || 'texto en negrita'}**`;
                break;
            case 'italic':
                textoFormateado = `*${textoSeleccionado || 'texto en cursiva'}*`;
                break;
        }
        
        textarea.value = textarea.value.substring(0, inicio) + textoFormateado + textarea.value.substring(fin);
        textarea.focus();
    }

    function insertarLista() {
        const textarea = document.getElementById('contenidoArticulo');
        const posicion = textarea.selectionStart;
        const textoBefore = textarea.value.substring(0, posicion);
        const textoAfter = textarea.value.substring(posicion);
        
        const lista = '\n- Elemento 1\n- Elemento 2\n- Elemento 3\n';
        textarea.value = textoBefore + lista + textoAfter;
        textarea.focus();
    }

    function insertarEnlace() {
        const textarea = document.getElementById('contenidoArticulo');
        const inicio = textarea.selectionStart;
        const fin = textarea.selectionEnd;
        const textoSeleccionado = textarea.value.substring(inicio, fin);
        
        const enlace = `[${textoSeleccionado || 'texto del enlace'}](URL)`;
        textarea.value = textarea.value.substring(0, inicio) + enlace + textarea.value.substring(fin);
        textarea.focus();
    }

    function insertarTabla() {
        const textarea = document.getElementById('contenidoArticulo');
        const posicion = textarea.selectionStart;
        const textoBefore = textarea.value.substring(0, posicion);
        const textoAfter = textarea.value.substring(posicion);
        
        const tabla = '\n| Columna 1 | Columna 2 | Columna 3 |\n|-----------|-----------|-----------||\n| Dato 1    | Dato 2    | Dato 3    |\n| Dato 4    | Dato 5    | Dato 6    |\n';
        textarea.value = textoBefore + tabla + textoAfter;
        textarea.focus();
    }

    function previsualizarArticulo() {
        const titulo = document.getElementById('tituloArticulo').value.trim();
        const contenido = document.getElementById('contenidoArticulo').value.trim();
        
        if (!titulo || !contenido) {
            mostrarMensajeTemp('‚ö†Ô∏è Completa el t√≠tulo y contenido para previsualizar', '#ffc107');
            return;
        }
        
        // Crear ventana de previsualizaci√≥n
        const ventana = window.open('', '_blank', 'width=800,height=600');
        ventana.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Previsualizaci√≥n: ${titulo}</title>
                <style>
                    body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
                    h1, h2, h3, h4, h5 { color: #17a2b8; }
                    pre { background: #f8f9fa; padding: 10px; border-radius: 4px; }
                </style>
            </head>
            <body>
                <h1>${titulo}</h1>
                <hr>
                ${formatearContenido(contenido)}
            </body>
            </html>
        `);
        ventana.document.close();
    }

    function duplicarArticulo() {
        if (!articuloActual) return;
        
        const copia = {
            ...articuloActual,
            id: Date.now(),
            titulo: `Copia de ${articuloActual.titulo}`,
            fecha: new Date().toISOString(),
            vistas: 0,
            comentarios: []
        };
        
        articulosWiki.unshift(copia);
        guardarArticulosWiki();
        mostrarListaArticulos();
        verArticulo(copia.id);
        
        mostrarMensajeTemp('üìã Art√≠culo duplicado', '#28a745');
    }

    function compartirArticulo() {
        if (!articuloActual) return;
        
        const texto = `üìö Base de Conocimientos ACHS
        
T√≠tulo: ${articuloActual.titulo}
Categor√≠a: ${articuloActual.categoria}

${articuloActual.contenido}

---
Compartido desde la Base de Conocimientos ACHS`;
        
        if (navigator.share) {
            navigator.share({
                title: articuloActual.titulo,
                text: texto
            });
        } else {
            // Fallback: copiar al portapapeles
            if (navigator.clipboard) {
                navigator.clipboard.writeText(texto).then(() => {
                    mostrarMensajeTemp('üìã Art√≠culo copiado al portapapeles', '#28a745');
                });
            } else {
                prompt('Copia este texto:', texto);
            }
        }
    }

    // ============ FUNCIONES FALTANTES PARA LA BASE DE CONOCIMIENTOS ============
    
    // Funci√≥n para crear nuevo art√≠culo
    function crearNuevoArticulo() {
        console.log('üìù Creando nuevo art√≠culo');
        
        articuloActual = null;
        modoEdicion = true;
        
        // Ocultar vista por defecto y visor
        const vistaPorDefecto = document.getElementById('vistaArticulo');
        if (vistaPorDefecto) {
            vistaPorDefecto.style.display = 'none';
        }
        
        // Mostrar editor
        const editor = document.getElementById('editorArticulo');
        if (editor) {
            editor.style.display = 'flex';
            editor.style.flexDirection = 'column';
        }
        
        // Mostrar panel de informaci√≥n
        const panelInfo = document.getElementById('panelInfo');
        if (panelInfo) {
            panelInfo.style.display = 'none'; // Ocultar mientras se edita
        }
        
        // Limpiar campos del editor
        const tituloEditor = document.getElementById('tituloEditor');
        const categoriaEditor = document.getElementById('categoriaEditor');
        const tipoDocumentoEditor = document.getElementById('tipoDocumentoEditor');
        const contenidoEditor = document.getElementById('contenidoEditor');
        
        if (tituloEditor) tituloEditor.value = '';
        if (categoriaEditor) categoriaEditor.value = 'general';
        if (tipoDocumentoEditor) tipoDocumentoEditor.value = 'MANUAL';
        if (contenidoEditor) contenidoEditor.value = '';
        
        // Enfocar en el t√≠tulo
        if (tituloEditor) {
            tituloEditor.focus();
        }
        
        mostrarMensajeTemp('‚úèÔ∏è Nuevo art√≠culo iniciado', '#28a745');
        console.log('‚úÖ Editor de nuevo art√≠culo activado');
    }

    // Funci√≥n para guardar art√≠culo
    function guardarArticulo() {
        console.log('üíæ Guardando art√≠culo');
        
        const titulo = document.getElementById('tituloEditor')?.value.trim();
        const categoria = document.getElementById('categoriaEditor')?.value;
        const tipoDocumento = document.getElementById('tipoDocumentoEditor')?.value;
        const contenido = document.getElementById('contenidoEditor')?.value.trim();
        
        // Validaciones
        if (!titulo) {
            alert('‚ö†Ô∏è Por favor ingresa un t√≠tulo para el art√≠culo');
            document.getElementById('tituloEditor')?.focus();
            return;
        }
        
        if (!contenido) {
            alert('‚ö†Ô∏è Por favor ingresa contenido para el art√≠culo');
            document.getElementById('contenidoEditor')?.focus();
            return;
        }
        
        const ahora = new Date();
        
        if (articuloActual) {
            // Actualizar art√≠culo existente
            articuloActual.titulo = titulo;
            articuloActual.categoria = categoria;
            articuloActual.tipoDocumento = tipoDocumento;
            articuloActual.contenido = contenido;
            articuloActual.fechaModificacion = ahora.toISOString();
            articuloActual.autor = 'Usuario ACHS'; // En un sistema real ser√≠a el usuario actual
            
            mostrarMensajeTemp('‚úÖ Art√≠culo actualizado', '#28a745');
        } else {
            // Crear nuevo art√≠culo
            const nuevoArticulo = {
                id: Date.now(),
                titulo: titulo,
                categoria: categoria,
                tipoDocumento: tipoDocumento,
                contenido: contenido,
                autor: 'Usuario ACHS',
                fecha: ahora.toISOString(),
                fechaModificacion: ahora.toISOString(),
                vistas: 0,
                comentarios: []
            };
            
            articulosWiki.unshift(nuevoArticulo); // Agregar al inicio
            articuloActual = nuevoArticulo;
            
            mostrarMensajeTemp('‚úÖ Art√≠culo creado exitosamente', '#28a745');
        }
        
        // Guardar en localStorage
        guardarArticulosWiki();
        
        // Actualizar lista de art√≠culos
        mostrarListaArticulos();
        
        // Mostrar el art√≠culo guardado
        cancelarEdicion();
        verArticulo(articuloActual.id);
        
        console.log('‚úÖ Art√≠culo guardado:', titulo);
    }

    // Funci√≥n para cancelar edici√≥n
    function cancelarEdicion() {
        console.log('‚ùå Cancelando edici√≥n');
        
        modoEdicion = false;
        
        // Ocultar editor
        const editor = document.getElementById('editorArticulo');
        if (editor) {
            editor.style.display = 'none';
        }
        
        if (articuloActual) {
            // Si hay un art√≠culo actual, mostrarlo
            verArticulo(articuloActual.id);
        } else {
            // Si no hay art√≠culo, mostrar vista por defecto
            const vistaArticulo = document.getElementById('vistaArticulo');
            if (vistaArticulo) {
                vistaArticulo.style.display = 'flex';
                vistaArticulo.style.flexDirection = 'column';
                vistaArticulo.style.justifyContent = 'center';
                vistaArticulo.style.alignItems = 'center';
            }
        }
        
        mostrarMensajeTemp('‚Ü©Ô∏è Edici√≥n cancelada', '#6c757d');
    }

    // Funci√≥n para ver un art√≠culo
    function verArticulo(id) {
        console.log('üëÅÔ∏è Viendo art√≠culo ID:', id);
        
        const articulo = articulosWiki.find(a => a.id === id);
        if (!articulo) {
            console.error('‚ùå Art√≠culo no encontrado:', id);
            return;
        }
        
        articuloActual = articulo;
        
        // Incrementar vistas
        articulo.vistas = (articulo.vistas || 0) + 1;
        guardarArticulosWiki();
        
        // Formatear fecha (definir al inicio para uso global en la funci√≥n)
        const fechaFormateada = new Date(articulo.fecha).toLocaleDateString('es-ES', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
        
        // Ocultar editor y vista por defecto
        const editor = document.getElementById('editorArticulo');
        if (editor) {
            editor.style.display = 'none';
        }
        
        // Mostrar contenido del art√≠culo
        const vistaArticulo = document.getElementById('vistaArticulo');
        if (vistaArticulo) {
            vistaArticulo.style.display = 'block';
            vistaArticulo.style.padding = '30px';
            vistaArticulo.style.overflow = 'auto';
            
            const iconoCategoria = {
                'general': 'üìã',
                'procedimientos': '‚öôÔ∏è',
                'politicas': 'üìú',
                'herramientas': 'üõ†Ô∏è',
                'faq': '‚ùì'
            };
            
            vistaArticulo.innerHTML = `
                <div style="border-bottom: 2px solid #dee2e6; padding-bottom: 20px; margin-bottom: 30px;">
                    <h1 style="color: #495057; margin: 0 0 15px 0; font-size: 2rem; line-height: 1.2;">
                        ${articulo.titulo}
                    </h1>
                    <div style="display: flex; gap: 20px; align-items: center; color: #6c757d; font-size: 0.9rem;">
                        <span style="background: linear-gradient(145deg, #667eea, #764ba2); color: white; padding: 4px 12px; border-radius: 15px; font-weight: 600;">
                            ${iconoCategoria[articulo.categoria] || 'üìã'} ${articulo.categoria.charAt(0).toUpperCase() + articulo.categoria.slice(1)}
                        </span>
                        <span>üë§ ${articulo.autor}</span>
                        <span>üìÖ ${fechaFormateada}</span>
                        <span>üëÄ ${articulo.vistas} vistas</span>
                        <span>üí¨ ${articulo.comentarios?.length || 0} comentarios</span>
                    </div>
                </div>
                <div style="font-size: 1.1rem; line-height: 1.8; color: #495057;">
                    ${formatearContenido(articulo.contenido)}
                </div>
            `;
        }
        
        // Mostrar panel de informaci√≥n
        const panelInfo = document.getElementById('panelInfo');
        if (panelInfo) {
            panelInfo.style.display = 'flex';
            panelInfo.style.flexDirection = 'column';
            
            // Actualizar informaci√≥n del art√≠culo
            const infoArticulo = document.getElementById('infoArticulo');
            if (infoArticulo) {
                infoArticulo.innerHTML = `
                    <div style="margin-bottom: 8px;"><strong>üìÖ Creado:</strong> ${fechaFormateada}</div>
                    <div style="margin-bottom: 8px;"><strong>üë§ Autor:</strong> ${articulo.autor}</div>
                    <div style="margin-bottom: 8px;"><strong>  Tipo:</strong> ${articulo.tipoDocumento || 'MANUAL'}</div>
                    <div style="margin-bottom: 8px;"><strong> üëÄ Vistas:</strong> ${articulo.vistas}</div>
                    <div style="margin-bottom: 8px;"><strong>üí¨ Comentarios:</strong> ${articulo.comentarios?.length || 0}</div>
                    <div><strong>üìä Categor√≠a:</strong> ${articulo.categoria}</div>
                `;
            }
            
            // Actualizar botones de acci√≥n
            const botonesAccion = panelInfo.querySelector('div[style*="flex-direction:column"]');
            if (botonesAccion) {
                botonesAccion.innerHTML = `
                    <button onclick="editarArticulo()" style="background:linear-gradient(145deg, #ffc107, #e0a800); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; margin-bottom: 8px;">
                        ‚úèÔ∏è Editar
                    </button>
                    <button onclick="duplicarArticulo()" style="background:linear-gradient(145deg, #6f42c1, #5a32a3); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; margin-bottom: 8px;">
                        üìã Duplicar
                    </button>
                    <button onclick="compartirArticulo()" style="background:linear-gradient(145deg, #17a2b8, #138496); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; margin-bottom: 8px;">
                        üì§ Compartir
                    </button>
                    <button onclick="imprimirArticulo()" style="background:linear-gradient(145deg, #6c757d, #5a6268); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease; margin-bottom: 8px;">
                        üñ®Ô∏è Imprimir
                    </button>
                    <button onclick="eliminarArticulo()" style="background:linear-gradient(145deg, #dc3545, #c82333); color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:600; transition:all 0.3s ease;">
                        üóëÔ∏è Eliminar
                    </button>
                `;
            }
            
            // Cargar comentarios
            cargarComentarios();
        }
        
        // Actualizar estad√≠sticas
        actualizarEstadisticasWiki();
        
        console.log('‚úÖ Art√≠culo mostrado:', articulo.titulo);
    }

    // Funci√≥n para exportar wiki
    function exportarWiki() {
        console.log('üì§ Exportando base de conocimientos');
        
        if (articulosWiki.length === 0) {
            alert('‚ö†Ô∏è No hay art√≠culos para exportar');
            return;
        }
        
        const datosExportacion = {
            version: '1.0',
            fechaExportacion: new Date().toISOString(),
            totalArticulos: articulosWiki.length,
            articulos: articulosWiki
        };
        
        const contenidoJson = JSON.stringify(datosExportacion, null, 2);
        const blob = new Blob([contenidoJson], { type: 'application/json' });
        
        const enlace = document.createElement('a');
        enlace.href = URL.createObjectURL(blob);
        enlace.download = `base_conocimientos_achs_${new Date().toISOString().split('T')[0]}.json`;
        
        document.body.appendChild(enlace);
        enlace.click();
        document.body.removeChild(enlace);
        
        URL.revokeObjectURL(enlace.href);
        
        mostrarMensajeTemp(`üì§ ${articulosWiki.length} art√≠culos exportados`, '#28a745');
        console.log('‚úÖ Base de conocimientos exportada exitosamente');
    }

    // Funci√≥n para importar wiki
    function importarWiki() {
        console.log('üì• Iniciando importaci√≥n de base de conocimientos');
        
        const input = document.getElementById('inputImportarWiki');
        if (input) {
            input.click();
        } else {
            console.error('‚ùå Input de importaci√≥n no encontrado');
        }
    }

    // Funci√≥n para procesar importaci√≥n
    function procesarImportacion(input) {
        console.log('üîÑ Procesando archivo de importaci√≥n');
        
        const archivo = input.files[0];
        if (!archivo) return;
        
        if (archivo.type !== 'application/json') {
            alert('‚ö†Ô∏è Por favor selecciona un archivo JSON v√°lido');
            return;
        }
        
        const lector = new FileReader();
        lector.onload = function(e) {
            try {
                const datos = JSON.parse(e.target.result);
                
                // Validar estructura
                if (!datos.articulos || !Array.isArray(datos.articulos)) {
                    throw new Error('Estructura de archivo inv√°lida');
                }
                
                // Confirmar importaci√≥n
                const confirmar = confirm(`¬øDeseas importar ${datos.articulos.length} art√≠culos?\n\nEsto se agregar√° a los art√≠culos existentes.`);
                
                if (confirmar) {
                    // Agregar art√≠culos con nuevos IDs para evitar conflictos
                    const articulosImportados = datos.articulos.map(articulo => ({
                        ...articulo,
                        id: Date.now() + Math.random(), // Nuevo ID √∫nico
                        fechaImportacion: new Date().toISOString()
                    }));
                    
                    articulosWiki = [...articulosImportados, ...articulosWiki];
                    guardarArticulosWiki();
                    mostrarListaArticulos();
                    actualizarEstadisticasWiki();
                    
                    mostrarMensajeTemp(`üì• ${articulosImportados.length} art√≠culos importados`, '#28a745');
                    console.log(`‚úÖ ${articulosImportados.length} art√≠culos importados exitosamente`);
                }
                
            } catch (error) {
                console.error('‚ùå Error al importar:', error);
                alert('‚ùå Error al procesar el archivo. Verifica que sea un archivo de exportaci√≥n v√°lido.');
            }
        };
        
        lector.readAsText(archivo);
        
        // Limpiar input
        input.value = '';
    }

    // Funci√≥n para editar art√≠culo
    function editarArticulo() {
        if (!articuloActual) return;
        
        console.log('‚úèÔ∏è Editando art√≠culo:', articuloActual.titulo);
        
        modoEdicion = true;
        
        // Llenar campos del editor
        const tituloEditor = document.getElementById('tituloEditor');
        const categoriaEditor = document.getElementById('categoriaEditor');
        const tipoDocumentoEditor = document.getElementById('tipoDocumentoEditor');
        const contenidoEditor = document.getElementById('contenidoEditor');
        
        if (tituloEditor) tituloEditor.value = articuloActual.titulo;
        if (categoriaEditor) categoriaEditor.value = articuloActual.categoria;
        if (tipoDocumentoEditor) tipoDocumentoEditor.value = articuloActual.tipoDocumento || 'MANUAL';
        if (contenidoEditor) contenidoEditor.value = articuloActual.contenido;
        
        // Ocultar visor y panel de info
        const vistaArticulo = document.getElementById('vistaArticulo');
        const panelInfo = document.getElementById('panelInfo');
        
        if (vistaArticulo) vistaArticulo.style.display = 'none';
        if (panelInfo) panelInfo.style.display = 'none';
        
        // Mostrar editor
        const editor = document.getElementById('editorArticulo');
        if (editor) {
            editor.style.display = 'flex';
            editor.style.flexDirection = 'column';
        }
        
        // Enfocar en el t√≠tulo
        if (tituloEditor) {
            tituloEditor.focus();
        }
        
        mostrarMensajeTemp('‚úèÔ∏è Modo edici√≥n activado', '#ffc107');
    }

    // Funci√≥n para eliminar art√≠culo
    function eliminarArticulo() {
        if (!articuloActual) return;
        
        const confirmar = confirm(`¬øEst√°s seguro de que deseas eliminar el art√≠culo "${articuloActual.titulo}"?\n\nEsta acci√≥n no se puede deshacer.`);
        
        if (confirmar) {
            console.log('üóëÔ∏è Eliminando art√≠culo:', articuloActual.titulo);
            
            // Eliminar de la lista
            articulosWiki = articulosWiki.filter(a => a.id !== articuloActual.id);
            guardarArticulosWiki();
            
            // Actualizar interfaz
            mostrarListaArticulos();
            actualizarEstadisticasWiki();
            
            // Volver a vista por defecto
            articuloActual = null;
            const vistaArticulo = document.getElementById('vistaArticulo');
            const panelInfo = document.getElementById('panelInfo');
            
            if (vistaArticulo) {
                vistaArticulo.innerHTML = `
                    <div style="padding:30px; text-align:center; color:#6c757d; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center;">
                        <div style="font-size:4rem; margin-bottom:20px;">üìö</div>
                        <h3 style="color:#495057; margin-bottom:15px;">Base de Conocimientos ACHS</h3>
                        <p style="font-size:1.1rem; line-height:1.6; max-width:500px;">
                            Selecciona un art√≠culo de la lista para verlo, o crea uno nuevo para comenzar a construir nuestra base de conocimientos colaborativa.
                        </p>
                        <button onclick="crearNuevoArticulo()" style="background:linear-gradient(145deg, #667eea, #764ba2); color:white; border:none; padding:12px 24px; border-radius:8px; cursor:pointer; font-size:1rem; font-weight:600; margin-top:20px; transition:all 0.3s ease;">
                            ‚úèÔ∏è Crear Primer Art√≠culo
                        </button>
                    </div>
                `;
            }
            
            if (panelInfo) panelInfo.style.display = 'none';
            
            mostrarMensajeTemp('üóëÔ∏è Art√≠culo eliminado', '#dc3545');
        }
    }

    // Funci√≥n para cargar art√≠culos desde localStorage
    function cargarArticulosWiki() {
        try {
            const datos = localStorage.getItem('articulosWikiACHS');
            if (datos) {
                articulosWiki = JSON.parse(datos);
                console.log(`üìö ${articulosWiki.length} art√≠culos cargados desde localStorage`);
                return true;
            }
        } catch (error) {
            console.error('‚ùå Error al cargar art√≠culos:', error);
        }
        
        articulosWiki = [];
        return false;
    }

    // Funci√≥n para guardar art√≠culos en localStorage
    function guardarArticulosWiki() {
        try {
            localStorage.setItem('articulosWikiACHS', JSON.stringify(articulosWiki));
            console.log(`üíæ ${articulosWiki.length} art√≠culos guardados en localStorage`);
        } catch (error) {
            console.error('‚ùå Error al guardar art√≠culos:', error);
            alert('Error al guardar. El almacenamiento puede estar lleno.');
        }
    }

    // Funci√≥n para mostrar lista de art√≠culos
    function mostrarListaArticulos() {
        const lista = document.getElementById('listaArticulos');
        if (!lista) return;
        
        lista.innerHTML = '';
        
        if (articulosWiki.length === 0) {
            lista.innerHTML = `
                <div style="text-align: center; color: #6c757d; padding: 20px;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üì≠</div>
                    <p>No hay art√≠culos a√∫n.</p>
                    <button onclick="crearNuevoArticulo()" style="background: linear-gradient(145deg, #667eea, #764ba2); color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.9rem; font-weight: 600; margin-top: 10px;">
                        ‚úèÔ∏è Crear Primero
                    </button>
                </div>
            `;
            return;
        }
        
        const iconoCategoria = {
            'general': 'üìã',
            'procedimientos': '‚öôÔ∏è',
            'politicas': 'üìú',
            'herramientas': 'üõ†Ô∏è',
            'faq': '‚ùì'
        };
        
        articulosWiki.forEach(articulo => {
            const elemento = document.createElement('div');
            elemento.style.cssText = `
                background: white;
                border: 2px solid #dee2e6;
                border-radius: 8px;
                padding: 12px;
                cursor: pointer;
                transition: all 0.3s ease;
                margin-bottom: 8px;
            `;
            
            elemento.onmouseover = function() {
                this.style.borderColor = '#667eea';
                this.style.boxShadow = '0 4px 12px rgba(102,126,234,0.2)';
                this.style.transform = 'translateY(-2px)';
            };
            
            elemento.onmouseout = function() {
                this.style.borderColor = '#dee2e6';
                this.style.boxShadow = 'none';
                this.style.transform = 'translateY(0)';
            };
            
            elemento.onclick = function() {
                verArticulo(articulo.id);
            };
            
            const fechaCorta = new Date(articulo.fecha).toLocaleDateString('es-ES', {
                day: '2-digit',
                month: '2-digit'
            });
            
            elemento.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                    <span style="font-size: 1.2rem;">${iconoCategoria[articulo.categoria] || 'üìã'}</span>
                    <span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 600;">
                        ${articulo.categoria.toUpperCase()}
                    </span>
                </div>
                <h4 style="margin: 0 0 8px 0; color: #495057; font-size: 0.95rem; line-height: 1.3;">
                    ${articulo.titulo}
                </h4>
                <div style="font-size: 0.75rem; color: #6c757d; display: flex; justify-content: space-between;">
                    <span>üìÖ ${fechaCorta}</span>
                    <span>üëÄ ${articulo.vistas || 0}</span>
                </div>
            `;
            
            lista.appendChild(elemento);
        });
        
        console.log(`üìã Lista de ${articulosWiki.length} art√≠culos actualizada`);
    }

    // Funci√≥n para actualizar estad√≠sticas
    function actualizarEstadisticasWiki() {
        const totalArticulos = document.getElementById('totalArticulos');
        const totalVistas = document.getElementById('totalVistas');
        const totalComentarios = document.getElementById('totalComentarios');
        const ultimaActualizacion = document.getElementById('ultimaActualizacion');
        
        const vistas = articulosWiki.reduce((total, articulo) => total + (articulo.vistas || 0), 0);
        const comentarios = articulosWiki.reduce((total, articulo) => total + (articulo.comentarios?.length || 0), 0);
        
        let ultimaFecha = '-';
        if (articulosWiki.length > 0) {
            const fechas = articulosWiki.map(a => new Date(a.fechaModificacion || a.fecha));
            const masReciente = new Date(Math.max(...fechas));
            ultimaFecha = masReciente.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit' });
        }
        
        if (totalArticulos) totalArticulos.textContent = articulosWiki.length;
        if (totalVistas) totalVistas.textContent = vistas;
        if (totalComentarios) totalComentarios.textContent = comentarios;
        if (ultimaActualizacion) ultimaActualizacion.textContent = ultimaFecha;
    }

    // Funci√≥n para buscar art√≠culos
    function buscarArticulos() {
        const termino = document.getElementById('buscadorWiki')?.value.toLowerCase() || '';
        const categoria = document.getElementById('filtroCategoria')?.value || '';
        const tipoDocumento = document.getElementById('filtroTipoDocumento')?.value || '';
        
        let articulosFiltrados = articulosWiki;
        
        // Filtrar por b√∫squeda
        if (termino) {
            articulosFiltrados = articulosFiltrados.filter(articulo =>
                articulo.titulo.toLowerCase().includes(termino) ||
                articulo.contenido.toLowerCase().includes(termino) ||
                articulo.autor.toLowerCase().includes(termino)
            );
        }
        
        // Filtrar por categor√≠a
        if (categoria) {
            articulosFiltrados = articulosFiltrados.filter(articulo =>
                articulo.categoria === categoria
            );
        }
        
        // Filtrar por tipo de documento
        if (tipoDocumento) {
            articulosFiltrados = articulosFiltrados.filter(articulo =>
                (articulo.tipoDocumento || 'MANUAL') === tipoDocumento
            );
        }
        
        // Actualizar lista con resultados filtrados
        const articulosOriginales = [...articulosWiki];
        articulosWiki = articulosFiltrados;
        mostrarListaArticulos();
        articulosWiki = articulosOriginales;
        
        console.log(`üîç B√∫squeda: "${termino}" | Categor√≠a: "${categoria}" | Tipo: "${tipoDocumento}" | Resultados: ${articulosFiltrados.length}`);
    }

    // Funci√≥n para filtrar por categor√≠a
    function filtrarPorCategoria() {
        buscarArticulos(); // Reutilizar la l√≥gica de b√∫squeda
    }

    // Funci√≥n para filtrar por tipo de documento
    function filtrarPorTipoDocumento() {
        buscarArticulos(); // Reutilizar la l√≥gica de b√∫squeda
    }

    // Funciones adicionales para el panel de informaci√≥n
    function cargarComentarios() {
        const listaComentarios = document.getElementById('listaComentarios');
        if (!listaComentarios || !articuloActual) return;
        
        listaComentarios.innerHTML = '';
        
        const comentarios = articuloActual.comentarios || [];
        
        if (comentarios.length === 0) {
            listaComentarios.innerHTML = `
                <div style="text-align: center; color: #6c757d; padding: 20px; font-size: 0.85rem;">
                    üí¨ No hay comentarios a√∫n.<br>¬°S√© el primero en comentar!
                </div>
            `;
            return;
        }
        
        comentarios.forEach(comentario => {
            const div = document.createElement('div');
            div.style.cssText = `
                background: white;
                border: 1px solid #dee2e6;
                border-radius: 6px;
                padding: 10px;
                margin-bottom: 8px;
                font-size: 0.8rem;
            `;
            
            const fecha = new Date(comentario.fecha).toLocaleDateString('es-ES', {
                day: '2-digit',
                month: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            div.innerHTML = `
                <div style="font-weight: 600; color: #495057; margin-bottom: 5px;">
                    ${comentario.autor} <span style="font-weight: normal; color: #6c757d;">- ${fecha}</span>
                </div>
                <div style="color: #495057; line-height: 1.4;">
                    ${comentario.contenido}
                </div>
            `;
            
            listaComentarios.appendChild(div);
        });
    }

    function agregarComentario() {
        if (!articuloActual) return;
        
        const textarea = document.getElementById('nuevoComentario');
        const contenido = textarea?.value.trim();
        
        if (!contenido) {
            alert('‚ö†Ô∏è Por favor escribe un comentario');
            return;
        }
        
        const nuevoComentario = {
            id: Date.now(),
            autor: 'Usuario ACHS', // En un sistema real ser√≠a el usuario actual
            contenido: contenido,
            fecha: new Date().toISOString()
        };
        
        if (!articuloActual.comentarios) {
            articuloActual.comentarios = [];
        }
        
        articuloActual.comentarios.push(nuevoComentario);
        guardarArticulosWiki();
        
        // Limpiar textarea
        if (textarea) textarea.value = '';
        
        // Recargar comentarios
        cargarComentarios();
        
        // Actualizar estad√≠sticas
        actualizarEstadisticasWiki();
        
        mostrarMensajeTemp('üí¨ Comentario agregado', '#28a745');
    }

    function imprimirArticulo() {
        if (!articuloActual) return;
        
        const contenidoImprimir = `
            <html>
            <head>
                <title>${articuloActual.titulo} - Base de Conocimientos ACHS</title>
                <style>
                    body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                    h1 { color: #495057; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
                    .metadata { background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 20px 0; }
                    .content { margin-top: 30px; }
                    @media print { body { margin: 20px; } }
                </style>
            </head>
            <body>
                <h1>${articuloActual.titulo}</h1>
                <div class="metadata">
                    <strong>Categor√≠a:</strong> ${articuloActual.categoria}<br>
                    <strong>Autor:</strong> ${articuloActual.autor}<br>
                    <strong>Fecha:</strong> ${new Date(articuloActual.fecha).toLocaleDateString('es-ES')}<br>
                    <strong>Vistas:</strong> ${articuloActual.vistas || 0}
                </div>
                <div class="content">
                    ${formatearContenido(articuloActual.contenido)}
                </div>
                <hr style="margin-top: 40px;">
                <small>Generado desde la Base de Conocimientos ACHS - ${new Date().toLocaleDateString('es-ES')}</small>
            </body>
            </html>
        `;
        
        const ventana = window.open('', '_blank');
        ventana.document.write(contenidoImprimir);
        ventana.document.close();
        ventana.print();
    }

    function previsualizarArticulo() {
        const titulo = document.getElementById('tituloEditor')?.value.trim();
        const contenido = document.getElementById('contenidoEditor')?.value.trim();
        
        if (!titulo || !contenido) {
            alert('‚ö†Ô∏è Ingresa t√≠tulo y contenido para previsualizar');
            return;
        }
        
        const ventana = window.open('', '_blank', 'width=800,height=600');
        const html = `
            <html>
            <head>
                <title>Vista Previa - ${titulo}</title>
                <style>
                    body { font-family: 'Segoe UI', sans-serif; margin: 40px; line-height: 1.6; }
                    h1 { color: #495057; margin-bottom: 20px; }
                    .preview-badge { background: #ffc107; color: #212529; padding: 5px 15px; border-radius: 15px; font-size: 0.8rem; font-weight: bold; }
                </style>
            </head>
            <body>
                <div class="preview-badge">üëÅÔ∏è VISTA PREVIA</div>
                <h1>${titulo}</h1>
                <div>${formatearContenido(contenido)}</div>
            </body>
            </html>
        `;
        
        ventana.document.write(html);
        ventana.document.close();
    }

    // ============ FUNCIONES DEL CONVERTIDOR PDF A JSON ============
    
    let contenidoPDFExtraido = '';
    let archivoActual = null;
    
    // Abrir modal del convertidor
    function abrirConvertidorPDF() {
        const modal = document.getElementById('modalConvertidorPDF');
        if (modal) {
            modal.style.display = 'flex';
            resetearConvertidor();
            console.log('üìÑ Modal convertidor PDF abierto');
        }
    }
    
    // Cerrar modal del convertidor
    function cerrarModalConvertidor() {
        const modal = document.getElementById('modalConvertidorPDF');
        if (modal) {
            modal.style.display = 'none';
            resetearConvertidor();
            console.log('üìÑ Modal convertidor PDF cerrado');
        }
    }
    
    // Resetear el estado del convertidor
    function resetearConvertidor() {
        document.getElementById('paso1').style.display = 'block';
        document.getElementById('paso2').style.display = 'none';
        document.getElementById('paso3').style.display = 'none';
        document.getElementById('btnGenerarJSON').style.display = 'none';
        document.getElementById('btnDescargarJSON').style.display = 'none';
        
        // Limpiar campos
        document.getElementById('tituloConvertidor').value = '';
        document.getElementById('categoriaConvertidor').value = 'general';
        document.getElementById('prioridadConvertidor').value = 'normal';
        document.getElementById('tagsConvertidor').value = '';
        document.getElementById('contenidoExtraido').textContent = '';
        document.getElementById('estadoConversion').textContent = '';
        
        contenidoPDFExtraido = '';
        archivoActual = null;
    }
    
    // Procesar archivo PDF
    function procesarPDF(input) {
        const file = input.files[0];
        if (!file) return;
        
        if (file.type !== 'application/pdf') {
            mostrarMensajeTemp('‚ùå Por favor selecciona un archivo PDF v√°lido', '#dc3545');
            return;
        }
        
        archivoActual = file;
        document.getElementById('estadoConversion').textContent = `üìÑ Archivo seleccionado: ${file.name}`;
        
        // Mostrar mensaje sobre limitaciones del navegador
        mostrarMensajeExplicativo();
        
        // Llenar nombre autom√°ticamente
        const nombreSinExtension = file.name.replace('.pdf', '');
        document.getElementById('tituloConvertidor').value = nombreSinExtension;
        
        // Mostrar paso 2
        document.getElementById('paso2').style.display = 'block';
        document.getElementById('btnGenerarJSON').style.display = 'inline-block';
        
        console.log(`üìÑ PDF seleccionado: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`);
    }
    
    // Mostrar mensaje explicativo sobre las limitaciones
    function mostrarMensajeExplicativo() {
        const mensaje = `üìÑ IMPORTANTE: Conversi√≥n de PDF a JSON
        
üîç M√âTODOS DISPONIBLES:

1Ô∏è‚É£ M√âTODO MANUAL (Recomendado):
‚Ä¢ Abre tu PDF en otro programa
‚Ä¢ Copia todo el texto (Ctrl+A, Ctrl+C)
‚Ä¢ Pega el contenido en el Paso 3
‚Ä¢ Contin√∫a con la conversi√≥n

2Ô∏è‚É£ M√âTODO AUTOM√ÅTICO (Limitado):
‚Ä¢ Solo funciona con PDFs de texto simple
‚Ä¢ No funciona con PDFs escaneados o con im√°genes
‚Ä¢ Puede requerir permisos especiales del navegador

üí° CONSEJOS:
‚Ä¢ Para PDFs complejos, usa herramientas online como:
  - SmallPDF.com (PDF to Text)
  - ILovePDF.com
  - Adobe Acrobat Reader (copiar texto)

¬øQuieres continuar con el m√©todo manual?`;
        
        if (confirm(mensaje)) {
            permitirEntradaManual();
        }
    }
    
    // Permitir entrada manual de texto
    function permitirEntradaManual() {
        document.getElementById('paso3').style.display = 'block';
        const contenidoDiv = document.getElementById('contenidoExtraido');
        
        // Hacer el div editable
        contenidoDiv.contentEditable = true;
        contenidoDiv.style.border = '2px solid #6f42c1';
        contenidoDiv.style.minHeight = '200px';
        contenidoDiv.style.padding = '15px';
        contenidoDiv.innerHTML = `<p style="color:#6c757d; font-style:italic;">
üìù Pega aqu√≠ el contenido de tu PDF...

üí° Puedes:
‚Ä¢ Copiar y pegar texto desde tu PDF
‚Ä¢ Escribir directamente aqu√≠
‚Ä¢ Formatear el texto como prefieras

Cuando termines, haz clic en "Generar JSON"</p>`;
        
        contenidoDiv.addEventListener('input', function() {
            if (this.textContent.trim()) {
                contenidoPDFExtraido = this.textContent;
                document.getElementById('estadoConversion').textContent = `‚úÖ Contenido listo (${this.textContent.length} caracteres)`;
            }
        });
        
        contenidoDiv.addEventListener('focus', function() {
            if (this.innerHTML.includes('Pega aqu√≠ el contenido')) {
                this.innerHTML = '';
            }
        });
    }
    
    // Generar JSON desde el texto extra√≠do
    function generarJSONDesdeTexto() {
        const titulo = document.getElementById('tituloConvertidor').value.trim();
        const categoria = document.getElementById('categoriaConvertidor').value;
        const tipoDocumento = document.getElementById('tipoDocumentoConvertidor').value;
        const prioridad = document.getElementById('prioridadConvertidor').value;
        const tags = document.getElementById('tagsConvertidor').value.split(',').map(t => t.trim()).filter(t => t);
        
        // Obtener contenido del div editable
        const contenidoDiv = document.getElementById('contenidoExtraido');
        const contenido = contenidoDiv.textContent || contenidoDiv.innerText || '';
        
        // Validaciones
        if (!titulo) {
            mostrarMensajeTemp('‚ö†Ô∏è El t√≠tulo es obligatorio', '#ffc107');
            return;
        }
        
        if (!contenido || contenido.includes('Pega aqu√≠ el contenido')) {
            mostrarMensajeTemp('‚ö†Ô∏è Necesitas agregar contenido al art√≠culo', '#ffc107');
            return;
        }
        
        if (contenido.length < 50) {
            mostrarMensajeTemp('‚ö†Ô∏è El contenido es muy corto. Agrega m√°s informaci√≥n.', '#ffc107');
            return;
        }
        
        // Crear estructura JSON
        const articuloJSON = {
            articulos: [
                {
                    id: Date.now(),
                    titulo: titulo,
                    categoria: categoria,
                    tipoDocumento: tipoDocumento,
                    prioridad: prioridad,
                    tags: tags,
                    contenido: contenido,
                    autor: 'Importado desde PDF',
                    fecha: new Date().toISOString(),
                    vistas: 0,
                    comentarios: []
                }
            ],
            fechaExportacion: new Date().toISOString(),
            version: '1.0'
        };
        
        // Guardar para descarga
        window.datosJSONGenerados = articuloJSON;
        
        // Mostrar bot√≥n de descarga
        document.getElementById('btnDescargarJSON').style.display = 'inline-block';
        document.getElementById('estadoConversion').textContent = '‚úÖ JSON generado correctamente';
        
        mostrarMensajeTemp('üéâ JSON generado exitosamente. ¬°Ya puedes descargarlo!', '#28a745');
        
        console.log('üìÑ JSON generado desde PDF:', articuloJSON);
    }
    
    // Descargar archivo JSON
    function descargarJSON() {
        if (!window.datosJSONGenerados) {
            mostrarMensajeTemp('‚ùå No hay datos para descargar', '#dc3545');
            return;
        }
        
        const blob = new Blob([JSON.stringify(window.datosJSONGenerados, null, 2)], { 
            type: 'application/json' 
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        
        const nombreArchivo = document.getElementById('tituloConvertidor').value.trim()
            .toLowerCase()
            .replace(/[^a-z0-9]/g, '-')
            .replace(/-+/g, '-')
            .replace(/^-|-$/g, '');
        
        a.href = url;
        a.download = `${nombreArchivo || 'articulo'}-base-conocimientos.json`;
        a.click();
        
        URL.revokeObjectURL(url);
        
        mostrarMensajeTemp('üíæ JSON descargado exitosamente', '#28a745');
        
        // Preguntar si quiere importar directamente
        setTimeout(() => {
            if (confirm('¬øQuieres importar este art√≠culo directamente a la Base de Conocimientos?')) {
                importarDirectamente();
            }
        }, 1000);
    }
    
    // Importar directamente a la base de conocimientos
    function importarDirectamente() {
        if (!window.datosJSONGenerados) return;
        
        try {
            const nuevosArticulos = window.datosJSONGenerados.articulos;
            
            // Agregar al array existente
            articulosWiki = [...nuevosArticulos, ...articulosWiki];
            
            // Guardar en localStorage
            guardarArticulosWiki();
            mostrarListaArticulos();
            actualizarEstadisticasWiki();
            
            // Cerrar modal del convertidor
            cerrarModalConvertidor();
            
            // Mostrar el art√≠culo reci√©n creado
            const primerArticulo = nuevosArticulos[0];
            verArticulo(primerArticulo.id);
            
            mostrarMensajeTemp('üéâ Art√≠culo importado exitosamente a la Base de Conocimientos', '#28a745');
            
            console.log('üìö Art√≠culo importado directamente:', primerArticulo);
        } catch (error) {
            console.error('‚ùå Error al importar:', error);
            mostrarMensajeTemp('‚ùå Error al importar el art√≠culo', '#dc3545');
        }
    }

    // ===== SISTEMA DE RECLAMOS Y QUEJAS =====
    
    // Funci√≥n para abrir el modal de reclamos
    function abrirModalReclamo() {
        const modal = document.getElementById('modalReclamo');
        if (modal) {
            modal.style.display = 'flex';
            modal.classList.add('mostrar');
            
            // Limpiar formulario al abrir
            limpiarFormularioReclamo();
            
            console.log('üì¢ Modal de reclamos abierto');
        } else {
            console.error('‚ùå Modal de reclamos no encontrado');
        }
    }
    
    // Funci√≥n para cerrar el modal de reclamos
    function cerrarModalReclamo() {
        console.log('üîÑ Intentando cerrar modal de reclamos...');
        const modal = document.getElementById('modalReclamo');
        if (modal) {
            modal.style.display = 'none';
            modal.classList.remove('mostrar');
            console.log('‚úÖ Modal de reclamos cerrado exitosamente');
        } else {
            console.error('‚ùå Modal de reclamos no encontrado al intentar cerrar');
        }
    }
    
    // Funci√≥n para configurar el bot√≥n de reclamos
    function configurarBotonReclamo() {
        const botonReclamo = document.getElementById('btnReclamo');
        if (botonReclamo) {
            botonReclamo.addEventListener('click', abrirModalReclamo);
            console.log('üì¢ Bot√≥n de reclamos configurado');
            
            // Configurar evento de teclado Escape para cerrar modal
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const modal = document.getElementById('modalReclamo');
                    if (modal && modal.style.display === 'flex') {
                        cerrarModalReclamo();
                    }
                }
            });
            
        } else {
            console.error('‚ùå Bot√≥n de reclamos no encontrado');
        }
    }
    
    // Funci√≥n para limpiar el formulario de reclamos
    function limpiarFormularioReclamo() {
        const campos = [
            'nombreCliente', 'rutCliente', 'telefonoCliente', 'emailCliente',
            'tipoReclamo', 'prioridadReclamo', 'descripcionReclamo',
            'fechaIncidente', 'areaReclamo', 'ejecutivoReclamo',
            'casoReclamo', 'observacionesInternas', 'estadoReclamo'
        ];
        
        campos.forEach(campo => {
            const elemento = document.getElementById(campo);
            if (elemento) {
                elemento.value = '';
            }
        });
        
        console.log('üßπ Formulario de reclamos limpiado');
    }
    
    // Funci√≥n para validar el formulario de reclamos
    function validarFormularioReclamo() {
        const camposRequeridos = [
            {id: 'nombreCliente', nombre: 'Nombre del Cliente'},
            {id: 'rutCliente', nombre: 'RUT del Cliente'},
            {id: 'tipoReclamo', nombre: 'Tipo de Reclamo'},
            {id: 'descripcionReclamo', nombre: 'Descripci√≥n del Reclamo'}
        ];
        
        const errores = [];
        
        camposRequeridos.forEach(campo => {
            const elemento = document.getElementById(campo.id);
            if (!elemento || !elemento.value.trim()) {
                errores.push(campo.nombre);
            }
        });
        
        // Validar RUT si est√° presente
        const rutCliente = document.getElementById('rutCliente');
        if (rutCliente && rutCliente.value.trim()) {
            if (!validarRut(rutCliente.value.trim())) {
                errores.push('RUT del Cliente (formato inv√°lido)');
            }
        }
        
        // Validar email si est√° presente
        const emailCliente = document.getElementById('emailCliente');
        if (emailCliente && emailCliente.value.trim()) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(emailCliente.value.trim())) {
                errores.push('Email del Cliente (formato inv√°lido)');
            }
        }
        
        if (errores.length > 0) {
            alert(`‚ùå Por favor complete los siguientes campos:\n\n${errores.join('\n')}`);
            return false;
        }
        
        return true;
    }
    
    // Funci√≥n para obtener los datos del reclamo
    function obtenerDatosReclamo() {
        return {
            // Informaci√≥n del Cliente
            nombreCliente: document.getElementById('nombreCliente')?.value || '',
            rutCliente: document.getElementById('rutCliente')?.value || '',
            telefonoCliente: document.getElementById('telefonoCliente')?.value || '',
            emailCliente: document.getElementById('emailCliente')?.value || '',
            
            // Detalles del Reclamo
            tipoReclamo: document.getElementById('tipoReclamo')?.value || '',
            prioridadReclamo: document.getElementById('prioridadReclamo')?.value || '',
            descripcionReclamo: document.getElementById('descripcionReclamo')?.value || '',
            fechaIncidente: document.getElementById('fechaIncidente')?.value || '',
            
            // Informaci√≥n Interna ACHS
            areaReclamo: document.getElementById('areaReclamo')?.value || '',
            ejecutivoReclamo: document.getElementById('ejecutivoReclamo')?.value || '',
            casoReclamo: document.getElementById('casoReclamo')?.value || '',
            observacionesInternas: document.getElementById('observacionesInternas')?.value || '',
            estadoReclamo: document.getElementById('estadoReclamo')?.value || 'Ingresado',
            
            // Metadata
            fechaCreacion: new Date().toISOString(),
            id: Date.now().toString()
        };
    }
    
    // Funci√≥n para guardar el reclamo localmente
    function guardarReclamo() {
        if (!validarFormularioReclamo()) {
            return false;
        }
        
        const datosReclamo = obtenerDatosReclamo();
        
        try {
            // Obtener reclamos existentes
            let reclamosGuardados = JSON.parse(localStorage.getItem('reclamosAchs') || '[]');
            
            // Agregar nuevo reclamo
            reclamosGuardados.push(datosReclamo);
            
            // Guardar en localStorage
            localStorage.setItem('reclamosAchs', JSON.stringify(reclamosGuardados));
            
            console.log('üíæ Reclamo guardado:', datosReclamo);
            
            // Mostrar notificaci√≥n de √©xito
            if (typeof showNotification === 'function') {
                showNotification(
                    '‚úÖ Reclamo Guardado',
                    'El reclamo ha sido guardado correctamente en el sistema local.',
                    'success'
                );
            }
            
            alert('‚úÖ Reclamo guardado correctamente');
            return true;
        } catch (error) {
            console.error('‚ùå Error al guardar reclamo:', error);
            alert('‚ùå Error al guardar el reclamo. Int√©ntelo nuevamente.');
            return false;
        }
    }
    
    // Funci√≥n para generar resumen del reclamo
    function generarResumenReclamo() {
        const datos = obtenerDatosReclamo();
        const fecha = new Date().toLocaleDateString();
        const hora = new Date().toLocaleTimeString();
        
        return `üè¢ === RECLAMO ACHS - RESUMEN ===
üìÖ Fecha: ${fecha} - ${hora}

üë§ === INFORMACI√ìN DEL CLIENTE ===
Nombre: ${datos.nombreCliente}
RUT: ${datos.rutCliente}
Tel√©fono: ${datos.telefonoCliente}
Email: ${datos.emailCliente}

üì¢ === DETALLES DEL RECLAMO ===
Tipo: ${datos.tipoReclamo}
Prioridad: ${datos.prioridadReclamo}
Fecha del Incidente: ${datos.fechaIncidente || 'No especificada'}

Descripci√≥n:
${datos.descripcionReclamo}

üè¢ === INFORMACI√ìN INTERNA ACHS ===
√Årea/Departamento: ${datos.areaReclamo}
Ejecutivo: ${datos.ejecutivoReclamo}
N¬∞ de Caso: ${datos.casoReclamo}
Estado: ${datos.estadoReclamo}

Observaciones Internas:
${datos.observacionesInternas}

=== FIN DEL RESUMEN ===`;
    }
    
    // Funci√≥n para enviar reclamo por Teams
    function enviarReclamoTeams() {
        if (!validarFormularioReclamo()) {
            return;
        }
        
        const resumen = generarResumenReclamo();
        
        try {
            // Crear URL para Teams
            const mensaje = encodeURIComponent(resumen);
            const urlTeams = `https://teams.microsoft.com/l/chat/0/0?users=&topicName=Reclamo%20ACHS&message=${mensaje}`;
            
            // Abrir Teams
            window.open(urlTeams, '_blank');
            
            // Guardar reclamo
            if (guardarReclamo()) {
                // Mostrar confirmaci√≥n
                alert('‚úÖ Reclamo enviado por Microsoft Teams.\n\nEl reclamo tambi√©n ha sido guardado localmente.');
                
                // Cerrar modal
                cerrarModalReclamo();
            }
            
        } catch (error) {
            console.error('‚ùå Error al enviar por Teams:', error);
            alert('‚ùå Error al abrir Microsoft Teams. Int√©ntelo nuevamente.');
        }
    }
    
    // Funci√≥n para enviar reclamo por email
    function enviarReclamoEmail() {
        if (!validarFormularioReclamo()) {
            return;
        }
        
        const datos = obtenerDatosReclamo();
        const resumen = generarResumenReclamo();
        
        try {
            // Configurar email
            const asunto = `Reclamo ACHS - ${datos.tipoReclamo} - ${datos.nombreCliente}`;
            const cuerpo = encodeURIComponent(resumen);
            
            // Crear URL mailto
            const urlEmail = `mailto:?subject=${encodeURIComponent(asunto)}&body=${cuerpo}`;
            
            // Abrir cliente de email
            window.location.href = urlEmail;
            
            // Guardar reclamo
            if (guardarReclamo()) {
                // Mostrar confirmaci√≥n
                alert('‚úÖ Cliente de email abierto con el reclamo.\n\nEl reclamo tambi√©n ha sido guardado localmente.');
                
                // Cerrar modal
                cerrarModalReclamo();
            }
            
        } catch (error) {
            console.error('‚ùå Error al enviar por email:', error);
            alert('‚ùå Error al abrir cliente de email. Int√©ntelo nuevamente.');
        }
    }
    
    // Funci√≥n para cargar reclamos guardados
    function cargarReclamosGuardados() {
        try {
            const reclamos = JSON.parse(localStorage.getItem('reclamosAchs') || '[]');
            console.log(`üì¢ Cargados ${reclamos.length} reclamos guardados`);
            return reclamos;
        } catch (error) {
            console.error('‚ùå Error al cargar reclamos:', error);
            return [];
        }
    }
    
    // Funci√≥n para inicializar el sistema de reclamos
    function inicializarFormularioReclamo() {
        try {
            // Configurar bot√≥n de reclamos
            configurarBotonReclamo();
            
            // Configurar botones del modal
            const btnEnviarTeams = document.querySelector('#modalReclamo button[onclick*="enviarReclamoTeams"]');
            const btnEnviarEmail = document.querySelector('#modalReclamo button[onclick*="enviarReclamoEmail"]');
            const btnLimpiar = document.querySelector('#modalReclamo button[onclick*="limpiarFormularioReclamo"]');
            const btnCerrar = document.querySelector('#modalReclamo button[onclick*="cerrarModalReclamo"]');
            
            if (btnEnviarTeams) btnEnviarTeams.onclick = enviarReclamoTeams;
            if (btnEnviarEmail) btnEnviarEmail.onclick = enviarReclamoEmail;
            if (btnLimpiar) btnLimpiar.onclick = limpiarFormularioReclamo;
            if (btnCerrar) btnCerrar.onclick = cerrarModalReclamo;
            
            // Cargar reclamos existentes
            cargarReclamosGuardados();
            
            // Configurar cierre del modal al hacer clic fuera
            const modal = document.getElementById('modalReclamo');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        cerrarModalReclamo();
                    }
                });
            }
            
            console.log('üì¢ Sistema de reclamos inicializado correctamente');
            
        } catch (error) {
            console.error('‚ùå Error al inicializar sistema de reclamos:', error);
        }
    }
    
    // ===== FIN SISTEMA DE RECLAMOS =====

    // ===== SISTEMA DE RESPALDOS =====
    
    let backupConfig = {
        autoBackup: false,
        frequency: 'daily',
        time: '02:00',
        notifications: true,
        maxBackups: 10
    };
    
    let backupHistory = [];
    
    // Funciones principales del sistema de respaldos
    function abrirModalRespaldo() {
        const modal = document.getElementById('modalRespaldo');
        if (modal) {
            modal.style.display = 'block';
            modal.classList.add('show');
            actualizarEstadisticasRespaldo();
            actualizarHistorialRespaldo();
            cargarConfiguracionRespaldo();
        }
    }
    
    function cerrarModalRespaldo() {
        const modal = document.getElementById('modalRespaldo');
        if (modal) {
            modal.style.display = 'none';
            modal.classList.remove('show');
        }
    }
    
    function crearRespaldoCompleto() {
        const fechaActual = new Date();
        const timestamp = fechaActual.toISOString();
        
        try {
            // Recopilar todos los datos del sistema
            const datosRespaldo = {
                version: '1.0',
                fecha: timestamp,
                datos: {
                    ejecutivos: obtenerEjecutivos(),
                    estadisticas: obtenerEstadisticas(),
                    configuracion: obtenerConfiguracion(),
                    historial: obtenerHistorial(),
                    reclamos: obtenerReclamos(),
                    documentos: obtenerDocumentos(),
                    localStorage: { ...localStorage }
                }
            };
            
            // Crear archivo de respaldo
            const blob = new Blob([JSON.stringify(datosRespaldo, null, 2)], {
                type: 'application/json'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `respaldo_completo_${fechaActual.toISOString().split('T')[0]}_${fechaActual.getHours()}${fechaActual.getMinutes()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Registrar en historial
            const respaldo = {
                id: Date.now(),
                tipo: 'Completo',
                fecha: fechaActual.toLocaleDateString('es-ES'),
                hora: fechaActual.toLocaleTimeString('es-ES'),
                tama√±o: formatearTama√±o(blob.size),
                estado: 'Exitoso'
            };
            
            backupHistory.unshift(respaldo);
            guardarHistorialRespaldo();
            actualizarHistorialRespaldo();
            actualizarEstadisticasRespaldo();
            
            mostrarNotificacion('‚úÖ Respaldo completo creado exitosamente', 'success');
            
        } catch (error) {
            console.error('Error al crear respaldo completo:', error);
            mostrarNotificacion('‚ùå Error al crear respaldo completo', 'error');
        }
    }
    
    function crearRespaldoRapido() {
        const fechaActual = new Date();
        const timestamp = fechaActual.toISOString();
        
        try {
            // Recopilar datos esenciales
            const datosRespaldo = {
                version: '1.0-quick',
                fecha: timestamp,
                datos: {
                    ejecutivos: obtenerEjecutivos(),
                    estadisticas: obtenerEstadisticas(),
                    configuracion: obtenerConfiguracion()
                }
            };
            
            // Crear archivo de respaldo
            const blob = new Blob([JSON.stringify(datosRespaldo, null, 2)], {
                type: 'application/json'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `respaldo_rapido_${fechaActual.toISOString().split('T')[0]}_${fechaActual.getHours()}${fechaActual.getMinutes()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Registrar en historial
            const respaldo = {
                id: Date.now(),
                tipo: 'R√°pido',
                fecha: fechaActual.toLocaleDateString('es-ES'),
                hora: fechaActual.toLocaleTimeString('es-ES'),
                tama√±o: formatearTama√±o(blob.size),
                estado: 'Exitoso'
            };
            
            backupHistory.unshift(respaldo);
            guardarHistorialRespaldo();
            actualizarHistorialRespaldo();
            actualizarEstadisticasRespaldo();
            
            mostrarNotificacion('‚úÖ Respaldo r√°pido creado exitosamente', 'success');
            
        } catch (error) {
            console.error('Error al crear respaldo r√°pido:', error);
            mostrarNotificacion('‚ùå Error al crear respaldo r√°pido', 'error');
        }
    }
    
    function programarRespaldoAutomatico() {
        const autoBackupToggle = document.getElementById('autoBackupToggle');
        
        if (autoBackupToggle && autoBackupToggle.checked) {
            backupConfig.autoBackup = true;
            
            // Calcular pr√≥ximo respaldo
            const ahora = new Date();
            const [hora, minuto] = backupConfig.time.split(':');
            const proximoRespaldo = new Date();
            proximoRespaldo.setHours(parseInt(hora), parseInt(minuto), 0, 0);
            
            // Si la hora ya pas√≥ hoy, programar para ma√±ana
            if (proximoRespaldo <= ahora) {
                proximoRespaldo.setDate(proximoRespaldo.getDate() + 1);
            }
            
            // Calcular tiempo hasta el pr√≥ximo respaldo
            const tiempoEspera = proximoRespaldo.getTime() - ahora.getTime();
            
            // Programar respaldo autom√°tico
            setTimeout(() => {
                if (backupConfig.autoBackup) {
                    crearRespaldoCompleto();
                    
                    if (backupConfig.notifications) {
                        mostrarNotificacion('üîÑ Respaldo autom√°tico completado', 'info');
                    }
                    
                    // Programar siguiente respaldo seg√∫n frecuencia
                    const siguienteIntervalo = backupConfig.frequency === 'daily' ? 24 * 60 * 60 * 1000 :
                                             backupConfig.frequency === 'weekly' ? 7 * 24 * 60 * 60 * 1000 :
                                             30 * 24 * 60 * 60 * 1000; // monthly
                    
                    setTimeout(() => programarRespaldoAutomatico(), siguienteIntervalo);
                }
            }, tiempoEspera);
            
            actualizarEstadisticasRespaldo();
            mostrarNotificacion('‚è∞ Respaldo autom√°tico programado', 'info');
            
        } else {
            backupConfig.autoBackup = false;
            mostrarNotificacion('‚èπÔ∏è Respaldo autom√°tico desactivado', 'info');
        }
        
        guardarConfiguracionRespaldo();
    }
    
    function restaurarRespaldo() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        
        input.onchange = function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const datosRespaldo = JSON.parse(event.target.result);
                    
                    if (confirm('‚ö†Ô∏è ¬øEst√° seguro de restaurar este respaldo? Esto sobrescribir√° todos los datos actuales.')) {
                        // Restaurar datos
                        if (datosRespaldo.datos.localStorage) {
                            Object.keys(datosRespaldo.datos.localStorage).forEach(key => {
                                localStorage.setItem(key, datosRespaldo.datos.localStorage[key]);
                            });
                        }
                        
                        // Registrar restauraci√≥n en historial
                        const restauracion = {
                            id: Date.now(),
                            tipo: 'Restauraci√≥n',
                            fecha: new Date().toLocaleDateString('es-ES'),
                            hora: new Date().toLocaleTimeString('es-ES'),
                            tama√±o: formatearTama√±o(JSON.stringify(datosRespaldo).length),
                            estado: 'Exitoso'
                        };
                        
                        backupHistory.unshift(restauracion);
                        guardarHistorialRespaldo();
                        
                        mostrarNotificacion('‚úÖ Respaldo restaurado exitosamente. Recargando p√°gina...', 'success');
                        
                        setTimeout(() => {
                            location.reload();
                        }, 2000);
                    }
                    
                } catch (error) {
                    console.error('Error al restaurar respaldo:', error);
                    mostrarNotificacion('‚ùå Error al restaurar respaldo: Archivo inv√°lido', 'error');
                }
            };
            
            reader.readAsText(file);
        };
        
        input.click();
    }
    
    // Funciones auxiliares del sistema de respaldos
    function actualizarEstadisticasRespaldo() {
        const totalRespaldos = backupHistory.length;
        const ultimoRespaldo = backupHistory[0];
        const respaldosExitosos = backupHistory.filter(r => r.estado === 'Exitoso').length;
        
        // Actualizar estad√≠sticas en el modal
        const statsContainer = document.querySelector('#modalRespaldo .backup-stats');
        if (statsContainer) {
            statsContainer.innerHTML = `
                <div class="col-md-3">
                    <div class="stat-card">
                        <h5>Total de Respaldos</h5>
                        <span class="stat-number">${totalRespaldos}</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <h5>Respaldos Exitosos</h5>
                        <span class="stat-number text-success">${respaldosExitosos}</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <h5>√öltimo Respaldo</h5>
                        <span class="stat-number">${ultimoRespaldo ? ultimoRespaldo.fecha : 'Nunca'}</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <h5>Pr√≥ximo Autom√°tico</h5>
                        <span class="stat-number">${backupConfig.autoBackup ? 'Programado' : 'Desactivado'}</span>
                    </div>
                </div>
            `;
        }
    }
    
    function actualizarHistorialRespaldo() {
        const tbody = document.querySelector('#modalRespaldo #backupHistoryTable tbody');
        if (!tbody) return;
        
        tbody.innerHTML = '';
        
        backupHistory.slice(0, 20).forEach(respaldo => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${respaldo.tipo}</td>
                <td>${respaldo.fecha}</td>
                <td>${respaldo.hora}</td>
                <td>${respaldo.tama√±o}</td>
                <td><span class="badge badge-${respaldo.estado === 'Exitoso' ? 'success' : 'danger'}">${respaldo.estado}</span></td>
            `;
            tbody.appendChild(tr);
        });
    }
    
    function cargarConfiguracionRespaldo() {
        const configGuardada = localStorage.getItem('backupConfig');
        if (configGuardada) {
            backupConfig = { ...backupConfig, ...JSON.parse(configGuardada) };
        }
        
        // Actualizar controles en el modal
        const autoBackupToggle = document.getElementById('autoBackupToggle');
        const backupFrequency = document.getElementById('backupFrequency');
        const backupTime = document.getElementById('backupTime');
        const backupNotifications = document.getElementById('backupNotifications');
        
        if (autoBackupToggle) autoBackupToggle.checked = backupConfig.autoBackup;
        if (backupFrequency) backupFrequency.value = backupConfig.frequency;
        if (backupTime) backupTime.value = backupConfig.time;
        if (backupNotifications) backupNotifications.checked = backupConfig.notifications;
    }
    
    function guardarConfiguracionRespaldo() {
        localStorage.setItem('backupConfig', JSON.stringify(backupConfig));
    }
    
    function guardarHistorialRespaldo() {
        localStorage.setItem('backupHistory', JSON.stringify(backupHistory));
    }
    
    function cargarHistorialRespaldo() {
        const historialGuardado = localStorage.getItem('backupHistory');
        if (historialGuardado) {
            backupHistory = JSON.parse(historialGuardado);
        }
    }
    
    function formatearTama√±o(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    // Funciones para obtener datos del sistema
    function obtenerEjecutivos() {
        return ejecutivos || [];
    }
    
    function obtenerEstadisticas() {
        return {
            llamadasAtendidas: document.querySelector('.stat-number')?.textContent || '0',
            satisfaccion: '95.2%',
            tiempoPromedio: '3:45',
            fecha: new Date().toISOString()
        };
    }
    
    function obtenerConfiguracion() {
        return {
            notificaciones: notificationConfig || {},
            respaldos: backupConfig,
            usuario: 'Administrador ACHS'
        };
    }
    
    function obtenerHistorial() {
        return historialActividades || [];
    }
    
    function obtenerReclamos() {
        return reclamos || [];
    }
    
    function obtenerDocumentos() {
        return documentos || [];
    }
    
    // Event Listeners para configuraci√≥n
    document.addEventListener('DOMContentLoaded', function() {
        cargarHistorialRespaldo();
        
        // Configurar eventos de cambio en la configuraci√≥n
        const autoBackupToggle = document.getElementById('autoBackupToggle');
        const backupFrequency = document.getElementById('backupFrequency');
        const backupTime = document.getElementById('backupTime');
        const backupNotifications = document.getElementById('backupNotifications');
        
        if (autoBackupToggle) {
            autoBackupToggle.addEventListener('change', function() {
                programarRespaldoAutomatico();
            });
        }
        
        if (backupFrequency) {
            backupFrequency.addEventListener('change', function() {
                backupConfig.frequency = this.value;
                guardarConfiguracionRespaldo();
            });
        }
        
        if (backupTime) {
            backupTime.addEventListener('change', function() {
                backupConfig.time = this.value;
                guardarConfiguracionRespaldo();
            });
        }
        
        if (backupNotifications) {
            backupNotifications.addEventListener('change', function() {
                backupConfig.notifications = this.checked;
                guardarConfiguracionRespaldo();
            });
        }
    });
    
    // ===== FIN SISTEMA DE RESPALDOS =====

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // ‚úÖ JAVASCRIPT INTEGRADO DESDE app.js - 2025-11-11
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    // ============================
    // ‚úÖ B√öSQUEDA R√ÅPIDA (Ctrl+K)
    // ============================
    (() => {
        const elO = document.getElementById('busquedaRapidaOverlay');
        const elM = document.getElementById('busquedaRapidaModal');
        const elIn = document.getElementById('busquedaRapidaInput');
        const elRes = document.getElementById('busquedaResultados');
        const elHint = document.getElementById('busquedaRapidaHint');

        let indiceSeleccionado = -1;
        let resultados = [];

        function abrirBusqueda() {
            if (!elO || !elM || !elIn) return;
            elO.style.display = 'flex';
            setTimeout(() => {
                elM.classList.add('activo');
                elIn.focus();
            }, 10);
        }

        function cerrarBusqueda() {
            if (!elO || !elM || !elIn) return;
            elM.classList.remove('activo');
            setTimeout(() => {
                elO.style.display = 'none';
                elIn.value = '';
                if (elRes) elRes.innerHTML = '';
                if (elHint) elHint.style.display = 'block';
                indiceSeleccionado = -1;
                resultados = [];
            }, 200);
        }

        function buscarEnDOM(query) {
            const norm = query.toLowerCase();
            resultados = [];

            // Buscar en todos los <details> y <summary>
            const details = document.querySelectorAll('details');
            details.forEach((det) => {
                const sum = det.querySelector('summary');
                if (!sum) return;
                const texto = sum.textContent.toLowerCase();
                if (texto.includes(norm)) {
                    resultados.push({
                        tipo: 'Secci√≥n',
                        titulo: sum.textContent.trim(),
                        elemento: det
                    });
                }
            });

            // Buscar en h3 y otros headings
            const headings = document.querySelectorAll('h3, h4, h5');
            headings.forEach((h) => {
                const texto = h.textContent.toLowerCase();
                if (texto.includes(norm)) {
                    resultados.push({
                        tipo: 'T√≠tulo',
                        titulo: h.textContent.trim(),
                        elemento: h
                    });
                }
            });

            // Buscar en botones
            const botones = document.querySelectorAll('button');
            botones.forEach((btn) => {
                const texto = btn.textContent.toLowerCase();
                if (texto.includes(norm)) {
                    resultados.push({
                        tipo: 'Bot√≥n',
                        titulo: btn.textContent.trim(),
                        elemento: btn
                    });
                }
            });

            mostrarResultados();
        }

        function mostrarResultados() {
            if (!elRes || !elHint) return;
            if (resultados.length === 0) {
                elRes.innerHTML = '<div style="padding: 20px; text-align: center; color: #888;">Sin resultados</div>';
                elHint.style.display = 'none';
                return;
            }

            elHint.style.display = 'none';
            elRes.innerHTML = '';
            resultados.forEach((r, idx) => {
                const div = document.createElement('div');
                div.className = 'busqueda-item';
                if (idx === indiceSeleccionado) div.classList.add('seleccionado');
                div.innerHTML = `<span class="tipo-resultado">${r.tipo}</span> ${r.titulo}`;
                div.addEventListener('click', () => {
                    navegarA(r);
                    cerrarBusqueda();
                });
                elRes.appendChild(div);
            });
        }

        function navegarA(resultado) {
            const el = resultado.elemento;
            if (!el) return;

            // Si es un details, abrirlo
            if (el.tagName === 'DETAILS') {
                el.open = true;
            }

            // Scroll suave
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Highlight temporal
            el.style.transition = 'background 0.3s';
            el.style.background = 'rgba(255, 235, 59, 0.3)';
            setTimeout(() => {
                el.style.background = '';
            }, 1500);
        }

        // Tecla global Ctrl+K
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'k') {
                e.preventDefault();
                abrirBusqueda();
            }

            if (e.key === 'Escape' && elO && elO.style.display === 'flex') {
                e.preventDefault();
                cerrarBusqueda();
            }
        });

        // Input de b√∫squeda
        if (elIn) {
            elIn.addEventListener('input', (e) => {
                const val = e.target.value.trim();
                if (val.length > 1) {
                    buscarEnDOM(val);
                } else {
                    if (elRes) elRes.innerHTML = '';
                    if (elHint) elHint.style.display = 'block';
                    resultados = [];
                    indiceSeleccionado = -1;
                }
            });

            elIn.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (resultados.length > 0) {
                        indiceSeleccionado = Math.min(indiceSeleccionado + 1, resultados.length - 1);
                        mostrarResultados();
                    }
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (resultados.length > 0) {
                        indiceSeleccionado = Math.max(indiceSeleccionado - 1, 0);
                        mostrarResultados();
                    }
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (indiceSeleccionado >= 0 && indiceSeleccionado < resultados.length) {
                        navegarA(resultados[indiceSeleccionado]);
                        cerrarBusqueda();
                    }
                }
            });
        }

        // Click fuera cierra
        if (elO) {
            elO.addEventListener('click', (e) => {
                if (e.target === elO) cerrarBusqueda();
            });
        }
    })();

    // ============================
    // ‚úÖ BOT√ìN GRABAR
    // ============================
    (() => {
        const btn = document.getElementById('btnGrabar');
        if (!btn) return;

        btn.addEventListener('click', () => {
            const container = document.querySelector('.container');
            if (!container) {
                alert('No se encuentra el contenedor principal.');
                return;
            }

            const html = container.innerHTML;
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ACHS_Ejecutivo_${new Date().toISOString().split('T')[0]}.html`;
            a.click();
            URL.revokeObjectURL(url);

            // Animaci√≥n de confirmaci√≥n
            btn.textContent = '‚úÖ Guardado';
            setTimeout(() => {
                btn.textContent = 'üíæ Grabar';
            }, 2000);
        });
    })();

    // ============================
    // ‚úÖ CALENDARIO CHILE FLOTANTE
    // ============================
    (() => {
        const panel = document.getElementById('panelCalendarioCL');
        const grid = document.getElementById('calGrid');
        const titulo = document.getElementById('calTitulo');
        const pie = document.getElementById('calFooter');

        let mesActual = new Date().getMonth();
        let anioActual = new Date().getFullYear();

        const MESES = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                      'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];

        const feriadosChile2025 = new Map([
            ['2025-01-01', 'A√±o Nuevo'],
            ['2025-04-18', 'Viernes Santo'],
            ['2025-04-19', 'S√°bado Santo'],
            ['2025-05-01', 'D√≠a del Trabajador'],
            ['2025-05-21', 'D√≠a de las Glorias Navales'],
            ['2025-06-20', 'D√≠a de los Pueblos Ind√≠genas'],
            ['2025-06-29', 'San Pedro y San Pablo'],
            ['2025-07-16', 'Virgen del Carmen'],
            ['2025-08-15', 'Asunci√≥n de la Virgen'],
            ['2025-09-18', 'Primera Junta Nacional de Gobierno'],
            ['2025-09-19', 'D√≠a de las Glorias del Ej√©rcito'],
            ['2025-10-12', 'Encuentro de Dos Mundos'],
            ['2025-10-31', 'D√≠a de las Iglesias Evang√©licas y Protestantes'],
            ['2025-11-01', 'D√≠a de Todos los Santos'],
            ['2025-12-08', 'Inmaculada Concepci√≥n'],
            ['2025-12-25', 'Navidad']
        ]);

        function renderizarCalendario(mes, anio) {
            console.log('[ACHS_CALENDARIO] Renderizando calendario:', MESES[mes], anio);
            if (!grid || !titulo || !pie) {
                console.error('[ACHS_CALENDARIO] ERROR: Faltan elementos DOM:', {
                    grid: !!grid,
                    titulo: !!titulo,
                    pie: !!pie
                });
                return;
            }

            titulo.textContent = `${MESES[mes]} ${anio}`;

            const primerDia = new Date(anio, mes, 1).getDay();
            const diasEnMes = new Date(anio, mes + 1, 0).getDate();

            // Ajustar para que la semana comience en lunes (0=domingo, 1=lunes, etc.)
            const primerDiaAjustado = primerDia === 0 ? 6 : primerDia - 1;

            let html = '<div class="cal-header">Lu</div><div class="cal-header">Ma</div><div class="cal-header">Mi</div>' +
                      '<div class="cal-header">Ju</div><div class="cal-header">Vi</div><div class="cal-header">Sa</div>' +
                      '<div class="cal-header">Do</div>';

            for (let i = 0; i < primerDiaAjustado; i++) {
                html += '<div class="cal-day"></div>';
            }

            const hoy = new Date();
            const esHoyMesAnio = (hoy.getMonth() === mes && hoy.getFullYear() === anio);

            for (let dia = 1; dia <= diasEnMes; dia++) {
                const diaSemana = new Date(anio, mes, dia).getDay();
                const esDomingo = diaSemana === 0;
                const esHoy = esHoyMesAnio && dia === hoy.getDate();
                const fecha = `${anio}-${String(mes + 1).padStart(2, '0')}-${String(dia).padStart(2, '0')}`;
                const feriado = feriadosChile2025.get(fecha);

                let clase = 'cal-day';
                if (esHoy) clase += ' cal-hoy';
                if (esDomingo || feriado) clase += ' cal-feriado';

                let titulo = '';
                if (feriado) titulo = `title="${feriado}"`;

                html += `<div class="${clase}" ${titulo}>${dia}</div>`;
            }

            grid.innerHTML = html;
            pie.textContent = `Hoy: ${hoy.getDate()}/${hoy.getMonth() + 1}/${hoy.getFullYear()}`;
        }

        window.toggleCalendarioCL = function() {
            console.log('[ACHS_CALENDARIO] Toggle calendario');
            if (!panel) {
                console.error('[ACHS_CALENDARIO] ERROR: No se encuentra el panel #panelCalendarioCL');
                return;
            }
            const visible = panel.style.display === 'block';
            panel.style.display = visible ? 'none' : 'block';
            if (!visible) {
                renderizarCalendario(mesActual, anioActual);
            }
        };

        window.calCambiarMes = function(delta) {
            console.log('[ACHS_CALENDARIO] Cambiando mes:', delta);
            mesActual += delta;
            if (mesActual > 11) { mesActual = 0; anioActual++; }
            if (mesActual < 0) { mesActual = 11; anioActual--; }
            renderizarCalendario(mesActual, anioActual);
        };

        window.calIrAHoy = function() {
            console.log('[ACHS_CALENDARIO] Navegando a hoy');
            const hoy = new Date();
            mesActual = hoy.getMonth();
            anioActual = hoy.getFullYear();
            renderizarCalendario(mesActual, anioActual);
        };

        renderizarCalendario(mesActual, anioActual);
    })();

    // ============================
    // ‚úÖ SISTEMA DE MODALES
    // ============================
    window.abrirModal = function(idModal) {
        const modal = document.getElementById(idModal);
        if (!modal) return;
        modal.style.display = 'flex';
        setTimeout(() => modal.classList.add('activo'), 10);
    };

    window.cerrarModal = function(idModal) {
        const modal = document.getElementById(idModal);
        if (!modal) return;
        modal.classList.remove('activo');
        setTimeout(() => modal.style.display = 'none', 300);
    };

    document.querySelectorAll('[data-modal]').forEach(btn => {
        btn.addEventListener('click', () => {
            const idModal = btn.getAttribute('data-modal');
            abrirModal(idModal);
        });
    });

    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                cerrarModal(modal.id);
            }
        });

        const btnCerrar = modal.querySelector('.btn-cerrar-modal');
        if (btnCerrar) {
            btnCerrar.addEventListener('click', () => cerrarModal(modal.id));
        }
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            document.querySelectorAll('.modal.activo').forEach(m => {
                cerrarModal(m.id);
            });
        }
    });

    // ============================
    // ‚úÖ SUBMENU SNL
    // ============================
    (() => {
        const submenu = document.querySelector('.submenu-snl');
        const btnSNL = document.querySelector('button[onclick="toggleSubmenuSNL()"]');

        window.toggleSubmenuSNL = function() {
            if (!submenu) return;
            const visible = submenu.classList.contains('visible');
            submenu.classList.toggle('visible', !visible);
        };

        if (submenu) {
            submenu.addEventListener('keydown', (e) => {
                const items = Array.from(submenu.querySelectorAll('li'));
                const activo = document.activeElement;
                const idx = items.findIndex(li => li.contains(activo));

                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    const siguiente = items[idx + 1] || items[0];
                    siguiente.querySelector('a, button')?.focus();
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    const anterior = items[idx - 1] || items[items.length - 1];
                    anterior.querySelector('a, button')?.focus();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    submenu.classList.remove('visible');
                    btnSNL?.focus();
                }
            });
        }

        document.addEventListener('click', (e) => {
            if (submenu && !submenu.contains(e.target) && e.target !== btnSNL) {
                submenu.classList.remove('visible');
            }
        });
    })();

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // ‚úÖ FIN JAVASCRIPT INTEGRADO
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    </script>
<!-- Eliminado duplicado del bot√≥n/modal de ayuda: reubicado cerca del primer body -->
</body>

</html>